<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cuestionario: Gen√©tica y Gen√≥mica (Bloque X)</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f4f4f9;
            color: #333;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        h1 {
            text-align: center;
            color: #2c3e50;
            margin-bottom: 30px;
        }
        .quiz-container {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            min-height: 200px;
        }
        .question-block {
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #eee;
            position: relative; /* Para posicionar el marcador */
        }
        
        /* Estilos para el marcador (Pesta√±a) */
        .mark-container {
            position: absolute;
            top: 0;
            right: 0;
            font-size: 0.9em;
            background-color: #f8f9fa;
            padding: 5px 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        .mark-container:hover {
            background-color: #e2e6ea;
        }
        .mark-container input {
            cursor: pointer;
            transform: scale(1.2);
        }

        .question-title {
            font-size: 1.1em;
            margin-bottom: 15px;
            font-weight: 600;
            padding-right: 120px; /* Espacio para que el texto no tape el marcador */
        }
        .options-list {
            list-style-type: none;
            padding: 0;
        }
        .option-item {
            margin-bottom: 10px;
        }
        .option-btn {
            display: block;
            width: 100%;
            text-align: left;
            padding: 12px 15px;
            background-color: #fff;
            border: 1px solid #ddd;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 0.95em;
            color: #444;
        }
        .option-btn:hover {
            background-color: #f0f0f0;
            border-color: #bbb;
        }
        
        /* Estilos de correcci√≥n */
        .correct {
            background-color: #d4edda !important;
            border-color: #c3e6cb !important;
            color: #155724 !important;
            position: relative;
        }
        .correct::after {
            content: " ‚úì Correcto";
            font-weight: bold;
            float: right;
        }
        
        .incorrect {
            background-color: #f8d7da !important;
            border-color: #f5c6cb !important;
            color: #721c24 !important;
            position: relative;
        }
        .incorrect::after {
            content: " ‚úó Incorrecto";
            font-weight: bold;
            float: right;
        }

        .disabled {
            pointer-events: none;
            opacity: 0.8;
        }

        /* Panel de Resultados y Botones de Reintento */
        #results-panel {
            display: none; /* Oculto por defecto */
            text-align: center;
            margin-top: 40px;
            padding: 30px;
            background: #fff;
            border-radius: 8px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            border-top: 5px solid #2c3e50;
        }
        .retry-buttons-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-top: 20px;
        }
        .retry-btn {
            padding: 15px;
            font-size: 1em;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            color: white;
            transition: opacity 0.2s;
        }
        .retry-btn:hover { opacity: 0.9; }
        .btn-full { background-color: #3498db; }
        .btn-failed { background-color: #e74c3c; }
        .btn-marked { background-color: #f39c12; }
        .btn-mixed { background-color: #9b59b6; }
        
        .btn-finish-main {
            background: #2c3e50; 
            color: white; 
            border: none; 
            padding: 15px 30px; 
            font-size: 1.2em; 
            border-radius: 6px; 
            cursor: pointer; 
            font-weight: bold;
            margin-top: 40px;
            display: block;
            width: 100%;
        }

        @media (max-width: 600px) {
            .retry-buttons-grid { grid-template-columns: 1fr; }
            .question-title { padding-right: 0; margin-top: 40px; }
            .mark-container { width: 100%; box-sizing: border-box; justify-content: flex-end; border: none; background: transparent; }
        }
    </style>
</head>
<body>

    <h1 id="quiz-title">Test Bloque X: Gen√©tica Humana y Gen√≥mica</h1>
    
    <div class="quiz-container" id="quiz">
        </div>

    <button id="btn-finish" class="btn-finish-main">
        üèÅ Finalizar Correcci√≥n
    </button>

    <div id="results-panel">
        <h2>üìä Resultados</h2>
        <p id="score-text" style="font-size: 1.2em; margin: 20px 0;"></p>
        
        <h3>¬øQu√© deseas hacer ahora?</h3>
        <div class="retry-buttons-grid">
            <button class="retry-btn btn-full" onclick="retryQuiz('all')">üîÑ Repetir Completo</button>
            <button class="retry-btn btn-failed" onclick="retryQuiz('failed')">‚ùå Repetir Falladas</button>
            <button class="retry-btn btn-marked" onclick="retryQuiz('marked')">üîñ Repetir Marcadas</button>
            <button class="retry-btn btn-mixed" onclick="retryQuiz('mixed')">‚ùå + üîñ Falladas y Marcadas</button>
        </div>
        <br>
        <button onclick="window.location.href='index.html'" style="background:transparent; border:1px solid #666; padding:10px; border-radius:4px; cursor:pointer;">Volver al Men√∫ Principal</button>
    </div>

    <script>
        // Definici√≥n de preguntas
        const questionsSource = [
  {
    "id": "1",
    "text": "En el estudio de la Gen√≥mica Biom√©dica Humana, cuando un solo genotipo influye en m√∫ltiples rasgos fenot√≠picos no relacionados (caracter√≠sticas distintas), se hace referencia al concepto de:",
    "options": [
      { "text": "Poligenia.", "correct": false },
      { "text": "Epistasis.", "correct": false },
      { "text": "Expresividad variable.", "correct": false },
      { "text": "Pleiotrop√≠a.", "correct": true }
    ]
  },
  {
    "id": "2",
    "text": "La correlaci√≥n genotipo/fenotipo se modula por diversos factores. El concepto de Penetrancia se refiere espec√≠ficamente a:",
    "options": [
      { "text": "El grado o la intensidad con la que se manifiesta un rasgo gen√©tico en los individuos portadores del genotipo.", "correct": false },
      { "text": "La interacci√≥n entre m√∫ltiples genes que contribuyen a un √∫nico rasgo cuantitativo.", "correct": false },
      { "text": "La probabilidad de que un individuo que posee un genotipo asociado a una enfermedad manifieste el fenotipo correspondiente.", "correct": true },
      { "text": "El efecto dominante negativo de una mutaci√≥n que se expresa con p√©rdida de funci√≥n.", "correct": false }
    ]
  },
  {
    "id": "3",
    "text": "¬øCu√°l de los siguientes patrones hereditarios est√° asociado a genes localizados en los autosomas y requiere que la secuencia gen√©tica alterada o ausente tenga un efecto fenot√≠pico independientemente de la presencia del alelo en el otro cromosoma, es decir, el gen va en dosis doble en las c√©lulas diploides?",
    "options": [
      { "text": "Ligado al cromosoma X recesivo.", "correct": false },
      { "text": "Mitocondrial.", "correct": false },
      { "text": "Autos√≥mico dominante.", "correct": true },
      { "text": "Autos√≥mico recesivo.", "correct": false }
    ]
  },
  {
    "id": "4",
    "text": "La variabilidad gen√©tica esencial para la adaptaci√≥n y evoluci√≥n es generada principalmente en organismos superiores a trav√©s de:",
    "options": [
      { "text": "La reproducci√≥n asexual y la acumulaci√≥n de mutaciones puntuales.", "correct": false },
      { "text": "La Reproducci√≥n sexual, mediante la recombinaci√≥n y la segregaci√≥n independiente de cromosomas.", "correct": true },
      { "text": "La metilaci√≥n del ADN en regiones promotoras.", "correct": false },
      { "text": "La duplicaci√≥n de genomas completos por endomitosis.", "correct": false }
    ]
  },
  {
    "id": "5",
    "text": "Los Alelos son:",
    "options": [
      { "text": "Diferentes tipos de c√©lulas.", "correct": false },
      { "text": "Las formas alternativas o variantes de un mismo gen que ocupan el mismo locus.", "correct": true },
      { "text": "Cromosomas hom√≥logos.", "correct": false },
      { "text": "Prote√≠nas reguladoras.", "correct": false }
    ]
  },
  {
    "id": "6",
    "text": "Un individuo Homocigoto para un gen espec√≠fico:",
    "options": [
      { "text": "Tiene dos alelos id√©nticos en ambos cromosomas hom√≥logos.", "correct": true },
      { "text": "Tiene dos alelos diferentes.", "correct": false },
      { "text": "Solo tiene un alelo (ej. cromosoma X en varones). " , "correct": false },
      { "text": "No tiene el gen.", "correct": false }
    ]
  },
  {
    "id": "7",
    "text": "Un individuo Heterocigoto para un gen espec√≠fico:",
    "options": [
      { "text": "Tiene dos alelos id√©nticos.", "correct": false },
      { "text": "Tiene dos alelos diferentes (ej. uno normal y uno mutado) en los cromosomas hom√≥logos.", "correct": true },
      { "text": "Es hemicigoto.", "correct": false },
      { "text": "Es triploide.", "correct": false }
    ]
  },
  {
    "id": "8",
    "text": "La herencia Ligada al Cromosoma X recesiva se caracteriza porque:",
    "options": [
      { "text": "Afecta por igual a hombres y mujeres.", "correct": false },
      { "text": "Afecta principalmente a los varones (hemicigotos), mientras que las mujeres suelen ser portadoras sanas.", "correct": true },
      { "text": "Se transmite de padre a hijo var√≥n.", "correct": false },
      { "text": "Requiere mutaci√≥n en ambas copias en el var√≥n.", "correct": false }
    ]
  },
  {
    "id": "9",
    "text": "La herencia Mitocondrial se transmite exclusivamente:",
    "options": [
      { "text": "Por el padre.", "correct": false },
      { "text": "Por la madre a todos sus hijos (varones y mujeres).", "correct": true },
      { "text": "Por los abuelos.", "correct": false },
      { "text": "Aleatoriamente.", "correct": false }
    ]
  },
  {
    "id": "10",
    "text": "Los rasgos Polig√©nicos o Multifactoriales son aquellos:",
    "options": [
      { "text": "Determinados por un solo gen.", "correct": false },
      { "text": "Determinados por la interacci√≥n de m√∫ltiples genes y factores ambientales (rasgos cuantitativos como la altura).", "correct": true },
      { "text": "Que no se heredan.", "correct": false },
      { "text": "Exclusivos de bacterias.", "correct": false }
    ]
  },
  {
    "id": "11",
    "text": "La Haploinsuficiencia ocurre cuando:",
    "options": [
      { "text": "Hay demasiadas copias del gen.", "correct": false },
      { "text": "Una sola copia funcional del gen (50% de producto) no es suficiente para mantener el fenotipo normal.", "correct": true },
      { "text": "El gen est√° silenciado.", "correct": false },
      { "text": "El alelo mutado mejora la funci√≥n.", "correct": false }
    ]
  },
  {
    "id": "12",
    "text": "El efecto Dominante Negativo se produce cuando:",
    "options": [
      { "text": "El alelo mutado no se expresa.", "correct": false },
      { "text": "La prote√≠na mutada interfiere o da√±a la funci√≥n de la prote√≠na normal producida por el otro alelo.", "correct": true },
      { "text": "El alelo normal domina.", "correct": false },
      { "text": "Hay una deleci√≥n completa.", "correct": false }
    ]
  },
  {
    "id": "13",
    "text": "Una mutaci√≥n de Ganancia de Funci√≥n (Gain-of-Function) suele ser:",
    "options": [
      { "text": "Recesiva.", "correct": false },
      { "text": "Dominante, ya que la prote√≠na adquiere una actividad nueva o t√≥xica.", "correct": true },
      { "text": "Silenciosa.", "correct": false },
      { "text": "Beneficiosa siempre.", "correct": false }
    ]
  },
  {
    "id": "14",
    "text": "Una mutaci√≥n de P√©rdida de Funci√≥n (Loss-of-Function) suele ser:",
    "options": [
      { "text": "Dominante.", "correct": false },
      { "text": "Recesiva (si hay haplosuficiencia), requiriendo que ambos alelos est√©n afectados para mostrar el fenotipo.", "correct": true },
      { "text": "Letal siempre.", "correct": false },
      { "text": "Codominante.", "correct": false }
    ]
  },
  {
    "id": "15",
    "text": "La Codominancia se observa cuando:",
    "options": [
      { "text": "Un alelo oculta al otro.", "correct": false },
      { "text": "Ambos alelos se expresan y sus fenotipos se manifiestan simult√°neamente (ej. grupo sangu√≠neo AB).", "correct": true },
      { "text": "El fenotipo es intermedio.", "correct": false },
      { "text": "El gen est√° en el cromosoma Y.", "correct": false }
    ]
  },
  {
    "id": "16",
    "text": "Una Mutaci√≥n Puntual (SNP) implica:",
    "options": [
      { "text": "La p√©rdida de un cromosoma.", "correct": false },
      { "text": "El cambio de un solo nucle√≥tido en la secuencia de ADN.", "correct": true },
      { "text": "La inversi√≥n de un segmento grande.", "correct": false },
      { "text": "La duplicaci√≥n del genoma.", "correct": false }
    ]
  },
  {
    "id": "17",
    "text": "Una mutaci√≥n Frameshift (cambio de marco de lectura) es causada por:",
    "options": [
      { "text": "Sustituci√≥n de nucle√≥tidos.", "correct": false },
      { "text": "Inserci√≥n o deleci√≥n de un n√∫mero de nucle√≥tidos que no es m√∫ltiplo de 3, alterando toda la secuencia proteica posterior.", "correct": true },
      { "text": "Metilaci√≥n.", "correct": false },
      { "text": "Crossing-over.", "correct": false }
    ]
  },
  {
    "id": "18",
    "text": "Una mutaci√≥n Missense (de sentido err√≥neo) provoca:",
    "options": [
      { "text": "Un cod√≥n de parada prematuro.", "correct": false },
      { "text": "El cambio de un amino√°cido por otro en la prote√≠na.", "correct": true },
      { "text": "Ning√∫n cambio en la prote√≠na.", "correct": false },
      { "text": "La eliminaci√≥n del gen.", "correct": false }
    ]
  },
  {
    "id": "19",
    "text": "Una mutaci√≥n Nonsense (sin sentido) introduce:",
    "options": [
      { "text": "Un amino√°cido diferente.", "correct": false },
      { "text": "Un cod√≥n de parada (stop) prematuro, generando una prote√≠na truncada.", "correct": true },
      { "text": "Un intr√≥n.", "correct": false },
      { "text": "Una repetici√≥n.", "correct": false }
    ]
  },
  {
    "id": "20",
    "text": "Una mutaci√≥n Sin√≥nima (silenciosa):",
    "options": [
      { "text": "Cambia el amino√°cido.", "correct": false },
      { "text": "No cambia la secuencia de amino√°cidos de la prote√≠na (debido a la degeneraci√≥n del c√≥digo gen√©tico).", "correct": true },
      { "text": "Causa enfermedad siempre.", "correct": false },
      { "text": "Altera el splicing.", "correct": false }
    ]
  },
  {
    "id": "21",
    "text": "Las Variantes de N√∫mero de Copias (CNV) son:",
    "options": [
      { "text": "Mutaciones puntuales.", "correct": false },
      { "text": "Variaciones estructurales donde segmentos de ADN (kb a Mb) est√°n duplicados o delecionados en comparaci√≥n con el genoma de referencia.", "correct": true },
      { "text": "Cambios epigen√©ticos.", "correct": false },
      { "text": "ARN no codificante.", "correct": false }
    ]
  },
  {
    "id": "22",
    "text": "Una Deleci√≥n cromos√≥mica implica:",
    "options": [
      { "text": "La ganancia de material gen√©tico.", "correct": false },
      { "text": "La p√©rdida de un segmento cromos√≥mico.", "correct": true },
      { "text": "El intercambio entre cromosomas.", "correct": false },
      { "text": "La inversi√≥n de un segmento.", "correct": false }
    ]
  },
  {
    "id": "23",
    "text": "Una Duplicaci√≥n cromos√≥mica implica:",
    "options": [
      { "text": "La p√©rdida de genes.", "correct": false },
      { "text": "La presencia de una copia extra de un segmento cromos√≥mico (ganancia de material).", "correct": true },
      { "text": "La fusi√≥n de cromosomas.", "correct": false },
      { "text": "La separaci√≥n de crom√°tidas.", "correct": false }
    ]
  },
  {
    "id": "24",
    "text": "Una Inversi√≥n cromos√≥mica:",
    "options": [
      { "text": "Cambia el n√∫mero de genes.", "correct": false },
      { "text": "Invierte la orientaci√≥n de un segmento cromos√≥mico (giro de 180 grados).", "correct": true },
      { "text": "Duplica el centr√≥mero.", "correct": false },
      { "text": "Elimina tel√≥meros.", "correct": false }
    ]
  },
  {
    "id": "25",
    "text": "Una Translocaci√≥n cromos√≥mica implica:",
    "options": [
      { "text": "Mutaci√≥n puntual.", "correct": false },
      { "text": "El intercambio de segmentos entre cromosomas no hom√≥logos.", "correct": true },
      { "text": "La p√©rdida de un cromosoma completo.", "correct": false },
      { "text": "La replicaci√≥n del ADN.", "correct": false }
    ]
  },
  {
    "id": "26",
    "text": "La Expresividad Variable se refiere a:",
    "options": [
      { "text": "Si se tiene o no la enfermedad (penetrancia).", "correct": false },
      { "text": "El grado o intensidad de las manifestaciones cl√≠nicas (fenotipo) en individuos con el mismo genotipo.", "correct": true },
      { "text": "La frecuencia de la mutaci√≥n en la poblaci√≥n.", "correct": false },
      { "text": "El tipo de herencia.", "correct": false }
    ]
  },
  {
    "id": "27",
    "text": "La Anticipaci√≥n Gen√©tica es un fen√≥meno donde:",
    "options": [
      { "text": "La enfermedad desaparece con las generaciones.", "correct": false },
      { "text": "La enfermedad aparece a una edad m√°s temprana y/o con mayor gravedad en generaciones sucesivas (ej. expansi√≥n de tripletes).", "correct": true },
      { "text": "La enfermedad salta generaciones.", "correct": false },
      { "text": "Solo afecta a mujeres.", "correct": false }
    ]
  },
  {
    "id": "28",
    "text": "El Mosaico Gen√©tico (Mosaicismo) se define por la presencia de:",
    "options": [
      { "text": "Genes de diferentes especies.", "correct": false },
      { "text": "Dos o m√°s l√≠neas celulares con diferente genotipo en un mismo individuo, derivadas de un √∫nico cigoto.", "correct": true },
      { "text": "C√©lulas fusionadas.", "correct": false },
      { "text": "Cromosomas extra.", "correct": false }
    ]
  },
  {
    "id": "29",
    "text": "Una Quimera es un individuo compuesto por:",
    "options": [
      { "text": "C√©lulas mutadas.", "correct": false },
      { "text": "C√©lulas derivadas de dos o m√°s cigotos distintos que se fusionaron.", "correct": true },
      { "text": "C√©lulas clonadas.", "correct": false },
      { "text": "C√©lulas tumorales.", "correct": false }
    ]
  },
  {
    "id": "30",
    "text": "La Epigen√©tica estudia cambios heredables en la expresi√≥n g√©nica que:",
    "options": [
      { "text": "Implican cambios en la secuencia de ADN.", "correct": false },
      { "text": "No implican cambios en la secuencia de ADN (ej. metilaci√≥n, modificaci√≥n de histonas).", "correct": true },
      { "text": "Son irreversibles.", "correct": false },
      { "text": "Ocurren solo en bacterias.", "correct": false }
    ]
  },
  {
    "id": "31",
    "text": "Los Estudios de Asociaci√≥n del Genoma Completo (GWAS) buscan:",
    "options": [
      { "text": "Secuenciar un gen espec√≠fico.", "correct": false },
      { "text": "Identificar variantes gen√©ticas (SNPs) asociadas estad√≠sticamente con un rasgo o enfermedad en toda la poblaci√≥n.", "correct": true },
      { "text": "Clonar individuos.", "correct": false },
      { "text": "Modificar el ADN.", "correct": false }
    ]
  },
  {
    "id": "32",
    "text": "Un Manhattan Plot es una representaci√≥n gr√°fica utilizada en GWAS para visualizar:",
    "options": [
      { "text": "El cariotipo.", "correct": false },
      { "text": "Los SNPs significativamente asociados con el rasgo (picos altos indican asociaci√≥n fuerte).", "correct": true },
      { "text": "La estructura del ADN.", "correct": false },
      { "text": "La expresi√≥n de prote√≠nas.", "correct": false }
    ]
  },
  {
    "id": "33",
    "text": "El Desequilibrio de Ligamiento (LD) se refiere a:",
    "options": [
      { "text": "La segregaci√≥n independiente perfecta.", "correct": false },
      { "text": "La asociaci√≥n no aleatoria de alelos en diferentes loci (se heredan juntos m√°s frecuentemente de lo esperado).", "correct": true },
      { "text": "La falta de genes.", "correct": false },
      { "text": "La mutaci√≥n constante.", "correct": false }
    ]
  },
  {
    "id": "34",
    "text": "Un Haplotipo es:",
    "options": [
      { "text": "Un solo gen.", "correct": false },
      { "text": "Un conjunto de variantes gen√©ticas (alelos) en un cromosoma que se heredan juntas como un bloque.", "correct": true },
      { "text": "Un fenotipo raro.", "correct": false },
      { "text": "Un tipo de c√©lula.", "correct": false }
    ]
  },
  {
    "id": "35",
    "text": "El Puntaje de Riesgo Polig√©nico (PRS) estima:",
    "options": [
      { "text": "El riesgo de una enfermedad monog√©nica.", "correct": false },
      { "text": "La predisposici√≥n gen√©tica de un individuo a un rasgo complejo sumando el efecto de m√∫ltiples variantes de riesgo.", "correct": true },
      { "text": "La edad de muerte.", "correct": false },
      { "text": "El n√∫mero de hijos.", "correct": false }
    ]
  },
  {
    "id": "36",
    "text": "La Farmacogen√≥mica estudia:",
    "options": [
      { "text": "C√≥mo fabricar f√°rmacos.", "correct": false },
      { "text": "C√≥mo la variabilidad gen√©tica de un individuo afecta su respuesta a los f√°rmacos (eficacia y toxicidad).", "correct": true },
      { "text": "El precio de los medicamentos.", "correct": false },
      { "text": "La anatom√≠a.", "correct": false }
    ]
  },
  {
    "id": "37",
    "text": "La Medicina de Precisi√≥n (o Personalizada) busca:",
    "options": [
      { "text": "Tratar a todos los pacientes igual.", "correct": false },
      { "text": "Adaptar el tratamiento m√©dico a las caracter√≠sticas individuales (gen√©ticas, ambientales, estilo de vida) de cada paciente.", "correct": true },
      { "text": "Usar solo medicina alternativa.", "correct": false },
      { "text": "Eliminar la cirug√≠a.", "correct": false }
    ]
  },
  {
    "id": "38",
    "text": "La Secuenciaci√≥n de Nueva Generaci√≥n (NGS) permite:",
    "options": [
      { "text": "Secuenciar un solo gen lentamente.", "correct": false },
      { "text": "Secuenciar masivamente millones de fragmentos de ADN en paralelo (r√°pido y costo-efectivo).", "correct": true },
      { "text": "Ver los cromosomas al microscopio.", "correct": false },
      { "text": "Clonar personas.", "correct": false }
    ]
  },
  {
    "id": "39",
    "text": "El Exoma es la parte del genoma que:",
    "options": [
      { "text": "No codifica prote√≠nas.", "correct": false },
      { "text": "Corresponde a los exones (regiones codificantes de prote√≠nas), representando ~1-2% del genoma pero albergando la mayor√≠a de mutaciones patog√©nicas.", "correct": true },
      { "text": "Contiene intrones.", "correct": false },
      { "text": "Es ADN basura.", "correct": false }
    ]
  },
  {
    "id": "40",
    "text": "La Secuenciaci√≥n del Genoma Completo (WGS) analiza:",
    "options": [
      { "text": "Solo los exones.", "correct": false },
      { "text": "Casi toda la secuencia de ADN del individuo (codificante y no codificante).", "correct": true },
      { "text": "Solo el ADN mitocondrial.", "correct": false },
      { "text": "Solo el cromosoma X.", "correct": false }
    ]
  },
  {
    "id": "41",
    "text": "Una Variante de Significado Incierto (VUS) es un hallazgo gen√©tico donde:",
    "options": [
      { "text": "Se sabe que causa enfermedad.", "correct": false },
      { "text": "No hay suficiente evidencia para clasificarla como benigna o patog√©nica.", "correct": true },
      { "text": "Es claramente benigna.", "correct": false },
      { "text": "Es un error de laboratorio.", "correct": false }
    ]
  },
  {
    "id": "42",
    "text": "Una variante Patog√©nica es aquella que:",
    "options": [
      { "text": "No causa enfermedad.", "correct": false },
      { "text": "Est√° confirmada como causa de la enfermedad o trastorno.", "correct": true },
      { "text": "Es com√∫n en la poblaci√≥n.", "correct": false },
      { "text": "Es silenciosa.", "correct": false }
    ]
  },
  {
    "id": "43",
    "text": "Una variante Benigna es aquella que:",
    "options": [
      { "text": "Causa enfermedad grave.", "correct": false },
      { "text": "No est√° asociada con enfermedad y es generalmente com√∫n o inocua.", "correct": true },
      { "text": "Es letal.", "correct": false },
      { "text": "Es nueva.", "correct": false }
    ]
  },
  {
    "id": "44",
    "text": "Un Hallazgo Incidental (o secundario) en gen√≥mica es:",
    "options": [
      { "text": "El diagn√≥stico buscado.", "correct": false },
      { "text": "El descubrimiento de una variante patog√©nica no relacionada con el motivo original de la prueba (ej. predisposici√≥n a c√°ncer en un test de autismo).", "correct": true },
      { "text": "Un error t√©cnico.", "correct": false },
      { "text": "Una variante benigna.", "correct": false }
    ]
  },
  {
    "id": "45",
    "text": "El Asesoramiento Gen√©tico es un proceso de:",
    "options": [
      { "text": "Terapia psicol√≥gica.", "correct": false },
      { "text": "Comunicaci√≥n para ayudar a los pacientes a entender y adaptarse a las implicaciones m√©dicas, psicol√≥gicas y familiares de la contribuci√≥n gen√©tica a la enfermedad.", "correct": true },
      { "text": "Ingenier√≠a gen√©tica.", "correct": false },
      { "text": "Venta de pruebas.", "correct": false }
    ]
  },
  {
    "id": "46",
    "text": "La Herencia Multifactorial implica que el fenotipo es resultado de:",
    "options": [
      { "text": "Un solo factor.", "correct": false },
      { "text": "La interacci√≥n compleja de factores gen√©ticos (poligenia) y ambientales.", "correct": true },
      { "text": "Solo el ambiente.", "correct": false },
      { "text": "Mala suerte.", "correct": false }
    ]
  },
  {
    "id": "47",
    "text": "La Heredabilidad es una medida estad√≠stica que estima:",
    "options": [
      { "text": "Si una enfermedad es gen√©tica.", "correct": false },
      { "text": "La proporci√≥n de la variaci√≥n fenot√≠pica total en una poblaci√≥n que es atribuible a la variaci√≥n gen√©tica.", "correct": true },
      { "text": "La gravedad de la enfermedad.", "correct": false },
      { "text": "Cu√°ntos genes est√°n implicados.", "correct": false }
    ]
  },
  {
    "id": "48",
    "text": "El Ambiente Compartido se refiere a:",
    "options": [
      { "text": "El clima global.", "correct": false },
      { "text": "Factores ambientales comunes a los miembros de una familia (ej. dieta familiar, nivel socioecon√≥mico).", "correct": true },
      { "text": "El ambiente uterino.", "correct": false },
      { "text": "El azar.", "correct": false }
    ]
  },
  {
    "id": "49",
    "text": "El Ambiente No Compartido (o √∫nico) se refiere a:",
    "options": [
      { "text": "Factores gen√©ticos.", "correct": false },
      { "text": "Experiencias y factores ambientales espec√≠ficos de un individuo, no compartidos con familiares (ej. amigos, accidentes).", "correct": true },
      { "text": "La casa familiar.", "correct": false },
      { "text": "El ADN.", "correct": false }
    ]
  },
  {
    "id": "50",
    "text": "La Interacci√≥n Gen-Ambiente (GxE) ocurre cuando:",
    "options": [
      { "text": "Los genes y el ambiente act√∫an independientemente.", "correct": false },
      { "text": "El efecto de un genotipo sobre el fenotipo depende del entorno, o el efecto del entorno depende del genotipo.", "correct": true },
      { "text": "El ambiente muta los genes.", "correct": false },
      { "text": "Los genes cambian el ambiente.", "correct": false }
    ]
  },
  {
    "id": "51",
    "text": "La Epistasis es un fen√≥meno donde:",
    "options": [
      { "text": "Un gen funciona solo.", "correct": false },
      { "text": "El efecto de un gen es modificado o enmascarado por uno o m√°s genes diferentes (interacci√≥n gen-gen).", "correct": true },
      { "text": "El gen salta.", "correct": false },
      { "text": "No hay herencia.", "correct": false }
    ]
  },
  {
    "id": "52",
    "text": "Un Locus (plural Loci) es:",
    "options": [
      { "text": "Un tipo de c√©lula.", "correct": false },
      { "text": "La posici√≥n f√≠sica espec√≠fica de un gen o secuencia de ADN en un cromosoma.", "correct": true },
      { "text": "Una enfermedad.", "correct": false },
      { "text": "Un insecto.", "correct": false }
    ]
  },
  {
    "id": "53",
    "text": "Un Alelo Nulo es una variante que:",
    "options": [
      { "text": "Produce prote√≠na normal.", "correct": false },
      { "text": "Resulta en la ausencia completa del producto g√©nico o de su funci√≥n.", "correct": true },
      { "text": "Es dominante.", "correct": false },
      { "text": "Es beneficioso.", "correct": false }
    ]
  },
  {
    "id": "54",
    "text": "La Heterogeneidad Gen√©tica se refiere a que:",
    "options": [
      { "text": "Todos los pacientes tienen la misma mutaci√≥n.", "correct": false },
      { "text": "Diferentes mutaciones (en el mismo gen o en genes diferentes) pueden causar el mismo fenotipo o enfermedad cl√≠nica.", "correct": true },
      { "text": "La gen√©tica es simple.", "correct": false },
      { "text": "Solo hay un gen.", "correct": false }
    ]
  },
  {
    "id": "55",
    "text": "Las modificaciones epigen√©ticas son un componente clave en la modulaci√≥n del fenotipo. ¬øCu√°ndo se transmiten estas modificaciones a la descendencia mediante herencia?",
    "options": [
      { "text": "Siempre que causen un frameshift en el mRNA.", "correct": false },
      { "text": "Siempre que afecten al sistema endocrino.", "correct": false },
      { "text": "Solo las que afectan a las c√©lulas germinales.", "correct": true },
      { "text": "Cuando se asocian con mutaciones dominante negativas.", "correct": false }
    ]
  },
  {
    "id": "56",
    "text": "La homeostasis y la plasticidad funcional son mecanismos regulados por la causalidad descendente, necesarios para:",
    "options": [
      { "text": "Evitar la recombinaci√≥n entre haplotipos.", "correct": false },
      { "text": "La s√≠ntesis de prote√≠nas truncadas.", "correct": false },
      { "text": "Ajustes fisiol√≥gicos, adaptaci√≥n y respuesta a la fatiga o al esfuerzo.", "correct": true },
      { "text": "El mapeo de rasgos cuantitativos.", "correct": false }
    ]
  },
  {
    "id": "57",
    "text": "El proceso de Histog√©nesis (formaci√≥n de tejidos) est√° directamente vinculado en el esquema de causalidad y desarrollo con:",
    "options": [
      { "text": "Las poblaciones de c√©lulas madre (stem cells) y la regulaci√≥n del n√∫mero y fenotipos celulares.", "correct": true },
      { "text": "La prevalencia de enfermedades monog√©nicas.", "correct": false },
      { "text": "Los mecanismos de gain-of-function.", "correct": false },
      { "text": "La determinaci√≥n del locus cromos√≥mico.", "correct": false }
    ]
  },
  {
    "id": "58",
    "text": "El fenotipo de un organismo resulta de la interacci√≥n compleja de tres elementos fundamentales, que son:",
    "options": [
      { "text": "Haploinsuficiencia, penetrancia y expresividad.", "correct": false },
      { "text": "DNA, RNA y prote√≠nas.", "correct": false },
      { "text": "Informaci√≥n gen√©tica, informaci√≥n epigen√©tica y el entorno.", "correct": true },
      { "text": "Sistemas endocrino, nervioso e inmune.", "correct": false }
    ]
  },
  {
    "id": "59",
    "text": "La regulaci√≥n por retroalimentaci√≥n (feed back regulation) entre el genoma y el comportamiento/estructura celular es un componente de:",
    "options": [
      { "text": "La segregaci√≥n independiente de alelos.", "correct": false },
      { "text": "El diagn√≥stico gen√©tico por PCR.", "correct": false },
      { "text": "Los mecanismos de causalidad ascendente y descendente que modulan el fenotipo.", "correct": true },
      { "text": "El patr√≥n de herencia ligado a Y.", "correct": false }
    ]
  },
  {
    "id": "60",
    "text": "En el marco de la Gen√≥mica Biom√©dica Humana, la plasticidad sin√°ptica y conectiva es un ejemplo de ajuste regulado por:",
    "options": [
      { "text": "La necesidad de una prote√≠na tetram√©rica funcional.", "correct": false },
      { "text": "Los estudios de asociaci√≥n del genoma completo (GWAS).", "correct": false },
      { "text": "La causalidad descendente mediada por el sistema nervioso y el comportamiento.", "correct": true },
      { "text": "El requisito de que los SNPs caigan en secuencias codificantes.", "correct": false }
    ]
  }
];

        // A√±adimos propiedades de estado a las preguntas
        const questions = questionsSource.map(q => ({
            ...q,
            userMarked: false,
            userFailed: false,
            userAnswered: false, // para saber si ya la ha intentado
            shuffledOptions: null // guardamos el orden mezclado
        }));

        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        // Renderiza el quiz con un subconjunto de preguntas (o todas)
        function renderQuiz(questionsToRender) {
            const quizContainer = document.getElementById('quiz');
            quizContainer.innerHTML = '';
            
            // Ocultar resultados si estamos repitiendo
            document.getElementById('results-panel').style.display = 'none';
            document.getElementById('btn-finish').style.display = 'block';

            if(questionsToRender.length === 0) {
                quizContainer.innerHTML = '<p style="text-align:center; padding:20px;">No hay preguntas que coincidan con este criterio.</p>';
                document.getElementById('btn-finish').style.display = 'none';
                document.getElementById('results-panel').style.display = 'block';
                return;
            }

            questionsToRender.forEach((q) => {
                const questionBlock = document.createElement('div');
                questionBlock.className = 'question-block';

                // Pesta√±a para MARCAR
                const markContainer = document.createElement('label');
                markContainer.className = 'mark-container';
                const checkbox = document.createElement('input');
                checkbox.type = 'checkbox';
                checkbox.checked = q.userMarked;
                checkbox.onchange = function() {
                    q.userMarked = this.checked;
                };
                markContainer.appendChild(checkbox);
                markContainer.appendChild(document.createTextNode(" Marcar"));
                questionBlock.appendChild(markContainer);

                // T√≠tulo
                const title = document.createElement('div');
                title.className = 'question-title';
                // Usamos q.id original para identificar la pregunta
                title.innerText = `${q.id}. ${q.text}`;
                questionBlock.appendChild(title);

                // Si no hemos mezclado las opciones a√∫n, lo hacemos ahora
                if (!q.shuffledOptions) {
                    q.shuffledOptions = shuffleArray([...q.options]);
                }

                const optionsList = document.createElement('ul');
                optionsList.className = 'options-list';

                q.shuffledOptions.forEach(opt => {
                    const li = document.createElement('li');
                    li.className = 'option-item';
                    
                    const btn = document.createElement('button');
                    btn.className = 'option-btn';
                    btn.innerText = opt.text;
                    
                    btn.onclick = function() {
                        // Marcar que el usuario ha respondido
                        q.userAnswered = true;

                        // Deshabilitar todos los botones de esta pregunta
                        const allBtns = optionsList.querySelectorAll('.option-btn');
                        allBtns.forEach(b => b.classList.add('disabled'));

                        if (opt.correct) {
                            btn.classList.add('correct');
                            // Si acierta a la primera y no ten√≠a fallo previo, userFailed se mantiene false
                        } else {
                            btn.classList.add('incorrect');
                            // Marcamos como fallada
                            q.userFailed = true;
                            
                            // Resaltar la correcta
                            allBtns.forEach(b => {
                                // Buscar el texto original
                                const originalOpt = q.options.find(o => o.correct);
                                if (b.innerText === originalOpt.text) {
                                    b.classList.add('correct');
                                }
                            });
                        }
                    };

                    li.appendChild(btn);
                    optionsList.appendChild(li);
                });

                questionBlock.appendChild(optionsList);
                quizContainer.appendChild(questionBlock);
            });
        }

        // Renderizar inicial (todas las preguntas)
        renderQuiz(questions);

        // L√≥gica de Finalizaci√≥n
        const urlParams = new URLSearchParams(window.location.search);
        const testID = urlParams.get('id');

        document.getElementById('btn-finish').onclick = function() {
            // Nota: Aqu√≠ calculamos sobre el TOTAL de preguntas originales para la nota, 
            // o sobre las que se est√°n mostrando?
            // Generalmente la nota oficial es del primer intento completo, 
            // pero aqu√≠ mostraremos el resultado de la sesi√≥n actual.
            
            // Calculamos aciertos sobre las preguntas que se est√°n mostrando actualmente en pantalla
            const currentBlocks = document.querySelectorAll('.question-block');
            let answeredCount = 0;
            let currentCorrect = 0;
            
            // Recorremos el DOM actual para ver qu√© pas√≥ en esta "ronda"
            currentBlocks.forEach(block => {
                const hasIncorrect = block.querySelector('.incorrect');
                const hasCorrect = block.querySelector('.correct'); // bot√≥n seleccionado correcto o revelado
                
                // Si hay un bot√≥n seleccionado (disabled)
                if (block.querySelector('.disabled')) {
                    answeredCount++;
                    // Si el usuario click√≥ la correcta (clase 'correct' en el clickeado) 
                    // Y NO hay clase 'incorrect' (no fall√≥)
                    // Nota: Mi l√≥gica de pintado pone 'correct' a la correcta siempre si se falla.
                    // Pero el bot√≥n clickeado tendr√° 'incorrect' si se falla.
                    if (!hasIncorrect) {
                        currentCorrect++;
                    }
                }
            });

            const totalCurrent = currentBlocks.length;
            const notaFinal = totalCurrent > 0 ? Math.round((currentCorrect / totalCurrent) * 100) : 0;
            
            // Mostrar Panel
            document.getElementById('btn-finish').style.display = 'none';
            const resultsPanel = document.getElementById('results-panel');
            resultsPanel.style.display = 'block';
            
            document.getElementById('score-text').innerHTML = 
                `Has acertado <b>${currentCorrect}</b> de <b>${totalCurrent}</b> preguntas visibles.<br>Nota de este intento: <b>${notaFinal}%</b>`;
            
            // Scroll hacia el resultado
            resultsPanel.scrollIntoView({behavior: "smooth"});

            // Guardar nota solo si es el test completo original (opcional)
            if (testID && questions.length === totalCurrent) {
                let intentos = parseInt(localStorage.getItem(`intentos_${testID}`) || 0);
                localStorage.setItem(`intentos_${testID}`, intentos + 1);
                let notaAnterior = localStorage.getItem(`nota_${testID}`);
                if (!notaAnterior || notaFinal > parseInt(notaAnterior)) {
                    localStorage.setItem(`nota_${testID}`, notaFinal);
                }
            }
        };

        // Funci√≥n para Repetir/Filtrar
        function retryQuiz(mode) {
            let filteredQuestions = [];

            if (mode === 'all') {
                // Resetear todo el estado para empezar de cero
                questions.forEach(q => {
                    q.userFailed = false;
                    q.userMarked = false; // Opcional: ¬øDesmarcar al reiniciar completo? Normalmente s√≠.
                    q.userAnswered = false;
                    q.shuffledOptions = null; // Re-mezclar opciones
                });
                filteredQuestions = questions;
            } 
            else if (mode === 'failed') {
                filteredQuestions = questions.filter(q => q.userFailed);
                // Reseteamos el estado visual de estas preguntas para poder re-contestarlas
                filteredQuestions.forEach(q => {
                    q.userAnswered = false; 
                    q.shuffledOptions = null;
                    // Mantenemos q.userFailed = true en el objeto global? 
                    // No, si queremos re-evaluarlo, lo ponemos a false temporalmente 
                    // o simplemente confiamos en el renderizado nuevo.
                    // Pero para que cuente como acierto en la nueva ronda:
                    // La l√≥gica de render usa propiedades limpias.
                });
            } 
            else if (mode === 'marked') {
                filteredQuestions = questions.filter(q => q.userMarked);
                filteredQuestions.forEach(q => {
                    q.userAnswered = false;
                    q.shuffledOptions = null;
                });
            }
            else if (mode === 'mixed') {
                // Falladas O Marcadas
                filteredQuestions = questions.filter(q => q.userFailed || q.userMarked);
                filteredQuestions.forEach(q => {
                    q.userAnswered = false;
                    q.shuffledOptions = null;
                });
            }

            renderQuiz(filteredQuestions);
            
            // Actualizar t√≠tulo
            const modeTitles = {
                'all': 'Test Completo',
                'failed': 'Repaso de Fallos',
                'marked': 'Repaso de Marcadas',
                'mixed': 'Repaso (Falladas + Marcadas)'
            };
            document.getElementById('quiz-title').innerText = `Modo: ${modeTitles[mode]}`;
            
            // Scroll arriba
            window.scrollTo(0,0);
        }

    </script>
</body>
</html>
