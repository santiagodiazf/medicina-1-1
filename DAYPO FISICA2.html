<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Biof√≠sica: Fluidos y Hemodin√°mica</title>
    <style>
        :root {
            --primary: #0284c7; /* Azul Oceano */
            --primary-dark: #0369a1;
            --primary-light: #e0f2fe;
            --bg: #f0f9ff; /* Fondo muy claro azulado */
            --text: #0f172a;
            --white: #ffffff;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg);
            color: var(--text);
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
        }

        h1 {
            text-align: center;
            color: var(--primary-dark);
            margin-bottom: 10px;
        }

        .intro-text {
            text-align: center;
            margin-bottom: 30px;
            color: #64748b;
            font-style: italic;
        }

        .question-card {
            background: var(--white);
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.05);
            border-left: 6px solid var(--primary);
            transition: transform 0.2s, box-shadow 0.2s;
            position: relative;
        }

        .question-card:hover {
            box-shadow: 0 8px 15px rgba(0,0,0,0.1);
        }

        /* --- Checkbox para Marcar --- */
        .mark-container {
            display: flex;
            align-items: center;
            justify-content: flex-end;
            margin-bottom: 15px;
            font-size: 0.9em;
            color: var(--primary);
            font-weight: bold;
            border-bottom: 1px solid #bae6fd;
            padding-bottom: 10px;
        }
        .mark-container input {
            margin-right: 8px;
            transform: scale(1.3);
            cursor: pointer;
            accent-color: var(--primary);
        }
        .mark-container label {
            cursor: pointer;
        }

        .question-header {
            font-size: 0.85em;
            color: #64748b;
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 1px;
            font-weight: bold;
        }

        .question-text {
            font-weight: 600;
            font-size: 1.15em;
            margin-bottom: 15px;
            color: #1e293b;
            line-height: 1.5;
        }

        /* Estilo para las etiquetas de imagen */
        .img-tag {
            display: block;
            margin-top: 12px;
            padding: 10px;
            background-color: #f1f5f9;
            border-left: 4px solid #94a3b8;
            color: #475569;
            font-size: 0.9em;
            font-style: italic;
            border-radius: 0 4px 4px 0;
        }

        .options-container {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .option-btn {
            padding: 14px 18px;
            border: 2px solid #e2e8f0;
            background: #fff;
            border-radius: 8px;
            cursor: pointer;
            text-align: left;
            transition: all 0.2s;
            font-size: 1em;
            color: #334155;
        }

        .option-btn:hover:not(:disabled) {
            background-color: var(--primary-light);
            border-color: var(--primary);
            color: var(--primary-dark);
            transform: translateX(5px);
        }

        .option-btn:disabled {
            cursor: default;
            opacity: 0.7;
        }

        .correct {
            background-color: #dcfce7 !important;
            border-color: #22c55e !important;
            color: #14532d !important;
            font-weight: bold;
        }

        .incorrect {
            background-color: #fee2e2 !important;
            border-color: #ef4444 !important;
            color: #7f1d1d !important;
        }

        .explanation {
            margin-top: 15px;
            padding: 15px;
            background-color: #e0f2fe;
            border-left: 5px solid #0ea5e9;
            border-radius: 4px;
            display: none;
            font-size: 0.95em;
            color: #0c4a6e;
        }

        .explanation.visible {
            display: block;
            animation: fadeIn 0.5s;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        /* --- √Årea de Controles --- */
        #controls-area {
            margin-top: 40px;
            text-align: center;
            padding: 30px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            border-top: 5px solid var(--primary);
        }
        .action-btn {
            background: var(--primary); color: white; border: none;
            padding: 12px 24px; font-size: 1em; border-radius: 8px;
            cursor: pointer; margin: 5px;
            transition: background 0.3s, transform 0.1s;
            font-weight: 600;
        }
        .action-btn:hover { 
            background: var(--primary-dark);
            transform: translateY(-2px);
        }
        
        .restart-options {
            display: none;
            flex-direction: column;
            gap: 10px;
            margin-top: 20px;
        }
        .restart-options button {
            background: #334155;
        }
        .restart-options button:hover { background: #0f172a; }
        .restart-options button:first-child { background: var(--primary); }

    </style>
</head>
<body>

    <h1>Examen de Hemodin√°mica y Fluidos</h1>
    <p class="intro-text">Bernoulli, Reynolds, Poiseuille y Circulaci√≥n Sangu√≠nea</p>
    
    <div id="quiz-container"></div>

    <div id="controls-area">
        <button id="finish-btn" class="action-btn" onclick="showEndOptions()">üèÅ Finalizar revisi√≥n</button>
        
        <div id="restart-menu" class="restart-options">
            <h3>¬øC√≥mo deseas continuar?</h3>
            <p id="stats-summary"></p>
            <button class="action-btn" onclick="restartQuiz('all')">üîÑ Rehacer el cuestionario entero</button>
            <button class="action-btn" onclick="restartQuiz('marked')">üîñ Hacer solo las preguntas marcadas</button>
            <button class="action-btn" onclick="restartQuiz('failed')">‚ùå Hacer solo las preguntas falladas</button>
            <button class="action-btn" onclick="restartQuiz('failed_marked')">‚ö†Ô∏è Hacer falladas y marcadas</button>
        </div>
    </div>

<script>
    const quizData = [
        { q: "Cuando un fluido ideal pasa por un estrechamiento en una conducci√≥n:", opts: ["su velocidad y presi√≥n aumenta", "su velocidad y presi√≥n disminuye", "aumenta su velocidad y disminuye su presi√≥n", "disminuye su velocidad y aumenta su presi√≥n"], a: "aumenta su velocidad y disminuye su presi√≥n" },
        { q: "si un fluido ideal la velocidad de circulaci√≥n disminuye de un punto A a otro B en un tubo de corriente:", opts: ["necesariamente el di√°metro del tubo ha aumentado en B respecto a A", "necesariamente el di√°metro en B es menor que en A", "el fluido se ha comprimido", "el fluido se ha expandido"], a: "necesariamente el di√°metro del tubo ha aumentado en B respecto a A" },
        { q: "en el torrente circulatorio la ecuaci√≥n de continuidad:", opts: ["no se puede aplicar ya que la sangre es un l√≠quido viscoso", "se puede aplicar en promedio para intervalos de tiempo largos", "no se puede aplicar en los capilares", "se puede aplicar en cualquier instante"], a: "se puede aplicar en promedio para intervalos de tiempo largos" },
        { q: "la resistencia hidrodin√°mica para un fluido viscoso:", opts: ["crece al aumentar el radio y la longitud de la tuber√≠a", "crece al aumentar la longitud y decrece al aumentar el radio de la tuber√≠a", "decrece al aumentar el radio y la longitud de la tuber√≠a", "crece al disminuir la longitud y aumenta al aumentar el radio de la tuber√≠a"], a: "crece al aumentar la longitud y decrece al aumentar el radio de la tuber√≠a" },
        { q: "por la tuber√≠a de la figura circula un liquido viscoso, si progresivamente se aumenta el caudal que circula, ¬øen que parte se producir√° antes la transici√≥n de r√©gimen laminar a turbulento? (en la figura se observa un conducto de 1,2 cm de di√°metro que se estrecha hasta 2mm):", opts: ["no aparecer√° un r√©gimen turbulento al ser un l√≠quido viscoso", "en la parte B (estrecha)", "en la parte A (ancha)", "en ambas partes a la vez"], a: "en la parte B (estrecha)" },
        { q: "para que llegue mas sangre a aquellos √≥rganos que lo precisan:", opts: ["aumenta solo la presi√≥n arterial", "disminuye la presi√≥n arterial y aumenta el ritmo cardiaco", "aumenta el radio de los vasos perif√©ricos, la presi√≥n y el ritmo cardiaco", "disminuye el radio de los vasos perif√©ricos para que disminuya la resistencia hemodin√°mica"], a: "aumenta el radio de los vasos perif√©ricos, la presi√≥n y el ritmo cardiaco" },
        { q: "la distribuci√≥n de velocidades en la secci√≥n de un vaso ser√°:", opts: ["igual en todos los puntos", "nula en todos los puntos de la secci√≥n", "nula junto a las paredes y m√°xima en el centro", "m√°xima en la paredes y nula en el centro"], a: "nula junto a las paredes y m√°xima en el centro" },
        { q: "¬øpor qu√© la velocidad de la sangre es unas 800 veces mayor en la aorta que en los capilares?", opts: ["por ser la secci√≥n de la aorta 800 veces mayor que la secci√≥n conjunta de los capilares", "por ser la secci√≥n conjunta de todos los capilares 800 veces mayor que la de la aorta", "la velocidad es la misma en la aorta que en los capilares", "la velocidad en la aorta es menor que en los capilares"], a: "por ser la secci√≥n conjunta de todos los capilares 800 veces mayor que la de la aorta" },
        { q: "el coeficiente de viscosidad de la sangre:", opts: ["es aproximadamente 1 Poise", "es generalmente 5 veces superior al del agua", "var√≠a mucho en funci√≥n del contenido en eritrocitos", "la b y la c"], a: "la b y la c" },
        { q: "para una persona que est√° en posici√≥n horizontal, la presi√≥n arterial a nivel del cerebro:", opts: ["es igual a la presi√≥n a nivel del coraz√≥n", "es inferior a la presi√≥n a nivel del coraz√≥n", "es superior a la presi√≥n a nivel del coraz√≥n", "depende de la altura de la persona"], a: "es igual a la presi√≥n a nivel del coraz√≥n" },
        { q: "la tensi√≥n que soportan las paredes de los vasos:", opts: ["es directamente proporcional al radio de los vasos", "es independiente de la presi√≥n sangu√≠nea", "es directamente proporcional a la presi√≥n sangu√≠nea", "la a y la c"], a: "la a y la c" },
        { q: "si la presi√≥n sangu√≠nea a nivel del cerebro se anula:", opts: ["la presi√≥n a nivel del coraz√≥n tambi√©n se anulara", "se producir√≠a una isquemia cerebral", "se producir√≠a un infarto de miocardio", "la presi√≥n a nivel del cerebro nunca se puede anular"], a: "se producir√≠a una isquemia cerebral" },
        { q: "la diferencia de presi√≥n entre dos puntos de un fluido situado a distintas alturas:", opts: ["depende de la diferencia de altura entre ellos", "depende de la gravedad", "depende de la densidad del fluido", "depende de las tres anteriores"], a: "depende de las tres anteriores" },
        { q: "se dice que un fluido es perfecto si:", opts: ["en su seno no se desarrollan fuerzas tangenciales", "es viscoso", "no es viscoso", "la a y la c"], a: "la a y la c" },
        { q: "se define el flujo a trav√©s de una superficie como:", opts: ["el volumen de fluido que atraviesa dicha superficie", "el volumen de fluido que atraviesa dicha superficie en la unidad de tiempo", "la velocidad del fluido por la superficie", "tiempo que tarda un fluido en atravesar la superficie"], a: "el volumen de fluido que atraviesa dicha superficie en la unidad de tiempo" },
        { q: "en un fluido estacionario, el flujo a trav√©s de una superficie es:", opts: ["A- proporcional a la velocidad del fluido", "B- inversamente proporcional a la superficie", "C- proporcional a la superficie", "la a y la c"], a: "la a y la c" },
        { q: "en un fluido real, el flujo entre dos secciones ser√°:", opts: ["proporcional a la diferencia de presiones que exista entre dichas secciones", "inversamente proporcional a la resistencia", "proporcional al radio del conducto", "las tres anteriores"], a: "las tres anteriores" },
        { q: "el n√∫mero de Reynolds en la aorta es del orden de 1200, esto implica que:", opts: ["el r√©gimen circulatorio es siempre laminar", "el r√©gimen circulatorio es siempre turbulento", "puede ser turbulento ya que los datos de Reynolds solo son exactos para tubos largos y rectos", "el flujo sangu√≠neo se anula"], a: "puede ser turbulento ya que los datos de Reynolds solo son exactos para tubos largos y rectos" },
        { q: "si hay un estrechamiento en un conducto sangu√≠neo se producir√°:", opts: ["un aumento de la velocidad de la sangre", "una disminuci√≥n de la presi√≥n de la sangre", "una disminuci√≥n de la velocidad y un aumento de la presi√≥n", "la a y la b"], a: "la a y la b" },
        { q: "cuando se produce una anomal√≠a en la secci√≥n de un vaso sangu√≠neo:", opts: ["el teorema de Bernouilli ayuda a corregirla", "el teorema de Bernouilli la empeora", "el teorema no influye en nada", "puede ayudar o no en funci√≥n de la velocidad de la sangre"], a: "el teorema de Bernouilli la empeora" },
        { q: "seg√∫n Reynolds la velocidad critica o caracter√≠stica es:", opts: ["inversamente proporcional al di√°metro del tubo", "directamente proporcional a la viscosidad del l√≠quido", "inversamente proporcional a la densidad del l√≠quido", "las tres anteriores"], a: "las tres anteriores" },
        { q: "el esfigmoman√≥metro:", opts: ["mide la presi√≥n sist√≥lica/diastolita", "mide el flujo sangu√≠neo turbulento", "mide la tasa de latidos del coraz√≥n", "mide la resistencia hemodin√°mica"], a: "mide la presi√≥n sist√≥lica/diastolita" },
        { q: "la resistencia hemodin√°mica (R).", opts: ["depende √∫nicamente de las caracter√≠sticas del fluido", "depende √∫nicamente de las caracter√≠sticas del tubo por el que circula", "depende de las caracter√≠sticas del fluido y del tubo", "disminuye si aumenta el coeficiente de viscosidad del fluido"], a: "depende de las caracter√≠sticas del fluido y del tubo" },
        { q: "para una persona que est√° de pie, la presi√≥n arterial a nivel del cerebro:", opts: ["es igual a la presi√≥n a nivel del coraz√≥n", "es inferior a la presi√≥n a nivel de coraz√≥n", "es superior a la presi√≥n a nivel del coraz√≥n", "es independiente de la altura de la persona"], a: "es inferior a la presi√≥n a nivel de coraz√≥n" },
        { q: "la velocidad de la sangre en los capilares es menor que en la aorta porque:", opts: ["la superficie total de los capilares es mayor que la de la aorta", "lo contrario que en a", "por el teorema de Bernouilli", "por la ley de Laplace"], a: "la superficie total de los capilares es mayor que la de la aorta" },
        { q: "en la circulaci√≥n sangu√≠nea, ¬øCu√°nto debe ser el n√∫mero de Reynolds para pasar de una regi√≥n laminar a una turbulenta?", opts: ["mayor de 2000", "menor de 2000", "igual a 2000", "la a y la c"], a: "mayor de 2000" },
        { q: "El r√©gimen de circulaci√≥n de un fluido ser√° laminar si el numero de Reynolds es:", opts: ["mayor de 2000", "menor de 2000", "mayor de 1200", "menor de 1200"], a: "menor de 2000" },
        { q: "la presi√≥n que ejerce un fluido sobre una superficie es:", opts: ["una magnitud escalar", "una magnitud vectorial", "depende de las unidades empleadas", "es adimensional"], a: "una magnitud escalar" },
        { q: "la potencia generada por el coraz√≥n puede aumentar hasta:", opts: ["2 veces", "5 veces", "7,5 veces", "Es siempre la misma"], a: "7,5 veces" },
        { q: "la presi√≥n hidrost√°tica ejercida en un fluido depende de:", opts: ["las coordenadas del punto", "de la forma del recipiente", "del color del fluido", "de la viscosidad"], a: "las coordenadas del punto" },
        { q: "si por una estenosis el radio disminuye a la mitad, la resistencia:", opts: ["aumenta 16 veces", "disminuye 16 veces", "aumenta el doble", "no var√≠a"], a: "aumenta 16 veces" },
        { q: "la unidades en el S.I del flujo son:", opts: ["litros/minutos", "metros c√∫bicos/horas", "metros c√∫bicos/segundos", "litros/segundos"], a: "metros c√∫bicos/segundos" },
        { q: "seg√∫n Reynolds, la velocidad caracter√≠stica es:", opts: ["inversamente proporcional a la viscosidad del fluido", "directamente proporcional al di√°metro del tubo", "inversamente proporcional a la densidad del liquido", "ninguna de las anteriores"], a: "inversamente proporcional a la densidad del liquido" },
        { q: "¬øQu√© instrumento usamos para medir la presi√≥n sangu√≠nea?", opts: ["esfigmoman√≥metro", "ec√≥grafo", "fluj√≥metro", "espir√≥metro"], a: "esfigmoman√≥metro" },
        { q: "la unidad de viscosidad en el S.I es:", opts: ["Poise", "Pascal * segundo (decapoise)", "Metro/segundo", "Pascal/litro"], a: "Pascal * segundo (decapoise)" },
        { q: "en un vaso sangu√≠neo de 1 cm de di√°metro, con sangre de 0,05 poise de viscosidad y densidad 1g/cm3, la velocidad critica resulta:", opts: ["0,0050 cm/s", "0,050 cm/s", "0,5 cm/s", "5 cm/s"], a: "5 cm/s" },
        { q: "La suma de dos resistencia hidrodin√°micas en serie es:", opts: ["mayor que cada una de ellas por separada", "la suma geom√©trica", "igual a la inversa de la suma", "menor que cada una de ellas por separada"], a: "mayor que cada una de ellas por separada" },
        { q: "¬øD√≥nde es mayor la ca√≠da de la presi√≥n hemodin√°mica?", opts: ["en las arterias", "en los capilares", "en las venas", "depende de la presi√≥n sangu√≠nea"], a: "en los capilares" },
        { q: "Por un tubo circula un fluido real, se√±ale la respuesta correcta:", opts: ["La velocidad media es la mitad de la velocidad m√°xima", "La velocidad m√≠nima se da en el centro del tubo", "La velocidad m√°xima se da en el centro del tubo", "La a) y la c)"], a: "La a) y la c)" },
        { q: "El esfigmoman√≥metro se basa en:", opts: ["Las variaciones de presiones del mercurio", "Las propiedades el√©ctricas del coraz√≥n", "Las tensiones superficiales de los m√∫sculos", "Las propiedades del flujo sangu√≠neo"], a: "Las propiedades del flujo sangu√≠neo" },
        { q: "Al aumentar la viscosidad de un fluido:", opts: ["El n√∫mero de Reynolds aumenta", "Disminuye su velocidad cr√≠tica", "Aumenta su velocidad cr√≠tica", "El r√©gimen de circulaci√≥n siempre ser√° laminar"], a: "Aumenta su velocidad cr√≠tica" },
        { q: "En un vaso sangu√≠neo se produce una estenosis reduciendo su radio a la mitad ¬øQu√© pasara con la velocidad de la sangre en ese punto?", opts: ["Aumentar√° el doble", "Aumentar√° en 4 veces", "Disminuir√° a la mitad", "Se mantendr√° constante"], a: "Aumentar√° en 4 veces" },
        { q: "Un flu√≠do ideal:", opts: ["Es incompresible, su densidad cambia y es viscoso", "Es incompresible, su densidad no cambia y no tiene viscosidad", "Es compresible, su densidad no cambia y no tiene viscosidad", "Es compresible, su densidad cambia y no tiene viscosidad"], a: "Es incompresible, su densidad no cambia y no tiene viscosidad" },
        { q: "¬øQu√© es la viscosidad de un fluido?", opts: ["S√≥lo aparece si el fluido es ideal", "Es la presi√≥n atmosf√©rica", "Es la fricci√≥n interna en el fluido", "Es la fuerza que ayuda al flfluido a desplazarse mejor"], a: "Es la fricci√≥n interna en el fluido" },
        { q: "¬øCu√°ndo se producir√° turbulencias en un fluido?", opts: ["Cuando la velocidad del fluido exceda de un cierto valor cr√≠tico", "Cuando la masa del fluido exceda de un cierto valor cr√≠tico", "Cuando el n√∫mero de Reynolds sea inferior a 2000", "La a) y la c)"], a: "Cuando la velocidad del fluido exceda de un cierto valor cr√≠tico" },
        { q: "Cuando un fluido ideal pasa por un estrechamiento en una conducci√≥n (Repetida):", opts: ["Su velocidad y presi√≥n aumenta", "Su velocidad y presi√≥n disminuye", "Aumenta su velocidad y disminuye su presi√≥n", "Disminuye su velocidad y aumenta su presi√≥n"], a: "Aumenta su velocidad y disminuye su presi√≥n" },
        { q: "Si en un fluido ideal la velocidad de circulaci√≥n disminuye de un punto ‚ÄúA‚Äù a otro ‚ÄúB‚Äù en un tubo de corriente (Repetida):", opts: ["Necesariamente el di√°metro del tubo ha aumentado en ‚ÄúB‚Äù respecto a ‚ÄúA‚Äù", "Necesariamente el di√°metro del tubo ‚ÄúB‚Äù es menor que en ‚ÄúA‚Äù", "El fluido se ha comprimido", "El fluido se ha expandido"], a: "Necesariamente el di√°metro del tubo ha aumentado en ‚ÄúB‚Äù respecto a ‚ÄúA‚Äù" },
        { q: "En el torrente circulatorio la ecuaci√≥n de continuidad (Repetida):", opts: ["No se puede aplicar, ya que la sangre es un l√≠quido viscoso", "Se puede aplicar en promedio, para intervalos de tiempos largos", "No se puede aplicar en los capilares", "Se puede aplicar en cualquier instante"], a: "Se puede aplicar en promedio, para intervalos de tiempos largos" },
        { q: "La resistencia hidrodin√°mica para un fluido viscoso (Repetida):", opts: ["Crece al aumentar el radio y la longitud de la tuber√≠a", "Crece al aumentar la longitud y decrece al aumentar el radio de la tuber√≠a", "Decrece al aumentar el radio y la longitud de la tuber√≠a", "Crece al disminuir la longitud y aumenta al aumentar el radio de la tuber√≠a"], a: "Crece al aumentar la longitud y decrece al aumentar el radio de la tuber√≠a" },
        { q: "Para que llegue m√°s sangre a aquellos √≥rganos que lo precisan (Repetida):", opts: ["Aumenta s√≥lo la presi√≥n arterial", "Disminuye la presi√≥n arterial y aumenta el ritmo cardiaco", "Aumenta la radio de los vasos perif√©ricos, la presi√≥n y el ritmo cardiaco", "Disminuye la radio de los vasos perif√©ricos para que disminuya la resistencia hemodin√°mica"], a: "Aumenta la radio de los vasos perif√©ricos, la presi√≥n y el ritmo cardiaco" },
        { q: "La tensi√≥n superficial:", opts: ["A- Es una caracter√≠stica del l√≠quido", "B- Da origen a fuerzas perpendiculares a la superficie", "C- Da lugar a fuerzas que operan paralelas a la superficie", "La a y la c"], a: "La a y la c" },
        { q: "la tensi√≥n superficial depende:", opts: ["del liquido", "del medio", "Todas son ciertas", "de la temperatura"], a: "Todas son ciertas" },
        { q: "Cuando se produce una anomal√≠a en la secci√≥n de un vaso sangu√≠neo:", opts: ["El teorema de Bernouilli ayuda a corregirla", "El teorema de Bernouilli no ayuda a corregirla", "Dicho teorema no influye en nada", "Puede ayudar a corregirla o no, dependiendo de la velocidad de la sangre"], a: "El teorema de Bernouilli no ayuda a corregirla" },
        { q: "machuca:", opts: ["machuca", "machuca", "machuca", "machuca"], a: "machuca" },
        { q: "Cuando en una arteria aumenta el radio:", opts: ["la tensi√≥n de sus paredes disminuye", "El vaso se abre hasta romperse", "La tensi√≥n de sus paredes aumenta", "El radio de la arteria se anula"], a: "La tensi√≥n de sus paredes aumenta" },
        { q: "¬øQu√© efecto tiene incrementar la viscosidad de la sangre sobre el flujo sangu√≠neo de acuerdo con la Ley de Poiseuille?", opts: ["Ninguno, la sangre no tiene viscosidad", "Hace que la resistencia hemodin√°mica sea mayor", "Para mantener un flujo constante deber√° incrementarse la diferencia de presi√≥n", "b y c son ciertas"], a: "b y c son ciertas" },
        { q: "El esfingoman√≥metro se basa en:", opts: ["Las propiedades el√©ctricas del coraz√≥n", "La tensi√≥n superficial de los alveolos", "Las variaciones de presi√≥n del mercurio", "Las propiedades del flujo sangu√≠neo"], a: "Las propiedades del flujo sangu√≠neo" },
        { q: "La velocidad critica de un fluido sera mas alta si:", opts: ["La viscosidad del fluido disminuye", "La viscosidad del fluido aumenta", "El radio del tubo aumenta", "La densidad del fluido aumenta"], a: "La viscosidad del fluido aumenta" },
        { q: "¬øCu√°l de los siguientes casos act√∫a el fen√≥meno de capilaridad?", opts: ["Al beber refresco de una pajita", "La circulacion de agua desde la ra√≠z hasta las hojas", "Al extraer sangre con una jeringuilla", "a y c son correctas"], a: "La circulacion de agua desde la ra√≠z hasta las hojas" },
        { q: "Un liquido moja a un solido cuando:", opts: ["Las fuerzas de cohesi√≥n son mayores que las de adherencia", "Solo depende de la presi√≥n atmosferica", "Es independiente de las fuerzas de cohesi√≥n y adherencia", "Las fuerzas de adherencia son mayores que las de cohesi√≥n"], a: "Las fuerzas de adherencia son mayores que las de cohesi√≥n" }
    ];

    // --- ASIGNAR IDs √öNICOS ---
    quizData.forEach((item, index) => {
        item.id = index;
    });

    // --- GESTI√ìN DE ESTADO ---
    let markedQuestions = new Set();
    let failedQuestions = new Set();

    function shuffleArray(array) {
        let currentIndex = array.length, randomIndex;
        while (currentIndex !== 0) {
            randomIndex = Math.floor(Math.random() * currentIndex);
            currentIndex--;
            [array[currentIndex], array[randomIndex]] = [array[randomIndex], array[currentIndex]];
        }
        return array;
    }

    const container = document.getElementById('quiz-container');

    // Funci√≥n principal para renderizar el quiz
    function renderQuiz(questionsToLoad = quizData) {
        container.innerHTML = "";
        document.getElementById("restart-menu").style.display = "none";
        document.getElementById("finish-btn").style.display = "inline-block";

        if(questionsToLoad.length === 0) {
            container.innerHTML = "<p style='text-align:center; padding:20px; color:#64748b;'>No hay preguntas para mostrar en esta selecci√≥n.</p>";
            return;
        }

        questionsToLoad.forEach((item, displayIndex) => {
            const card = document.createElement('div');
            card.className = 'question-card';

            // --- Checkbox Marcar ---
            const markContainer = document.createElement("div");
            markContainer.className = "mark-container";
            const checkbox = document.createElement("input");
            checkbox.type = "checkbox";
            checkbox.id = `mark-${item.id}`;
            if(markedQuestions.has(item.id)) checkbox.checked = true;

            checkbox.onchange = (e) => {
                if(e.target.checked) markedQuestions.add(item.id);
                else markedQuestions.delete(item.id);
            };

            const label = document.createElement("label");
            label.htmlFor = `mark-${item.id}`;
            label.innerText = "Marcar para revisar";
            markContainer.appendChild(checkbox);
            markContainer.appendChild(label);
            card.appendChild(markContainer);

            // --- Header & Texto ---
            const header = document.createElement('div');
            header.className = 'question-header';
            header.textContent = `Pregunta ${item.id + 1}`; 
            card.appendChild(header);

            const questionText = document.createElement('div');
            questionText.className = 'question-text';
            questionText.textContent = item.q;

            // --- L√≥gica de Diagramas ---
            if (item.id === 0 || item.id === 47) { // Bernoulli / Estrechamiento
                 questionText.innerHTML += `<span class='img-tag'>

[Image of Bernoulli principle venturi effect diagram]
</span>`;
            } else if (item.id === 4 || item.id === 30 || item.id === 48) { // Resistencia / Poiseuille
                 questionText.innerHTML += `<span class='img-tag'></span>`;
            } else if (item.id === 5 || item.id === 26 || item.id === 27) { // Laminar vs Turbulento / Reynolds
                 questionText.innerHTML += `<span class='img-tag'>

[Image of laminar vs turbulent flow diagram]
</span>`;
            } else if (item.id === 11 || item.id === 55) { // Tensi√≥n pared / Laplace / Aneurisma
                 questionText.innerHTML += `<span class='img-tag'></span>`;
            } else if (item.id === 64) { // Capilaridad
                 questionText.innerHTML += `<span class='img-tag'>

[Image of capillary action diagram]
</span>`;
            } else if (item.id === 6) { // Vasos perif√©ricos / Presi√≥n
                 questionText.innerHTML += `<span class='img-tag'>

[Image of vasoconstriction and vasodilation]
</span>`;
            }

            card.appendChild(questionText);

            // --- Opciones ---
            const optionsDiv = document.createElement('div');
            optionsDiv.className = 'options-container';

            let optionsObj = item.opts.map(opt => ({
                text: opt,
                isCorrect: opt === item.a
            }));
            optionsObj = shuffleArray(optionsObj);

            // --- Explicaci√≥n ---
            const explanationDiv = document.createElement('div');
            explanationDiv.className = 'explanation';
            explanationDiv.innerHTML = `<strong>Respuesta Correcta:</strong> ${item.a}`;

            optionsObj.forEach(opt => {
                const btn = document.createElement('button');
                btn.className = 'option-btn';
                btn.textContent = opt.text;

                btn.onclick = () => {
                    const allBtns = optionsDiv.querySelectorAll('.option-btn');
                    allBtns.forEach(b => b.disabled = true);

                    if (opt.isCorrect) {
                        btn.classList.add('correct');
                    } else {
                        btn.classList.add('incorrect');
                        failedQuestions.add(item.id);
                        
                        allBtns.forEach(b => {
                            if (b.textContent === item.a) b.classList.add('correct');
                        });
                    }
                    explanationDiv.classList.add('visible');
                };
                optionsDiv.appendChild(btn);
            });

            card.appendChild(optionsDiv);
            card.appendChild(explanationDiv);
            container.appendChild(card);
        });
    }

    // --- Control Final ---
    function showEndOptions() {
        document.getElementById("finish-btn").style.display = "none";
        document.getElementById("restart-menu").style.display = "flex";
        document.getElementById("controls-area").scrollIntoView({behavior: "smooth"});
        
        document.getElementById("stats-summary").innerHTML = `
            Preguntas marcadas: <strong>${markedQuestions.size}</strong><br>
            Preguntas falladas en esta sesi√≥n: <strong>${failedQuestions.size}</strong>
        `;
    }

    function restartQuiz(mode) {
        let subset = [];
        if (mode === 'all') subset = quizData;
        else if (mode === 'marked') subset = quizData.filter(q => markedQuestions.has(q.id));
        else if (mode === 'failed') subset = quizData.filter(q => failedQuestions.has(q.id));
        else if (mode === 'failed_marked') subset = quizData.filter(q => failedQuestions.has(q.id) || markedQuestions.has(q.id));

        if(mode !== 'all') failedQuestions.clear(); 
        else {
            failedQuestions.clear();
            markedQuestions.clear();
        }

        renderQuiz(subset);
        window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    renderQuiz();
</script>

</body>
</html>
