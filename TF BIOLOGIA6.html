<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Examen Bloque 6 - Relaciones C√©lula-Entorno</title>
    <style>
        :root {
            --primary: #8e44ad; /* Morado Histolog√≠a */
            --secondary: #9b59b6;
            --success: #27ae60;
            --danger: #c0392b;
            --warning: #f1c40f;
            --light: #f4f6f7;
            --dark: #2c3e50;
        }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--light);
            color: var(--dark);
            margin: 0;
            padding: 20px;
            line-height: 1.6;
        }
        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            padding: 40px;
            border-radius: 12px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            min-height: 600px;
        }
        header {
            text-align: center;
            border-bottom: 3px solid var(--primary);
            padding-bottom: 20px;
            margin-bottom: 30px;
        }
        h1 { color: var(--primary); margin: 0; font-size: 2rem; }
        .prof-info { font-style: italic; color: #7f8c8d; margin-top: 5px; }
        
        .status-panel {
            background: #e8daef;
            padding: 15px 25px;
            border-radius: 8px;
            display: flex;
            justify-content: space-between;
            font-weight: bold;
            margin-bottom: 25px;
            color: var(--primary);
            border: 1px solid #d2b4de;
        }

        .question-card {
            display: none;
            position: relative; /* Para el marcador */
            animation: fadeIn 0.4s ease-out;
        }
        .question-card.active { display: block; }

        /* ESTILOS DEL MARCADOR */
        .bookmark-panel {
            position: absolute;
            top: 0;
            right: 0;
            background: #fff9c4;
            border: 1px solid #fbc02d;
            color: #f57f17;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.9rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: transform 0.2s;
            z-index: 10;
        }
        .bookmark-panel:hover { transform: scale(1.05); background: #fff176; }
        .bookmark-panel input { cursor: pointer; transform: scale(1.3); }

        .question-header {
            font-size: 0.9rem;
            text-transform: uppercase;
            color: #7f8c8d;
            margin-bottom: 10px;
            letter-spacing: 1px;
            margin-top: 15px;
        }

        .question-text {
            font-size: 1.3rem;
            margin-bottom: 25px;
            font-weight: 600;
            padding-right: 120px; /* Espacio para no tapar el marcador */
        }

        .options-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .option-btn {
            background: white;
            border: 2px solid #bdc3c7;
            padding: 18px;
            border-radius: 10px;
            cursor: pointer;
            text-align: left;
            font-size: 1.05rem;
            transition: all 0.2s;
        }

        .option-btn:hover:not(:disabled) {
            border-color: var(--primary);
            background: #fdfefe;
            transform: translateX(5px);
        }

        .option-btn:disabled { cursor: default; opacity: 0.9; }

        .correct {
            background-color: #d5f5e3 !important;
            border-color: var(--success) !important;
            color: #145a32;
        }

        .incorrect {
            background-color: #fadbd8 !important;
            border-color: var(--danger) !important;
            color: #7b241c;
        }

        .feedback-area {
            margin-top: 25px;
            padding: 20px;
            border-radius: 8px;
            background: #f8f9fa;
            border-left: 5px solid var(--dark);
            display: none;
        }
        .feedback-area.show { display: block; }
        .rationale { margin-top: 10px; font-size: 0.95rem; }

        .nav-btn {
            display: none;
            background: var(--primary);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 6px;
            font-size: 1.1rem;
            margin-top: 25px;
            cursor: pointer;
            float: right;
            transition: background 0.3s;
        }
        .nav-btn:hover { background: var(--secondary); }

        /* PANTALLA DE RESULTADOS */
        .results-view {
            text-align: center;
            display: none;
            padding: 20px 0;
        }
        .final-score {
            font-size: 4rem;
            font-weight: bold;
            color: var(--primary);
            margin: 20px 0;
        }
        
        .stats-summary {
            color: #555;
            margin-bottom: 30px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
            display: inline-block;
        }

        /* GRID DE BOTONES DE ACCI√ìN */
        .action-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-top: 20px;
        }
        .action-btn {
            padding: 15px;
            border: none;
            border-radius: 8px;
            font-weight: bold;
            color: white;
            cursor: pointer;
            transition: transform 0.2s;
            font-size: 1rem;
        }
        .action-btn:hover { transform: translateY(-3px); filter: brightness(110%); }
        .action-btn:disabled { background-color: #bdc3c7 !important; cursor: not-allowed; transform: none; filter: none; }

        .btn-restart { background-color: var(--primary); grid-column: span 2; }
        .btn-failed { background-color: var(--danger); }
        .btn-marked { background-color: #f39c12; color: #fff; } /* Naranja */
        .btn-mixed { background-color: #2c3e50; grid-column: span 2; }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>

<div class="container">
    <header>
        <h1>Examen Bloque 6: Relaciones C√©lula-Microambiente</h1>
        <div class="prof-info">Facultad de Medicina de C√°diz - Prof. Meritxell Llorca Torralba</div>
    </header>

    <div class="status-panel" id="statusBar">
        <span id="q-progress">Cargando...</span>
        <span id="score-display">Aciertos: 0</span>
    </div>

    <div id="quiz-container"></div>

    <div id="results-screen" class="results-view">
        <h2>Sesi√≥n Completada</h2>
        <div class="final-score" id="final-number">0/0</div>
        <p id="final-text" style="font-size: 1.2rem; margin-bottom: 20px;"></p>
        
        <div class="stats-summary" id="stats-box"></div>

        <div class="action-grid">
            <button class="action-btn btn-restart" onclick="startQuiz('all')">üîÑ Reiniciar Test Completo</button>
            <button class="action-btn btn-failed" id="btn-failed" onclick="startQuiz('failed')">‚ùå Repetir Falladas</button>
            <button class="action-btn btn-marked" id="btn-marked" onclick="startQuiz('marked')">‚ö†Ô∏è Repetir Marcadas</button>
            <button class="action-btn btn-mixed" id="btn-mixed" onclick="startQuiz('mixed')">‚ùå + ‚ö†Ô∏è Repetir Falladas y Marcadas</button>
        </div>
    </div>
</div>

<script>
const quizData = [
    // --- INTRODUCCI√ìN Y GENERALIDADES (1-5) ---
    { topic: "Introducci√≥n", question: "¬øQu√© transformaci√≥n fundamental permiti√≥ la aparici√≥n de formas de vida complejas y especializadas?", options: ["El desarrollo de la fotos√≠ntesis.", "El paso de organismos unicelulares a multicelulares.", "La aparici√≥n de la mitocondria.", "La p√©rdida de la pared celular."], correct: 1, explanation: "La multicelularidad permiti√≥ la especializaci√≥n celular y la formaci√≥n de tejidos." },
    { topic: "Tejidos", question: "¬øQu√© tejido se encarga principalmente de proporcionar soporte y estructura, teniendo abundante matriz extracelular?", options: ["Tejido Epitelial", "Tejido Nervioso", "Tejido Conjuntivo", "Tejido Muscular"], correct: 2, explanation: "En el tejido conjuntivo, la matriz extracelular soporta la carga mec√°nica y es m√°s abundante que las c√©lulas." },
    { topic: "Tejidos", question: "¬øQu√© tejido forma barreras y superficies, con c√©lulas muy unidas entre s√≠?", options: ["Tejido Conjuntivo", "Tejido Epitelial", "Tejido Muscular", "Tejido Nervioso"], correct: 1, explanation: "Los epitelios recubren superficies y cavidades, requiriendo uniones estrechas entre c√©lulas." },
    { topic: "Adhesi√≥n", question: "¬øCu√°les son los dos tipos principales de adhesi√≥n celular?", options: ["C√©lula-C√©lula y C√©lula-Sustrato", "C√©lula-Virus y C√©lula-Bacteria", "N√∫cleo-Citoplasma y ADN-ARN", "Mitosis-Meiosis"], correct: 0, explanation: "Las c√©lulas pueden unirse directamente a sus vecinas o anclarse a la matriz extracelular (sustrato)." },
    { topic: "Adhesi√≥n", question: "¬øQu√© es la histog√©nesis?", options: ["La destrucci√≥n de tejidos.", "El proceso de formaci√≥n de tejidos mediante la organizaci√≥n celular.", "La duplicaci√≥n del ADN.", "La muerte celular programada."], correct: 1, explanation: "Es el proceso por el cual las c√©lulas se organizan espacialmente para formar estructuras tisulares funcionales." },

    // --- MOL√âCULAS DE ADHESI√ìN CELULAR (CAMs) (6-20) ---
    { topic: "CAMs", question: "¬øQu√© significa el acr√≥nimo CAM?", options: ["Cell Adhesion Molecules (Mol√©culas de Adhesi√≥n Celular)", "Complejo de Ataque a Membrana", "C√©lula Activa Metab√≥licamente", "Centro de Actividad Mit√≥tica"], correct: 0, explanation: "Son las prote√≠nas de membrana responsables de la uni√≥n entre c√©lulas." },
    { topic: "Cadherinas", question: "¬øDe qu√© ion dependen las Cadherinas para funcionar correctamente?", options: ["Sodio (Na+)", "Potasio (K+)", "Calcio (Ca2+)", "Magnesio (Mg2+)"], correct: 2, explanation: "Las Cadherinas son dependientes de Calcio; sin √©l, pierden su rigidez y no pueden unirse." },
    { topic: "Cadherinas", question: "¬øQu√© tipo de adhesi√≥n median principalmente las cadherinas?", options: ["Adhesi√≥n selectiva homot√≠pica (c√©lula con c√©lula del mismo tipo).", "Adhesi√≥n a la matriz extracelular.", "Adhesi√≥n a bacterias.", "Adhesi√≥n heterot√≠pica inespec√≠fica."], correct: 0, explanation: "Las cadherinas suelen unirse a cadherinas id√©nticas en la c√©lula vecina, permitiendo que c√©lulas iguales se agrupen." },
    { topic: "CAMs", question: "¬øQu√© familia de prote√≠nas de adhesi√≥n pertenece a la superfamilia de las inmunoglobulinas?", options: ["Integrinas", "Cadherinas", "N-CAM e I-CAM", "Selectinas"], correct: 2, explanation: "Las mol√©culas de adhesi√≥n como N-CAM (neuronal) pertenecen a la superfamilia de las Igs." },
    { topic: "Selectinas", question: "¬øQu√© caracter√≠stica define a las interacciones mediadas por Selectinas?", options: ["Son uniones permanentes y muy fuertes.", "Son uniones transitorias, a menudo en el torrente sangu√≠neo (rodamiento de leucocitos).", "Unen la c√©lula a la l√°mina basal.", "Forman canales i√≥nicos."], correct: 1, explanation: "Las selectinas median interacciones d√©biles y transitorias, cruciales para que los gl√≥bulos blancos rueden sobre el endotelio." },
    { topic: "Cadherinas", question: "¬øEn qu√© tipo de uni√≥n celular estructural son fundamentales las cadherinas?", options: ["Uniones Gap", "Hemidesmosomas", "Uniones Adherentes y Desmosomas", "Uniones Estrechas"], correct: 2, explanation: "Las cadherinas son el 'pegamento' tanto en desmosomas como en uniones adherentes." },
    { topic: "Integrinas", question: "¬øLas integrinas pueden participar en la adhesi√≥n c√©lula-c√©lula?", options: ["No, nunca.", "S√≠, algunos tipos espec√≠ficos, aunque su rol principal es c√©lula-sustrato.", "S√≠, siempre.", "Solo en c√©lulas vegetales."], correct: 1, explanation: "Aunque son cl√°sicas de la matriz (SAMs), algunas integrinas (como LFA-1 en leucocitos) median uni√≥n c√©lula-c√©lula." },
    { topic: "CAMs", question: "¬øQu√© proceso depende cr√≠ticamente de la adhesi√≥n selectiva mediada por CAMs?", options: ["La s√≠ntesis de ATP.", "La segregaci√≥n de tejidos durante el desarrollo embrionario.", "La replicaci√≥n del ADN.", "La gluc√≥lisis."], correct: 1, explanation: "Las c√©lulas de diferentes tejidos se separan y agrupan gracias a expresar cadherinas distintas." },
    { topic: "Estructura", question: "¬øD√≥nde se localizan las CAMs?", options: ["En el citosol.", "En la membrana plasm√°tica.", "En el n√∫cleo.", "En la mitocondria."], correct: 1, explanation: "Son prote√≠nas transmembrana o de superficie para poder interactuar con el exterior." },
    { topic: "Funci√≥n", question: "¬øQu√© funci√≥n tienen las CAMs adem√°s de la adhesi√≥n mec√°nica?", options: ["Transducci√≥n de se√±ales (comunicaci√≥n).", "Generaci√≥n de energ√≠a.", "S√≠ntesis de prote√≠nas.", "Digesti√≥n celular."], correct: 0, explanation: "Act√∫an como receptores que informan a la c√©lula sobre su entorno (densidad celular, contacto)." },
    { topic: "Cadherinas", question: "¬øC√≥mo se llama la cadherina t√≠pica de las c√©lulas epiteliales?", options: ["E-cadherina", "N-cadherina", "P-cadherina", "VE-cadherina"], correct: 0, explanation: "La E-cadherina es la principal en epitelios; su p√©rdida se asocia a met√°stasis tumoral." },
    { topic: "Cadherinas", question: "¬øA qu√© elemento del citoesqueleto se unen las cadherinas en una Uni√≥n Adherente?", options: ["Microt√∫bulos", "Filamentos de Actina", "Filamentos Intermedios", "L√°mina Nuclear"], correct: 1, explanation: "En las uniones adherentes (zonula adherens), las cadherinas conectan con la actina." },
    { topic: "Cadherinas", question: "¬øA qu√© elemento del citoesqueleto se unen las cadherinas en un Desmosoma?", options: ["Actina", "Filamentos Intermedios", "Microt√∫bulos", "ADN"], correct: 1, explanation: "En los desmosomas, las cadherinas (desmogle√≠nas) conectan con filamentos intermedios para dar resistencia." },
    { topic: "Selectinas", question: "¬øQu√© reconocen y unen las Selectinas en la c√©lula diana?", options: ["Otras prote√≠nas.", "Carbohidratos (az√∫cares) de la superficie celular.", "L√≠pidos.", "ADN."], correct: 1, explanation: "Las selectinas son lectinas: prote√≠nas que unen az√∫cares espec√≠ficos." },
    { topic: "General", question: "¬øQu√© ocurre si se eliminan las CAMs en un embri√≥n en desarrollo?", options: ["El embri√≥n crece m√°s r√°pido.", "Las c√©lulas se disgregan y la estructura tisular falla.", "No pasa nada.", "Aumenta la matriz extracelular."], correct: 1, explanation: "Sin adhesi√≥n, no hay arquitectura tisular y el desarrollo se detiene." },

    // --- MOL√âCULAS DE ADHESI√ìN AL SUSTRATO (SAMs) (21-30) ---
    { topic: "SAMs", question: "¬øCu√°l es la principal familia de receptores para la adhesi√≥n a la Matriz Extracelular?", options: ["Cadherinas", "Integrinas", "Selectinas", "Claudinas"], correct: 1, explanation: "Las integrinas son los puentes universales entre la c√©lula y la matriz." },
    { topic: "Integrinas", question: "¬øC√≥mo es la estructura b√°sica de una integrina?", options: ["Un mon√≥mero.", "Un heterod√≠mero con subunidades alfa y beta.", "Un tr√≠mero.", "Un canal i√≥nico."], correct: 1, explanation: "Est√°n formadas por dos cadenas distintas (alfa y beta) que cruzan la membrana." },
    { topic: "Integrinas", question: "¬øQu√© conectan las integrinas en el interior de la c√©lula?", options: ["El n√∫cleo.", "El citoesqueleto (actina o filamentos intermedios).", "El aparato de Golgi.", "Los ribosomas."], correct: 1, explanation: "Vinculan la matriz externa con el esqueleto interno de la c√©lula." },
    { topic: "Funci√≥n", question: "¬øQu√© es la 'Mecanotransducci√≥n' mediada por integrinas?", options: ["La conversi√≥n de fuerzas mec√°nicas de la matriz en se√±ales bioqu√≠micas intracelulares.", "El movimiento muscular.", "La s√≠ntesis de matriz.", "La rotura de la matriz."], correct: 0, explanation: "Las c√©lulas 'sienten' la rigidez de su entorno a trav√©s de las integrinas y responden a ella." },
    { topic: "Activaci√≥n", question: "¬øPueden las integrinas cambiar de estado activo a inactivo?", options: ["No, siempre est√°n activas.", "S√≠, pueden activarse 'desde dentro' o 'desde fuera'.", "Solo est√°n activas en mitosis.", "Est√°n siempre inactivas."], correct: 1, explanation: "Las integrinas cambian de conformaci√≥n (se 'despliegan') para unirse a la matriz cuando la c√©lula lo necesita." },
    { topic: "Fibronectina", question: "¬øQu√© papel juega la fibronectina en la adhesi√≥n?", options: ["Es un componente del citoesqueleto.", "Act√∫a como adaptador o 'pegamento' uniendo las integrinas al col√°geno.", "Es una enzima.", "Es un l√≠pido."], correct: 1, explanation: "La fibronectina tiene dominios de uni√≥n para col√°geno y para integrinas, sirviendo de puente." },
    { topic: "Laminina", question: "¬øEn qu√© estructura especializada de la MEC es fundamental la Laminina?", options: ["En el hueso.", "En la l√°mina basal.", "En el cart√≠lago.", "En el tend√≥n."], correct: 1, explanation: "La laminina es el principal componente organizador de la l√°mina basal epitelial." },
    { topic: "Hemidesmosomas", question: "¬øQu√© mol√©cula de adhesi√≥n es clave en los Hemidesmosomas?", options: ["Cadherina", "Selectina", "Integrina (espec√≠ficamente alfa6beta4).", "Ig-CAM"], correct: 2, explanation: "A diferencia de los desmosomas (cadherinas), los hemidesmosomas usan integrinas para anclarse a la base." },
    { topic: "Movimiento", question: "¬øPor qu√© es importante la uni√≥n din√°mica de las integrinas para la migraci√≥n celular?", options: ["Para que la c√©lula se quede quieta.", "Permite el ciclo de 'agarre y liberaci√≥n' necesario para avanzar.", "Para sintetizar ADN.", "Para comer."], correct: 1, explanation: "La c√©lula debe pegar su frente y soltar su cola para moverse; las integrinas gestionan este agarre." },
    { topic: "Patolog√≠a", question: "¬øQu√© ocurre si una c√©lula pierde su anclaje a la matriz (v√≠a integrinas)?", options: ["Se divide m√°s r√°pido.", "Suele entrar en apoptosis (anoikis).", "Se hace inmortal.", "Se convierte en neurona."], correct: 1, explanation: "La mayor√≠a de c√©lulas normales requieren anclaje para sobrevivir; si flotan, mueren." },

    // --- MATRIZ EXTRACELULAR (MEC) (31-45) ---
    { topic: "Definici√≥n", question: "¬øQu√© es la Matriz Extracelular (MEC)?", options: ["El citoplasma.", "Una red de prote√≠nas y polisac√°ridos secretada por las c√©lulas que rellena los espacios intercelulares.", "La pared celular bacteriana.", "El n√∫cleo."], correct: 1, explanation: "Es el andamio f√≠sico y qu√≠mico donde residen las c√©lulas en los tejidos." },
    { topic: "Componentes", question: "¬øCu√°les son las dos clases principales de macromol√©culas de la MEC?", options: ["ADN y ARN.", "Prote√≠nas fibrosas (ej. col√°geno) y cadenas de polisac√°ridos (GAGs).", "L√≠pidos y carbohidratos simples.", "Actina y Tubulina."], correct: 1, explanation: "La MEC combina fibras resistentes (prote√≠nas) con un gel hidratado (az√∫cares)." },
    { topic: "Col√°geno", question: "¬øCu√°l es la prote√≠na m√°s abundante en el reino animal y en la MEC?", options: ["Actina", "Tubulina", "Col√°geno", "Elastina"], correct: 2, explanation: "El col√°geno constituye el 25-30% de la prote√≠na total en mam√≠feros." },
    { topic: "Col√°geno", question: "¬øCu√°l es la funci√≥n principal de las fibras de col√°geno?", options: ["Resistencia a la compresi√≥n.", "Resistencia a la tracci√≥n (estiramiento).", "Elasticidad.", "Se√±alizaci√≥n el√©ctrica."], correct: 1, explanation: "El col√°geno es como una cuerda de acero biol√≥gica; resiste que el tejido se desgarre." },
    { topic: "Col√°geno", question: "¬øCu√°l es la estructura caracter√≠stica del col√°geno?", options: ["Doble h√©lice.", "Triple h√©lice.", "L√°mina beta.", "Gl√≥bulo."], correct: 1, explanation: "Tres cadenas polipept√≠dicas se enrollan entre s√≠ para formar una superh√©lice resistente." },
    { topic: "S√≠ntesis", question: "¬øQu√© c√©lulas son las principales productoras de MEC en el tejido conjuntivo?", options: ["Neuronas", "Fibroblastos", "Macr√≥fagos", "Adipocitos"], correct: 1, explanation: "Los fibroblastos secretan los precursores de la matriz (procol√°geno, etc.)." },
    { topic: "Col√°geno", question: "¬øPor qu√© se secreta el col√°geno como 'procol√°geno' (inactivo)?", options: ["Para que no se ensamble dentro de la c√©lula y la obstruya.", "Porque es t√≥xico.", "Para ahorrar energ√≠a.", "Para transportarlo al n√∫cleo."], correct: 0, explanation: "Si las fibras se formaran dentro de la c√©lula, esta se ahogar√≠a; el ensamblaje ocurre fuera." },
    { topic: "GAGs", question: "¬øQu√© son los Glucosaminoglucanos (GAGs)?", options: ["Prote√≠nas motoras.", "Largas cadenas de polisac√°ridos no ramificados con carga negativa.", "L√≠pidos de membrana.", "Factores de transcripci√≥n."], correct: 1, explanation: "Son cadenas de az√∫cares repetitivos, muy hidrof√≠licos." },
    { topic: "Proteoglucanos", question: "¬øCu√°l es la funci√≥n principal del gel de Proteoglucanos/GAGs?", options: ["Resistencia a la tracci√≥n.", "Resistencia a la compresi√≥n y ocupaci√≥n de volumen.", "Contracci√≥n muscular.", "Transmisi√≥n nerviosa."], correct: 1, explanation: "Al atraer mucha agua (por sus cargas), forman un gel turgente que act√∫a como 'amortiguador'." },
    { topic: "Tejidos", question: "¬øQu√© tejido es especialmente rico en Proteoglucanos para absorber impactos?", options: ["El tend√≥n.", "El cart√≠lago articular.", "El hueso.", "La epidermis."], correct: 1, explanation: "El cart√≠lago necesita resistir mucha presi√≥n, por lo que est√° lleno de este gel hidratado." },
    { topic: "Hueso", question: "¬øQu√© caracteriza a la MEC del tejido √≥seo?", options: ["Es l√≠quida.", "Est√° calcificada (mineralizada).", "Es solo col√°geno.", "Carece de matriz."], correct: 1, explanation: "La matriz √≥sea se endurece con cristales de hidroxiapatita (calcio/fosfato)." },
    { topic: "Elastina", question: "¬øQu√© prote√≠na confiere elasticidad a tejidos como la piel o las arterias?", options: ["Col√°geno", "Fibronectina", "Elastina", "Laminina"], correct: 2, explanation: "Las fibras el√°sticas permiten que el tejido se estire y vuelva a su forma original." },
    { topic: "Degradaci√≥n", question: "¬øQu√© enzimas degradan la matriz extracelular (necesario para la migraci√≥n celular)?", options: ["Polimerasas", "Metaloproteasas de matriz (MMPs)", "Ligasas", "Quinasas"], correct: 1, explanation: "Las MMPs cortan prote√≠nas de la matriz, abriendo camino a las c√©lulas (ej. en cicatrizaci√≥n o c√°ncer)." },
    { topic: "L√°mina Basal", question: "¬øQu√© es la l√°mina basal?", options: ["Una capa de c√©lulas.", "Una capa delgada y especializada de MEC bajo los epitelios.", "La membrana plasm√°tica basal.", "El fondo del n√∫cleo."], correct: 1, explanation: "Es una alfombrilla de matriz especializada que sostiene y separa el epitelio del tejido conectivo." },
    { topic: "Conexi√≥n", question: "¬øC√≥mo interact√∫a la c√©lula con el col√°geno?", options: ["Directamente.", "Indirectamente a trav√©s de Fibronectina e Integrinas.", "A trav√©s de cadherinas.", "No interact√∫a."], correct: 1, explanation: "La c√©lula agarra la fibronectina con sus integrinas, y la fibronectina agarra el col√°geno." },

    // --- UNIONES CELULARES (46-70) ---
    { topic: "Epitelios", question: "¬øQu√© caracter√≠stica de las c√©lulas epiteliales depende de las uniones celulares?", options: ["Su capacidad de divisi√≥n.", "Su polaridad (cara apical vs basolateral).", "Su color.", "Su tama√±o."], correct: 1, explanation: "Las uniones mantienen la separaci√≥n f√≠sica entre los dominios de membrana apical y basal." },
    { topic: "Uniones Estrechas", question: "¬øCu√°l es la funci√≥n principal de las Uniones Estrechas (Tight Junctions)?", options: ["Comunicaci√≥n el√©ctrica.", "Resistencia mec√°nica.", "Sellar el espacio intercelular (barrera de permeabilidad).", "Unir la c√©lula a la matriz."], correct: 2, explanation: "Impiden que fluidos y mol√©culas se filtren entre las c√©lulas (v√≠a paracelular)." },
    { topic: "Uniones Estrechas", question: "¬øQu√© prote√≠nas forman las hebras de sellado en las Uniones Estrechas?", options: ["Cadherinas", "Claudinas y Ocludinas", "Conexinas", "Integrinas"], correct: 1, explanation: "Estas prote√≠nas transmembrana cosen las membranas adyacentes." },
    { topic: "Uniones Estrechas", question: "¬øQu√© funci√≥n adicional tienen las uniones estrechas respecto a las prote√≠nas de membrana?", options: ["Act√∫an como 'vallas' impidiendo la difusi√≥n lateral de prote√≠nas entre dominio apical y basal.", "Sintetizan prote√≠nas.", "Transportan iones.", "Generan ATP."], correct: 0, explanation: "Mantienen la composici√≥n distinta de la cara apical y la basolateral." },
    { topic: "Uniones de Anclaje", question: "¬øQu√© funci√≥n general tienen las uniones de anclaje (Adherentes y Desmosomas)?", options: ["Impermeabilidad.", "Comunicaci√≥n.", "Resistencia y cohesi√≥n mec√°nica.", "Secreci√≥n."], correct: 2, explanation: "Distribuyen las tensiones mec√°nicas por todo el tejido para evitar roturas." },
    { topic: "Uniones Adherentes", question: "¬øQu√© estructura forman a menudo las Uniones Adherentes en epitelios?", options: ["Un punto aislado.", "Un cintur√≥n de adhesi√≥n continuo alrededor de la c√©lula.", "Un canal.", "Una red dispersa."], correct: 1, explanation: "Este cintur√≥n de actina permite que el epitelio se contraiga o doble coordinadamente (ej. tubo neural)." },
    { topic: "Uniones Adherentes", question: "¬øQu√© elemento del citoesqueleto une el cintur√≥n de adhesi√≥n?", options: ["Filamentos de Actina", "Filamentos Intermedios", "Microt√∫bulos", "L√°mina"], correct: 0, explanation: "Las cadherinas de la uni√≥n adherente se conectan intracelularmente con la actina." },
    { topic: "Desmosomas", question: "¬øC√≥mo se describen visualmente los desmosomas?", options: ["Como cremalleras.", "Como remaches o botones de soldadura.", "Como canales.", "Como poros."], correct: 1, explanation: "Son puntos de uni√≥n fuertes y puntuales, como remaches que unen dos chapas." },
    { topic: "Desmosomas", question: "¬øQu√© filamentos se anclan a los desmosomas?", options: ["Actina", "Microt√∫bulos", "Filamentos Intermedios (ej. queratina).", "Col√°geno"], correct: 2, explanation: "Esta conexi√≥n crea una red continua de filamentos intermedios a trav√©s del tejido, dando gran resistencia tensil." },
    { topic: "Hemidesmosomas", question: "¬øQu√© diferencia un Hemidesmosoma de un Desmosoma?", options: ["El hemidesmosoma une c√©lula con matriz (l√°mina basal), el desmosoma c√©lula con c√©lula.", "El hemidesmosoma usa cadherinas.", "El desmosoma usa integrinas.", "Son iguales."], correct: 0, explanation: "Hemidesmosoma ('mitad de desmosoma') ancla la base de la c√©lula al sustrato usando integrinas." },
    { topic: "Patolog√≠a", question: "¬øQu√© ocurre en el P√©nfigo (enfermedad autoinmune contra desmosomas)?", options: ["La piel se vuelve impermeable.", "Se forman ampollas porque las c√©lulas de la piel se separan entre s√≠.", "La piel se endurece.", "No pasa nada."], correct: 1, explanation: "Al atacar las cadherinas de los desmosomas, se pierde la cohesi√≥n y la piel se deshace." },
    { topic: "Uniones Gap", question: "¬øCu√°l es la funci√≥n de las Uniones Comunicantes (Gap Junctions)?", options: ["Resistencia mec√°nica.", "Barrera impermeable.", "Comunicaci√≥n directa citoplasma-citoplasma.", "Adhesi√≥n a matriz."], correct: 2, explanation: "Permiten el paso de iones y mol√©culas peque√±as entre c√©lulas vecinas." },
    { topic: "Uniones Gap", question: "¬øQu√© prote√≠nas forman los canales de las Uniones Gap?", options: ["Conexinas", "Claudinas", "Cadherinas", "Integrinas"], correct: 0, explanation: "6 conexinas forman un conex√≥n (hemicanal); dos conexones forman el canal completo." },
    { topic: "Uniones Gap", question: "¬øQu√© tipo de acoplamiento permiten las uniones Gap?", options: ["Solo mec√°nico.", "El√©ctrico y metab√≥lico.", "Gen√©tico.", "Ninguno."], correct: 1, explanation: "Permiten que las c√©lulas compartan metabolitos y que los impulsos el√©ctricos se propaguen (ej. coraz√≥n)." },
    { topic: "Uniones Gap", question: "¬øSon los canales Gap permanentes?", options: ["S√≠, siempre abiertos.", "No, pueden abrirse o cerrarse (gating) en respuesta a se√±ales (ej. pH, Ca2+).", "Nunca se abren.", "Se destruyen con el uso."], correct: 1, explanation: "La c√©lula puede cerrar sus gap junctions para aislarse si una vecina muere (entrada masiva de Ca2+)." },
    { topic: "Coraz√≥n", question: "¬øPor qu√© el m√∫sculo card√≠aco se contrae sincronizadamente?", options: ["Por las uniones estrechas.", "Por el flujo de iones a trav√©s de las Uniones Gap.", "Por la matriz extracelular.", "Por casualidad."], correct: 1, explanation: "Las uniones gap permiten que el potencial de acci√≥n pase directamente de c√©lula a c√©lula." },
    { topic: "Resumen Uniones", question: "¬øQu√© uni√≥n usa integrinas?", options: ["Desmosoma", "Uni√≥n Adherente", "Hemidesmosoma", "Uni√≥n Gap"], correct: 2, explanation: "Es la √∫nica uni√≥n de anclaje de la lista que conecta con la matriz (l√°mina basal)." },
    { topic: "Resumen Uniones", question: "¬øQu√© uni√≥n sella el espacio intercelular?", options: ["Desmosoma", "Uni√≥n Estrecha", "Hemidesmosoma", "Uni√≥n Gap"], correct: 1, explanation: "Es la 'junta de estanqueidad' del epitelio." },
    { topic: "Resumen Uniones", question: "¬øQu√© uni√≥n conecta los filamentos de actina de dos c√©lulas?", options: ["Desmosoma", "Uni√≥n Adherente", "Hemidesmosoma", "Uni√≥n Gap"], correct: 1, explanation: "La uni√≥n adherente (zonula adherens) es el anclaje c√©lula-c√©lula basado en actina." },
    { topic: "Plantas", question: "¬øCu√°l es el equivalente funcional de las uniones Gap en las plantas?", options: ["Desmosomas", "Plasmodesmos", "Pared celular", "Estomas"], correct: 1, explanation: "Los plasmodesmos son canales revestidos de membrana que conectan citoplasmas vegetales a trav√©s de la pared." },
    { topic: "C√°ncer", question: "¬øQu√© relaci√≥n hay entre cadherinas y c√°ncer?", options: ["Los tumores expresan m√°s cadherinas.", "La p√©rdida de E-cadherina permite que las c√©lulas se suelten y hagan met√°stasis.", "Las cadherinas matan al tumor.", "No hay relaci√≥n."], correct: 1, explanation: "Para migrar, las c√©lulas cancerosas deben romper sus uniones con las vecinas (transici√≥n epitelio-mes√©nquima)." },
    { topic: "Leucocitos", question: "¬øQu√© deficiencia causa el 's√≠ndrome de deficiencia de adhesi√≥n leucocitaria'?", options: ["Falta de integrinas beta-2.", "Falta de col√°geno.", "Falta de actina.", "Falta de ATP."], correct: 0, explanation: "Sin integrinas funcionales, los gl√≥bulos blancos no pueden adherirse firmemente y salir del vaso sangu√≠neo hacia la infecci√≥n." },
    { topic: "Piel", question: "¬øQu√© uni√≥n es vital para que la epidermis resista la fricci√≥n sin romperse?", options: ["Uni√≥n Gap", "Uni√≥n Estrecha", "Desmosoma", "Sinapsis"], correct: 2, explanation: "Los desmosomas (y filamentos intermedios) proporcionan la resistencia tensil necesaria." },
    { topic: "MEC", question: "¬øQu√© vitamina es esencial para la s√≠ntesis correcta de col√°geno (previniendo el escorbuto)?", options: ["Vitamina A", "Vitamina C", "Vitamina D", "Vitamina B12"], correct: 1, explanation: "La vitamina C es cofactor para la hidroxilaci√≥n de la prolina, necesaria para la estabilidad de la h√©lice de col√°geno." },
    { topic: "General", question: "¬øQu√© define a un tejido?", options: ["C√©lulas aisladas.", "Un conjunto cooperativo de c√©lulas y matriz con una funci√≥n espec√≠fica.", "Solo matriz extracelular.", "Solo prote√≠nas."], correct: 1, explanation: "Es la definici√≥n b√°sica: c√©lulas + matriz trabajando juntas." }
];

// Inicializaci√≥n de estado
quizData.forEach(q => {
    q.isMarked = false;
    q.userCorrect = null;
});

let activeIndices = []; 
let currentPlaylistIndex = 0;
let sessionScore = 0;
let answered = false;

document.addEventListener('DOMContentLoaded', () => {
    startQuiz('all');
});

function startQuiz(mode) {
    activeIndices = [];

    if (mode === 'all') {
        quizData.forEach(q => q.userCorrect = null);
        activeIndices = quizData.map((_, i) => i);
    } 
    else if (mode === 'failed') {
        activeIndices = quizData.map((q, i) => q.userCorrect === false ? i : -1).filter(i => i !== -1);
    } 
    else if (mode === 'marked') {
        activeIndices = quizData.map((q, i) => q.isMarked ? i : -1).filter(i => i !== -1);
    } 
    else if (mode === 'mixed') {
        activeIndices = quizData.map((q, i) => (q.userCorrect === false || q.isMarked) ? i : -1).filter(i => i !== -1);
    }

    if (activeIndices.length === 0) {
        alert("No hay preguntas disponibles para este modo.");
        return;
    }

    currentPlaylistIndex = 0;
    sessionScore = 0;
    
    document.getElementById('results-screen').style.display = 'none';
    document.getElementById('quiz-container').style.display = 'block';
    document.getElementById('statusBar').style.display = 'flex';
    
    loadQuestion();
}

function loadQuestion() {
    answered = false;
    const realIndex = activeIndices[currentPlaylistIndex];
    const q = quizData[realIndex];
    
    document.getElementById('q-progress').innerText = `Pregunta ${currentPlaylistIndex + 1} de ${activeIndices.length}`;
    document.getElementById('score-display').innerText = `Aciertos: ${sessionScore}`;

    const container = document.getElementById('quiz-container');
    const checkedAttr = q.isMarked ? 'checked' : '';

    let html = `
        <div class="question-card active">
            <label class="bookmark-panel">
                <input type="checkbox" onchange="toggleMark(${realIndex}, this)" ${checkedAttr}>
                <span>Marcar</span>
            </label>

            <div class="question-header">${q.topic}</div>
            <div class="question-text">${q.question}</div>
            <div class="options-list">
                ${q.options.map((opt, i) => `
                    <button class="option-btn" onclick="checkAnswer(${i}, ${q.correct}, this, ${realIndex})">
                        ${String.fromCharCode(65+i)}. ${opt}
                    </button>
                `).join('')}
            </div>
            <div class="feedback-area" id="feedback"></div>
            <button class="nav-btn" id="next-btn" onclick="nextQuestion()">Siguiente</button>
        </div>
    `;
    
    container.innerHTML = html;
}

function toggleMark(realIndex, checkbox) {
    quizData[realIndex].isMarked = checkbox.checked;
}

function checkAnswer(selected, correct, btn, realIndex) {
    if(answered) return;
    answered = true;

    const allBtns = document.querySelectorAll('.option-btn');
    const feedback = document.getElementById('feedback');
    const nextBtn = document.getElementById('next-btn');

    allBtns.forEach(b => b.disabled = true);

    if(selected === correct) {
        sessionScore++;
        quizData[realIndex].userCorrect = true;
        btn.classList.add('correct');
        feedback.innerHTML = `<strong style="color:var(--success)">¬°Correcto!</strong> <div class="rationale">${quizData[realIndex].explanation}</div>`;
    } else {
        quizData[realIndex].userCorrect = false;
        btn.classList.add('incorrect');
        allBtns[correct].classList.add('correct');
        feedback.innerHTML = `<strong style="color:var(--danger)">Incorrecto.</strong> <div class="rationale">${quizData[realIndex].explanation}</div>`;
    }

    feedback.classList.add('show');
    nextBtn.style.display = 'block';
    document.getElementById('score-display').innerText = `Aciertos: ${sessionScore}`;
}

function nextQuestion() {
    if(currentPlaylistIndex < activeIndices.length - 1) {
        currentPlaylistIndex++;
        loadQuestion();
    } else {
        showResults();
    }
}

function showResults() {
    document.getElementById('statusBar').style.display = 'none';
    document.getElementById('quiz-container').style.display = 'none';
    document.getElementById('results-screen').style.display = 'block';
    
    document.getElementById('final-number').innerText = `${sessionScore} / ${activeIndices.length}`;
    
    const percent = Math.round((sessionScore / activeIndices.length) * 100);
    let msg = "";
    if(percent >= 90) msg = "¬°Excelente!";
    else if(percent >= 70) msg = "¬°Muy bien!";
    else if(percent >= 50) msg = "Aprobado.";
    else msg = "Necesitas repasar.";
    
    document.getElementById('final-text').innerText = `${percent}% - ${msg}`;

    // Stats
    const totalFailed = quizData.filter(q => q.userCorrect === false).length;
    const totalMarked = quizData.filter(q => q.isMarked === true).length;
    const totalMixed = quizData.filter(q => q.userCorrect === false || q.isMarked).length;

    document.getElementById('stats-box').innerHTML = `
        <strong>Resumen Global:</strong><br>
        Marcadas: ${totalMarked} | Falladas: ${totalFailed}
    `;

    document.getElementById('btn-failed').disabled = (totalFailed === 0);
    document.getElementById('btn-marked').disabled = (totalMarked === 0);
    document.getElementById('btn-mixed').disabled = (totalMixed === 0);
    
    document.getElementById('btn-failed').innerText = `‚ùå Repetir Falladas (${totalFailed})`;
    document.getElementById('btn-marked').innerText = `‚ö†Ô∏è Repetir Marcadas (${totalMarked})`;
}
</script>

</body>
</html>
