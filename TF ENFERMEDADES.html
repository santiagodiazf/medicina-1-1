<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Examen: Bases Celulares de la Patolog√≠a - Medicina C√°diz</title>
    <style>
        :root {
            --primary: #800000; /* Granate Medicina */
            --secondary: #b30000;
            --light: #fdedec;
            --dark: #2c3e50;
            --success: #27ae60;
            --error: #c0392b;
            --warning: #f1c40f;
        }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--light);
            color: var(--dark);
            margin: 0;
            padding: 20px;
            line-height: 1.6;
        }
        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            padding: 40px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            border-top: 5px solid var(--primary);
            min-height: 600px;
        }
        header {
            text-align: center;
            border-bottom: 2px solid #eee;
            padding-bottom: 20px;
            margin-bottom: 30px;
        }
        h1 { color: var(--primary); margin: 0; font-size: 2rem; }
        .prof-info { font-style: italic; color: #7f8c8d; margin-top: 10px; }
        
        .status-bar {
            background: #fadbd8;
            padding: 15px 25px;
            border-radius: 8px;
            display: flex;
            justify-content: space-between;
            font-weight: bold;
            margin-bottom: 25px;
            color: var(--primary);
            border: 1px solid #ebcccc;
        }

        .question-card {
            display: none;
            position: relative; /* Necesario para posicionar la marca */
            animation: fadeIn 0.4s ease-out;
        }
        .question-card.active { display: block; }

        /* ESTILOS DE LA PESTA√ëA DE MARCAR */
        .bookmark-panel {
            position: absolute;
            top: 0;
            right: 0;
            background: #fff9c4;
            border: 1px solid #fbc02d;
            color: #f57f17;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.9rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: transform 0.2s;
            z-index: 10;
        }
        .bookmark-panel:hover { transform: scale(1.05); background: #fff176; }
        .bookmark-panel input { cursor: pointer; transform: scale(1.3); }

        .question-header {
            font-size: 0.9rem;
            text-transform: uppercase;
            color: #e74c3c;
            margin-bottom: 10px;
            letter-spacing: 1px;
            font-weight: 700;
            margin-top: 15px;
        }

        .question-text {
            font-size: 1.3rem;
            margin-bottom: 25px;
            font-weight: 600;
            padding-right: 120px; /* Espacio para la marca */
        }

        .options-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .option-btn {
            background: white;
            border: 2px solid #e0e0e0;
            padding: 15px;
            border-radius: 8px;
            cursor: pointer;
            text-align: left;
            font-size: 1.05rem;
            transition: all 0.2s;
            position: relative;
        }

        .option-btn:hover:not(:disabled) {
            border-color: var(--primary);
            background: #f9e1e1;
        }

        .option-btn:disabled { cursor: default; opacity: 0.8; }

        .correct {
            background-color: #d5f5e3 !important;
            border-color: var(--success) !important;
            color: #145a32;
        }

        .incorrect {
            background-color: #fadbd8 !important;
            border-color: var(--error) !important;
            color: #7b241c;
        }

        .feedback-area {
            margin-top: 25px;
            padding: 20px;
            border-radius: 8px;
            background: #f4f6f7;
            border-left: 5px solid var(--dark);
            display: none;
        }
        .feedback-area.show { display: block; }
        .rationale { margin-top: 10px; font-size: 0.95rem; }

        .nav-btn {
            display: none;
            background: var(--primary);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 6px;
            font-size: 1.1rem;
            margin-top: 25px;
            cursor: pointer;
            float: right;
            transition: background 0.3s;
        }
        .nav-btn:hover { background: var(--secondary); }

        /* PANTALLA DE RESULTADOS */
        .results-view {
            text-align: center;
            display: none;
        }
        .final-score {
            font-size: 4rem;
            font-weight: 800;
            color: var(--primary);
            margin: 20px 0;
        }

        .stats-summary {
            background: #fff;
            border: 1px solid #eee;
            padding: 15px;
            border-radius: 8px;
            display: inline-block;
            margin-bottom: 20px;
            color: #555;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }

        /* GRID DE BOTONES DE ACCI√ìN */
        .action-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-top: 20px;
        }
        .action-btn {
            padding: 15px;
            border: none;
            border-radius: 8px;
            font-weight: bold;
            color: white;
            cursor: pointer;
            transition: transform 0.2s;
            font-size: 1rem;
        }
        .action-btn:hover { transform: translateY(-3px); filter: brightness(110%); }
        .action-btn:disabled { background-color: #bdc3c7 !important; cursor: not-allowed; transform: none; filter: none; }

        .btn-restart { background-color: var(--primary); grid-column: span 2; }
        .btn-failed { background-color: var(--error); }
        .btn-marked { background-color: var(--warning); color: #444; }
        .btn-mixed { background-color: var(--dark); grid-column: span 2; }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>

<div class="container">
    <header>
        <h1>Examen: Bases Celulares de la Enfermedad</h1>
        <div class="prof-info">Facultad de Medicina de C√°diz - Asignatura de Biolog√≠a Celular</div>
    </header>

    <div class="status-bar" id="statusBar">
        <span id="q-progress">Cargando...</span>
        <span id="score-display">Aciertos: 0</span>
    </div>

    <div id="quiz-container">
        </div>

    <div id="results-screen" class="results-view">
        <h2>Sesi√≥n Finalizada</h2>
        <div class="final-score" id="final-number">0/0</div>
        <p id="final-text" style="font-size: 1.2rem; margin-bottom: 20px;"></p>
        
        <div class="stats-summary" id="stats-box"></div>

        <div class="action-grid">
            <button class="action-btn btn-restart" onclick="startQuiz('all')">üîÑ Reiniciar Test Completo</button>
            <button class="action-btn btn-failed" id="btn-failed" onclick="startQuiz('failed')">‚ùå Repetir Falladas</button>
            <button class="action-btn btn-marked" id="btn-marked" onclick="startQuiz('marked')">‚ö†Ô∏è Repetir Marcadas</button>
            <button class="action-btn btn-mixed" id="btn-mixed" onclick="startQuiz('mixed')">‚ùå + ‚ö†Ô∏è Repetir Falladas y Marcadas</button>
        </div>
    </div>
</div>

<script>
const quizData = [
    // --- BLOQUE 2: Mutaciones, Reparaci√≥n y Splicing ---
    { topic: "Mutaciones", question: "¬øCu√°l es la causa molecular de la Anemia Drepanoc√≠tica (falciforme)?", options: ["Una deleci√≥n en el cromosoma 21.", "Una mutaci√≥n de un √∫nico nucle√≥tido en el gen de la hemoglobina.", "Un error en el splicing del gen SMN1.", "La infecci√≥n por un retrovirus."], correct: 1, explanation: "Es el ejemplo cl√°sico de enfermedad por mutaci√≥n puntual, que provoca la deformaci√≥n de los gl√≥bulos rojos." },
    { topic: "C√°ncer - Reparaci√≥n ADN", question: "Los defectos en el sistema de reparaci√≥n de apareamientos err√≥neos (mismatch repair) predisponen fuertemente a:", options: ["C√°ncer de colon.", "Anemia falciforme.", "Atrofia Muscular Espinal.", "Progeria."], correct: 0, explanation: "La incapacidad de corregir errores de replicaci√≥n acumula mutaciones que conducen al c√°ncer de colon hereditario." },
    { topic: "Atrofia Muscular Espinal", question: "¬øQu√© defecto molecular causa la Atrofia Muscular Espinal (SMA)?", options: ["La duplicaci√≥n del gen de la miostatina.", "Mutaciones o deleciones en el gen SMN1 y un splicing ineficiente del gen SMN2.", "La p√©rdida de los tel√≥meros.", "La sobreexpresi√≥n de p53."], correct: 1, explanation: "La enfermedad se debe a la falta de prote√≠na SMN funcional, agravada porque la copia de respaldo (SMN2) excluye el ex√≥n 7." },
    { topic: "Terapia SMA", question: "¬øC√≥mo funciona el f√°rmaco Nusinersen (Spinraza¬Æ) para tratar la SMA?", options: ["Es un antibi√≥tico que mata bacterias.", "Es un oligonucle√≥tido antisentido que corrige el splicing del gen SMN2 para incluir el ex√≥n 7.", "Repara el ADN da√±ado mediante recombinaci√≥n hom√≥loga.", "Inhibe la apoptosis de las neuronas."], correct: 1, explanation: "El f√°rmaco modula el procesamiento del pre-ARNm de SMN2 para producir prote√≠na funcional." },
    { topic: "C√°ncer - Mutaciones", question: "¬øQu√© tipo de mutaciones pueden conducir al desarrollo de c√°ncer si afectan a genes de control de divisi√≥n?", options: ["Mutaciones en c√©lulas germinales.", "Mutaciones en c√©lulas som√°ticas.", "Mutaciones silenciosas.", "Mutaciones en el ADN mitocondrial."], correct: 1, explanation: "El c√°ncer surge de la acumulaci√≥n de mutaciones en c√©lulas del cuerpo (som√°ticas) que pierden el control del ciclo." },
    { topic: "Da√±o ADN", question: "¬øQu√© lesi√≥n en el ADN es causada com√∫nmente por la radiaci√≥n ultravioleta (UV) solar y puede llevar a c√°ncer de piel si no se repara?", options: ["Desaminaci√≥n de citosina.", "D√≠meros de timina.", "Rotura de doble cadena.", "P√©rdida de tel√≥meros."], correct: 1, explanation: "La luz UV provoca enlaces covalentes entre timinas adyacentes, deformando la h√©lice." },
    { topic: "Reparaci√≥n ADN", question: "¬øQu√© mecanismo de reparaci√≥n de roturas bicatenarias es propenso a errores y puede causar mutaciones (cicatrices gen√©ticas)?", options: ["Recombinaci√≥n hom√≥loga.", "Uni√≥n de extremos no hom√≥logos (NHEJ).", "Correcci√≥n de pruebas.", "Escisi√≥n de base."], correct: 1, explanation: "NHEJ une los extremos rotos r√°pidamente pero a menudo pierde nucle√≥tidos, generando mutaciones." },

    // --- BLOQUE 3: Regulaci√≥n G√©nica y Virus ---
    { topic: "Virus - VIH", question: "¬øPor qu√© el VIH-1 evoluciona y genera resistencia tan r√°pidamente en el paciente?", options: ["Porque su polimerasa corrige errores.", "Porque su transcriptasa inversa no corrige errores, generando una alta tasa de mutaci√≥n.", "Porque tiene un genoma de ADN estable.", "Porque no entra en el n√∫cleo."], correct: 1, explanation: "La falta de correcci√≥n de pruebas de la enzima viral permite una variabilidad enorme para evadir al sistema inmune." },
    { topic: "Virus - SARS-CoV-2", question: "¬øQu√© caracter√≠stica del SARS-CoV-2 explica que genere variantes en lugar de cepas completamente nuevas r√°pidamente?", options: ["Su polimerasa tiene actividad de correcci√≥n de pruebas, manteniendo la tasa de mutaci√≥n relativamente baja.", "Muta m√°s r√°pido que el VIH.", "Es un virus de ADN.", "Se integra en el genoma humano."], correct: 0, explanation: "A diferencia de otros virus ARN, los coronavirus corrigen errores, lo que limita su velocidad de mutaci√≥n." },
    { topic: "C√°ncer - Epigen√©tica", question: "¬øC√≥mo puede la hipermetilaci√≥n del ADN contribuir al c√°ncer?", options: ["Activando oncogenes.", "Silenciando genes supresores de tumores (inactivando su expresi√≥n).", "Reparando el ADN.", "Aumentando la s√≠ntesis de prote√≠nas."], correct: 1, explanation: "La metilaci√≥n en promotores 'apaga' genes que deber√≠an frenar la divisi√≥n celular." },
    { topic: "Variaci√≥n Gen√©tica", question: "¬øQu√© variaci√≥n gen√©tica en humanos confiere resistencia a la malaria (paludismo)?", options: ["Intolerancia a la lactosa.", "Mutaciones asociadas a la anemia falciforme (en heterocigosis).", "Duplicaci√≥n del gen de la hemoglobina.", "P√©rdida del gen p53."], correct: 1, explanation: "Los portadores del rasgo falciforme tienen una ventaja de supervivencia frente al par√°sito de la malaria." },
    { topic: "Terapia G√©nica", question: "¬øPara qu√© enfermedad se ha aprobado el uso de la tecnolog√≠a CRISPR-Cas como terapia g√©nica?", options: ["Gripe com√∫n.", "Anemia falciforme (sickle cell).", "Diabetes tipo 2.", "Hipertensi√≥n."], correct: 1, explanation: "CRISPR se usa para editar c√©lulas madre hematopoy√©ticas y corregir el defecto de la hemoglobina." },
    { topic: "Wnt y C√°ncer", question: "¬øQu√© patolog√≠a se asocia a la activaci√≥n descontrolada de la v√≠a de se√±alizaci√≥n Wnt en el intestino?", options: ["C√°ncer colorrectal.", "√ölcera g√°strica.", "Celiaqu√≠a.", "Diabetes."], correct: 0, explanation: "La v√≠a Wnt mantiene a las c√©lulas madre; su sobreactivaci√≥n genera p√≥lipos y tumores." },

    // --- BLOQUE 4: N√∫cleo y Enfermedades ---
    { topic: "Patolog√≠a Nuclear", question: "En la Atrofia Muscular Espinal (SMA), ¬øqu√© estructura nuclear se pierde o desorganiza?", options: ["El nucl√©olo.", "Los Cuerpos de Cajal.", "La l√°mina nuclear.", "Los poros nucleares."], correct: 1, explanation: "La prote√≠na SMN es vital para la formaci√≥n de los Cuerpos de Cajal; sin ella, estos centros de splicing fallan." },
    { topic: "Virus y N√∫cleo", question: "¬øC√≥mo manipula el Adenovirus la maquinaria nuclear para su beneficio?", options: ["Destruye la envoltura nuclear.", "Secuestra la prote√≠na coilina de los Cuerpos de Cajal para exportar sus ARNm virales.", "Bloquea el poro nuclear.", "Inhibe la transcripci√≥n."], correct: 1, explanation: "El virus usa los componentes de los cuerpos nucleares como 'salvoconducto' para su replicaci√≥n." },
    { topic: "Degradaci√≥n Proteica", question: "¬øQu√© cuerpo nuclear se forma bajo condiciones de estr√©s proteol√≠tico para degradar prote√≠nas?", options: ["Clastosoma.", "Nucl√©olo.", "Speckle.", "Cuerpo de Barr."], correct: 0, explanation: "Los clastosomas son ricos en proteasomas y aparecen cuando la c√©lula necesita eliminar muchas prote√≠nas." },

    // --- BLOQUE 5: Citoesqueleto y Org√°nulos ---
    { topic: "Mitocondrias", question: "¬øQu√© consecuencia tiene la disfunci√≥n de la cadena respiratoria mitocondrial?", options: ["Aumento de la s√≠ntesis de ATP.", "Producci√≥n excesiva de lactato y fallo energ√©tico (enfermedades mitocondriales).", "Mejora del rendimiento muscular.", "Divisi√≥n celular acelerada."], correct: 1, explanation: "Sin fosforilaci√≥n oxidativa, la c√©lula depende de la gluc√≥lisis anaerobia, generando √°cido l√°ctico y poca energ√≠a." },
    { topic: "Citoesqueleto", question: "¬øQu√© ocurre en la distrofia muscular si falla la conexi√≥n entre el citoesqueleto y la matriz?", options: ["El m√∫sculo se hace m√°s fuerte.", "La membrana celular se rompe durante la contracci√≥n por falta de soporte mec√°nico.", "La c√©lula no puede dividirse.", "Aumenta el calcio en el n√∫cleo."], correct: 1, explanation: "La falta de prote√≠nas de anclaje (como distrofina/integrinas) hace que la c√©lula muscular sea fr√°gil al estr√©s mec√°nico." },
    { topic: "Citoesqueleto", question: "¬øC√≥mo act√∫an f√°rmacos como el Taxol en el tratamiento del c√°ncer?", options: ["Rompen el ADN.", "Estabilizan los microt√∫bulos, impidiendo la formaci√≥n del huso mit√≥tico y la divisi√≥n celular.", "Inhiben la s√≠ntesis de prote√≠nas.", "Bloquean la gluc√≥lisis."], correct: 1, explanation: "Al congelar la din√°mica de los microt√∫bulos, la c√©lula cancerosa no puede separar sus cromosomas y muere." },
    { topic: "Filamentos Intermedios", question: "¬øQu√© patolog√≠a cut√°nea se asocia a defectos en los filamentos intermedios (queratinas) o desmosomas?", options: ["Psoriasis.", "Fragilidad de la piel y formaci√≥n de ampollas (ej. Epiderm√≥lisis bullosa).", "C√°ncer de piel.", "Acn√©."], correct: 1, explanation: "Sin la resistencia mec√°nica de los filamentos intermedios, la piel se rompe ante el m√≠nimo roce." },

    // --- BLOQUE 6: Adhesi√≥n y Matriz ---
    { topic: "Met√°stasis", question: "¬øQu√© cambio en la adhesi√≥n celular es clave para que un tumor se vuelva metast√°sico?", options: ["Aumento de cadherinas.", "P√©rdida de E-cadherina, permitiendo que las c√©lulas se desprendan del tumor primario.", "Uni√≥n m√°s fuerte a la matriz.", "Formaci√≥n de uniones gap."], correct: 1, explanation: "Para migrar a otros √≥rganos, las c√©lulas cancerosas deben romper sus uniones con las vecinas." },
    { topic: "Matriz Extracelular", question: "¬øQu√© enfermedad es causada por la deficiencia de Vitamina C, afectando a la s√≠ntesis de col√°geno?", options: ["Raquitismo.", "Escorbuto.", "Osteoporosis.", "Artritis."], correct: 1, explanation: "Sin vitamina C, el col√°geno es inestable, provocando debilidad en vasos sangu√≠neos, piel y enc√≠as." },
    { topic: "Uniones Celulares", question: "¬øQu√© enfermedad autoinmune ataca a los desmosomas de la piel (p√©nfigo)?", options: ["Lupus.", "P√©nfigo vulgar (ampollas por p√©rdida de adhesi√≥n celular).", "Vit√≠ligo.", "Dermatitis."], correct: 1, explanation: "Los anticuerpos destruyen las cadherinas desmosomales, separando los queratinocitos." },
    { topic: "Integrinas", question: "¬øQu√© problema causa la deficiencia en integrinas en los leucocitos?", options: ["Incapacidad para adherirse al endotelio y migrar a los tejidos infectados (inmunodeficiencia).", "Anemia.", "Coagulaci√≥n excesiva.", "Alergias."], correct: 0, explanation: "Sin integrinas, los gl√≥bulos blancos no pueden 'frenar' y salir de la sangre para combatir infecciones." },

    // --- BLOQUE 7: Comunicaci√≥n y Muerte Celular ---
    { topic: "C√°ncer - Se√±alizaci√≥n", question: "Las mutaciones que activan permanentemente la prote√≠na Ras (siempre unida a GTP) causan:", options: ["Apoptosis.", "Proliferaci√≥n celular descontrolada (C√°ncer).", "Diferenciaci√≥n celular.", "Parada del ciclo celular."], correct: 1, explanation: "Ras es un oncog√©n clave; si no se apaga, env√≠a se√±ales continuas de divisi√≥n." },
    { topic: "C√°ncer - Supresores", question: "¬øPor qu√© se llama a p53 el 'guardi√°n del genoma'?", options: ["Porque repara el ADN.", "Porque detiene el ciclo celular o induce apoptosis si hay da√±o en el ADN, previniendo el c√°ncer.", "Porque acelera la mitosis.", "Porque protege los tel√≥meros."], correct: 1, explanation: "La p√©rdida de funci√≥n de p53 es la mutaci√≥n m√°s com√∫n en c√°nceres humanos, permitiendo la supervivencia de c√©lulas da√±adas." },
    { topic: "Apoptosis", question: "¬øQu√© enfermedad puede surgir si la apoptosis es excesiva?", options: ["C√°ncer.", "Enfermedades neurodegenerativas (ej. Alzheimer, Parkinson) o da√±o post-infarto.", "Hipertrofia muscular.", "Sindactilia."], correct: 1, explanation: "La muerte celular no deseada lleva a la p√©rdida de tejido funcional (neuronas, cardiomiocitos)." },
    { topic: "Apoptosis", question: "¬øQu√© enfermedad surge si la apoptosis es defectuosa o insuficiente?", options: ["Sida.", "Atrofia muscular.", "C√°ncer o enfermedades autoinmunes.", "Infarto."], correct: 2, explanation: "Si las c√©lulas da√±adas o autorreactivas no se suicidan, pueden formar tumores o atacar al propio cuerpo." },
    { topic: "Se√±alizaci√≥n", question: "¬øQu√© efecto tiene la mutaci√≥n que inactiva el gen de la Miostatina?", options: ["Atrofia muscular.", "Hipertrofia muscular masiva (crecimiento muscular excesivo).", "Obesidad.", "Enanismo."], correct: 1, explanation: "La miostatina frena el crecimiento muscular; sin ella, el m√∫sculo crece sin control (ej. vacas 'azul belga')." },
    { topic: "Necrosis", question: "¬øPor qu√© la necrosis es perjudicial para el organismo a diferencia de la apoptosis?", options: ["Porque gasta energ√≠a.", "Porque la c√©lula explota liberando contenido t√≥xico e induciendo inflamaci√≥n.", "Porque reduce el n√∫mero de c√©lulas.", "Porque es lenta."], correct: 1, explanation: "La rotura de la membrana en necrosis vierte enzimas que da√±an a las c√©lulas vecinas, causando inflamaci√≥n." },
    { topic: "Receptores de Muerte", question: "¬øC√≥mo elimina el sistema inmune a c√©lulas infectadas por virus?", options: ["Fagocit√°ndolas vivas.", "Activando receptores de muerte (Fas) en la c√©lula diana para inducir apoptosis.", "Bloqueando sus poros.", "Quit√°ndoles el ox√≠geno."], correct: 1, explanation: "Los linfocitos T 'ordenan' a la c√©lula infectada que se suicide mediante la v√≠a extr√≠nseca." },

    // --- BLOQUE 8: Ciclo Celular ---
    { topic: "C√°ncer - Ciclo", question: "¬øQu√© es un oncog√©n?", options: ["Un gen que detiene el ciclo.", "Una forma mutada de un gen normal (protooncog√©n) que estimula la divisi√≥n celular de forma excesiva.", "Un gen de reparaci√≥n.", "Un gen viral."], correct: 1, explanation: "Act√∫a como un 'acelerador atascado' del ciclo celular." },
    { topic: "C√°ncer - Rb", question: "¬øQu√© ocurre si la prote√≠na Retinoblastoma (Rb) pierde su funci√≥n?", options: ["La c√©lula no puede dividirse.", "El ciclo celular no se detiene en G1, permitiendo la proliferaci√≥n incontrolada (Retinoblastoma).", "La c√©lula entra en apoptosis.", "No pasa nada."], correct: 1, explanation: "Rb es un supresor tumoral que frena el ciclo; sin √©l, la c√©lula entra en fase S sin control." },
    { topic: "Telomerasa", question: "¬øQu√© papel juega la telomerasa en el c√°ncer?", options: ["Mata a las c√©lulas cancerosas.", "Se reactiva en c√©lulas tumorales, permitiendo que se dividan indefinidamente (inmortalidad).", "Acorta los tel√≥meros.", "Repara mutaciones."], correct: 1, explanation: "La reactivaci√≥n de la telomerasa evita el envejecimiento celular, permitiendo el crecimiento infinito del tumor." },
    { topic: "Aneuploid√≠a", question: "¬øQu√© fallo en el ciclo celular causa aneuploid√≠a (n√∫mero incorrecto de cromosomas)?", options: ["Fallo en el punto de control del huso mit√≥tico.", "Fallo en la replicaci√≥n.", "Fallo en G1.", "Fallo en la citocinesis."], correct: 0, explanation: "Si el checkpoint de metafase falla, los cromosomas se reparten desigualmente, rasgo t√≠pico de c√©lulas tumorales." },

    // --- BLOQUE 9: Reproducci√≥n y Gen√©tica M√©dica ---
    { topic: "Aneuploid√≠as", question: "¬øQu√© es la trisom√≠a 21 (S√≠ndrome de Down)?", options: ["Una enfermedad mitocondrial.", "Una aneuploid√≠a causada por la no disyunci√≥n de cromosomas durante la meiosis.", "Una infecci√≥n viral.", "Un defecto de splicing."], correct: 1, explanation: "Es la patolog√≠a cromos√≥mica m√°s com√∫n, resultado de un error en la segregaci√≥n mei√≥tica." },
    { topic: "Infertilidad", question: "¬øQu√© t√©cnica de reproducci√≥n asistida se usa para tratar la infertilidad masculina severa (pocos espermatozoides)?", options: ["Inseminaci√≥n artificial.", "ICSI (Inyecci√≥n Intracitoplasm√°tica de Espermatozoides).", "Clonaci√≥n.", "Terapia hormonal."], correct: 1, explanation: "Permite fecundar el √≥vulo inyectando un √∫nico espermatozoide directamente, puenteando problemas de movilidad o n√∫mero." },
    { topic: "Enfermedades Mitocondriales", question: "¬øC√≥mo se heredan las enfermedades causadas por mutaciones en el ADN mitocondrial?", options: ["Herencia mendeliana recesiva.", "Herencia exclusivamente materna.", "Herencia paterna.", "Herencia ligada al sexo."], correct: 1, explanation: "Las mitocondrias del cigoto provienen del √≥vulo, por lo que las madres transmiten estas enfermedades a todos sus hijos." },
    { topic: "DGP", question: "¬øCu√°l es el objetivo m√©dico del Diagn√≥stico Gen√©tico Preimplantacional (DGP)?", options: ["Clonar humanos.", "Seleccionar embriones libres de enfermedades gen√©ticas graves antes de transferirlos al √∫tero.", "Modificar el ADN del embri√≥n.", "Elegir el color de ojos."], correct: 1, explanation: "Evita la transmisi√≥n de enfermedades hereditarias (como SMA o Huntington) en familias de riesgo." },
    { topic: "Edad Materna", question: "¬øQu√© riesgo aumenta significativamente con la edad materna avanzada?", options: ["Gemelaridad dicig√≥tica y aneuploid√≠as (debido al largo arresto mei√≥tico).", "Infecciones.", "Mutaciones mitocondriales.", "C√°ncer de √∫tero."], correct: 0, explanation: "Los ovocitos 'viejos' tienen m√°s errores de segregaci√≥n tras d√©cadas detenidos en profase I." },
    { topic: "Clonaci√≥n Terap√©utica", question: "¬øCu√°l es el fin de la clonaci√≥n terap√©utica (Transferencia Nuclear)?", options: ["Crear copias de personas.", "Obtener c√©lulas madre compatibles con el paciente para tratar enfermedades (medicina regenerativa).", "Mejorar la raza.", "Producir f√°rmacos."], correct: 1, explanation: "Busca generar tejidos de repuesto que no sean rechazados por el sistema inmune del paciente." },
    { topic: "Patolog√≠a Mei√≥tica", question: "¬øQu√© ocurre si hay un error en el 'Crossing Over'?", options: ["Nada.", "Puede causar deleciones, duplicaciones o translocaciones cromos√≥micas patol√≥gicas.", "La c√©lula se divide m√°s r√°pido.", "Se forman clones."], correct: 1, explanation: "Un intercambio desigual de ADN genera cromosomas defectuosos que causan s√≠ndromes gen√©ticos." },
    { topic: "Virus - Retrovirus", question: "Los retrovirus como el VIH son pat√≥genos persistentes porque:", options: ["Se integran en el genoma del hu√©sped (provirus) y permanecen latentes.", "Son muy grandes.", "Tienen ADN circular.", "No usan prote√≠nas."], correct: 0, explanation: "La integraci√≥n en el ADN celular hace que la infecci√≥n sea cr√≥nica e incurable por m√©todos est√°ndar." },
    { topic: "Lisosomas", question: "¬øQu√© grupo de enfermedades se debe a defectos en las enzimas de los lisosomas?", options: ["Enfermedades de almacenamiento lisosomal (ej. Tay-Sachs).", "Diabetes.", "Gripe.", "Raquitismo."], correct: 0, explanation: "Si el lisosoma no puede digerir, se acumulan desechos en la c√©lula causando toxicidad y muerte celular." },
    { topic: "C√°ncer - General", question: "Desde el punto de vista celular, el c√°ncer se define como:", options: ["Una infecci√≥n.", "Una enfermedad de proliferaci√≥n celular incontrolada e invasiva.", "Una muerte celular excesiva.", "Un fallo mitocondrial."], correct: 1, explanation: "Es la p√©rdida de la homeostasis entre divisi√≥n y muerte celular, rompiendo las reglas sociales del tejido." },
    { topic: "Priones", question: "¬øQu√© son las enfermedades pri√≥nicas (como las vacas locas)? (Concepto de plegamiento)", options: ["Virus.", "Enfermedades causadas por prote√≠nas mal plegadas que inducen el mal plegamiento en otras.", "Bacterias.", "Hongos."], correct: 1, explanation: "Relacionado con el control de calidad de prote√≠nas (chaperonas/proteasoma), donde una forma t√≥xica propaga la enfermedad." },
    { topic: "Epigen√©tica y Salud", question: "¬øPueden los factores ambientales (dieta, estr√©s) causar enfermedades alterando el epigenoma?", options: ["No, solo cambian el ADN.", "S√≠, modificando patrones de metilaci√≥n/histonas que afectan la expresi√≥n g√©nica a largo plazo.", "Solo en el embarazo.", "Es un mito."], correct: 1, explanation: "Es la base de muchas enfermedades complejas donde el ambiente 'enciende' o 'apaga' genes de riesgo." },
    { topic: "Terapia", question: "¬øQu√© ventaja tienen las c√©lulas iPS (inducidas) para tratar enfermedades?", options: ["Son m√°s baratas.", "Son aut√≥logas (del propio paciente), evitando el rechazo inmune.", "Vienen de embriones.", "Son artificiales."], correct: 1, explanation: "Permiten medicina personalizada y regenerativa sin los problemas √©ticos o de rechazo de las embrionarias." },
    { topic: "Resumen", question: "¬øPor qu√© 'La Medicina comienza en la C√©lula'?", options: ["Es un eslogan publicitario.", "Porque toda patolog√≠a tiene su origen en la disfunci√≥n de los mecanismos moleculares y celulares.", "Porque las c√©lulas son peque√±as.", "No es cierto."], correct: 1, explanation: "Entender la c√©lula es el √∫nico camino para entender la causa ra√≠z de la enfermedad y dise√±ar curas racionales." }
];

// --- GESTI√ìN DE ESTADO Y LISTAS DE REPRODUCCI√ìN ---
quizData.forEach(q => {
    q.isMarked = false;
    q.userCorrect = null; // null: sin responder, true: acierto, false: fallo
});

let activeIndices = []; 
let currentPlaylistIndex = 0;
let sessionScore = 0;
let answered = false;

document.addEventListener('DOMContentLoaded', () => {
    startQuiz('all');
});

function startQuiz(mode) {
    activeIndices = [];

    // L√≥gica para crear la "lista de reproducci√≥n" seg√∫n el modo
    if (mode === 'all') {
        quizData.forEach(q => q.userCorrect = null); // Resetear respuestas
        // Opcional: resetear marcas con quizData.forEach(q => q.isMarked = false);
        activeIndices = quizData.map((_, i) => i);
    } 
    else if (mode === 'failed') {
        activeIndices = quizData.map((q, i) => q.userCorrect === false ? i : -1).filter(i => i !== -1);
    } 
    else if (mode === 'marked') {
        activeIndices = quizData.map((q, i) => q.isMarked ? i : -1).filter(i => i !== -1);
    } 
    else if (mode === 'mixed') {
        activeIndices = quizData.map((q, i) => (q.userCorrect === false || q.isMarked) ? i : -1).filter(i => i !== -1);
    }

    if (activeIndices.length === 0) {
        alert("No hay preguntas disponibles para este modo.");
        return;
    }

    currentPlaylistIndex = 0;
    sessionScore = 0;
    
    // UI Updates
    document.getElementById('results-screen').style.display = 'none';
    document.getElementById('quiz-container').style.display = 'block';
    document.getElementById('statusBar').style.display = 'flex';
    
    loadQuestion();
}

function loadQuestion() {
    answered = false;
    // Obtener el √≠ndice real en el array de datos
    const realIndex = activeIndices[currentPlaylistIndex];
    const q = quizData[realIndex];
    
    document.getElementById('q-progress').innerText = `Pregunta ${currentPlaylistIndex + 1} de ${activeIndices.length}`;
    document.getElementById('score-display').innerText = `Aciertos: ${sessionScore}`;

    const container = document.getElementById('quiz-container');
    const checkedAttr = q.isMarked ? 'checked' : '';

    let html = `
        <div class="question-card active">
            <label class="bookmark-panel">
                <input type="checkbox" onchange="toggleMark(${realIndex}, this)" ${checkedAttr}>
                <span>Marcar/Duda</span>
            </label>

            <div class="question-header">${q.topic}</div>
            <div class="question-text">${q.question}</div>
            <div class="options-list">
                ${q.options.map((opt, i) => `
                    <button class="option-btn" onclick="checkAnswer(${i}, ${q.correct}, this, ${realIndex})">
                        ${String.fromCharCode(65+i)}. ${opt}
                    </button>
                `).join('')}
            </div>
            <div class="feedback-area" id="feedback"></div>
            <button class="nav-btn" id="next-btn" onclick="nextQuestion()">Siguiente</button>
        </div>
    `;
    
    container.innerHTML = html;
}

function toggleMark(realIndex, checkbox) {
    quizData[realIndex].isMarked = checkbox.checked;
}

function checkAnswer(selected, correct, btn, realIndex) {
    if(answered) return;
    answered = true;

    const allBtns = document.querySelectorAll('.option-btn');
    const feedback = document.getElementById('feedback');
    const nextBtn = document.getElementById('next-btn');

    allBtns.forEach(b => b.disabled = true);

    if(selected === correct) {
        sessionScore++;
        quizData[realIndex].userCorrect = true; // Guardar acierto
        btn.classList.add('correct');
        feedback.innerHTML = `<strong style="color:var(--success)">¬°Correcto!</strong> <div class="rationale">${quizData[realIndex].explanation}</div>`;
    } else {
        quizData[realIndex].userCorrect = false; // Guardar fallo
        btn.classList.add('incorrect');
        allBtns[correct].classList.add('correct');
        feedback.innerHTML = `<strong style="color:var(--error)">Incorrecto.</strong> <div class="rationale">${quizData[realIndex].explanation}</div>`;
    }

    feedback.classList.add('show');
    nextBtn.style.display = 'block';
    document.getElementById('score-display').innerText = `Aciertos: ${sessionScore}`;
}

function nextQuestion() {
    if(currentPlaylistIndex < activeIndices.length - 1) {
        currentPlaylistIndex++;
        loadQuestion();
    } else {
        showResults();
    }
}

function showResults() {
    document.getElementById('statusBar').style.display = 'none';
    document.getElementById('quiz-container').style.display = 'none';
    document.getElementById('results-screen').style.display = 'block';
    
    document.getElementById('final-number').innerText = `${sessionScore} / ${activeIndices.length}`;
    
    const percent = Math.round((sessionScore / activeIndices.length) * 100);
    let msg = "";
    if(percent >= 90) msg = "¬°Excelente!";
    else if(percent >= 70) msg = "¬°Muy bien!";
    else if(percent >= 50) msg = "Aprobado.";
    else msg = "Necesitas repasar.";
    
    document.getElementById('final-text').innerText = `${percent}% - ${msg}`;

    // Calcular estad√≠sticas para habilitar botones
    const totalFailed = quizData.filter(q => q.userCorrect === false).length;
    const totalMarked = quizData.filter(q => q.isMarked === true).length;
    const totalMixed = quizData.filter(q => q.userCorrect === false || q.isMarked).length;

    document.getElementById('stats-box').innerHTML = `
        <strong>Resumen Global:</strong><br>
        Marcadas: ${totalMarked} | Falladas: ${totalFailed}
    `;

    // Habilitar/Deshabilitar botones seg√∫n si hay preguntas
    document.getElementById('btn-failed').disabled = (totalFailed === 0);
    document.getElementById('btn-marked').disabled = (totalMarked === 0);
    document.getElementById('btn-mixed').disabled = (totalMixed === 0);
    
    document.getElementById('btn-failed').innerText = `‚ùå Repetir Falladas (${totalFailed})`;
    document.getElementById('btn-marked').innerText = `‚ö†Ô∏è Repetir Marcadas (${totalMarked})`;
}
</script>

</body>
</html>
