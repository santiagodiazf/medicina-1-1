<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Bloque III: Biomol√©culas</title>
    <style>
        :root {
            --primary: #d97706; /* √Åmbar/Naranja Molecular */
            --primary-dark: #b45309;
            --primary-light: #fef3c7;
            --bg: #fffbeb;
            --text: #1f2937;
            --white: #ffffff;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg);
            color: var(--text);
            max-width: 850px;
            margin: 0 auto;
            padding: 20px;
        }

        h1 {
            text-align: center;
            color: var(--primary-dark);
            margin-bottom: 10px;
            border-bottom: 3px solid var(--primary);
            padding-bottom: 15px;
            display: inline-block;
            width: 100%;
        }

        .question-card {
            background: var(--white);
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            border-left: 6px solid var(--primary);
            transition: transform 0.2s, box-shadow 0.2s;
            position: relative;
        }

        .question-card:hover {
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        }

        /* --- Checkbox para Marcar --- */
        .mark-container {
            display: flex;
            align-items: center;
            justify-content: flex-end;
            margin-bottom: 15px;
            font-size: 0.9em;
            color: var(--primary);
            font-weight: bold;
            border-bottom: 1px solid #fde68a;
            padding-bottom: 10px;
        }
        .mark-container input {
            margin-right: 8px;
            transform: scale(1.3);
            cursor: pointer;
            accent-color: var(--primary);
        }
        .mark-container label {
            cursor: pointer;
        }

        .question-header {
            font-size: 0.85em;
            color: #d97706;
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 1px;
            font-weight: bold;
        }

        .question-text {
            font-weight: 700;
            font-size: 1.15em;
            margin-bottom: 20px;
            color: #111827;
            line-height: 1.5;
        }

        /* Etiquetas para diagramas */
        .img-tag {
            display: block;
            margin-top: 12px;
            padding: 10px;
            background-color: #fff7ed;
            border-left: 4px solid #fdba74;
            color: #9a3412;
            font-size: 0.9em;
            font-style: italic;
            border-radius: 0 4px 4px 0;
        }

        .options-container {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .option-btn {
            padding: 14px 18px;
            border: 2px solid #e5e7eb;
            background: #fff;
            border-radius: 8px;
            cursor: pointer;
            text-align: left;
            transition: all 0.2s;
            font-size: 1em;
            color: #374151;
            position: relative;
        }

        .option-btn:hover:not(:disabled) {
            background-color: var(--primary-light);
            border-color: var(--primary);
            color: var(--primary-dark);
            padding-left: 25px; /* Efecto desplazamiento */
        }

        .option-btn:disabled {
            cursor: default;
            opacity: 0.7;
        }

        /* Estados de respuesta */
        .correct {
            background-color: #d1fae5 !important;
            border-color: #059669 !important;
            color: #064e3b !important;
            font-weight: 600;
        }

        .incorrect {
            background-color: #fee2e2 !important;
            border-color: #ef4444 !important;
            color: #7f1d1d !important;
        }

        /* Caja de Explicaci√≥n */
        .explanation {
            margin-top: 20px;
            padding: 15px;
            background-color: #fff7ed;
            border-left: 5px solid var(--primary);
            border-radius: 6px;
            display: none;
            font-size: 0.95em;
            color: #7c2d12;
            animation: slideDown 0.3s ease-out;
        }
        .explanation.visible {
            display: block;
        }
        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* --- √Årea de Controles --- */
        #controls-area {
            margin-top: 50px;
            text-align: center;
            padding: 30px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 -4px 20px rgba(0,0,0,0.05);
            border-top: 5px solid var(--primary);
        }

        .action-btn {
            background: var(--primary); color: white; border: none;
            padding: 12px 25px; font-size: 1.05em; border-radius: 8px;
            cursor: pointer; margin: 8px;
            transition: background 0.3s, transform 0.2s;
            font-weight: 600;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .action-btn:hover { 
            background: var(--primary-dark);
            transform: translateY(-2px);
        }
        
        .restart-options {
            display: none;
            flex-direction: column;
            gap: 12px;
            margin-top: 25px;
            max-width: 400px;
            margin-left: auto;
            margin-right: auto;
        }
        .restart-options button {
            width: 100%;
            background: #4b5563;
        }
        .restart-options button:hover { background: #1f2937; }
        .restart-options button:first-child { background: var(--primary); }

    </style>
</head>
<body>

    <h1>Bloque III: Biomol√©culas</h1>
    <div style="text-align: center; color: #4b5563; margin-bottom: 30px;">
        √Ålvaro Cond√≥n | Amino√°cidos, Prote√≠nas, Gl√∫cidos y L√≠pidos
    </div>
    
    <div id="quiz-container"></div>

    <div id="controls-area">
        <button id="finish-btn" class="action-btn" onclick="showEndOptions()">üèÅ Finalizar revisi√≥n</button>
        
        <div id="restart-menu" class="restart-options">
            <h3>Resultados de la sesi√≥n</h3>
            <p id="stats-summary"></p>
            <button class="action-btn" onclick="restartQuiz('all')">üîÑ Rehacer todo el test</button>
            <button class="action-btn" onclick="restartQuiz('marked')">üîñ Repasar marcadas</button>
            <button class="action-btn" onclick="restartQuiz('failed')">‚ùå Repasar falladas</button>
            <button class="action-btn" onclick="restartQuiz('failed_marked')">‚ö†Ô∏è Falladas + Marcadas</button>
        </div>
    </div>

<script>
    // Datos convertidos al formato est√°ndar
    const quizData = [
        { 
            q: "En relaci√≥n con la cadena lateral de un amino√°cido y su polaridad, ¬øqu√© es incorrecto?", 
            opts: ["Glutamato ‚Äì carboxilo ‚Äì polar", "Serina ‚Äì hidroxilo ‚Äì polar", "Ciste√≠na ‚Äì tiol ‚Äì polar", "Tirosina ‚Äì cadena alif√°tica ‚Äì apolar", "Lisina ‚Äì grupo amino Œµ ‚Äì polar"], 
            a: "Tirosina ‚Äì cadena alif√°tica ‚Äì apolar", 
            exp: "La tirosina NO es alif√°tica, es arom√°tica, y su grupo fenol (-OH) le confiere cierto car√°cter polar (aunque sea menos que otros)." 
        },
        { 
            q: "Qu√© asociaci√≥n es incorrecta respecto a la contribuci√≥n del amino√°cido a la funci√≥n/propiedad de la prote√≠na:", 
            opts: ["Serina ‚Äì ataque nucle√≥filo a los sustratos", "Glutamato ‚Äì car√°cter b√°sico a la prote√≠na", "Ciste√≠na ‚Äì formaci√≥n de puentes disulfuro", "Tirosina ‚Äì sitio fosforilable de la prote√≠na", "Lisina ‚Äì uni√≥n por enlace √©ster-amida de grupos prost√©ticos"], 
            a: "Glutamato ‚Äì car√°cter b√°sico a la prote√≠na", 
            exp: "El glutamato (√°cido glut√°mico) es un amino√°cido √°cido (carga negativa), no b√°sico." 
        },
        { 
            q: "Respecto a los siguientes gl√∫cidos, ¬øcu√°l de estas afirmaciones es incorrecta?", 
            opts: ["Sedoheptulosa: cetosa de 7 carbonos", "Œ±-glicerofosfato: monosac√°rido de 3 carbonos", "Lactosa: galactosa‚Äìglucosa (Œ≤ 1-4)", "Heparina: mucopolisac√°rido", "Almid√≥n: pol√≠mero de glucosa Œ± 1-4 con ramificaciones Œ± 1-6"], 
            a: "Œ±-glicerofosfato: monosac√°rido de 3 carbonos", 
            exp: "El Œ±-glicerofosfato no es un az√∫car puro, es un derivado fosforilado de un polialcohol (glicerol)." 
        },
        { 
            q: "Respecto a los siguientes gl√∫cidos, ¬øcu√°l de estas afirmaciones es incorrecta?", 
            opts: ["Xilulosa: cetosa de 5 carbonos", "Gliceraldeh√≠do: aldosa de 3 carbonos", "Lactosa: galactosa‚Äìglucosa (Œ≤ 1-4)", "√Åcido hialur√≥nico: monosac√°rido de 9 carbonos modificado", "Heparina: mucopolisac√°rido"], 
            a: "√Åcido hialur√≥nico: monosac√°rido de 9 carbonos modificado", 
            exp: "El √°cido hialur√≥nico es un glicosaminoglicano (polisac√°rido) de alto peso molecular, NO un monosac√°rido." 
        },
        { 
            q: "Cu√°l de estas asociaciones es incorrecta entre sustancias y sus componentes:", 
            opts: ["Lecitina: derivada del √°cido fosfat√≠dico", "Esfingomielina: contiene ceramida", "Triglic√©rido: formado a partir de gliceraldeh√≠do", "Colesterol esterificado: contiene un √°cido graso en posici√≥n 3", "Cerebr√≥sido: contiene glucosa u otros az√∫cares sencillos"], 
            a: "Triglic√©rido: formado a partir de gliceraldeh√≠do", 
            exp: "El triglic√©rido se forma por esterificaci√≥n de tres √°cidos grasos con glicerol, no con gliceraldeh√≠do." 
        },
        { 
            q: "Cu√°l es la composici√≥n del fosfol√≠pido esfingomielina:", 
            opts: ["Ceramida + fosfato + colina", "Glicerol + 2 √°cidos grasos + fosfato + colina", "√Åcido fosfat√≠dico + fosfato + colina", "Esfingosina + fosfato + colina", "Esfingosina + √°cido graso + fosfato + glucosa"], 
            a: "Ceramida + fosfato + colina", 
            exp: "Es una ceramida (esfingosina + √°cido graso) unida a un grupo fosfocolina." 
        },
        { 
            q: "Cu√°l de estas afirmaciones NO es correcta respecto al transporte a trav√©s de membranas biol√≥gicas:", 
            opts: ["La ATPasa Na+/K+ bombea Na+ contra gradiente hacia el exterior celular", "AE-1 realiza un antiporte Cl-/HCO3- en la membrana del hemat√≠e", "El IP3 puede activar canales de Ca2+ del ret√≠culo endopl√°smico", "GLUT4 transporta glucosa contra gradiente en h√≠gado y cerebro", "SGLT realiza un simporte glucosa‚ÄìNa+ en la membrana luminal del enterocito"], 
            a: "GLUT4 transporta glucosa contra gradiente en h√≠gado y cerebro", 
            exp: "GLUT4 realiza transporte pasivo (difusi√≥n facilitada) a favor de gradiente y se encuentra en m√∫sculo/adiposo, no en h√≠gado/cerebro." 
        },
        { 
            q: "Con respecto a las prote√≠nas, ¬øcu√°l de las siguientes afirmaciones NO es cierta?", 
            opts: ["Est√°n constituidas por combinaciones de 20 Œ±-amino√°cidos", "Todos los amino√°cidos son enanti√≥meros D", "Todos los amino√°cidos de prote√≠nas son de la serie L", "El enlace pept√≠dico es un enlace covalente", "Los p√©ptidos tienen un extremo amino-terminal y otro carboxilo-terminal"], 
            a: "Todos los amino√°cidos son enanti√≥meros D", 
            exp: "Los amino√°cidos presentes en las prote√≠nas son estereois√≥meros L." 
        },
        { 
            q: "En la estructura proteica:", 
            opts: ["En las h√©lices los puentes de hidr√≥geno son casi paralelos al eje", "En la h√©lice las cadenas laterales se sit√∫an hacia el exterior", "En la l√°mina Œ≤ los puentes de hidr√≥geno son aproximadamente perpendiculares a las cadenas", "En la l√°mina Œ≤ paralela un residuo puede contactar con dos de la cadena vecina", "Todas las afirmaciones anteriores son ciertas"], 
            a: "Todas las afirmaciones anteriores son ciertas", 
            exp: "Resumen correcto de las caracter√≠sticas de la estructura secundaria (H√©lice alfa y Hoja beta)." 
        },
        { 
            q: "Los fosfoglic√©ridos:", 
            opts: ["Derivan del √°cido fosfat√≠dico", "El carbono 2 del glicerol suele estar esterificado por un √°cido graso saturado", "El carbono 2 del glicerol suele estar esterificado por un √°cido graso insaturado", "Derivan del √°cido fosfat√≠dico y el C2 suele llevar un √°cido graso insaturado", "Ninguna de las afirmaciones es cierta"], 
            a: "Derivan del √°cido fosfat√≠dico y el C2 suele llevar un √°cido graso insaturado", 
            exp: "Generalmente, el C1 tiene un √°cido graso saturado y el C2 uno insaturado." 
        },
        { 
            q: "Un √°cido graso 16:4 œâ3:", 
            opts: ["Tiene 4 dobles enlaces", "Tiene 3 dobles enlaces", "Tiene 16 carbonos", "Es saturado", "Tiene 4 dobles enlaces y 16 carbonos"], 
            a: "Tiene 4 dobles enlaces y 16 carbonos", 
            exp: "La nomenclatura C:D indica Carbonos:DoblesEnlaces. 16:4 = 16 carbonos y 4 insaturaciones." 
        },
        { 
            q: "En el enlace glucos√≠dico:", 
            opts: ["Siempre intervienen dos carbonos anom√©ricos", "Nunca intervienen carbonos anom√©ricos", "Interviene al menos un carbono anom√©rico", "Se forma entre dos grupos hidroxilo", "Ninguna afirmaci√≥n es cierta"], 
            a: "Interviene al menos un carbono anom√©rico", 
            exp: "El enlace se forma entre el grupo -OH del carbono anom√©rico de un az√∫car y cualquier grupo -OH del otro." 
        },
        { 
            q: "Se√±alar cu√°l de las siguientes afirmaciones referentes a las glucoprote√≠nas NO es cierta:", 
            opts: ["La uni√≥n entre los sac√°ridos y las prote√≠nas no es covalente", "El enlace O-glucos√≠dico se establece con Ser o Thr", "El enlace N-glucos√≠dico se establece con Asn", "El enlace O-glucos√≠dico suele implicar N-acetilgalactosamina", "El enlace N-glucos√≠dico suele implicar N-acetilglucosamina"], 
            a: "La uni√≥n entre los sac√°ridos y las prote√≠nas no es covalente", 
            exp: "Falso. La uni√≥n entre la parte gluc√≠dica y proteica es siempre COVALENTE." 
        },
        { 
            q: "El fosfatidilinositol est√° compuesto por:", 
            opts: ["Ceramida + fosfato + colina", "√Åcido fosfat√≠dico + fosfato + inositol", "Glicerol + dos √°cidos grasos + fosfato + inositol", "Esfingosina + fosfato + inositol", "Esfingosina + √°cido graso + fosfato + glucosa"], 
            a: "Glicerol + dos √°cidos grasos + fosfato + inositol", 
            exp: "Es un glicerofosfol√≠pido cl√°sico." 
        },
        { 
            q: "Respecto a los siguientes gl√∫cidos, ¬øcu√°l de estas afirmaciones es incorrecta? (Repetida)", 
            opts: ["Eritrosa: aldosa de 4 carbonos", "Gliceraldeh√≠do: aldosa de 3 carbonos", "√Åcido si√°lico: monosac√°rido de 9 carbonos modificado", "Maltosa: glucosa‚Äìglucosa (Œ± 1-4)", "√Åcido glucur√≥nico: mucopolisac√°rido"], 
            a: "√Åcido glucur√≥nico: mucopolisac√°rido", 
            exp: "El √°cido glucur√≥nico es un monosac√°rido derivado (√°cido ur√≥nico), no un polisac√°rido." 
        },
        { 
            q: "Cu√°l de estos mecanismos de transporte es un transporte activo secundario:", 
            opts: ["SGLT: simporte glucosa‚ÄìNa+ en el enterocito", "GLUT4: difusi√≥n de glucosa al interior celular", "ATPasa Na+/K+: bomba primaria de Na+ hacia el exterior", "AE-1: antiporte Cl-/HCO3-", "IP3: activaci√≥n de canales de Ca2+ del ret√≠culo"], 
            a: "SGLT: simporte glucosa‚ÄìNa+ en el enterocito", 
            exp: "Aprovecha el gradiente de Na+ creado por la ATPasa (transporte primario) para mover glucosa." 
        },
        { 
            q: "Cu√°l de los siguientes compuestos es un alcohol graso:", 
            opts: ["√Åcido linoleico", "Esfingosina", "Ceramida", "√Åcido fosfat√≠dico"], 
            a: "Esfingosina", 
            exp: "La esfingosina es un aminoalcohol de cadena larga (alcohol graso)." 
        },
        { 
            q: "Qu√© asociaci√≥n es incorrecta respecto a la contribuci√≥n del amino√°cido a la funci√≥n de la prote√≠na (Repetida):", 
            opts: ["Histidina ‚Äì uni√≥n de grupos prost√©ticos por enlace pept√≠dico", "Glutamato ‚Äì car√°cter √°cido de la prote√≠na", "Treonina ‚Äì sitio fosforilable", "Ciste√≠na ‚Äì formaci√≥n de puentes disulfuro"], 
            a: "Histidina ‚Äì uni√≥n de grupos prost√©ticos por enlace pept√≠dico", 
            exp: "La histidina coordina grupos prost√©ticos (como el hemo) mediante interacciones no covalentes o de coordinaci√≥n, no creando nuevos enlaces pept√≠dicos." 
        },
        { 
            q: "La absorci√≥n de glucosa a trav√©s de la membrana luminal del epitelio intestinal es:", 
            opts: ["A favor de gradiente", "En antiporte con Na+", "Con el transportador GLUT2", "Mediante transporte activo secundario dependiente de Na+"], 
            a: "Mediante transporte activo secundario dependiente de Na+", 
            exp: "A trav√©s del cotransportador SGLT1." 
        },
        { 
            q: "Respecto a los siguientes gl√∫cidos, la afirmaci√≥n incorrecta es (Variaci√≥n):", 
            opts: ["Maltosa: glucosa‚Äìglucosa (Œ± 1-4)", "√Åcido glucur√≥nico: mucopolisac√°rido", "Gliceraldeh√≠do: aldosa de 3 carbonos", "Eritrosa: aldosa de 4 carbonos"], 
            a: "√Åcido glucur√≥nico: mucopolisac√°rido", 
            exp: "Reiteraci√≥n: El √°cido glucur√≥nico es un monosac√°rido √°cido, no un mucopolisac√°rido." 
        },
        { 
            q: "Qu√© asociaci√≥n es incorrecta respecto a la contribuci√≥n del amino√°cido a la funci√≥n de la prote√≠na (Repetida 2):", 
            opts: ["Lisina ‚Äì ataque nucle√≥filo al sustrato", "Aspartato ‚Äì car√°cter √°cido de la prote√≠na", "Serina ‚Äì sitio fosforilable", "Ciste√≠na ‚Äì formaci√≥n de puentes disulfuro", "Histidina ‚Äì cesi√≥n/captaci√≥n de protones"], 
            a: "Lisina ‚Äì ataque nucle√≥filo al sustrato", 
            exp: "La lisina suele participar en enlaces i√≥nicos o estabilizaci√≥n; el ataque nucle√≥filo es m√°s t√≠pico de Ser, Cys o His." 
        },
        { 
            q: "En funci√≥n de su complejidad, la mol√©cula de piruvato puede clasificarse como:", 
            opts: ["Un precursor estructural", "Una unidad estructural b√°sica", "Una macromol√©cula", "Una supramol√©cula", "Un intermediario metab√≥lico"], 
            a: "Un intermediario metab√≥lico", 
            exp: "Es un compuesto central en el metabolismo intermediario (cruce de caminos)." 
        },
        { 
            q: "Los amino√°cidos:", 
            opts: ["Son todos dextr√≥giros", "Su carga neta es independiente del pH", "En el punto isoel√©ctrico la carga neta es cero", "A pH √°cido su carga es negativa", "A y B son ciertas"], 
            a: "En el punto isoel√©ctrico la carga neta es cero", 
            exp: "Definici√≥n de punto isoel√©ctrico." 
        },
        { 
            q: "Leucina, tirosina y fenilalanina son amino√°cidos:", 
            opts: ["Todos arom√°ticos", "Leucina y tirosina tienen cadena lateral alif√°tica", "Tirosina y fenilalanina son arom√°ticos", "Fenilalanina tiene cadena lateral alif√°tica", "La leucina contiene azufre en su cadena lateral"], 
            a: "Tirosina y fenilalanina son arom√°ticos", 
            exp: "La leucina es alif√°tica (ramificada); Tyr y Phe tienen anillos arom√°ticos." 
        },
        { 
            q: "En la alfa-h√©lice, los puentes de hidr√≥geno intracatenarios se establecen entre:", 
            opts: ["Un CO en posici√≥n i y un NH en posici√≥n i+2", "Un COO- en posici√≥n i y un NH3+ en posici√≥n i+2", "Un COO- en posici√≥n i y un NH3+ en posici√≥n i+4", "El amino-terminal y el carboxilo-terminal", "Un CO en posici√≥n i y un NH en posici√≥n i+4"], 
            a: "Un CO en posici√≥n i y un NH en posici√≥n i+4", 
            exp: "Patr√≥n caracter√≠stico de puentes de H en la h√©lice alfa." 
        },
        { 
            q: "Como resultado del efecto hidr√≥fobo:", 
            opts: ["Las prote√≠nas se pliegan necesariamente en forma de h√©lice Œ±", "Se adquiere una estructura globular con residuos apolares hacia el interior", "Los residuos polares se disponen hacia el interior", "Desaparecen las l√°minas Œ≤", "Desaparecen los puentes de hidr√≥geno intracatenarios"], 
            a: "Se adquiere una estructura globular con residuos apolares hacia el interior", 
            exp: "Es la fuerza impulsora principal del plegamiento globular en medio acuoso." 
        },
        { 
            q: "En los monosac√°ridos, ¬øcu√°l es el carbono anom√©rico?", 
            opts: ["El C2 en las aldosas", "El carbono que porta el OH en posici√≥n 6", "El C1 en las cetosas", "El carbono que contiene la funci√≥n aldeh√≠do o ceto", "El carbono del extremo no reductor"], 
            a: "El carbono que contiene la funci√≥n aldeh√≠do o ceto", 
            exp: "Es el carbono carbon√≠lico que se convierte en un nuevo centro quiral al ciclarse." 
        },
        { 
            q: "Cu√°l de los siguientes disac√°ridos est√° formado por dos mol√©culas de glucosa con uni√≥n 1-4-Œ± glucos√≠dica:", 
            opts: ["Sacarosa", "Lactosa", "Trealosa", "Maltosa", "Celobiosa"], 
            a: "Maltosa", 
            exp: "Maltosa = Glc(alpha1->4)Glc." 
        },
        { 
            q: "La serie linol√©nica se caracteriza por:", 
            opts: ["No presentar insaturaciones", "Derivar del √°cido linoleico", "Presentar solo dos dobles enlaces", "Ser √°cidos grasos de cadena muy corta", "Presentar un doble enlace en posici√≥n œâ-3"], 
            a: "Presentar un doble enlace en posici√≥n œâ-3", 
            exp: "El √°cido alfa-linol√©nico es el precursor de la serie omega-3." 
        },
        { 
            q: "Los glicol√≠pidos:", 
            opts: ["Derivan de la esfingosina", "El grupo amino de la esfingosina est√° acilado por un √°cido graso", "Al OH primario de la esfingosina se unen uno o m√°s az√∫cares", "Los glicol√≠pidos m√°s simples son los cerebr√≥sidos", "Todas las afirmaciones anteriores son ciertas"], 
            a: "Todas las afirmaciones anteriores son ciertas", 
            exp: "Descripci√≥n completa y correcta de la estructura de los glicol√≠pidos." 
        },
        { 
            q: "Cu√°l de estos componentes lip√≠dicos es el m√°s abundante en las membranas biol√≥gicas:", 
            opts: ["Fosfatidilcolina", "Fosfatidilserina", "Fosfatidilinositol", "√Åcido fosfat√≠dico", "Colesterol"], 
            a: "Fosfatidilcolina", 
            exp: "Es el fosfol√≠pido mayoritario en la capa externa de la mayor√≠a de c√©lulas animales." 
        },
        { 
            q: "Las insaturaciones en los √°cidos grasos de nuestro organismo:", 
            opts: ["Siempre est√°n separadas por un solo carbono saturado", "Presentan isomer√≠a cis", "Se sit√∫an m√°s all√° de la posici√≥n 9 en todos los casos", "Aparecen de forma espont√°nea sin enzimas", "No existen √°cidos grasos insaturados en el organismo"], 
            a: "Presentan isomer√≠a cis", 
            exp: "Los dobles enlaces naturales son casi siempre CIS, lo que produce acodamientos en la cadena." 
        },
        { 
            q: "Los eicosanoides:", 
            opts: ["Son fosfol√≠pidos de membrana", "Derivan de √°cidos grasos saturados", "Derivan del √°cido araquid√≥nico", "Son sustancias patol√≥gicas que no aparecen en condiciones normales", "Su principal funci√≥n es producir energ√≠a"], 
            a: "Derivan del √°cido araquid√≥nico", 
            exp: "Prostaglandinas, tromboxanos y leucotrienos derivan de √°cidos grasos poliinsaturados de 20 carbonos (araquid√≥nico)." 
        },
        { 
            q: "Cu√°l de estas prote√≠nas de membrana se relaciona con un mecanismo de antiporte por difusi√≥n facilitada:", 
            opts: ["GLUT4", "AE-1", "SGLT", "Bomba Na+/K+-ATPasa", "Un receptor acoplado a prote√≠na G (GPCR)"], 
            a: "AE-1", 
            exp: "Intercambiador ani√≥nico 1 (Banda 3): Cl- entra, HCO3- sale (o viceversa)." 
        },
        { 
            q: "Cu√°l de estas mol√©culas NO es un proteoglicano:", 
            opts: ["Condroit√≠n sulfato", "Dermat√°n sulfato", "Querat√°n sulfato", "Sulf√°tidos", "√Åcido hialur√≥nico"], 
            a: "Sulf√°tidos", 
            exp: "Los sulf√°tidos son esfingol√≠pidos (galactocerebr√≥sido sulfatado), no glicosaminoglicanos/proteoglicanos." 
        },
        { 
            q: "Qu√© es el √°cido si√°lico:", 
            opts: ["Un gangli√≥sido completo", "Un monosac√°rido modificado", "Un glicerofosfol√≠pido", "Un proteoglicano", "Una glucoprote√≠na"], 
            a: "Un monosac√°rido modificado", 
            exp: "Es un derivado de 9 carbonos (√°cido N-acetilneuram√≠nico)." 
        },
        { 
            q: "Tirosina, histidina y ciste√≠na:", 
            opts: ["La tirosina es un amino√°cido arom√°tico", "La ciste√≠na contiene azufre en su cadena lateral", "La histidina es un amino√°cido b√°sico", "La ciste√≠na puede formar puentes disulfuro", "Todas las afirmaciones anteriores son ciertas"], 
            a: "Todas las afirmaciones anteriores son ciertas", 
            exp: "Todas son caracter√≠sticas correctas de estos amino√°cidos." 
        },
        { 
            q: "Con respecto a la estructura proteica, se√±alar cu√°l de las siguientes afirmaciones NO es cierta:", 
            opts: ["En las h√©lices los enlaces de hidr√≥geno son perpendiculares al eje de enrollamiento", "En la l√°mina Œ≤ las cadenas laterales se sit√∫an por encima y por debajo del plano", "En las h√©lices los enlaces de hidr√≥geno son paralelos al eje de enrollamiento", "El enlace de hidr√≥geno se establece entre el H del amino y el O del carbonilo", "En las h√©lices las cadenas laterales se disponen al exterior"], 
            a: "En las h√©lices los enlaces de hidr√≥geno son perpendiculares al eje de enrollamiento", 
            exp: "Incorrecto. En la h√©lice alfa, los puentes de H son PARALELOS al eje longitudinal de la h√©lice." 
        },
        { 
            q: "En las prote√≠nas globulares:", 
            opts: ["Los residuos hidr√≥fobos se sit√∫an en el interior", "La estructura es siempre en h√©lice", "El plegado incluye interacciones entre cargas", "Las dos afirmaciones anteriores (hidr√≥fobos internos e interacciones de carga) son ciertas", "El plegado es independiente de la secuencia"], 
            a: "Las dos afirmaciones anteriores (hidr√≥fobos internos e interacciones de carga) son ciertas", 
            exp: "Combina el efecto hidr√≥fobo y las interacciones electrost√°ticas." 
        },
        { 
            q: "La degradaci√≥n de Edman se emplea:", 
            opts: ["Para analizar la estructura secundaria de las prote√≠nas", "Para analizar la secuencia de amino√°cidos de un p√©ptido", "Para separar secuencialmente el residuo del extremo amino-terminal", "Puede realizarse varias veces sobre el mismo p√©ptido", "Incluye las tres afirmaciones anteriores sobre la secuencia"], 
            a: "Incluye las tres afirmaciones anteriores sobre la secuencia", 
            exp: "Es el m√©todo cl√°sico de secuenciaci√≥n desde el extremo N-terminal." 
        },
        { 
            q: "Los disac√°ridos:", 
            opts: ["Son todos reductores", "Si intervienen dos carbonos anom√©ricos pueden no ser reductores", "La lactosa se forma por uni√≥n de galactosa y glucosa", "La sacarosa es un disac√°rido reductor", "Las dos afirmaciones anteriores sobre el car√°cter reductor y la lactosa son correctas"], 
            a: "Las dos afirmaciones anteriores sobre el car√°cter reductor y la lactosa son correctas", 
            exp: "Si ambos carbonos anom√©ricos forman el enlace, no hay extremo libre para reducir. La lactosa es Gal+Glc." 
        },
        { 
            q: "En las glucoprote√≠nas, los enlaces entre prote√≠nas y sac√°ridos:", 
            opts: ["Son siempre enlaces N-glucos√≠dicos", "Son siempre enlaces O-glucos√≠dicos", "Los carbohidratos se unen a las prote√≠nas a trav√©s de Asn o de Ser/Thr", "Pueden ser enlaces N- u O-glucos√≠dicos", "Las dos afirmaciones anteriores (uni√≥n por Asn o por Ser/Thr y enlaces N u O) son correctas"], 
            a: "Las dos afirmaciones anteriores (uni√≥n por Asn o por Ser/Thr y enlaces N u O) son correctas", 
            exp: "Existen ambos tipos de glicosilaci√≥n." 
        },
        { 
            q: "Cu√°l de los siguientes √°cidos grasos corresponde a la serie araquid√≥nica:", 
            opts: ["18:1 Œî9", "18:2 Œî9,12", "18:3 Œî9,12,15", "20:4 Œî5,8,11,14", "Ninguna de las anteriores"], 
            a: "20:4 Œî5,8,11,14", 
            exp: "√Åcido araquid√≥nico = 20 carbonos, 4 dobles enlaces." 
        },
        { 
            q: "Los glicerofosfol√≠pidos:", 
            opts: ["Son derivados del √°cido fosfat√≠dico", "Contienen dos √°cidos grasos", "Contienen un alcohol en el grupo polar", "Fosfatidilcolina y fosfatidiletanolamina son glicerofosfol√≠pidos", "Todas las afirmaciones anteriores son ciertas"], 
            a: "Todas las afirmaciones anteriores son ciertas", 
            exp: "Definici√≥n completa." 
        },
        { 
            q: "Los glucol√≠pidos y esfingol√≠pidos:", 
            opts: ["Contienen ambos esfingosina", "Los esfingol√≠pidos suelen tener √°cidos grasos muy largos", "Los cerebr√≥sidos incluyen un monosac√°rido unido a ceramida", "La colina no forma parte de la mayor√≠a de esfingol√≠pidos (solo en esfingomielina)", "Las dos primeras afirmaciones son ciertas"], 
            a: "Las dos primeras afirmaciones son ciertas", 
            exp: "Comparten la base esfingoide y suelen tener √°cidos grasos de cadena larga." 
        },
        { 
            q: "En las prote√≠nas, la h√©lice Œ± y la hoja Œ≤-plegada son ejemplos de:", 
            opts: ["Estructura primaria", "Estructura secundaria", "Estructura terciaria", "Estructura cuaternaria"], 
            a: "Estructura secundaria", 
            exp: "Patrones de plegamiento local." 
        },
        { 
            q: "Indica qu√© afirmaci√≥n es correcta (Repetida):", 
            opts: ["La glicina es el √∫nico amino√°cido con carbono Œ± asim√©trico", "En un centro quiral las im√°genes especulares son superponibles", "El pKa del grupo carboxilo de un amino√°cido es invariable en cualquier entorno", "A mayor hidrofobicidad de un amino√°cido, m√°s tendencia a unirse a mol√©culas no polares"], 
            a: "A mayor hidrofobicidad de un amino√°cido, m√°s tendencia a unirse a mol√©culas no polares", 
            exp: "Principio b√°sico de las interacciones hidr√≥fobas." 
        },
        { 
            q: "Indica qu√© afirmaci√≥n es correcta (Variaci√≥n):", 
            opts: ["En un centro quiral las im√°genes especulares son superponibles", "A mayor hidrofobicidad de un amino√°cido, m√°s tendencia a unirse a mol√©culas no polares", "La glicina es el √∫nico amino√°cido con carbono Œ± asim√©trico", "El pKa del grupo carboxilo de un amino√°cido es totalmente invariable"], 
            a: "A mayor hidrofobicidad de un amino√°cido, m√°s tendencia a unirse a mol√©culas no polares", 
            exp: "Reiteraci√≥n del concepto hidr√≥fobo." 
        },
        { 
            q: "Indica qu√© afirmaci√≥n es correcta en relaci√≥n con soluciones de amino√°cidos a pH fisiol√≥gico:", 
            opts: ["Algunos amino√°cidos contienen s√≥lo cargas negativas", "Todos los amino√°cidos contienen simult√°neamente cargas positivas y negativas", "Todos los amino√°cidos tienen cargas positivas en la cadena R", "Algunos amino√°cidos contienen s√≥lo cargas positivas"], 
            a: "Todos los amino√°cidos contienen simult√°neamente cargas positivas y negativas", 
            exp: "A pH neutro, todos tienen el grupo alfa-amino protonado (+) y el alfa-carboxilo desprotonado (-)." 
        },
        { 
            q: "Cu√°l de los siguientes compuestos no es de alta energ√≠a de hidr√≥lisis:", 
            opts: ["ATP", "Acil-CoA", "Carboxibiotina", "Fosfoenolpiruvato", "Fosfocreatina"], 
            a: "Carboxibiotina", 
            exp: "Es un cofactor activado para transferencia de CO2, pero su hidr√≥lisis no libera la energ√≠a comparable a un fosfato de alta energ√≠a o un tio√©ster." 
        },
        { 
            q: "Tras la disociaci√≥n del heterotr√≠mero Œ±/Œ≤/Œ≥ asociado a un receptor GPCR:", 
            opts: ["El receptor no sufre cambios conformacionales", "El complejo Œ≤/Œ≥ no puede actuar sobre prote√≠nas efectoras", "La subunidad Œ± intercambia GTP por GDP tras la hidr√≥lisis", "El receptor puede disminuir su afinidad por el ligando"], 
            a: "El receptor puede disminuir su afinidad por el ligando", 
            exp: "Al activarse la prote√≠na G, el receptor suele pasar a un estado de baja afinidad." 
        }
    ];

    // --- ASIGNAR IDs √öNICOS ---
    quizData.forEach((item, index) => {
        item.id = index;
    });

    // --- GESTI√ìN DE ESTADO ---
    let markedQuestions = new Set();
    let failedQuestions = new Set();

    function shuffleArray(array) {
        let currentIndex = array.length, randomIndex;
        while (currentIndex !== 0) {
            randomIndex = Math.floor(Math.random() * currentIndex);
            currentIndex--;
            [array[currentIndex], array[randomIndex]] = [array[randomIndex], array[currentIndex]];
        }
        return array;
    }

    const container = document.getElementById('quiz-container');

    // Funci√≥n principal
    function renderQuiz(questionsToLoad = quizData) {
        container.innerHTML = "";
        document.getElementById("restart-menu").style.display = "none";
        document.getElementById("finish-btn").style.display = "inline-block";

        if(questionsToLoad.length === 0) {
            container.innerHTML = "<p style='text-align:center; padding:20px; color:#6b7280;'>No hay preguntas para mostrar en esta selecci√≥n.</p>";
            return;
        }

        questionsToLoad.forEach((item, displayIndex) => {
            const card = document.createElement('div');
            card.className = 'question-card';

            // Checkbox Marcar
            const markContainer = document.createElement("div");
            markContainer.className = "mark-container";
            const checkbox = document.createElement("input");
            checkbox.type = "checkbox";
            checkbox.id = `mark-${item.id}`;
            if(markedQuestions.has(item.id)) checkbox.checked = true;

            checkbox.onchange = (e) => {
                if(e.target.checked) markedQuestions.add(item.id);
                else markedQuestions.delete(item.id);
            };

            const label = document.createElement("label");
            label.htmlFor = `mark-${item.id}`;
            label.innerText = "Marcar para revisar";
            markContainer.appendChild(checkbox);
            markContainer.appendChild(label);
            card.appendChild(markContainer);

            // Pregunta
            const header = document.createElement('div');
            header.className = 'question-header';
            header.textContent = `Pregunta ${item.id + 1}`; 
            card.appendChild(header);

            const questionText = document.createElement('div');
            questionText.className = 'question-text';
            questionText.textContent = item.q;

            // --- INSERCI√ìN DE DIAGRAMAS ---
            if (item.id === 0) { // Amino√°cidos estructura
                 questionText.innerHTML += `<span class='img-tag'>

[Image of amino acid general structure and side chains]
</span>`;
            } else if (item.id === 29) { // H√©lice Alfa
                 questionText.innerHTML += `<span class='img-tag'></span>`;
            } else if (item.id === 6) { // Transporte membrana
                 questionText.innerHTML += `<span class='img-tag'></span>`;
            } else if (item.id === 37) { // Fosfol√≠pidos
                 questionText.innerHTML += `<span class='img-tag'></span>`;
            } else if (item.id === 12) { // Enlace glucos√≠dico
                 questionText.innerHTML += `<span class='img-tag'>

[Image of glycosidic bond formation]
</span>`;
            } else if (item.id === 5) { // Esfingomielina
                 questionText.innerHTML += `<span class='img-tag'>

[Image of sphingomyelin structure]
</span>`;
            } else if (item.id === 50) { // GPCR
                 questionText.innerHTML += `<span class='img-tag'>

[Image of GPCR signaling pathway]
</span>`;
            }

            card.appendChild(questionText);

            // Opciones
            const optionsDiv = document.createElement('div');
            optionsDiv.className = 'options-container';

            let optionsObj = item.opts.map(opt => ({
                text: opt,
                isCorrect: opt === item.a
            }));
            optionsObj = shuffleArray(optionsObj);

            // Explicaci√≥n
            const explanationDiv = document.createElement('div');
            explanationDiv.className = 'explanation';
            explanationDiv.innerHTML = `<strong>Explicaci√≥n:</strong> ${item.exp}`;

            optionsObj.forEach(opt => {
                const btn = document.createElement('button');
                btn.className = 'option-btn';
                btn.textContent = opt.text;

                btn.onclick = () => {
                    const allBtns = optionsDiv.querySelectorAll('.option-btn');
                    allBtns.forEach(b => b.disabled = true);

                    if (opt.isCorrect) {
                        btn.classList.add('correct');
                    } else {
                        btn.classList.add('incorrect');
                        failedQuestions.add(item.id);
                        
                        allBtns.forEach(b => {
                            if (b.textContent === item.a) b.classList.add('correct');
                        });
                    }
                    explanationDiv.classList.add('visible');
                };
                optionsDiv.appendChild(btn);
            });

            card.appendChild(optionsDiv);
            card.appendChild(explanationDiv);
            container.appendChild(card);
        });
    }

    // --- Control Final ---
    function showEndOptions() {
        document.getElementById("finish-btn").style.display = "none";
        document.getElementById("restart-menu").style.display = "flex";
        document.getElementById("controls-area").scrollIntoView({behavior: "smooth"});
        
        document.getElementById("stats-summary").innerHTML = `
            Preguntas marcadas: <strong>${markedQuestions.size}</strong><br>
            Preguntas falladas en esta sesi√≥n: <strong>${failedQuestions.size}</strong>
        `;
    }

    function restartQuiz(mode) {
        let subset = [];
        if (mode === 'all') subset = quizData;
        else if (mode === 'marked') subset = quizData.filter(q => markedQuestions.has(q.id));
        else if (mode === 'failed') subset = quizData.filter(q => failedQuestions.has(q.id));
        else if (mode === 'failed_marked') subset = quizData.filter(q => failedQuestions.has(q.id) || markedQuestions.has(q.id));

        if(mode !== 'all') failedQuestions.clear(); 
        else {
            failedQuestions.clear();
            markedQuestions.clear();
        }

        renderQuiz(subset);
        window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    renderQuiz();
</script>

</body>
</html>
