<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cuestionario: Bloque II - Gen√©tica Molecular y Cromosomas</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f4f4f9;
            color: #333;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        h1 {
            text-align: center;
            color: #2c3e50;
            margin-bottom: 30px;
        }
        .quiz-container {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            min-height: 200px;
        }
        .question-block {
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #eee;
            position: relative; /* Necesario para posicionar el marcador */
        }
        
        /* ESTILO NUEVO: Pesta√±a para Marcar */
        .mark-container {
            position: absolute;
            top: 0;
            right: 0;
            background-color: #f1f1f1;
            border: 1px solid #ccc;
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 0.9em;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        .mark-container:hover {
            background-color: #e2e6ea;
        }
        .mark-container input {
            cursor: pointer;
            transform: scale(1.2);
        }

        .question-title {
            font-size: 1.1em;
            margin-bottom: 15px;
            font-weight: 600;
            padding-right: 100px; /* Espacio para que el texto no tape el marcador */
        }
        .options-list {
            list-style-type: none;
            padding: 0;
        }
        .option-item {
            margin-bottom: 10px;
        }
        .option-btn {
            display: block;
            width: 100%;
            text-align: left;
            padding: 12px 15px;
            background-color: #fff;
            border: 1px solid #ddd;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 0.95em;
            color: #444;
        }
        .option-btn:hover {
            background-color: #f0f0f0;
            border-color: #bbb;
        }
        
        /* Estilos de correcci√≥n */
        .correct {
            background-color: #d4edda !important;
            border-color: #c3e6cb !important;
            color: #155724 !important;
            position: relative;
        }
        .correct::after {
            content: " ‚úì Correcto";
            font-weight: bold;
            float: right;
        }
        
        .incorrect {
            background-color: #f8d7da !important;
            border-color: #f5c6cb !important;
            color: #721c24 !important;
            position: relative;
        }
        .incorrect::after {
            content: " ‚úó Incorrecto";
            font-weight: bold;
            float: right;
        }

        .disabled {
            pointer-events: none;
            opacity: 0.8;
        }

        /* ESTILO NUEVO: Panel de Resultados */
        #results-panel {
            display: none; /* Oculto por defecto */
            text-align: center;
            margin-top: 40px;
            padding: 30px;
            background: #fff;
            border-radius: 8px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            border-top: 5px solid #2c3e50;
        }
        .retry-buttons-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-top: 20px;
        }
        .retry-btn {
            padding: 15px;
            font-size: 1em;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            color: white;
            transition: opacity 0.2s;
        }
        .retry-btn:hover { opacity: 0.9; }
        
        .btn-full { background-color: #3498db; }    /* Azul */
        .btn-failed { background-color: #e74c3c; }  /* Rojo */
        .btn-marked { background-color: #f39c12; }  /* Naranja */
        .btn-mixed { background-color: #9b59b6; }   /* Morado */

        /* Responsive para botones */
        @media (max-width: 600px) {
            .retry-buttons-grid { grid-template-columns: 1fr; }
            .question-title { padding-right: 0; margin-top: 35px; }
            .mark-container { width: 100%; border: none; background: transparent; justify-content: flex-end; }
        }
    </style>
</head>
<body>

    <h1 id="quiz-title">Test Bloque II: Cromosomas, Replicaci√≥n, Transcripci√≥n y Traducci√≥n</h1>
    
    <div class="quiz-container" id="quiz">
        </div>

    <div style="text-align: center; margin-top: 40px; padding: 20px; background: #eee; border-radius: 8px;" id="finish-container">
        <button id="btn-finish" style="background: #2c3e50; color: white; border: none; padding: 15px 30px; font-size: 1.2em; border-radius: 6px; cursor: pointer; font-weight: bold;">
            üèÅ Finalizar y Ver Resultados
        </button>
    </div>

    <div id="results-panel">
        <h2>üìä Resultados</h2>
        <p id="score-text" style="font-size: 1.2em; margin: 20px 0;"></p>
        
        <h3>¬øQu√© deseas hacer ahora?</h3>
        <div class="retry-buttons-grid">
            <button class="retry-btn btn-full" onclick="retryQuiz('all')">üîÑ Repetir Completo</button>
            <button class="retry-btn btn-failed" onclick="retryQuiz('failed')">‚ùå Repetir Falladas</button>
            <button class="retry-btn btn-marked" onclick="retryQuiz('marked')">üîñ Repetir Marcadas</button>
            <button class="retry-btn btn-mixed" onclick="retryQuiz('mixed')">‚ùå + üîñ Falladas y Marcadas</button>
        </div>
        <br>
        <button onclick="window.location.href='index.html'" style="background:transparent; border:1px solid #666; padding:8px 15px; border-radius:4px; cursor:pointer;">Volver al Men√∫ Principal</button>
    </div>

    <script>
        // Datos crudos de las preguntas
        const rawQuestions = [
            {
                "text": "1. En t√©rminos moleculares, ¬øcu√°l de los siguientes enunciados define de manera m√°s precisa un gen?",
                "options": [
                    {"text": "La unidad de herencia que determina las caracter√≠sticas o el fenotipo de un organismo.", "correct": false},
                    {"text": "La secuencia de ADN que, sin ser transcrita, determina las caracter√≠sticas de la prote√≠na.", "correct": false},
                    {"text": "Un segmento de ADN que dirige la producci√≥n de una prote√≠na espec√≠fica o de una mol√©cula de ARN funcional.", "correct": true},
                    {"text": "La mol√©cula de ADN completa que porta la informaci√≥n gen√©tica hereditaria.", "correct": false}
                ]
            },
            {
                "text": "2. La unidad b√°sica de la estructura de los cromosomas eucariotas, formada por ADN y prote√≠nas, es el nucleosoma. ¬øCu√°ntos pares de bases (pb) de ADN se enrollan alrededor del oct√°mero de histonas para formar esta unidad?",
                "options": [
                    {"text": "M√°s de 60 millones de pares de bases.", "correct": false},
                    {"text": "147 pb.", "correct": true},
                    {"text": "1,7 vueltas en espiral lev√≥gira.", "correct": false},
                    {"text": "Cientos de millones de nucle√≥tidos (tama√±o del ADN).", "correct": false}
                ]
            },
            {
                "text": "3. ¬øQu√© prote√≠na proporciona una compactaci√≥n adicional en la fibra de cromatina, ayudando a plegar la estructura que se forma tras el oct√°mero de histonas?",
                "options": [
                    {"text": "El complejo remodelador de la cromatina.", "correct": false},
                    {"text": "La prote√≠na Cohesina.", "correct": false},
                    {"text": "La histona H1.", "correct": true},
                    {"text": "Las enzimas modificadoras de histonas (Metiltransferasas).", "correct": false}
                ]
            },
            {
                "text": "4. La informaci√≥n gen√©tica de una c√©lula eucariota est√° contenida en un conjunto de cromosomas. ¬øQu√© elementos de secuencia son esenciales, adem√°s de los genes, para asegurar la duplicaci√≥n y distribuci√≥n equitativa de los cromosomas hijos en la divisi√≥n celular?",
                "options": [
                    {"text": "Exones, intrones y la fibra de cromatina.", "correct": false},
                    {"text": "Colas aminoac√≠dicas de las histonas, bucles de ADN y el nucle√≥lo.", "correct": false},
                    {"text": "Muchos or√≠genes de replicaci√≥n, un centr√≥mero y dos tel√≥meros.", "correct": true},
                    {"text": "Histonas y prote√≠nas no histonas.", "correct": false}
                ]
            },
            {
                "text": "5. Molecularmente, el proceso que provoca la relajaci√≥n de la cromatina a un estado m√°s descondensado permite que:",
                "options": [
                    {"text": "Se produzca la degradaci√≥n de prote√≠nas en los proteasomas.", "correct": false},
                    {"text": "Las histonas H1 se separen del oct√°mero de histonas.", "correct": false},
                    {"text": "La replicaci√≥n de ADN se lleve a cabo a 1000 nucle√≥tidos por segundo.", "correct": false},
                    {"text": "Las prote√≠nas implicadas en la expresi√≥n g√©nica, la replicaci√≥n del ADN y la reparaci√≥n del ADN tengan acceso a las secuencias de ADN necesarias.", "correct": true}
                ]
            },
            {
                "text": "6. ¬øQu√© complejo proteico SMC (Structural Maintenance of Chromosomes) es fundamental para la formaci√≥n de bucles en la cromatina interf√°sica y para mantener unidas las crom√°tidas hermanas antes de la correcta segregaci√≥n?",
                "options": [
                    {"text": "Condensina.", "correct": false},
                    {"text": "SMC5/6.", "correct": false},
                    {"text": "Cohesina.", "correct": true},
                    {"text": "Topoisomerasa.", "correct": false}
                ]
            },
            {
                "text": "7. Un alto grado de condensaci√≥n del ADN ocurre en todos los cromosomas durante la mitosis y en la heterocromatina en interfase. Esta condensaci√≥n:",
                "options": [
                    {"text": "Facilita la acci√≥n del factor sigma en el promotor.", "correct": false},
                    {"text": "Impide que sus genes puedan expresarse para producir ARN.", "correct": true},
                    {"text": "Es el resultado de la acci√≥n del empalmosoma.", "correct": false},
                    {"text": "Se revierte por la acci√≥n de la telomerasa.", "correct": false}
                ]
            },
            {
                "text": "8. La fosforilaci√≥n, acetilaci√≥n y metilaci√≥n de las colas de histonas son modificaciones qu√≠micas reversibles. ¬øCu√°l es la importancia molecular de estas modificaciones?",
                "options": [
                    {"text": "Son el mecanismo de correcci√≥n de la ADN polimerasa.", "correct": false},
                    {"text": "Determinan el espaciado de los fragmentos de Okazaki.", "correct": false},
                    {"text": "Permiten regular la estructura de la cromatina, pudiendo ser heredables.", "correct": true},
                    {"text": "Definen el marco de lectura en la traducci√≥n.", "correct": false}
                ]
            },
            {
                "text": "9. Seg√∫n la posici√≥n del centr√≥mero, los cromosomas se clasifican en metac√©ntricos, submetac√©ntricos, acroc√©ntricos y teloc√©ntricos. ¬øQu√© tipo de cromosoma tiene el centr√≥mero muy cerca de un extremo, siendo el tipo teloc√©ntrico inexistente en humanos?",
                "options": [
                    {"text": "Metac√©ntrico.", "correct": false},
                    {"text": "Submetac√©ntrico.", "correct": false},
                    {"text": "Teloc√©ntrico.", "correct": false},
                    {"text": "Acroc√©ntrico.", "correct": true}
                ]
            },
            {
                "text": "10. Los investigadores Hershey y Chase trabajaron con virus T2, compuestos enteramente de prote√≠nas y ADN. ¬øQu√© demostraron de manera definitiva con este experimento?",
                "options": [
                    {"text": "La existencia del nucleosoma.", "correct": false},
                    {"text": "El mecanismo de correcci√≥n de la ADN polimerasa.", "correct": false},
                    {"text": "La capacidad autocatal√≠tica del ARN.", "correct": false},
                    {"text": "Que los genes est√°n hechos de ADN.", "correct": true}
                ]
            },
            {
                "text": "11. La replicaci√≥n del ADN se considera semiconservadora. Este proceso es altamente eficiente en eucariotas, ¬øa qu√© velocidad aproximada se incorporan los nucle√≥tidos?",
                "options": [
                    {"text": "1000 nucle√≥tidos por segundo.", "correct": false},
                    {"text": "100 nucle√≥tidos por segundo.", "correct": true},
                    {"text": "1 error cada 10 000 nucle√≥tidos.", "correct": false},
                    {"text": "10 000 or√≠genes de replicaci√≥n por genoma.", "correct": false}
                ]
            },
            {
                "text": "12. En la replicaci√≥n del ADN, la ADN polimerasa III es la enzima que realiza la mayor parte de la s√≠ntesis. Sin embargo, la s√≠ntesis requiere otros componentes. ¬øCu√°l de estos es un complejo proteico que consume ATP y depende del cargador de la abrazadera para permitir que la polimerasa se desplace por la hebra sin soltarse?",
                "options": [
                    {"text": "La Helicasa.", "correct": false},
                    {"text": "La Primasa.", "correct": false},
                    {"text": "La abrazadera deslizante.", "correct": true},
                    {"text": "La Topoisomerasa.", "correct": false}
                ]
            },
            {
                "text": "13. Para liberar la tensi√≥n acumulada que se produce al abrir la doble h√©lice durante la replicaci√≥n, interviene una enzima clave. ¬øCu√°l de las siguientes produce un corte monocateriano transitorio en el ADN con este fin?",
                "options": [
                    {"text": "La Nucleasa (corte en reparaci√≥n).", "correct": false},
                    {"text": "Una topoisomerasa.", "correct": true},
                    {"text": "La ADN ligasa (sellado).", "correct": false},
                    {"text": "La Telomerasa (tel√≥meros).", "correct": false}
                ]
            },
            {
                "text": "14. Si un pat√≥logo detecta una mutaci√≥n en un solo nucle√≥tido del gen de la hemoglobina humana, que resulta en una prote√≠na menos soluble que forma precipitados fibrosos intracelulares, el diagn√≥stico molecular compatible es:",
                "options": [
                    {"text": "Atrofia Muscular Espinal (SMA).", "correct": false},
                    {"text": "C√°ncer de colon (relacionado con reparaci√≥n de apareamientos err√≥neos).", "correct": false},
                    {"text": "Anemia drepanoc√≠tica.", "correct": true},
                    {"text": "Una rotura bicatenaria reparada por recombinaci√≥n hom√≥loga.", "correct": false}
                ]
            },
            {
                "text": "15. El mecanismo b√°sico de reparaci√≥n del ADN consta de tres pasos esenciales que involucran la acci√≥n secuencial de enzimas. ¬øCu√°l es la secuencia correcta de estas enzimas?",
                "options": [
                    {"text": "Primasa, Nucleasa, Ligasa.", "correct": false},
                    {"text": "Nucleasa, ADN polimerasa reparadora, ADN ligasa.", "correct": true},
                    {"text": "Helicasa, Primasa, Topoisomerasa.", "correct": false},
                    {"text": "ARN polimerasa, Factor de liberaci√≥n, Proteasoma.", "correct": false}
                ]
            },
            {
                "text": "16. ¬øQu√© reacci√≥n qu√≠mica frecuente causa da√±os graves en el ADN, junto con la despurinaci√≥n?",
                "options": [
                    {"text": "La metilaci√≥n de histonas.", "correct": false},
                    {"text": "La poliadenilaci√≥n.", "correct": false},
                    {"text": "La traducci√≥n.", "correct": false},
                    {"text": "La desaminaci√≥n.", "correct": true}
                ]
            },
            {
                "text": "17. En la cadena retrasada de replicaci√≥n, el ADN polimerasa debe actuar de manera discontinua, generando los denominados:",
                "options": [
                    {"text": "Promotores eucariontes.", "correct": false},
                    {"text": "Cromosomas telom√©ricos.", "correct": false},
                    {"text": "Fragmentos de Okazaki.", "correct": true},
                    {"text": "Nucle√≥tidos trifosfato.", "correct": false}
                ]
            },
            {
                "text": "18. A nivel molecular, la telomerasa se une al extremo 3‚Äô del tel√≥mero para alargarlo y lo repite en varios ciclos. Para realizar esta funci√≥n, la telomerasa transporta su propia mol√©cula que act√∫a como:",
                "options": [
                    {"text": "Cebador.", "correct": true},
                    {"text": "Cadena de ADN monocatenario.", "correct": false},
                    {"text": "Prote√≠na SMC.", "correct": false},
                    {"text": "Ribonucleasa (degradaci√≥n).", "correct": false}
                ]
            },
            {
                "text": "19. El sistema de reparaci√≥n de apareamientos err√≥neos es vital porque elimina los errores de replicaci√≥n que escapan a la correcci√≥n de la ADN polimerasa. La mutaci√≥n de los genes que codifican estas prote√≠nas de reparaci√≥n aumenta la predisposici√≥n a:",
                "options": [
                    {"text": "La atrofia muscular espinal.", "correct": false},
                    {"text": "Ciertos c√°nceres, sobre todo de colon.", "correct": true},
                    {"text": "La anemia drepanoc√≠tica.", "correct": false},
                    {"text": "El acortamiento telom√©rico (TERRA).", "correct": false}
                ]
            },
            {
                "text": "20. La recombinaci√≥n hom√≥loga se utiliza como una estrategia de reparaci√≥n para:",
                "options": [
                    {"text": "Corregir d√≠meros de timina causados por luz UV.", "correct": false},
                    {"text": "Eliminar intrones de los pre-ARNm.", "correct": false},
                    {"text": "Reparar roturas bicatenarias del ADN.", "correct": true},
                    {"text": "Alargar los extremos telom√©ricos.", "correct": false}
                ]
            },
            {
                "text": "21. El flujo de informaci√≥n gen√©tica en todas las c√©lulas vivas es ADN > ARN > prote√≠na. El paso de las instrucciones gen√©ticas del ADN a ARN se denomina:",
                "options": [
                    {"text": "Traducci√≥n.", "correct": false},
                    {"text": "Replicaci√≥n.", "correct": false},
                    {"text": "Silenciamiento g√©nico.", "correct": false},
                    {"text": "Transcripci√≥n.", "correct": true}
                ]
            },
            {
                "text": "22. Las ARN polimerasas son las enzimas que catalizan la transcripci√≥n. ¬øQu√© mol√©cula entrante aporta la energ√≠a necesaria para la formaci√≥n del enlace fosfodi√©ster en la cadena de ARN?",
                "options": [
                    {"text": "ATP (usado por ligasa o helicasa).", "correct": false},
                    {"text": "Desoxirribonucle√≥sidos trifosfato.", "correct": false},
                    {"text": "Ribonucle√≥sidos trifosfato.", "correct": true},
                    {"text": "El factor sigma.", "correct": false}
                ]
            },
            {
                "text": "23. A diferencia de la ADN polimerasa, la ARN polimerasa tiene una menor capacidad de correcci√≥n. Aproximadamente, ¬øcu√°l es su tasa de error de incorporaci√≥n?",
                "options": [
                    {"text": "1 error cada 10 millones de nucle√≥tidos.", "correct": false},
                    {"text": "1 error cada 100 nucle√≥tidos.", "correct": false},
                    {"text": "1 error cada 10 000 nucle√≥tidos.", "correct": true},
                    {"text": "100 nucle√≥tidos por segundo.", "correct": false}
                ]
            },
            {
                "text": "24. El ARN difiere del ADN en varios aspectos estructurales. ¬øQu√© base nitrogenada contiene el ARN en lugar de la timina (T)?",
                "options": [
                    {"text": "Adenina (A).", "correct": false},
                    {"text": "Citosina (C).", "correct": false},
                    {"text": "Guanina (G).", "correct": false},
                    {"text": "Uracilo (U).", "correct": true}
                ]
            },
            {
                "text": "25. El procesamiento de pre-ARNm eucariota incluye el encapuchamiento del extremo 5‚Äô. ¬øQu√© enzima a√±ade el nucle√≥tido GTP, formando un enlace 5‚Äô‚Äì5‚Äô trifosfato?",
                "options": [
                    {"text": "RNA trifosfatasa.", "correct": false},
                    {"text": "Metiltransferasa.", "correct": false},
                    {"text": "Guanylil transferasa.", "correct": true},
                    {"text": "Aminoacil-ARNt sintetasa.", "correct": false}
                ]
            },
            {
                "text": "26. ¬øCu√°l de las siguientes funciones es realizada por el encapuchamiento del extremo 5‚Äô y la poliadenilaci√≥n del extremo 3‚Äô en el pre-ARNm?",
                "options": [
                    {"text": "Servir de plantilla para los tel√≥meros.", "correct": false},
                    {"text": "Codificar la informaci√≥n para la s√≠ntesis proteica.", "correct": false},
                    {"text": "Aumentar la estabilidad de la mol√©cula y facilitar su exportaci√≥n al citosol.", "correct": true},
                    {"text": "Silenciar transposones en c√©lulas germinales.", "correct": false}
                ]
            },
            {
                "text": "27. La Atrofia Muscular Espinal (SMA) es una patolog√≠a que se relaciona con el gen, cuya peque√±a fracci√≥n de transcritos funcionales no basta para la supervivencia neuronal. ¬øQu√© porcentaje de genes humanos son sometidos al proceso de corte y empalme (splicing) alternativo?",
                "options": [
                    {"text": "61%.", "correct": false},
                    {"text": "20%.", "correct": false},
                    {"text": "95%.", "correct": true},
                    {"text": "100%.", "correct": false}
                ]
            },
            {
                "text": "28. El proceso de splicing o corte y empalme elimina los intrones del ARN y une los exones. Esta reacci√≥n es catalizada por peque√±os complejos ribonucleoproteicos conocidos como:",
                "options": [
                    {"text": "Proteasomas.", "correct": false},
                    {"text": "Ribosomas.", "correct": false},
                    {"text": "Factores generales de transcripci√≥n.", "correct": false},
                    {"text": "snRNPs (ribonucleoprote√≠nas nucleares peque√±as).", "correct": true}
                ]
            },
            {
                "text": "29. En la transcripci√≥n de eucariontes, el factor de transcripci√≥n general TFIIH tiene dos funciones cruciales:",
                "options": [
                    {"text": "Unir el cod√≥n de iniciaci√≥n AUG al ARNm.", "correct": false},
                    {"text": "Degradar el ARNm una vez en el citosol.", "correct": false},
                    {"text": "Abrir la doble h√©lice y fosforilar la cola de la ARN polimerasa.", "correct": true},
                    {"text": "A√±adir el grupo metilo al nucle√≥tido de guanosina en el 5‚Äô.", "correct": false}
                ]
            },
            {
                "text": "30. Se han identificado varios tipos de ARN funcional. ¬øQu√© mol√©cula de ARN no codificante, de 24-31 nucle√≥tidos, tiene como funci√≥n principal silenciar transposones (elementos m√≥viles del ADN) y se encuentra en las c√©lulas germinales?",
                "options": [
                    {"text": "siRNA (silenciamiento g√©nico).", "correct": false},
                    {"text": "miRNA (regulaci√≥n expresi√≥n).", "correct": false},
                    {"text": "TERRA (regula longitud tel√≥meros).", "correct": false},
                    {"text": "piRNA.", "correct": true}
                ]
            },
            {
                "text": "31. ¬øQu√© mol√©cula de ARN telom√©rico (ncRNA) sirve de plantilla para alargar los tel√≥meros y est√° asociada a la enzima telomerasa?",
                "options": [
                    {"text": "TERRA.", "correct": false},
                    {"text": "TERC / hTR.", "correct": true},
                    {"text": "lncRNA.", "correct": false},
                    {"text": "siRNA.", "correct": false}
                ]
            },
            {
                "text": "32. Si dos genes ribos√≥micos adyacentes en una misma mol√©cula de ADN son transcritos simult√°neamente por numerosas RNA polimerasas, ¬øqu√© secuencias contienen estas regiones transcritas?",
                "options": [
                    {"text": "Los intrones y las regiones promotoras.", "correct": false},
                    {"text": "Las regiones promotoras y las secuencias terminadoras.", "correct": false},
                    {"text": "Las secuencias terminadoras, pero no las promotoras.", "correct": true},
                    {"text": "El anticod√≥n y el sitio de uni√≥n del ARNm.", "correct": false}
                ]
            },
            {
                "text": "33. ¬øQu√© caracteriza a las ARN polimerasas respecto a los cebadores?",
                "options": [
                    {"text": "Requieren un cebador de ADN para empezar la s√≠ntesis.", "correct": false},
                    {"text": "No necesitan cebador.", "correct": true},
                    {"text": "Utilizan el cebador de la telomerasa.", "correct": false},
                    {"text": "Utilizan el cebador sintetizado por la primasa (replicaci√≥n).", "correct": false}
                ]
            },
            {
                "text": "34. Una de las funciones diversas de las mol√©culas de ARN es actuar como catalizador en las c√©lulas modernas, lo cual es considerado una ventana al antiguo mundo basado en ARN. Este tipo de ARN catal√≠tico se denomina:",
                "options": [
                    {"text": "Prote√≠na.", "correct": false},
                    {"text": "Citoesqueleto.", "correct": false},
                    {"text": "Ribozima.", "correct": true},
                    {"text": "LncRNA.", "correct": false}
                ]
            },
            {
                "text": "35. ¬øCu√°l es el significado molecular de la presencia de intrones en la secuencia de los ARNm?",
                "options": [
                    {"text": "Indican el final de la transcripci√≥n.", "correct": false},
                    {"text": "Son regiones codificantes necesarias para la prote√≠na.", "correct": false},
                    {"text": "Son regiones no codificantes que son eliminadas de las transcripciones de ARN en el n√∫cleo mediante el empalme.", "correct": true},
                    {"text": "Son elementos gen√©ticos m√≥viles silenciados por piRNA.", "correct": false}
                ]
            },
            {
                "text": "36. La traducci√≥n de la secuencia de nucle√≥tidos de un ARNm a una prote√≠na ocurre en grandes complejos ribonucleoproteicos llamados ribosomas. El ARNm es le√≠do en conjuntos consecutivos de tres nucle√≥tidos, denominados:",
                "options": [
                    {"text": "Nucleosomas.", "correct": false},
                    {"text": "Anticodones.", "correct": false},
                    {"text": "Exones.", "correct": false},
                    {"text": "Codones.", "correct": true}
                ]
            },
            {
                "text": "37. El c√≥digo gen√©tico se caracteriza porque la mayor√≠a de los amino√°cidos est√°n especificados por m√°s de un cod√≥n. ¬øCu√°ntas combinaciones distintas generan los 4 nucle√≥tidos diferentes en el ARN?",
                "options": [
                    {"text": "20 (n√∫mero de amino√°cidos).", "correct": false},
                    {"text": "31 (mol√©culas de ARNt).", "correct": false},
                    {"text": "64 (codones).", "correct": true},
                    {"text": "4 (bases de ARN).", "correct": false}
                ]
            },
            {
                "text": "38. El 'titubeo' (wobble) es un fen√≥meno molecular que explica por qu√©:",
                "options": [
                    {"text": "Solo 20 tipos de sintetasas son necesarias para los 64 codones.", "correct": false},
                    {"text": "La ARN polimerasa comete 1 error cada 10 000 nucle√≥tidos.", "correct": false},
                    {"text": "Existen 61 codones codificantes, pero solo alrededor de 31 mol√©culas de ARNt.", "correct": true},
                    {"text": "El c√≥digo gen√©tico tiene diferencias en las mitocondrias.", "correct": false}
                ]
            },
            {
                "text": "39. ¬øQu√© enzima consume ATP para generar un enlace de alta energ√≠a al unir covalentemente el amino√°cido correcto a su mol√©cula de ARNt correspondiente?",
                "options": [
                    {"text": "La ADN ligasa.", "correct": false},
                    {"text": "La metiltransferasa.", "correct": false},
                    {"text": "El Factor de liberaci√≥n.", "correct": false},
                    {"text": "Aminoacil-ARNt sintetasas.", "correct": true}
                ]
            },
            {
                "text": "40. Los ribosomas est√°n compuestos por un sitio de uni√≥n a ARNm y tres sitios para ARNt. ¬øQu√© componente de la subunidad grande del ribosoma act√∫a como ribozima para catalizar la uni√≥n secuencial de amino√°cidos en la cadena polipept√≠dica?",
                "options": [
                    {"text": "El anticod√≥n.", "correct": false},
                    {"text": "La prote√≠na SMC.", "correct": false},
                    {"text": "Una mol√©cula de ARNr.", "correct": true},
                    {"text": "El cod√≥n de terminaci√≥n.", "correct": false}
                ]
            },
            {
                "text": "41. ¬øCu√°l de los siguientes codones de terminaci√≥n (parada) libera la cadena proteica completa del ribosoma con la ayuda de un factor de liberaci√≥n?",
                "options": [
                    {"text": "AUG (iniciaci√≥n).", "correct": false},
                    {"text": "G-C o A-T (pares de bases ADN).", "correct": false},
                    {"text": "UAA, UAG o UGA.", "correct": true},
                    {"text": "147 pb (nucleosoma).", "correct": false}
                ]
            },
            {
                "text": "42. Las prote√≠nas se sintetizan en el citoplasma en:",
                "options": [
                    {"text": "N√∫cleosomas.", "correct": false},
                    {"text": "Mol√©culas de ARNt.", "correct": false},
                    {"text": "Polirribosomas.", "correct": true},
                    {"text": "Ribonucleasas (degradaci√≥n).", "correct": false}
                ]
            },
            {
                "text": "43. La degradaci√≥n de prote√≠nas en el citosol y el n√∫cleo es un proceso esencial para el turnover proteico y ocurre dentro de grandes complejos proteicos denominados:",
                "options": [
                    {"text": "snRNPs.", "correct": false},
                    {"text": "El complejo de poro nuclear.", "correct": false},
                    {"text": "Proteasomas.", "correct": true},
                    {"text": "Lisosomas (digesti√≥n general).", "correct": false}
                ]
            },
            {
                "text": "44. El tiempo de vida de una mol√©cula de ARNm una vez que llega al citosol puede ser muy variable y est√° determinado por:",
                "options": [
                    {"text": "El n√∫mero de nucleosomas en su secuencia.", "correct": false},
                    {"text": "El n√∫mero de fragmentos de Okazaki.", "correct": false},
                    {"text": "La degradaci√≥n por ribonucleasas y las necesidades de la c√©lula en ese momento.", "correct": true},
                    {"text": "La actividad del factor sigma.", "correct": false}
                ]
            },
            {
                "text": "45. ¬øCu√°l es el significado del concepto de 'Marco de lectura' en la iniciaci√≥n de la traducci√≥n?",
                "options": [
                    {"text": "Es el lugar donde la ARN polimerasa se une al promotor (transcripci√≥n).", "correct": false},
                    {"text": "Es el sitio donde la helicasa abre la doble h√©lice (replicaci√≥n).", "correct": false},
                    {"text": "Determina la lectura correcta de los codones a partir del cod√≥n de iniciaci√≥n (AUG).", "correct": true},
                    {"text": "Es la regi√≥n 3‚Äô no traducida del ARNm.", "correct": false}
                ]
            },
            {
                "text": "46. Adem√°s del ARNm, ARNr y ARNt, ¬øqu√© otros tipos de ARN presentan actividad reguladora y catal√≠tica?",
                "options": [
                    {"text": "ADN y prote√≠nas.", "correct": false},
                    {"text": "RNAs no codificantes reguladores y RNAs no codificantes.", "correct": true},
                    {"text": "Histonas y no histonas.", "correct": false},
                    {"text": "Ribonucle√≥sidos trifosfato.", "correct": false}
                ]
            },
            {
                "text": "47. Molecularmente, si el c√≥digo gen√©tico tuviera la misma correspondencia que los 20 amino√°cidos disponibles, ¬øcu√°ntos codones distintos habr√≠a?",
                "options": [
                    {"text": "64 (real).", "correct": false},
                    {"text": "3 (codones de parada).", "correct": false},
                    {"text": "61 (codones codificantes).", "correct": false},
                    {"text": "20 (si no hubiera redundancia o codones de parada).", "correct": true}
                ]
            },
            {
                "text": "48. En las c√©lulas eucariotas, el tiempo de vida del ARNm es variable y es degradado en el citosol por:",
                "options": [
                    {"text": "Proteasomas (degradan prote√≠nas).", "correct": false},
                    {"text": "La telomerasa.", "correct": false},
                    {"text": "Ribonucleasas.", "correct": true},
                    {"text": "La Topoisomerasa.", "correct": false}
                ]
            },
            {
                "text": "49. ¬øCu√°l de los siguientes ARN est√° asociado a la patog√©nesis de c√°nceres, seg√∫n los conceptos moleculares de ncRNAs?",
                "options": [
                    {"text": "miRNA (regula expresi√≥n).", "correct": false},
                    {"text": "siRNA (silenciamiento g√©nico).", "correct": false},
                    {"text": "lncRNA.", "correct": true},
                    {"text": "TERC/hTR (telomerasa).", "correct": false}
                ]
            },
            {
                "text": "50. La correspondencia entre amino√°cidos y codones es crucial para la s√≠ntesis proteica. Esta correspondencia est√° especificada por:",
                "options": [
                    {"text": "La abrazadera deslizante.", "correct": false},
                    {"text": "El c√≥digo gen√©tico.", "correct": true},
                    {"text": "La estructura del nucleosoma.", "correct": false},
                    {"text": "La cromatina en interfase.", "correct": false}
                ]
            }
        ];

        // A√±adimos estado a las preguntas (Marcada, Fallada, Respondida)
        // Tambi√©n guardamos opciones mezcladas para que no cambien de orden si el usuario marca/desmarca (opcional, pero buena pr√°ctica)
        const questions = rawQuestions.map(q => ({
            ...q,
            userMarked: false,
            userFailed: false,
            userAnswered: false,
            shuffledOptions: null 
        }));

        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
        }

        // Renderiza una lista espec√≠fica de preguntas
        function renderQuiz(questionsToRender) {
            const quizContainer = document.getElementById('quiz');
            quizContainer.innerHTML = '';
            
            // Ocultar resultados si estamos repitiendo
            document.getElementById('results-panel').style.display = 'none';
            document.getElementById('finish-container').style.display = 'block';

            if(questionsToRender.length === 0) {
                quizContainer.innerHTML = '<p style="text-align:center; padding:20px; font-style:italic;">No hay preguntas que coincidan con este criterio.</p>';
                document.getElementById('finish-container').style.display = 'none';
                document.getElementById('results-panel').style.display = 'block';
                return;
            }

            questionsToRender.forEach((q) => {
                const questionBlock = document.createElement('div');
                questionBlock.className = 'question-block';

                // --- Pesta√±a "Marcar" ---
                const markContainer = document.createElement('label');
                markContainer.className = 'mark-container';
                const checkbox = document.createElement('input');
                checkbox.type = 'checkbox';
                checkbox.checked = q.userMarked;
                checkbox.onchange = function() {
                    q.userMarked = this.checked;
                };
                markContainer.appendChild(checkbox);
                markContainer.appendChild(document.createTextNode(" Marcar"));
                questionBlock.appendChild(markContainer);

                // --- T√≠tulo ---
                const title = document.createElement('div');
                title.className = 'question-title';
                title.innerText = q.text;
                questionBlock.appendChild(title);

                // --- Opciones ---
                // Si no tienen orden mezclado asignado, lo creamos ahora
                if (!q.shuffledOptions) {
                    q.shuffledOptions = [...q.options];
                    shuffleArray(q.shuffledOptions);
                }

                const optionsList = document.createElement('ul');
                optionsList.className = 'options-list';

                q.shuffledOptions.forEach(opt => {
                    const li = document.createElement('li');
                    li.className = 'option-item';
                    
                    const btn = document.createElement('button');
                    btn.className = 'option-btn';
                    btn.innerText = opt.text;
                    
                    btn.onclick = function() {
                        // Marcar como respondida
                        q.userAnswered = true;

                        // Deshabilitar todos los botones de esta pregunta
                        const allBtns = optionsList.querySelectorAll('.option-btn');
                        allBtns.forEach(b => b.classList.add('disabled'));

                        if (opt.correct) {
                            btn.classList.add('correct');
                            // Si acierta a la primera y no estaba marcada como fallada previamente, se queda as√≠.
                        } else {
                            btn.classList.add('incorrect');
                            // Marcar en el objeto que el usuario fall√≥ esta pregunta
                            q.userFailed = true;

                            // Resaltar la correcta
                            allBtns.forEach(b => {
                                const originalOpt = q.options.find(o => o.correct);
                                if (b.innerText === originalOpt.text) {
                                    b.classList.add('correct');
                                }
                            });
                        }
                    };

                    li.appendChild(btn);
                    optionsList.appendChild(li);
                });

                questionBlock.appendChild(optionsList);
                quizContainer.appendChild(questionBlock);
            });
        }

        // Renderizar inicial (todas)
        renderQuiz(questions);

        // L√≥gica de Finalizaci√≥n
        const urlParams = new URLSearchParams(window.location.search);
        const testID = urlParams.get('id');

        document.getElementById('btn-finish').onclick = function() {
            // Nota: Calculamos la nota basada en lo que se est√° viendo en pantalla
            const currentBlocks = document.querySelectorAll('.question-block');
            let totalCurrent = currentBlocks.length;
            let currentCorrect = 0;

            // Revisamos el DOM actual para contar aciertos en esta "ronda"
            currentBlocks.forEach(block => {
                // Si tiene botones deshabilitados, se respondi√≥
                if (block.querySelector('.disabled')) {
                    // Si NO hay bot√≥n incorrecto, es un acierto
                    const hasIncorrect = block.querySelector('.incorrect');
                    if (!hasIncorrect) {
                        currentCorrect++;
                    }
                }
            });

            const notaFinal = totalCurrent > 0 ? Math.round((currentCorrect / totalCurrent) * 100) : 0;

            // Mostrar Panel de Resultados
            document.getElementById('finish-container').style.display = 'none';
            const resultsPanel = document.getElementById('results-panel');
            resultsPanel.style.display = 'block';
            
            document.getElementById('score-text').innerHTML = 
                `Has acertado <b>${currentCorrect}</b> de <b>${totalCurrent}</b> preguntas visibles.<br>Nota de este intento: <b>${notaFinal}%</b>`;
            
            // Scroll suave hacia los resultados
            resultsPanel.scrollIntoView({behavior: "smooth"});

            // Guardar Nota (Solo si es el test completo original para no sobrescribir con notas parciales de repasos)
            if (testID && totalCurrent === questions.length) {
                let intentos = parseInt(localStorage.getItem(`intentos_${testID}`) || 0);
                localStorage.setItem(`intentos_${testID}`, intentos + 1);

                let notaAnterior = localStorage.getItem(`nota_${testID}`);
                if (!notaAnterior || notaFinal > parseInt(notaAnterior)) {
                    localStorage.setItem(`nota_${testID}`, notaFinal);
                }
            }
        };

        // --- L√≥gica de Repetici√≥n ---
        function retryQuiz(mode) {
            let filteredQuestions = [];

            if (mode === 'all') {
                // Reinicio total
                questions.forEach(q => {
                    q.userFailed = false;
                    q.userMarked = false; // Opcional: ¬øDesmarcar al reiniciar todo? Normalmente s√≠.
                    q.userAnswered = false;
                    q.shuffledOptions = null; // Re-mezclar
                });
                filteredQuestions = questions;
            } 
            else if (mode === 'failed') {
                filteredQuestions = questions.filter(q => q.userFailed);
                // Reseteamos visualmente estas preguntas para re-intentarlas
                filteredQuestions.forEach(q => {
                    q.userAnswered = false; 
                    q.shuffledOptions = null;
                });
            } 
            else if (mode === 'marked') {
                filteredQuestions = questions.filter(q => q.userMarked);
                filteredQuestions.forEach(q => {
                    q.userAnswered = false;
                    q.shuffledOptions = null;
                });
            }
            else if (mode === 'mixed') {
                // Falladas O Marcadas
                filteredQuestions = questions.filter(q => q.userFailed || q.userMarked);
                filteredQuestions.forEach(q => {
                    q.userAnswered = false;
                    q.shuffledOptions = null;
                });
            }

            renderQuiz(filteredQuestions);

            // Actualizar t√≠tulo para dar contexto
            const modeTitles = {
                'all': 'Test Completo',
                'failed': 'Repaso de Fallos',
                'marked': 'Repaso de Marcadas',
                'mixed': 'Repaso (Falladas + Marcadas)'
            };
            document.getElementById('quiz-title').innerText = `Modo: ${modeTitles[mode]}`;
            
            // Subir al inicio
            window.scrollTo(0,0);
        }
    </script>
</body>
</html>
