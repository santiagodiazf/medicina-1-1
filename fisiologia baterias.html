<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Master Quiz Fisiología - 6 Baterías</title>
    <style>
        :root {
            --primary: #2c3e50;
            --secondary: #3498db;
            --success: #27ae60;
            --danger: #c0392b;
            --warning: #f39c12;
            --light: #ecf0f1;
            --dark: #34495e;
            --bio: #8e44ad; /* Color para bioquímica */
        }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            display: flex;
            height: 100vh;
            color: #333;
            background-color: #f4f6f7;
        }
        
        /* Sidebar */
        #sidebar {
            width: 380px;
            background-color: var(--primary);
            color: white;
            display: flex;
            flex-direction: column;
            padding: 15px;
            flex-shrink: 0;
            border-right: 1px solid #1a252f;
        }

        #sidebar h3 {
            margin-top: 0;
            text-align: center;
            font-size: 1.1rem;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            padding-bottom: 10px;
        }

        #nav-grid {
            display: grid;
            grid-template-columns: repeat(8, 1fr);
            gap: 3px;
            overflow-y: auto;
            padding-right: 5px;
            flex-grow: 1;
            align-content: start;
        }

        #nav-grid::-webkit-scrollbar { width: 6px; }
        #nav-grid::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.3); border-radius: 3px; }

        .nav-btn {
            width: 100%;
            aspect-ratio: 1;
            border-radius: 3px;
            border: none;
            background-color: rgba(255,255,255,0.1);
            color: #ecf0f1;
            cursor: pointer;
            font-weight: 600;
            font-size: 9px;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: all 0.2s;
        }

        .nav-btn:hover { background-color: var(--secondary); transform: scale(1.2); z-index: 2; }
        .nav-btn.active { background-color: var(--secondary); border: 1px solid white; }
        .nav-btn.correct { background-color: var(--success); color: white; }
        .nav-btn.incorrect { background-color: var(--danger); color: white; }
        .nav-btn.marked { box-shadow: inset 0 0 0 2px var(--warning); }

        .legend {
            font-size: 0.8rem;
            display: flex;
            justify-content: space-around;
            margin-top: 10px;
            padding-top: 10px;
            border-top: 1px solid rgba(255,255,255,0.1);
            flex-shrink: 0;
        }
        .dot { width: 8px; height: 8px; border-radius: 50%; display: inline-block; margin-right: 4px; }

        /* Main Content */
        #main {
            flex-grow: 1;
            padding: 20px;
            overflow-y: auto;
            position: relative;
        }

        .screen { display: none; max-width: 950px; margin: 0 auto; }
        .screen.active { display: block; }

        /* UI Elements */
        .card {
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
            text-align: center;
        }

        .mode-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .battery-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
            margin-bottom: 15px;
        }

        .btn {
            padding: 12px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 13px;
            font-weight: bold;
            transition: transform 0.1s, box-shadow 0.2s;
            width: 100%;
        }
        .btn:active { transform: scale(0.98); }
        .btn:hover { box-shadow: 0 4px 8px rgba(0,0,0,0.1); }

        .btn-blue { background-color: var(--secondary); color: white; }
        .btn-purple { background-color: var(--bio); color: white; }
        .btn-green { background-color: var(--success); color: white; }
        .btn-red { background-color: var(--danger); color: white; }
        .btn-dark { background-color: var(--dark); color: white; }
        .btn-yellow { background-color: var(--warning); color: #2c3e50; }
        .btn-outline { background: transparent; border: 2px solid var(--primary); color: var(--primary); }

        /* Question Container */
        .question-container {
            background: white;
            padding: 25px;
            margin-bottom: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            position: relative;
        }
        .question-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 15px;
        }
        .question-text { font-size: 1.15em; font-weight: 600; color: #2c3e50; line-height: 1.4; text-align: left; }
        
        .mark-check {
            cursor: pointer;
            color: #bdc3c7;
            font-size: 26px;
            transition: color 0.2s;
            user-select: none;
            margin-left: 15px;
        }
        .mark-check.marked { color: #f1c40f; }
        
        .options-grid { display: grid; gap: 8px; }
        .option {
            padding: 12px 18px;
            background-color: #f8f9fa;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 1em;
            text-align: left;
        }
        .option:hover:not(.disabled) { background-color: #e2e6ea; border-color: #adb5bd; }
        .option.correct { background-color: #d4edda; border-color: var(--success); color: #155724; }
        .option.incorrect { background-color: #f8d7da; border-color: var(--danger); color: #721c24; }
        .option.disabled { cursor: default; pointer-events: none; opacity: 0.7; }

        .feedback {
            margin-top: 15px;
            padding: 15px;
            background-color: #e8f6f3;
            border-radius: 8px;
            display: none;
            border-left: 5px solid var(--success);
            text-align: left;
        }
        .feedback.error { background-color: #fdeaea; border-color: var(--danger); }

        #controls {
            position: fixed;
            bottom: 30px;
            right: 40px;
            z-index: 100;
        }

        .badge {
            background: #95a5a6;
            color: white;
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 0.7em;
            vertical-align: middle;
            margin-left: 5px;
            display: inline-block;
        }
    </style>
</head>
<body>

    <div id="sidebar">
        <h3 id="sidebar-title">Índice</h3>
        <div id="nav-grid"></div>
        <div class="legend">
            <span><div class="dot" style="background:var(--success)"></div> Bien</span>
            <span><div class="dot" style="background:var(--danger)"></div> Mal</span>
            <span><div class="dot" style="background:var(--warning)"></div> Ojo</span>
        </div>
    </div>

    <div id="main">
        <div id="start-screen" class="screen active">
            <div class="card">
                <h1 style="color:var(--primary); margin-bottom: 5px;">Master Quiz Fisiología</h1>
                <p style="color:#7f8c8d; margin-top:0;">Base de Datos: 6 Baterías (~540 Preguntas)</p>
                
                <hr style="margin: 25px 0; opacity: 0.2">
                
                <h3 style="margin-bottom: 10px;">Selecciona Contenido:</h3>
                
                <div class="battery-grid">
                    <button class="btn btn-blue" onclick="selectBattery('b1')">Bat 1 <br><small>General (95)</small></button>
                    <button class="btn btn-blue" onclick="selectBattery('b2')">Bat 2 <br><small>Seminarios (42)</small></button>
                    <button class="btn btn-blue" onclick="selectBattery('b3')">Bat 3 <br><small>Sin Resp (95)</small></button>
                    <button class="btn btn-blue" onclick="selectBattery('b4')">Bat 4 <br><small>Examen 2025 (135)</small></button>
                    <button class="btn btn-blue" onclick="selectBattery('b5')">Bat 5 <br><small>Junio 2020 (30)</small></button>
                    <button class="btn btn-purple" onclick="selectBattery('b6')">Bat 6 <br><small>Bioq. Neuro (~25)</small></button>
                </div>

                <div class="mode-grid">
                    <button class="btn btn-dark" onclick="selectBattery('all')">TODO EL TEMARIO <br><small>Modo Master</small></button>
                    <button class="btn btn-red" onclick="selectBattery('exam')">SIMULACRO <br><small>20 Preguntas Aleatorias</small></button>
                </div>

                <div id="order-options" style="display:none; margin-top:20px; background:#f8f9fa; padding:15px; border-radius:8px;">
                    <h3 style="margin-top:0;">Orden de preguntas:</h3>
                    <div class="mode-grid" style="max-width: 400px; margin: 0 auto;">
                        <button class="btn btn-outline" onclick="startQuiz('ordered')">Orden Numérico</button>
                        <button class="btn btn-outline" onclick="startQuiz('random')">Aleatorio</button>
                    </div>
                </div>
            </div>
        </div>

        <div id="quiz-screen" class="screen">
            <div id="questions-list"></div>
            <div id="controls">
                <button class="btn btn-red" style="box-shadow: 0 4px 10px rgba(0,0,0,0.3);" onclick="finishQuiz()">Finalizar Revisión</button>
            </div>
        </div>

        <div id="results-screen" class="screen">
            <div class="card">
                <h2 style="color:var(--primary)">Resultados</h2>
                <div id="score-display" style="font-size: 3em; font-weight:bold; color:var(--secondary); margin: 20px 0;"></div>
                <div id="stats-display" style="color:#7f8c8d; font-size: 1.2em;"></div>
                
                <hr style="margin: 30px 0; opacity: 0.2">
                <h3>Opciones de Repaso</h3>
                <div class="mode-grid" style="grid-template-columns: repeat(3, 1fr); gap:10px;">
                    <button class="btn btn-danger" onclick="resetQuiz('failed')">Repetir Falladas</button>
                    <button class="btn btn-yellow" onclick="resetQuiz('marked')">Repetir Marcadas</button>
                    <button class="btn btn-dark" onclick="resetQuiz('failed_marked')">Falladas + Marcadas</button>
                </div>
                <div style="margin-top: 15px;">
                    <button class="btn btn-success" onclick="resetQuiz('all')">Repetir Mismo Test</button>
                    <br><br>
                    <button class="btn btn-outline" onclick="location.reload()">Volver al Menú Principal</button>
                </div>
            </div>
        </div>
    </div>

<script>
    // ==========================================
    // BASE DE DATOS (TODAS LAS BATERÍAS)
    // ==========================================
    
    // --- BATERÍA 1 ---
    const battery1 = [
        { id: 'b1_1', text: "La velocidad de propagación de los potenciales de acción se incrementa:", options: ["Al aumentar el diámetro del axón", "Al aumentar la capacitancia de membrana (Cm)", "Al reducir la resistencia de membrana (Rm)", "Al aumentar la resistencia interna o axial (ri)", "Al mielinizar el axón"], correct: 4, explanation: "La mielinización permite la conducción saltatoria." },
        { id: 'b1_2', text: "Respecto a la sinapsis química:", options: ["Están formadas por conexones", "Las SNARE, SNAP y NSF son proteínas presinápticas necesarias para la fusión", "Transmiten información más rápidamente que las eléctricas", "El aumento de calcio presináptico induce liberación de NT", "Facilitan el acoplamiento eléctrico"], correct: 3 },
        { id: 'b1_3', text: "Si comparamos los receptores colinérgicos nicotínicos y muscarínicos (marque la incorrecta):", options: ["La acción de los nicotínicos es más rápida", "Ambos se localizan en la membrana de fibras musculares esqueléticas", "Nicotínicos son ionotrópicos, muscarínicos metabotrópicos", "En ambos la unión de ACh puede abrir canal iónico", "Solo los muscarínicos usan proteínas G"], correct: 1 },
        { id: 'b1_4', text: "Respecto a la noradrenalina (marque la incorrecta):", options: ["Es un derivado del triptófano", "Se sintetiza a partir de dopamina", "Activa receptores beta-adrenérgicos", "Su acción termina por recaptación", "Se libera en neuronas posganglionares simpáticas"], correct: 0 },
        { id: 'b1_5', text: "Receptores de glutamato NMDA (marque la incorrecta):", options: ["Son canales iónicos activados por ligando", "Son canales catiónicos poco selectivos", "Se abren solo cuando la célula está despolarizada", "Su activación induce un potencial inhibidor (IPSP)", "Se inactivan por glicina"], correct: 3 },
        { id: 'b1_6', text: "Los neuropéptidos en las sinapsis:", options: ["Actúan más lejos del sitio de liberación", "Se unen con baja afinidad", "Se eliminan por recaptación", "Liberación no depende de calcio", "Pueden coexistir con otros neurotransmisores"], correct: 4 },
        { id: 'b1_7', text: "En sistemas sensoriales, la inhibición lateral:", options: ["Reduce el umbral de activación", "Aumenta el umbral perceptivo", "Reduce la adaptación", "Aumenta la capacidad de discriminación espacial", "Reduce la amplitud del potencial"], correct: 3 },
        { id: 'b1_8', text: "El aprendizaje y consolidación de memorias se relacionan con:", options: ["Cambios en propiedades pasivas", "Muerte neuronal", "Modificaciones persistentes en eficacia sináptica", "Aumento velocidad conducción", "Nada es cierto"], correct: 2 },
        { id: 'b1_9', text: "Los sistemas de transporte pasivo:", options: ["Mueven iones contra gradiente", "Mueven iones a favor de gradiente", "Mueven moléculas no iónicas a favor de gradiente", "Mueven moléculas contra gradiente", "Mueven iones y moléculas a favor o en contra"], correct: 2 },
        { id: 'b1_10', text: "Transporte con proteínas a favor de gradiente:", options: ["Difusión simple", "Difusión facilitada", "Difusión pasiva", "Velocidad constante a niveles altos", "Velocidad independiente de concentración"], correct: 1 },
        { id: 'b1_11', text: "Canales iónicos (señalar la incorrecta):", options: ["Mueven iones y solutos pequeños a favor de gradiente", "Mueven iones a favor de gradiente electroquímico", "Formados por subunidades proteicas", "Solamente mueven iones de carga positiva", "Contribuyen al potencial de membrana"], correct: 3 },
        { id: 'b1_12', text: "Citoquinas sinérgicas cuando:", options: ["Producidas por célula diferente", "Efecto combinado mayor que suma de partes", "Efectos contrarios", "Actúan sobre dianas diferentes", "Inducen respuesta idéntica"], correct: 1 },
        { id: 'b1_13', text: "Si Eq K+ = -58mV y Vm = +58mV, el flujo neto de K+:", options: ["Del interior al exterior", "Del exterior al interior", "No habrá flujo", "Mayor que si no hay diferencia", "No afectado"], correct: 0 },
        { id: 'b1_14', text: "Estímulo subumbral positivo (10ms) en neurona en reposo:", options: ["Potencial proporcional a corriente siempre", "Potencial no proporcional al inicio", "Potencial no varía", "Membrana se despolariza", "Membrana se hiperpolariza"], correct: 3 },
        { id: 'b1_15', text: "Potencial de acción (Incorrecta):", options: ["Tiene siempre la misma duración", "Se propaga en todas direcciones", "Despolarización por apertura de Na+", "Se invierte por entrada de K+", "Existe periodo refractario"], correct: 3 },
        { id: 'b1_16', text: "Sinapsis química, llegada de PA (Incorrecta):", options: ["Permite liberar NT", "Despolariza membrana presináptica", "Abre canales de Ca++ voltaje-dependientes", "Libera calcio al exterior celular", "Facilita potenciales locales postsinápticos"], correct: 3 },
        { id: 'b1_17', text: "Difusión pasiva:", options: ["Cinética lineal hasta saturación", "A través de canales hidrofóbicos", "Implica proteínas transmembrana", "Proceso no selectivo depende de propiedades del soluto", "Selectivo por filtro"], correct: 3 },
        { id: 'b1_18', text: "Receptores NT incorrecto:", options: ["NMDA activados por ligando y voltaje", "Serotonina tiene autorreceptores", "Glicinérgicos son metabotrópicos", "ACh se une a muscarínicos y nicotínicos", "Glutamato pueden ser iono o metabotrópicos"], correct: 2 },
        { id: 'b1_19', text: "Síntesis NT correcto:", options: ["AChe es precursora de ACh", "Noradrenalina precursora de dopamina", "Histidina transferasa precursora...", "GABA precursor de glutamato", "L-DOPA precursora de dopamina"], correct: 4 },
        { id: 'b1_20', text: "Eicosanoides:", options: ["Derivados del ác. araquidónico", "Señalización paracrina", "Proteínas de membrana", "Median uniones homofílicas", "Son neurotrofinas"], correct: 0 },
        { id: 'b1_21', text: "Hematopoyesis:", options: ["Cada célula madre genera gran progenie", "Hemangioblasto solo mieloide", "Hígado principal en adulto", "Células madre escasa regeneración", "Células madre gran capacidad proliferativa"], correct: 0 },
        { id: 'b1_22', text: "Incorrecta coagulación:", options: ["Plaquetas imprescindibles para coagulación", "tPA necesario fibrinolisis", "Trombomodulina necesaria coagulación", "Factor tisular activa extrínseca", "Endotelio sano limita coágulo"], correct: 0 },
        { id: 'b1_23', text: "Cadherinas:", options: ["Células inmunes", "Señalización supervivencia", "Señalización por contacto", "Actúan sobre presinápticas", "Respuesta inflamatoria"], correct: 2 },
        { id: 'b1_24', text: "S-nitrosilación incorrecta:", options: ["Activa guanilato ciclasa", "Modifica grupos sulfidrilos (tioles)", "Modifica grupos hemo", "Es reversible", "Regula enzimas"], correct: 2 },
        { id: 'b1_25', text: "Plaquetas no actúan en:", options: ["Hemostasia", "Activación plaquetaria", "Vía de coagulación", "Vasodilatación", "Retracción coágulo"], correct: 3 },
        { id: 'b1_26', text: "Potencial reposo:", options: ["Requiere canales ligando", "Eflujo continuo K+ e influjo Na+", "Solo células excitables", "Eq es cero si concentraciones iguales", "Si permeable solo a Na+ sería -80mV"], correct: 1 },
        { id: 'b1_27', text: "Propiedades pasivas:", options: ["No afecta velocidad PA", "Determinan amplitud y propagación espacial", "Determinan atenuación espacial", "Determinantes integración", "Dependen de canales voltaje"], correct: 2 },
        { id: 'b1_28', text: "Grupos sanguíneos incorrecto:", options: ["AB+ tiene enzimas A, B y H", "IgM sistema ABO", "Anticuerpos contra A/B no contra D", "Paciente AB- puede recibir O+", "Dos padres Rh+ pueden tener hijo Rh-"], correct: 3 },
        { id: 'b1_29', text: "Limitar neurotransmisión correcto:", options: ["Glutamato por transportador indolaminas", "Neuropéptidos degradados fosfatasas", "Aminas por COMT/MAO", "ACh por colinacetiltransferasa", "Noradrenalina recaptada presináptica"], correct: 4 },
        { id: 'b1_30', text: "Transmisión sináptica:", options: ["Neuropéptidos más rápidos", "Toxinas estimuladoras", "Activan receptores conexinas", "Potencial de reversión flujo neto", "Si abre Cl-, reversión coincide con Eq Cl-"], correct: 4 },
        { id: 'b1_31', text: "Contracción muscular:", options: ["Química contrae liso sin cambiar Vm", "Esquelético marcapasos", "Relajación acoplada a recaptación Ca++", "Esquelético excitador e inhibidor", "Hormonas relajan esquelético"], correct: 2 },
        { id: 'b1_32', text: "NT molécula pequeña incorrecto:", options: ["Dopamina, serotonina, histidina son catecolaminas", "ACh transporte activo vesícula", "Glutamato excitatorio", "ACh, dopamina... pequeña", "GABA inhibitorio"], correct: 0 },
        { id: 'b1_33', text: "Nutrición correcto:", options: ["Vitaminas esenciales", "Proteínas 300g/día", "Carbohidratos <20%", "Oleico esencial", "Recién nacido bajo requerimiento"], correct: 0 },
        { id: 'b1_34', text: "Eritrocitos:", options: ["HIF-1 mediador", "HbF menor afinidad", "Sin EPO apoptosis", "Ejercicio curva izquierda", "Hipoxia EPO hígado"], correct: 2 },
        { id: 'b1_35', text: "Integración sináptica:", options: ["IPSP no siempre hiperpolarizante", "Axodendrítica más relevante", "EPSP no siempre despolarizante", "Mayor constante tiempo menor sumación", "Si reversión bajo umbral es inhibidora"], correct: 0 },
        { id: 'b1_36', text: "Fuerza muscular:", options: ["Rápidas antes que lentas", "Regulación por reclutamiento y tasa disparo", "Isotónica longitud constante", "Mayor longitud sarcómero mayor tensión", "Isométrica precede"], correct: 1 },
        { id: 'b1_37', text: "Endocitosis:", options: ["Hierro degradado", "Mediada receptor inespecífica", "Constitutiva requiere señal", "Transcitosis misma región", "Pinocitosis inespecífica"], correct: 4 },
        { id: 'b1_38', text: "Receptores sensoriales:", options: ["Codificación intensidad...", "Tónico adaptación lenta", "Inhibición lateral aumenta discriminación", "Transducción convierte...", "Propioceptores externos"], correct: 1 },
        { id: 'b1_39', text: "Eficacia sináptica incorrecto:", options: ["Habituación decremento", "LTP tardía estructural", "LTD fosfatasas", "LTP temprana solo eficacia", "LTP respuesta a baja frecuencia"], correct: 4 },
        { id: 'b1_40', text: "Isoosmolar e Hipotónica:", options: ["75 NaCl + 150 KCl", "150 NaCl + 150 Urea", "75 NaCl + 75 KCl", "75 NaCl + 150 Benceno", "75 NaCl + 75 Benceno"], correct: 1 },
        { id: 'b1_41', text: "Segundo mensajero vía Gq:", options: ["Proteína G", "Diacilglicerol (DAG)", "Ligando", "PLC", "PKC"], correct: 1 },
        { id: 'b1_42', text: "Causa edema:", options: ["Hipoalbuminemia", "Aumento presión oncótica", "Disminución presión oncótica por proteína alta", "Disminución permeabilidad", "Aumento presión oncótica plasma"], correct: 0 },
        { id: 'b1_43', text: "Transporte membrana:", options: ["Na/K 3K dentro", "Receptor recicla", "Simporte contra gradiente ambos", "Insulina exocitosis glucosa", "Permeasas comunicación directa"], correct: 1 },
        { id: 'b1_44', text: "Velocidad PA:", options: ["Diámetro más relevante", "Menor diámetro mayor vel", "Mayor Rm mayor vel", "Mielina aumenta por bajar Cm y subir Rm", "Desmielinización disminuye"], correct: 3 },
        { id: 'b1_45', text: "Leucocitos incorrecto:", options: ["Basófilos histamina", "Plasmáticas anticuerpos", "Neutrófilos fagocitos", "Monocitos diapédesis", "Solo respuesta adquirida"], correct: 4 },
        { id: 'b1_46', text: "Cadherinas:", options: ["Unen células mismo tipo", "Uniones heterofílicas", "Funciones tróficas", "Facilitan movilidad", "Pérdida metástasis"], correct: 4 },
        { id: 'b1_47', text: "Sinergia citoquinas:", options: ["Mismo efecto 2 células", "Mismo efecto 1 célula", "Efectos suman", "Respuesta menor", "Respuesta mayor que suma"], correct: 4 },
        { id: 'b1_48', text: "Potencial reposo:", options: ["Salida Na+", "Permeabilidad relativa", "Independiente transporte activo", "Próximo a K+", "Depende Ca++"], correct: 3 },
        { id: 'b1_49', text: "Despolarización reposo:", options: ["Aumento permeabilidad Cl-", "Reducción permeabilidad Na+", "Aumento permeabilidad Ca++", "Reducción permeabilidad K+", "Nada"], correct: 2 },
        { id: 'b1_50', text: "Potencial electrotónico distancia:", options: ["Resistencia longitudinal", "Constante espacio (lambda)", "Resistencia membrana", "Capacitancia", "Densidad canales"], correct: 1 },
        { id: 'b1_51', text: "Sumación múltiples axones:", options: ["LTP", "Temporal", "Sensibilización", "Espacial", "Tétanos"], correct: 3 },
        { id: 'b1_52', text: "Gráfica PA Incorrecta:", options: ["Punto a gradiente Na", "Punto b salida K excede entrada Na", "Punto c K alejado eq", "Punto d canales K inactivos", "Punto e refractario"], correct: 1 },
        { id: 'b1_53', text: "Transporte hidroliza ATP:", options: ["Solo a favor", "Contra y a favor", "Canales ligando", "Proteínas membrana", "Pasivo"], correct: 3 },
        { id: 'b1_54', text: "Difusión facilitada:", options: ["Permeasas", "Canales", "A favor", "Velocidad lineal", "Solo iones"], correct: 2 },
        { id: 'b1_55', text: "Colesterol LDL incorrecta:", options: ["Endocitosis receptor", "Clatrina", "Unión a receptor", "Vesículas degradan en RE", "Receptores reciclan"], correct: 3 },
        { id: 'b1_56', text: "Receptores celulares:", options: ["Todos proteínas", "Solo algunos proteínas", "Todos actividad enzimática", "Solo algunos enzimática", "Todos membrana"], correct: 0 },
        { id: 'b1_57', text: "Señalización peptídica:", options: ["Mismo receptor todas", "Efectos distintos", "Más de una vía", "Solo tras atravesar", "Factor transcripción"], correct: 1 },
        { id: 'b1_58', text: "Receptores hormonales:", options: ["Menor afinidad", "Células vecinas", "Menos específicos", "Más rápida", "Activan simultáneamente distintos órganos"], correct: 4 },
        { id: 'b1_59', text: "Unión Miosina-Actina:", options: ["Baja Ca", "Fija ATP", "Hidroliza ATP", "Ca a troponina", "Tropomiosina libera sitio"], correct: 4 },
        { id: 'b1_60', text: "Músculo liso diferencia:", options: ["Ausencia sarcómeras", "Mayor velocidad", "Mayor consumo", "Menos resistente fatiga", "Mayor tubos T"], correct: 0 },
        { id: 'b1_61', text: "Contracción isométrica:", options: ["No consumo", "No acortamiento sarcómera", "Distienden elementos elásticos", "No acortamiento músculo", "No tensión"], correct: 3 },
        { id: 'b1_62', text: "Gradiente electroquímico:", options: ["Favorece activo", "Favorece iones canales", "Favorece permeasas", "Sumatorio", "Movimiento glucosa"], correct: 3 },
        { id: 'b1_63', text: "Transporte glucosa intestinal:", options: ["Primario", "Secundario simporte Na", "Secundario antiporte", "A favor", "Contra"], correct: 1 },
        { id: 'b1_64', text: "Fagocitosis:", options: ["Iones", "Glucosa", "Recicla", "Regula", "Destruir bacterias"], correct: 4 },
        { id: 'b1_65', text: "Receptores NT incorrecta:", options: ["Canales", "Proteína G", "Membrana plasmática", "Membrana nuclear", "Vesículas"], correct: 3 },
        { id: 'b1_66', text: "Integrinas:", options: ["NT", "Neurotrofinas", "Citoquinas", "Hormonas", "Adhesión"], correct: 4 },
        { id: 'b1_67', text: "Conexinas incorrecta:", options: ["Poros regulables", "Paso proteínas", "Acoplamiento eléctrico", "Solo neuronas", "Respuestas coordinadas"], correct: 3 },
        { id: 'b1_68', text: "Potencial equilibrio incorrecta:", options: ["Depende gradiente concentración", "Depende diferencia potencial", "Depende carga", "Varía si varían concentraciones", "Cero si iguales"], correct: 1 },
        { id: 'b1_69', text: "Vm más positivo que reposo:", options: ["Despolarizada", "Hiperpolarizada", "Acerca umbral", "Abre ACh", "Abre Na"], correct: 0 },
        { id: 'b1_70', text: "Potenciales locales incorrecta:", options: ["Cambios Vm", "Solo excitables", "Suman", "Son PA", "Respuesta corriente"], correct: 3 },
        { id: 'b1_71', text: "Canales K voltaje:", options: ["Respuesta NA", "Inactivan", "Fase hiperpolarizante", "Todos tipos", "Salida K"], correct: 2 },
        { id: 'b1_72', text: "Velocidad PA incorrecta:", options: ["Resistencia media", "Resistencia membrana", "Capacitancia", "Intensidad estímulo", "Aislamiento"], correct: 3 },
        { id: 'b1_73', text: "Na/K ATPasa:", options: ["Osmolaridad", "Isoosmótico", "Genera PA", "Electrotónicos", "Mueve cargas crea diferencia"], correct: 4 },
        { id: 'b1_74', text: "Cinética facilitada:", options: ["Lineal", "Lineal bajas", "Máxima saturantes", "Mayor conc menor vel", "Independiente"], correct: 2 },
        { id: 'b1_75', text: "Endocitosis receptor incorrecta:", options: ["Iones individualmente", "Macromoléculas", "Recicla", "Regula", "Hierro"], correct: 0 },
        { id: 'b1_76', text: "ACh incorrecta:", options: ["Sintetiza L-Dopa", "Vesículas", "Terminal", "Rotura enzimática", "Libera calcio"], correct: 0 },
        { id: 'b1_77', text: "Glutamato incorrecta:", options: ["Iono y Metabo", "Bloqueo Calcio", "Despolarizada aumenta", "AMPA/NMDA iono", "Entrada Glu"], correct: 1 },
        { id: 'b1_78', text: "Excitotoxicidad:", options: ["ACh", "Serotonina", "Glutamato", "GABA", "NA"], correct: 2 },
        { id: 'b1_79', text: "Hiperpolarización SNC:", options: ["GABA A", "Glicina", "AMPA", "Nicotínico", "Adrenérgico"], correct: 0 },
        { id: 'b1_80', text: "Inhibición MAO:", options: ["Aumento ACh", "Caída glicina", "Incremento catecolaminas", "Descenso endorfinas", "Despolarización"], correct: 2 },
        { id: 'b1_81', text: "Difusión simple:", options: ["Na", "CO2", "Galactosa", "Ca", "Glucosa"], correct: 1 },
        { id: 'b1_82', text: "Activo incorrecto:", options: ["Contra gradiente", "Desequilibrio", "Secundario hidrólisis propia", "Primario ATP directo", "Na/K 2K 3Na"], correct: 2 },
        { id: 'b1_83', text: "Facilitada:", options: ["Continuidad", "Satura", "Proteínas", "Lineal", "Energía"], correct: 1 },
        { id: 'b1_84', text: "Tonicidad:", options: ["No depende", "Concentración solutos", "Hipertónica hincha", "Hipotónica hincha", "Ideal hipotónica"], correct: 3 },
        { id: 'b1_85', text: "Proteínas transporte:", options: ["Canales", "Endocitosis", "Activo", "Permeasas", "Simple"], correct: 1 },
        { id: 'b1_86', text: "Permeabilidad reposo incorrecta:", options: ["Solo sodio", "Potasio y sodio", "Fuga Na menos K", "Influyen", "Bomba contribuye"], correct: 0 },
        { id: 'b1_87', text: "Conexinas:", options: ["Adhesión", "Canales intercelulares", "NT", "Hormonas", "Ligandos"], correct: 1 },
        { id: 'b1_88', text: "Sinapsis incorrecta:", options: ["Libera NT Ca", "Libera hormonas simpático", "NT receptores intracelulares", "Postsináptica G", "Postsináptica Ligando"], correct: 2 },
        { id: 'b1_89', text: "Excitadores:", options: ["ACh", "Glutamato", "Glicina", "GABA", "Ninguno"], correct: 1 },
        { id: 'b1_90', text: "Hematopoyesis incorrecta:", options: ["Todas dividen mitosis", "Hígado/Hueso", "EPO", "Megacariocito", "TPO"], correct: 0 },
        { id: 'b1_91', text: "Eritrocitos:", options: ["Multinucleadas", "Reservas", "Distribuyen O2", "Vida pocas horas", "Poco abundantes"], correct: 2 },
        { id: 'b1_92', text: "Transfusión AB:", options: ["A+", "O+", "AB+", "A-", "B-"], correct: 2 },
        { id: 'b1_93', text: "Plaquetas incorrecta:", options: ["Fragmentos", "Defensa extravasan", "Tapón", "Gránulos", "Uniones Gap"], correct: 1 },
        { id: 'b1_94', text: "Circulatorio:", options: ["Presión elevada arterias", "Favor presión", "Sistólica 60", "Diastólica 120", "Diámetro no afecta"], correct: 0 },
        { id: 'b1_95', text: "Capilares:", options: ["Fenestrados", "Endotelio SNC", "Sinusoides médula", "Starling", "Transcitosis"], correct: 3 }
    ];

    // --- BATERÍA 2 (42 Preguntas) ---
    const battery2 = [
        { id: 'b2_1', text: "Los sistemas de transporte pasivo:", options: ["Mueven iones en contra de gradiente", "Mueven iones a favor de gradiente", "Mueven moléculas no iónicas a favor de gradiente", "Mueven moléculas no iónicas en contra", "Mueven iones y otras moléculas tanto a favor como en contra"], correct: 2 },
        { id: 'b2_2', text: "Sistema de transporte con proteínas a favor de gradiente:", options: ["Difusión simple", "Difusión facilitada", "Difusión pasiva", "Velocidad constante", "Velocidad independiente"], correct: 1 },
        { id: 'b2_3', text: "Canales iónicos (señalar la incorrecta):", options: ["Mueven iones y solutos pequeños", "A favor de gradiente", "Formados por subunidades", "Solamente mueven iones de carga positiva", "Contribuyen al potencial"], correct: 3 },
        { id: 'b2_4', text: "Dos citoquinas actúan de forma sinérgica cuando:", options: ["Producida por célula diferente", "Efecto combinado mayor que suma individual", "Efectos contrarios", "Dianas diferentes", "Respuesta idéntica"], correct: 1 },
        { id: 'b2_5', text: "Si Eq K+ = -58mV y Vm = +58mV, el flujo neto de K+:", options: ["Interior hacia exterior", "Exterior hacia interior", "No flujo", "Mayor", "No afectado"], correct: 0 },
        { id: 'b2_6', text: "Estímulo subumbral positivo (10ms):", options: ["Proporcional siempre", "No proporcional inicio", "No varía", "Se despolariza", "Se hiperpolariza"], correct: 3 },
        { id: 'b2_7', text: "Potencial de acción (Incorrectas):", options: ["Misma duración", "Propaga todas direcciones", "Despolarización por Na+", "Invierte por entrada de K+", "Periodo refractario"], correct: 3 },
        { id: 'b2_8', text: "Sinapsis químicas llegada PA (Incorrectas):", options: ["Libera NT", "Despolariza presináptica", "Abre canales Ca++", "Libera calcio al exterior", "Facilita locales"], correct: 3 },
        { id: 'b2_9', text: "Comparación Nicotínicos/Muscarínicos (Incorrectas):", options: ["Nicotínicos más rápidos", "Ambos en placa motora", "Nico-Iono / Musc-Metabo", "Apertura canal", "Musc proteína G"], correct: 1 },
        { id: 'b2_10', text: "Noradrenalina (Incorrectas):", options: ["Derivado triptófano", "Sintetiza de dopamina", "Activa adrenérgicos", "Recaptación", "Neuronas posganglionares"], correct: 0 },
        { id: 'b2_11', text: "Receptores NMDA (Incorrectas):", options: ["Canales ligando", "Catiónicos", "Solo si despolarizada", "Induce potencial inhibitorio", "Inhiben glicina"], correct: 3 },
        { id: 'b2_12', text: "Neuropéptidos:", options: ["Lejos sitio liberación", "Baja afinidad", "Eliminan recaptación", "No dependiente Ca", "Coexistir con otros NT"], correct: 4 },
        { id: 'b2_13', text: "Difusión pasiva:", options: ["Cinética lineal", "Canales hidrofóbicos", "Proteínas transmembrana", "No selectivo (propiedades soluto)", "Filtro selectividad"], correct: 3 },
        { id: 'b2_14', text: "Receptores NT incorrecto:", options: ["NMDA voltaje/ligando", "Serotonina autorreceptores", "Glicinérgicos metabotrópicos", "ACh musc/nico", "Glutamato iono/metabo"], correct: 2 },
        { id: 'b2_15', text: "Síntesis NT correcto:", options: ["AChe precursora", "Noradrenalina precursora dopa", "Histidina precursora", "GABA precursor Glu", "DOPA precursora dopamina"], correct: 4 },
        { id: 'b2_16', text: "Eicosanoides:", options: ["Derivados ác araquidónico", "Paracrina", "Proteínas", "Uniones directas", "Neurotrofinas"], correct: 0 },
        { id: 'b2_17', text: "Hematopoyesis:", options: ["Gran progenie", "Solo mieloide", "Hígado adulto", "Escasa regeneración", "Gran capacidad proliferativa"], correct: 4 },
        { id: 'b2_18', text: "Incorrecta coagulación:", options: ["Plaquetas imprescindibles", "tPA necesario", "Trombomodulina necesaria", "Factor tisular activa", "Endotelio limita"], correct: 0 },
        { id: 'b2_19', text: "Cadherinas:", options: ["Células inmunes", "Señalización supervivencia", "Señalización contacto", "Presinápticas", "Inflamatoria"], correct: 2 },
        { id: 'b2_20', text: "S-nitrosilación incorrecta:", options: ["Activa GC", "Modifica tioles", "Modifica grupos hemo", "Reversible", "Regula enzimas"], correct: 2 },
        { id: 'b2_21', text: "Plaquetas no actúan:", options: ["Hemostasia", "Activación", "Coagulación", "Vasodilatación", "Retracción"], correct: 3 },
        { id: 'b2_22', text: "Potencial reposo:", options: ["Canales ligando", "Eflujo continuo K influjo Na", "Solo excitables", "Eq cero", "Solo Na sería -80"], correct: 1 },
        { id: 'b2_23', text: "Propiedades pasivas:", options: ["No afecta vel", "Amplitud/propagación espacial", "Atenuación", "Integración", "Canales voltaje"], correct: 2 },
        { id: 'b2_24', text: "Grupos sanguíneos incorrecto:", options: ["AB+", "IgM", "Anti A/B naturales", "AB- recibe O+", "Padres Rh+ hijo Rh-"], correct: 3 },
        { id: 'b2_25', text: "Limitar transmisión correcto:", options: ["Glu indoles", "Peptidos fosfatasas", "Aminas COMT", "ACh colinacetil", "Noradrenalina transportador"], correct: 4 },
        { id: 'b2_26', text: "Transmisión sináptica:", options: ["Peptidos rápidos", "Toxinas estimulan", "Conexinas", "Reversión flujo neto", "Si Cl-, reversión = Eq Cl-"], correct: 4 },
        { id: 'b2_27', text: "Contracción muscular:", options: ["Química liso", "Marcapasos esq", "Relajación recaptación Ca", "Esq inhibidor", "Hormonas relajan esq"], correct: 2 },
        { id: 'b2_28', text: "NT pequeña incorrecto:", options: ["Serotonina catecolamina", "ACh activo", "Glu excitador", "ACh pequeña", "GABA inhibidor"], correct: 0 },
        { id: 'b2_29', text: "Nutrición correcto:", options: ["Vitaminas esenciales", "Prot 300g", "Carb 20%", "Oleico esencial", "Bebé bajo"], correct: 0 },
        { id: 'b2_30', text: "Eritrocitos:", options: ["HIF-1", "HbF", "Apoptosis sin EPO", "Curva izq ejercicio", "EPO hígado"], correct: 2 },
        { id: 'b2_31', text: "Integración sináptica:", options: ["IPSP hiperpolarizante", "Axodendrítica", "EPSP despolarizante", "Constante tiempo sumación", "Reversión bajo umbral inhibidora"], correct: 4 },
        { id: 'b2_32', text: "Fuerza muscular:", options: ["Rápidas antes", "Reclutamiento", "Isotónica longitud cte", "Longitud/Tensión", "Isométrica precede"], correct: 1 },
        { id: 'b2_33', text: "Endocitosis:", options: ["Hierro", "Receptor inespecífico", "Constitutiva", "Transcitosis", "Pinocitosis inespecífica"], correct: 4 },
        { id: 'b2_34', text: "Estímulos sensoriales:", options: ["Codificación", "Tónico lenta", "Inhibición lat", "Transducción", "Propioceptores"], correct: 1 },
        { id: 'b2_35', text: "Eficacia sináptica incorrecto:", options: ["Habituación", "LTP tardía", "LTD", "LTP temprana", "LTP baja frecuencia"], correct: 4 },
        { id: 'b2_36', text: "Isoosmolar e Hipotónica:", options: ["NaCl+KCl", "NaCl+Urea", "NaCl+KCl", "75NaCl + 150 Benceno", "NaCl+Benceno"], correct: 3 },
        { id: 'b2_37', text: "Segundo mensajero vía Gq:", options: ["G", "DAG", "Ligando", "PLC", "PKC"], correct: 1 },
        { id: 'b2_38', text: "Edema:", options: ["Hipoalbuminemia", "Aumento oncótica", "Disminución oncótica prot", "Disminución perm", "Aumento oncótica"], correct: 0 },
        { id: 'b2_39', text: "Transporte:", options: ["Na/K", "Recicla", "Simporte", "Insulina", "Permeasas"], correct: 1 },
        { id: 'b2_40', text: "Velocidad PA:", options: ["Diámetro", "Menor diám", "Mayor Rm", "Mielina (baja Cm sube Rm)", "Desmielinización"], correct: 3 },
        { id: 'b2_41', text: "Sinergia:", options: ["Idéntico", "Bloquea", "Diferente", "Mayor que separado", "Distintas células"], correct: 3 },
        { id: 'b2_42', text: "Leucocitos incorrecto:", options: ["Basófilos", "Plasmáticas", "Neutrófilos", "Monocitos", "Solo adquirida"], correct: 4 }
    ];

    // --- BATERÍA 3 (95 Preguntas) ---
    const battery3 = [
        { id: 'b3_1', text: "La velocidad de propagación de los potenciales de acción se incrementa:", options: ["Al aumentar el diámetro del axón", "Al aumentar la capacitancia de membrana (Cm)", "Al reducir la resistencia de membrana (Rm)", "Al aumentar la resistencia interna o axial (ri)", "Al mielinizar el axón"], correct: 4 },
        { id: 'b3_2', text: "Respecto a la sinapsis química:", options: ["Están formadas por conexones", "Las SNARE, SNAP y NSF son proteínas del elemento presináptico", "Transmiten información más rápidamente que las eléctricas", "El aumento de calcio induce la liberación de NT", "Facilitan el acoplamiento eléctrico"], correct: 3 },
        { id: 'b3_3', text: "Receptores colinérgicos (incorrecta):", options: ["Nicotínicos más rápida", "Ambos en fibras musculares esqueléticas", "Nicotínicos ionotrópicos", "ACh abre canal", "Muscarínicos proteína G"], correct: 1 },
        { id: 'b3_4', text: "Noradrenalina (incorrecta):", options: ["Derivado triptófano", "Sintetiza de dopamina", "Activa beta-adrenérgicos", "Recaptación", "Neuronas posganglionares"], correct: 0 },
        { id: 'b3_5', text: "Receptores NMDA (incorrecta):", options: ["Canales ligando", "Catiónicos", "Solo despolarizada", "Induce potencial inhibidor", "Inactivan por glicina"], correct: 3 },
        { id: 'b3_6', text: "Neuropéptidos:", options: ["Lejos sitio liberación", "Baja afinidad", "Recaptación", "No dependiente Ca", "Coexistir con otros NT"], correct: 4 },
        { id: 'b3_7', text: "Inhibición lateral:", options: ["Reduce umbral", "Aumenta umbral", "Reduce adaptación", "Aumenta discriminación espacial", "Reduce amplitud"], correct: 3 },
        { id: 'b3_8', text: "Aprendizaje y memoria:", options: ["Propiedades pasivas", "Muerte neuronal", "Modificaciones eficacia sináptica", "Velocidad conducción", "Nada"], correct: 2 },
        { id: 'b3_9', text: "Transporte pasivo:", options: ["Contra gradiente", "A favor gradiente", "No iónicas a favor", "No iónicas contra", "Iones a favor o contra"], correct: 1 },
        { id: 'b3_10', text: "Transporte proteínas a favor:", options: ["Simple", "Facilitada", "Pasiva", "Velocidad constante", "Independiente"], correct: 1 },
        { id: 'b3_11', text: "Canales iónicos (incorrecta):", options: ["Pequeño tamaño", "A favor", "Subunidades", "Solo carga positiva", "Contribuyen potencial"], correct: 3 },
        { id: 'b3_12', text: "Sinergia citoquinas:", options: ["Célula diferente", "Efecto mayor que suma", "Contrarios", "Dianas diferentes", "Respuesta idéntica"], correct: 1 },
        { id: 'b3_13', text: "Eq K+ -58mV y Vm +58mV:", options: ["Interior a exterior", "Exterior a interior", "No flujo", "Mayor", "No afectado"], correct: 0 },
        { id: 'b3_14', text: "Estímulo positivo subumbral:", options: ["Proporcional", "No proporcional", "No varía", "Despolariza", "Hiperpolariza"], correct: 3 },
        { id: 'b3_15', text: "Potencial acción (incorrecta):", options: ["Misma duración", "Todas direcciones", "Despolarización Na", "Invierte entrada K", "Refractario"], correct: 3 },
        { id: 'b3_16', text: "Sinapsis química (incorrecta):", options: ["Libera NT", "Despolariza", "Abre Ca", "Libera Ca exterior", "Potenciales locales"], correct: 3 },
        { id: 'b3_17', text: "Difusión pasiva:", options: ["Lineal", "Canales", "Proteínas", "No selectivo", "Selectivo"], correct: 3 },
        { id: 'b3_18', text: "Receptores NT (incorrecta):", options: ["NMDA voltaje", "Serotonina auto", "Glicinérgicos metabo", "ACh musc/nico", "Glu iono/metabo"], correct: 2 },
        { id: 'b3_19', text: "Síntesis NT:", options: ["AChe precursora", "Noradrenalina de dopamina", "Histidina trans", "GABA de Glu", "DOPA de dopamina"], correct: 4 },
        { id: 'b3_20', text: "Eicosanoides:", options: ["Derivados araquidónico", "Paracrina", "Proteínas", "Uniones directas", "Neurotrofinas"], correct: 0 },
        { id: 'b3_21', text: "Hematopoyesis:", options: ["Gran progenie", "Solo mieloide", "Hígado adulto", "Escasa regeneración", "Gran capacidad"], correct: 0 },
        { id: 'b3_22', text: "Coagulación (incorrecta):", options: ["Plaquetas imprescindibles", "tPA", "Trombomodulina", "Factor tisular", "Endotelio"], correct: 0 },
        { id: 'b3_23', text: "Cadherinas:", options: ["Inmune", "Supervivencia", "Contacto", "Presinápticas", "Inflamatoria"], correct: 2 },
        { id: 'b3_24', text: "S-nitrosilación (incorrecta):", options: ["Activa GC", "Tioles", "Hemo", "Reversible", "Regula enzimas"], correct: 2 },
        { id: 'b3_25', text: "Plaquetas no actúan:", options: ["Hemostasia", "Activación", "Coagulación", "Vasodilatación", "Retracción"], correct: 3 },
        { id: 'b3_26', text: "Potencial reposo:", options: ["Canales ligando", "Eflujo K influjo Na", "Solo excitables", "Eq cero", "Solo Na -80"], correct: 1 },
        { id: 'b3_27', text: "Propiedades pasivas:", options: ["No afecta vel", "Amplitud/propagación", "Atenuación", "Integración", "Canales voltaje"], correct: 2 },
        { id: 'b3_28', text: "Grupos sanguíneos (incorrecta):", options: ["AB+", "IgM", "Anti A/B", "AB- recibe O+", "Padres Rh+ hijo Rh-"], correct: 3 },
        { id: 'b3_29', text: "Limitar NT:", options: ["Glu indoles", "Peptidos fosfatasas", "Aminas COMT", "ACh colinacetil", "Noradrenalina transportador"], correct: 4 },
        { id: 'b3_30', text: "Transmisión sináptica:", options: ["Peptidos rápidos", "Toxinas estimulan", "Conexinas", "Reversión flujo neto", "Si Cl reversión Eq"], correct: 4 },
        { id: 'b3_31', text: "Contracción muscular:", options: ["Química liso", "Marcapasos", "Relajación recaptación", "Esq inhibidor", "Hormonas relajan"], correct: 2 },
        { id: 'b3_32', text: "NT pequeña (incorrecta):", options: ["Serotonina catecolamina", "ACh activo", "Glu excitador", "ACh pequeña", "GABA inhibidor"], correct: 0 },
        { id: 'b3_33', text: "Nutrición:", options: ["Vitaminas", "Prot 300g", "Carb 20%", "Oleico", "Bebé bajo"], correct: 0 },
        { id: 'b3_34', text: "Eritrocitos:", options: ["HIF-1", "HbF", "Apoptosis sin EPO", "Curva izq", "EPO hígado"], correct: 2 },
        { id: 'b3_35', text: "Integración sináptica:", options: ["IPSP hiperpolarizante", "Axodendrítica", "EPSP despolarizante", "Constante tiempo", "Reversión bajo umbral inhibidora"], correct: 0 },
        { id: 'b3_36', text: "Fuerza muscular:", options: ["Rápidas antes", "Reclutamiento", "Isotónica cte", "Longitud", "Isométrica precede"], correct: 1 },
        { id: 'b3_37', text: "Endocitosis:", options: ["Hierro", "Inespecífico", "Constitutiva", "Transcitosis", "Pinocitosis inespecífica"], correct: 4 },
        { id: 'b3_38', text: "Estímulos:", options: ["Codificación", "Tónico lenta", "Inhibición lat", "Transducción", "Propioceptores"], correct: 1 },
        { id: 'b3_39', text: "Eficacia sináptica (incorrecta):", options: ["Habituación", "LTP tardía", "LTD", "LTP temprana", "LTP baja frecuencia"], correct: 4 },
        { id: 'b3_40', text: "Isoosmolar e Hipotónica:", options: ["NaCl+KCl", "NaCl+Urea", "NaCl+KCl", "NaCl+Benceno", "NaCl+Benceno"], correct: 1 },
        { id: 'b3_41', text: "Segundo mensajero Gq:", options: ["G", "DAG", "Ligando", "PLC", "PKC"], correct: 1 },
        { id: 'b3_42', text: "Edema:", options: ["Hipoalbuminemia", "Aumento oncótica", "Disminución oncótica prot", "Disminución perm", "Aumento oncótica"], correct: 0 },
        { id: 'b3_43', text: "Transporte:", options: ["Na/K", "Recicla", "Simporte", "Insulina", "Permeasas"], correct: 1 },
        { id: 'b3_44', text: "Velocidad PA:", options: ["Diámetro", "Menor diám", "Mayor Rm", "Mielina", "Desmielinización"], correct: 3 },
        { id: 'b3_45', text: "Leucocitos (incorrecta):", options: ["Basófilos", "Plasmáticas", "Neutrófilos", "Monocitos", "Solo adquirida"], correct: 4 },
        { id: 'b3_46', text: "Cadherinas:", options: ["Mismo tipo", "Heterofílicas", "Tróficas", "Movilidad", "Metástasis"], correct: 4 },
        { id: 'b3_47', text: "Sinergia:", options: ["Mismo efecto", "Mismo tipo", "Suman", "Menor", "Mayor que suma"], correct: 4 },
        { id: 'b3_48', text: "Potencial reposo:", options: ["Salida Na", "Permeabilidad", "Independiente", "Próximo K", "Gradientes"], correct: 3 },
        { id: 'b3_49', text: "Despolarización:", options: ["Aumento Cl", "Reducción Na", "Aumento Ca", "Reducción K", "Nada"], correct: 2 },
        { id: 'b3_50', text: "Electrotónico:", options: ["Longitudinal", "Lambda", "Rm", "Cm", "Densidad"], correct: 1 },
        { id: 'b3_51', text: "Sumación múltiples:", options: ["LTP", "Temporal", "Sensibilización", "Espacial", "Tétanos"], correct: 3 },
        { id: 'b3_52', text: "Gráfica PA (incorrecta):", options: ["Punto a", "Punto b salida K excede", "Punto c", "Punto d", "Punto e"], correct: 1 },
        { id: 'b3_53', text: "Hidroliza ATP:", options: ["Solo favor", "Contra/Favor", "Canales", "Proteínas", "Pasivo"], correct: 3 },
        { id: 'b3_54', text: "Facilitada:", options: ["Permeasas", "Canales", "Favor", "Lineal", "Iones"], correct: 2 },
        { id: 'b3_55', text: "Colesterol (incorrecta):", options: ["Endocitosis", "Clatrina", "Unión", "Degradan RE", "Reciclan"], correct: 3 },
        { id: 'b3_56', text: "Receptores:", options: ["Todos proteínas", "Algunos", "Todos enzima", "Algunos enzima", "Todos membrana"], correct: 0 },
        { id: 'b3_57', text: "Peptídica:", options: ["Mismo receptor", "Efectos distintos", "Más de una", "Atravesar", "Transcripción"], correct: 1 },
        { id: 'b3_58', text: "Hormonales:", options: ["Menor afinidad", "Vecinas", "Menos específicos", "Rápida", "Simultáneamente"], correct: 4 },
        { id: 'b3_59', text: "Miosina-Actina:", options: ["Baja Ca", "Fija ATP", "Hidroliza ATP", "Ca Troponina", "Tropomiosina libera"], correct: 4 },
        { id: 'b3_60', text: "Liso:", options: ["Ausencia sarcómeras", "Velocidad", "Consumo", "Fatiga", "Tubos T"], correct: 0 },
        { id: 'b3_61', text: "Isométrica:", options: ["No consumo", "No acortamiento sarcómera", "Distienden elásticos", "No acortamiento músculo", "No tensión"], correct: 3 },
        { id: 'b3_62', text: "Gradiente electroquímico:", options: ["Activo", "Iones canales", "Permeasas", "Sumatorio", "Glucosa"], correct: 3 },
        { id: 'b3_63', text: "Glucosa intestinal:", options: ["Primario", "Simporte Na", "Antiporte", "Favor", "Contra"], correct: 1 },
        { id: 'b3_64', text: "Fagocitosis:", options: ["Iones", "Glucosa", "Recicla", "Regula", "Bacterias"], correct: 4 },
        { id: 'b3_65', text: "Receptores NT (incorrecta):", options: ["Canales", "G", "Membrana", "Nuclear", "Vesículas"], correct: 3 },
        { id: 'b3_66', text: "Integrinas:", options: ["NT", "Neurotrofinas", "Citoquinas", "Hormonas", "Adhesión"], correct: 4 },
        { id: 'b3_67', text: "Conexinas (incorrecta):", options: ["Poros", "Proteínas", "Acoplamiento", "Solo neuronas", "Coordinadas"], correct: 3 },
        { id: 'b3_68', text: "Potencial equilibrio (incorrecta):", options: ["Conc", "Diferencia potencial", "Carga", "Varía conc", "Cero iguales"], correct: 1 },
        { id: 'b3_69', text: "Vm positivo:", options: ["Despolarizada", "Hiperpolarizada", "Umbral", "ACh", "Na"], correct: 0 },
        { id: 'b3_70', text: "Locales (incorrecta):", options: ["Cambios", "Excitables", "Suman", "Son PA", "Corriente"], correct: 3 },
        { id: 'b3_71', text: "Canales K:", options: ["NA", "Inactivan", "Hiperpolarizante", "Todos", "Salida K"], correct: 2 },
        { id: 'b3_72', text: "Velocidad PA (incorrecta):", options: ["Axial", "Rm", "Cm", "Intensidad", "Aislamiento"], correct: 3 },
        { id: 'b3_73', text: "Na/K ATPasa:", options: ["Osmolaridad", "Isoosmótico", "PA", "Electrotónicos", "Cargas"], correct: 4 },
        { id: 'b3_74', text: "Facilitada:", options: ["Lineal", "Bajas", "Saturantes", "Mayor menor", "Independiente"], correct: 2 },
        { id: 'b3_75', text: "Endocitosis (incorrecta):", options: ["Iones", "Macro", "Recicla", "Regula", "Hierro"], correct: 0 },
        { id: 'b3_76', text: "ACh (incorrecta):", options: ["L-Dopa", "Vesículas", "Terminal", "Rotura", "Ca"], correct: 0 },
        { id: 'b3_77', text: "Glu (incorrecta):", options: ["Tipos", "Bloqueo Ca", "Despolarizada", "Iono", "Entrada"], correct: 1 },
        { id: 'b3_78', text: "Excitotoxicidad:", options: ["ACh", "Serotonina", "Glu", "GABA", "NA"], correct: 2 },
        { id: 'b3_79', text: "Hiperpolariza:", options: ["GABA A", "Glicina", "AMPA", "Nicotínico", "Adrenérgico"], correct: 0 },
        { id: 'b3_80', text: "MAO:", options: ["ACh", "Glicina", "Catecolaminas", "Endorfinas", "Despolarización"], correct: 2 },
        { id: 'b3_81', text: "Simple:", options: ["Na", "CO2", "Galactosa", "Ca", "Glucosa"], correct: 1 },
        { id: 'b3_82', text: "Activo (incorrecto):", options: ["Contra", "Desequilibrio", "Secundario hidrólisis propia", "Primario", "Na/K"], correct: 2 },
        { id: 'b3_83', text: "Facilitada:", options: ["Continuidad", "Satura", "Proteínas", "Lineal", "Energía"], correct: 1 },
        { id: 'b3_84', text: "Tonicidad:", options: ["No depende", "Concentración", "Hiper", "Hipo", "Ideal"], correct: 3 },
        { id: 'b3_85', text: "Proteínas:", options: ["Canales", "Endocitosis", "Activo", "Permeasas", "Simple"], correct: 1 },
        { id: 'b3_86', text: "Permeabilidad (incorrecta):", options: ["Solo Na", "K y Na", "Fuga", "Influyen", "Bomba"], correct: 0 },
        { id: 'b3_87', text: "Conexinas:", options: ["Adhesión", "Canales", "NT", "Hormonas", "Ligandos"], correct: 1 },
        { id: 'b3_88', text: "Sinapsis (incorrecta):", options: ["Ca", "Hormonas", "Intracelulares", "G", "Ligando"], correct: 2 },
        { id: 'b3_89', text: "Excitador:", options: ["ACh", "Glu", "Glicina", "GABA", "Ninguno"], correct: 1 },
        { id: 'b3_90', text: "Hematopoyesis (incorrecta):", options: ["Mitosis", "Hígado", "EPO", "Megacariocito", "TPO"], correct: 0 },
        { id: 'b3_91', text: "Eritrocitos:", options: ["Multi", "Reservas", "O2", "Horas", "Pocos"], correct: 2 },
        { id: 'b3_92', text: "Transfusión AB:", options: ["A", "O", "AB", "A-", "B-"], correct: 2 },
        { id: 'b3_93', text: "Plaquetas (incorrecta):", options: ["Fragmentos", "Defensa", "Tapón", "Gránulos", "Gap"], correct: 1 },
        { id: 'b3_94', text: "Circulatorio:", options: ["Arterias", "Presión", "60", "120", "Diámetro"], correct: 0 },
        { id: 'b3_95', text: "Capilares:", options: ["Fenestrados", "SNC", "Sinusoides", "Starling", "Transcitosis"], correct: 3 }
    ];

    // --- BATERÍA 6 (BIOQUÍMICA - CORREGIDA Y DESDOBLADA) ---
    const battery6 = [
        { id: 'b6_1a', text: "Respecto a la coenzima tetrahidrobiopterina (BH4), señale la INCORRECTA:", options: ["Se sintetiza a partir de GTP", "Al oxidarse se convierte en dihidrobiopterina", "Es coenzima de las descarboxilasas de aminoácidos aromáticos", "Primera enzima es ciclohidrolasa 1"], correct: 2 },
        { id: 'b6_1b', text: "La tetrahidrobiopterina (BH4) es coenzima esencial para:", options: ["Las hidroxilasas de aminoácidos aromáticos", "Las descarboxilasas", "Las transaminasas", "Las quinasas"], correct: 0 },
        
        { id: 'b6_2a', text: "Enzima que requiere BH4 para la síntesis de catecolaminas:", options: ["Dopamina beta-hidroxilasa", "Tirosina hidroxilasa", "DOPA descarboxilasa", "FNMT"], correct: 1 },
        { id: 'b6_2b', text: "Enzima que requiere BH4 para la síntesis de serotonina:", options: ["Triptófano hidroxilasa", "5-HT descarboxilasa", "MAO", "COMT"], correct: 0 },

        { id: 'b6_3a', text: "Enzima que cataliza L-DOPA a Dopamina:", options: ["DOPA descarboxilasa", "Tirosina hidroxilasa", "Dopamina beta-hidroxilasa", "FNMT"], correct: 0 },
        { id: 'b6_3b', text: "Enzima limitante en la síntesis de catecolaminas:", options: ["Tirosina hidroxilasa", "DOPA descarboxilasa", "Dopamina beta-hidroxilasa", "MAO"], correct: 0 },

        { id: 'b6_4a', text: "Producto de degradación de serotonina:", options: ["Ácido 5-hidroxiindolacético (5-HIAA)", "Ácido homovanílico", "Ácido vanilmandélico", "Metanefrina"], correct: 0 },
        { id: 'b6_4b', text: "Producto final de degradación de noradrenalina/adrenalina:", options: ["Ácido vanilmandélico (VMA)", "Homovanílico", "5-HIAA", "DOPAC"], correct: 0 },

        { id: 'b6_5', text: "Enzima que convierte Tirosina a L-DOPA:", options: ["Tirosina Hidroxilasa", "DOPA descarboxilasa", "Tirosina descarboxilasa", "Fenilalanina hidroxilasa"], correct: 0 },

        { id: 'b6_6', text: "Producto de la acción de GABA-transaminasa sobre GABA:", options: ["Semialdehído succínico", "Succinato", "Glutamato", "Glutamina"], correct: 0 },
        
        { id: 'b6_7', text: "Enzima clave en la degradación de GABA:", options: ["GABA transaminasa (GABA-T)", "GAD", "GABA oxidasa", "Glutamato deshidrogenasa"], correct: 0 },

        { id: 'b6_8a', text: "Sustrato principal para síntesis de Glutamato (ciclo con glía):", options: ["Glutamina", "Aspartato", "Glicina", "Serina"], correct: 0 },
        { id: 'b6_8b', text: "Sustrato principal para síntesis de Glutamato (desde Krebs):", options: ["Alfa-cetoglutarato", "Succinato", "Oxalacetato", "Fumarato"], correct: 0 },

        { id: 'b6_10', text: "Enzima que forma Dopamina directamente:", options: ["L-DOPA descarboxilasa", "Tirosina hidroxilasa", "DBH", "PNMT"], correct: 0 },

        { id: 'b6_11', text: "El ácido homovanílico (HVA) procede de la degradación de:", options: ["Dopamina", "Noradrenalina", "Serotonina", "Acetilcolina"], correct: 0 },

        { id: 'b6_12', text: "Enzima que sintetiza Acetilcolina:", options: ["Colina acetiltransferasa (ChAT)", "Acetilcolinesterasa", "Colina quinasa", "Acetil CoA sintetasa"], correct: 0 },

        { id: 'b6_13', text: "Enzima que degrada Acetilcolina:", options: ["Acetilcolinesterasa", "ChAT", "MAO", "COMT"], correct: 0 },

        { id: 'b6_14', text: "Precursor de Serotonina:", options: ["Triptófano", "Tirosina", "Fenilalanina", "Histidina"], correct: 0 },

        { id: 'b6_15', text: "Degradación de serotonina implica:", options: ["Desaminación oxidativa (MAO)", "Hidroxilación", "Reducción", "Metilación"], correct: 0 },

        { id: 'b6_16', text: "Subunidad G-alpha-i:", options: ["Inhibe adenilato ciclasa", "Activa fosfolipasa C", "Aumenta AMPc", "Cierra canales K+"], correct: 0 },

        { id: 'b6_17', text: "Enzima que NO degrada aminas biógenas:", options: ["GABA-transaminasa", "MAO", "COMT", "Histamina N-metiltransferasa"], correct: 0 },

        { id: 'b6_19', text: "Precursor de Glicina:", options: ["Serina", "Glutamato", "Triptófano", "Tirosina"], correct: 0 },

        { id: 'b6_20', text: "Neurotransmisor excitatorio:", options: ["Glutamato", "GABA", "Glicina", "Taurina"], correct: 0 }
    ];

    // ==========================================
    // LÓGICA
    // ==========================================

    let currentQuestions = [];
    let userAnswers = {};
    let markedQuestions = new Set();
    let currentBatteryMode = 'all';

    function selectBattery(mode) {
        currentBatteryMode = mode;
        
        if (mode === 'exam') {
            startQuiz('random');
        } else {
            document.getElementById('order-options').style.display = 'block';
            document.getElementById('order-options').scrollIntoView({ behavior: 'smooth' });
        }
    }

    function startQuiz(orderMode) {
        userAnswers = {};
        markedQuestions.clear();
        let rawSet = [];

        if (currentBatteryMode === 'b3_opt') rawSet = [...battery3_optimized];
        // Aquí puedes añadir lógica para otras baterías si las incluyeras en el futuro
        // else if (currentBatteryMode === 'b1') rawSet = [...battery1];
        else rawSet = [...battery3_optimized]; // Por defecto usa la optimizada si se selecciona 'exam' sin otras

        // Si tuviéramos todas las baterías cargadas, concatenaríamos aquí
        // rawSet = [...battery1, ...battery2, ...battery3_optimized, ...battery4, ...battery5, ...battery6];

        if (currentBatteryMode === 'exam') {
            rawSet.sort(() => Math.random() - 0.5);
            currentQuestions = rawSet.slice(0, 20);
        } else {
            currentQuestions = rawSet;
            if (orderMode === 'random') {
                currentQuestions.sort(() => Math.random() - 0.5);
            }
        }

        loadQuestions();
        
        document.getElementById('start-screen').classList.remove('active');
        document.getElementById('results-screen').classList.remove('active');
        document.getElementById('quiz-screen').classList.add('active');
    }

    function loadQuestions() {
        const container = document.getElementById('questions-list');
        const navGrid = document.getElementById('nav-grid');
        const sidebarTitle = document.getElementById('sidebar-title');
        
        container.innerHTML = '';
        navGrid.innerHTML = '';
        sidebarTitle.innerText = `Preguntas: ${currentQuestions.length}`;

        currentQuestions.forEach((q, index) => {
            const displayIndex = index + 1;
            
            const div = document.createElement('div');
            div.className = 'question-container';
            div.id = `q-${index}`; 
            
            let optionIndices = q.options.map((_, i) => i);
            optionIndices.sort(() => Math.random() - 0.5);

            div.innerHTML = `
                <div class="question-header">
                    <span class="question-text">${displayIndex}. ${q.text}</span>
                    <span class="mark-check" onclick="toggleMark(${index})" id="mark-${index}" title="Marcar para revisar">★</span>
                </div>
                <div class="options-grid">
                    ${optionIndices.map(optIdx => `
                        <div class="option" onclick="selectAnswer(${index}, ${optIdx}, this, ${q.correct})">
                            ${q.options[optIdx]}
                        </div>
                    `).join('')}
                </div>
                <div class="feedback" id="feedback-${index}"></div>
            `;
            container.appendChild(div);

            const navBtn = document.createElement('button');
            navBtn.className = 'nav-btn';
            navBtn.innerText = displayIndex;
            navBtn.id = `nav-${index}`;
            navBtn.onclick = () => document.getElementById(`q-${index}`).scrollIntoView({ behavior: 'smooth', block: 'center' });
            navGrid.appendChild(navBtn);
        });
    }

    function selectAnswer(index, selectedOptIdx, optionElem, correctOptIdx) {
        if (userAnswers[index]) return;

        const q = currentQuestions[index];
        const isCorrect = selectedOptIdx === correctOptIdx;
        userAnswers[index] = { selectedOption: selectedOptIdx, isCorrect: isCorrect };

        const parent = optionElem.parentNode;
        const options = parent.getElementsByClassName('option');
        
        for(let opt of options) {
            opt.classList.add('disabled');
            if (opt.innerText.trim() === q.options[correctOptIdx].trim()) {
                opt.classList.add('correct');
            }
        }

        if (!isCorrect) optionElem.classList.add('incorrect');

        const feedbackEl = document.getElementById(`feedback-${index}`);
        feedbackEl.style.display = 'block';
        feedbackEl.innerHTML = `<strong>${isCorrect ? '¡Correcto!' : 'Respuesta Incorrecta'}</strong><br>${q.explanation || ''}`;
        feedbackEl.classList.add(isCorrect ? 'success' : 'error');

        document.getElementById(`nav-${index}`).classList.add(isCorrect ? 'correct' : 'incorrect');
    }

    function toggleMark(index) {
        if (markedQuestions.has(index)) {
            markedQuestions.delete(index);
            document.getElementById(`mark-${index}`).classList.remove('marked');
            document.getElementById(`nav-${index}`).classList.remove('marked');
        } else {
            markedQuestions.add(index);
            document.getElementById(`mark-${index}`).classList.add('marked');
            document.getElementById(`nav-${index}`).classList.add('marked');
        }
    }

    function finishQuiz() {
        const total = currentQuestions.length;
        const correct = Object.values(userAnswers).filter(a => a.isCorrect).length;
        const score = total > 0 ? ((correct / total) * 10).toFixed(1) : 0;

        document.getElementById('score-display').innerText = `Nota: ${score} / 10`;
        document.getElementById('stats-display').innerText = `Aciertos: ${correct} / ${total}`;
        
        document.getElementById('quiz-screen').classList.remove('active');
        document.getElementById('results-screen').classList.add('active');
    }

    function resetQuiz(criteria) {
        let nextIndices = [];
        if (criteria === 'all') {
            startQuiz(currentMode === 'exam' ? 'exam' : 'ordered');
            return;
        }
        
        if (criteria === 'failed') {
            nextIndices = currentQuestions.map((q, i) => i).filter(i => userAnswers[i] && !userAnswers[i].isCorrect);
        } else if (criteria === 'marked') {
            nextIndices = Array.from(markedQuestions);
        } else if (criteria === 'failed_marked') {
            nextIndices = currentQuestions.map((q, i) => i).filter(i => 
                (userAnswers[i] && !userAnswers[i].isCorrect) || markedQuestions.has(i)
            );
        }

        if (nextIndices.length === 0) {
            alert("No hay preguntas para ese criterio.");
            return;
        }

        // Reconstruir el subset
        let subsetQuestions = nextIndices.map(i => currentQuestions[i]);
        
        userAnswers = {};
        markedQuestions.clear(); // Opcional: limpiar marcas al reintentar
        
        currentQuestions = subsetQuestions;
        currentQuestions.sort(() => Math.random() - 0.5);

        loadQuestions();
        document.getElementById('results-screen').classList.remove('active');
        document.getElementById('quiz-screen').classList.add('active');
    }
</script>
</body>
</html>
