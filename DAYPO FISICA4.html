<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Ondas, Sonido y Luz</title>
    <style>
        :root {
            --primary: #4834d4;
            --bg: #f0f2f5;
            --text: #1a1a1a;
            --white: #ffffff;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg);
            color: var(--text);
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
        }

        h1 {
            text-align: center;
            color: var(--primary);
            margin-bottom: 30px;
        }

        .question-card {
            background: var(--white);
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.05);
            transition: transform 0.2s;
            position: relative;
        }

        /* --- NUEVO: Estilos para el Checkbox --- */
        .mark-container {
            display: flex;
            align-items: center;
            justify-content: flex-end;
            margin-bottom: 15px;
            font-size: 0.9em;
            color: #636e72;
            font-weight: bold;
            border-bottom: 1px solid #eee;
            padding-bottom: 10px;
        }
        .mark-container input {
            margin-right: 8px;
            transform: scale(1.3);
            cursor: pointer;
            accent-color: var(--primary);
        }
        .mark-container label {
            cursor: pointer;
        }

        .question-header {
            font-size: 0.85em;
            color: #a4b0be;
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 1px;
            font-weight: bold;
        }

        .question-text {
            font-weight: 700;
            font-size: 1.1em;
            margin-bottom: 20px;
            color: #2d3436;
            line-height: 1.5;
        }

        .options-container {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .option-btn {
            padding: 15px 20px;
            border: 2px solid #dfe6e9;
            background: #fff;
            border-radius: 8px;
            cursor: pointer;
            text-align: left;
            transition: all 0.2s;
            font-size: 1em;
            color: #444;
        }

        .option-btn:hover:not(:disabled) {
            background-color: #f1f2f6;
            border-color: var(--primary);
        }

        .option-btn:disabled {
            cursor: default;
            opacity: 0.7;
        }

        .correct {
            background-color: #d1fae5 !important;
            border-color: #10b981 !important;
            color: #065f46 !important;
        }

        .incorrect {
            background-color: #fee2e2 !important;
            border-color: #ef4444 !important;
            color: #991b1b !important;
        }

        .explanation {
            margin-top: 20px;
            padding: 15px;
            background-color: #e0f2fe;
            border-left: 5px solid #0ea5e9;
            border-radius: 4px;
            display: none;
            line-height: 1.5;
        }
        .explanation.visible {
            display: block;
            animation: fadeIn 0.4s ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-5px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* --- Estilos para el √°rea de controles finales --- */
        #controls-area {
            margin-top: 40px;
            text-align: center;
            padding: 30px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        .action-btn {
            background: #2d3436; color: white; border: none;
            padding: 12px 24px; font-size: 1em; border-radius: 8px;
            cursor: pointer; margin: 5px;
            transition: background 0.3s;
            font-weight: 600;
        }
        .action-btn:hover { background: #636e72; }
        
        .restart-options {
            display: none;
            flex-direction: column;
            gap: 10px;
            margin-top: 20px;
        }
        .restart-options button {
            background: var(--primary);
        }
        .restart-options button:hover { background: #686de0; }

    </style>
</head>
<body>

    <h1>Examen de F√≠sica: Ondas y Sonido</h1>
    
    <div id="quiz-container"></div>

    <div id="controls-area">
        <button id="finish-btn" class="action-btn" onclick="showEndOptions()">üèÅ Finalizar revisi√≥n</button>
        
        <div id="restart-menu" class="restart-options">
            <h3>¬øC√≥mo deseas continuar?</h3>
            <p id="stats-summary"></p>
            <button class="action-btn" onclick="restartQuiz('all')">üîÑ Rehacer el cuestionario entero</button>
            <button class="action-btn" onclick="restartQuiz('marked')">üîñ Hacer solo las preguntas marcadas</button>
            <button class="action-btn" onclick="restartQuiz('failed')">‚ùå Hacer solo las preguntas falladas</button>
            <button class="action-btn" onclick="restartQuiz('failed_marked')">‚ö†Ô∏è Hacer falladas y marcadas</button>
        </div>
    </div>

<script>
    // --- BANCO DE PREGUNTAS ---
    const quizData = [
        { q: "¬øSe puede propagar la luz y el sonido en el vac√≠o?", opts: ["Ambos se pueden transmitir", "Ninguno se puede transmitir", "La luz s√≠, el sonido no", "La luz no, el sonido s√≠"], a: "La luz s√≠, el sonido no" },
        { q: "Cuando se utiliza un sistema de ultrasonidos en diagn√≥stico, la sonda emisora-receptora se suele untar de una especie de gel con objeto de:", opts: ["Que se desplace mejor sobre el paciente", "Acoplar las impedancias ac√∫sticas", "Aumentar la tensi√≥n sexual", "Que existe una gran discontinuidad de impedancias"], a: "Acoplar las impedancias ac√∫sticas" },
        { q: "El n√∫mero de capas hemireductoras m√≠nimo necesario para que tras un blindaje la intensidad de un haz de fotones se vea reducida a menos de la d√©cima parte del valor inicial es:", opts: ["5", "4", "3", "2"], a: "4" },
        { q: "Cuando el valor de ‚ÄúCHR‚Äù es muy grande diremos que la radiaci√≥n es:", opts: ["Muy penetrante", "Monoenerg√©tica", "Poco penetrante", "Regular de penetrante"], a: "Muy penetrante" },
        { q: "Cuando una onda se propaga en un medio disipativo, su intensidad:", opts: ["Permanece constante", "Decrece exponencialmente con la distancia", "Es inversamente proporcional al cuadrado de la distancia", "Se anula"], a: "Decrece exponencialmente con la distancia" },
        { q: "Cuando duplicamos la frecuencia de un sonido, el nuevo sonido tendr√°:", opts: ["Un tono m√°s agudo", "Un timbre diferente", "Un tono m√°s grave", "Doble n√∫mero de fones"], a: "Un tono m√°s agudo" },
        { q: "Para la realizaci√≥n de ecograf√≠as se suele utilizar:", opts: ["Una sonda que emite los ultrasonidos y otra distinta que los recibe", "La misma sonda para la emisi√≥n y la captaci√≥n de los ultrasonidos reflejados", "Una placa sensible a la radiaci√≥n ultrasonora", "Una sonda que emite los ultrasonidos a 50 cm del paciente como m√≠nimo"], a: "La misma sonda para la emisi√≥n y la captaci√≥n de los ultrasonidos reflejados" },
        { q: "La obtenci√≥n de im√°genes ecogr√°ficas de tipo Doppler se basa en:", opts: ["El movimiento de la sonda que emite los ultrasonidos", "La variaci√≥n de frecuencia debida al movimiento del objeto que refleja la onda", "Las diferencias de densidad del medio", "La amplitud de la onda"], a: "La variaci√≥n de frecuencia debida al movimiento del objeto que refleja la onda" },
        { q: "Recibe el nombre de Onda o Movimiento ondulatorio:", opts: ["La l√≠nea ondulada que se obtiene al agitar una cuerda", "Cualquier movimiento que produzca ondulaciones en la superficie del agua", "Una perturbaci√≥n que se propaga", "Aquellas que pueden ser captadas mediante una antena"], a: "Una perturbaci√≥n que se propaga" },
        { q: "Una onda transversal es:", opts: ["Aquella en la que la direcci√≥n de la perturbaci√≥n y la de propagaci√≥n son iguales", "Aquella que atraviesa de forma transversal el medio", "El sonido", "Aquella en la que la direcci√≥n de la perturbaci√≥n y la de propagaci√≥n son perpendiculares"], a: "Aquella en la que la direcci√≥n de la perturbaci√≥n y la de propagaci√≥n son perpendiculares" },
        { q: "Cuando una onda se propaga en un medio material:", opts: ["Atraviesa √©ste sin que sus part√≠culas sufran alteraci√≥n alguna", "Hace que las part√≠culas del medio oscilen", "Provoca un movimiento uniformemente acelerado en sus part√≠culas", "Las part√≠culas del medio se mueven con velocidad constante"], a: "Hace que las part√≠culas del medio oscilen" },
        { q: "Indicar cu√°l de las siguientes afirmaciones puede ser verdadera:", opts: ["El periodo de una onda es de 5 s", "El periodo de una onda es de 5 m", "El periodo de una onda es de 5 Hz", "El periodo de una onda es directamente proporcional a su velocidad de propagaci√≥n"], a: "El periodo de una onda es de 5 s" },
        { q: "La frecuencia de las ondas sonoras disminuye cuando la fuente y el receptor:", opts: ["Se mueven de forma que se mantiene constante la separaci√≥n de ambos", "Se acercan", "Est√°n en reposo", "Se alejan"], a: "Se alejan" },
        { q: "Debido a su tono distinguimos entre sonidos:", opts: ["Complejos y simples", "Fuertes y d√©biles", "R√°pidos y lentos", "Agudos y Graves"], a: "Agudos y Graves" },
        { q: "El periodo de una onda:", opts: ["Es el espacio que tarda en repetirse una onda", "Es el tiempo que tarda en completar un ciclo", "Dividido por 2œÄ da la frecuencia", "Ninguna de las afirmaciones anteriores es cierta"], a: "Es el tiempo que tarda en completar un ciclo" },
        { q: "La funci√≥n del o√≠do humano es:", opts: ["Convertir los impulsos el√©ctricos en ondas sonoras", "Transformar los impulsos nerviosos en ondas sonoras", "Convertir las ondas sonoras en impulsos el√©ctricos (nerviosos)", "Transformar los impulsos mec√°nicos en ondas sonoras"], a: "Convertir las ondas sonoras en impulsos el√©ctricos (nerviosos)" },
        { q: "En su camino a lo largo del o√≠do externo, las ondas sonoras alcanzan finalmente:", opts: ["El pabell√≥n auditivo", "El conducto Auditivo", "El T√≠mpano", "El vest√≠bulo"], a: "El T√≠mpano" },
        { q: "En la cadena de huesecillos del o√≠do medio se encuentra:", opts: ["El yunque", "El vest√≠bulo", "El t√≠mpano", "El conducto auditivo"], a: "El yunque" },
        { q: "La oreja es parte constitutiva del:", opts: ["O√≠do externo", "O√≠do medio", "O√≠do interno", "O√≠do musical"], a: "O√≠do externo" },
        { q: "Las distintas frecuencias son recogidas en puntos distintos de:", opts: ["La membrana basilar", "El pabell√≥n auditivo", "La membrana oval", "El vest√≠bulo"], a: "La membrana basilar" },
        { q: "El o√≠do medio se encuentra limitado por la base de la c√≥clea y el:", opts: ["El pabell√≥n auditivo", "El conducto auditivo", "El t√≠mpano", "El vest√≠bulo"], a: "El t√≠mpano" },
        { q: "Las vibraciones de la ventana oval son transformadas en impulsos nerviosos en:", opts: ["La ventana redonda", "El martillo", "El t√≠mpano", "La c√≥clea (√ìrgano de Corti)"], a: "La c√≥clea (√ìrgano de Corti)" },
        { q: "Cuando una persona habla con voz m√°s aguda que otra significa que:", opts: ["Produce sonidos de mayor amplitud", "Produce sonidos de mayor longitud de onda", "Produce sonidos de mayor frecuencia", "Produce sonidos de menor frecuencia"], a: "Produce sonidos de mayor frecuencia" },
        { q: "Cierto movimiento ondulatorio posee una frecuencia de 10Hz y una longitud de onda de 3m, as√≠ que su velocidad de propagaci√≥n es:", opts: ["10/3 m/s", "10 m/s", "3 m/s", "30 m/s"], a: "30 m/s" },
        { q: "Una onda arm√≥nica de longitud de onda de 3m, se propaga a una velocidad de 3m/s. La frecuencia de onda es:", opts: ["1 Hz", "1 rad/s", "1 m", "1 s"], a: "1 Hz" },
        { q: "Las ondas mec√°nicas se propagan:", opts: ["En el vac√≠o", "Siempre que haya un transporte neto de materia", "Siempre que no haya un transporte de energ√≠a", "En un medio material"], a: "En un medio material" },
        { q: "Para medir la velocidad de la sangre en un vaso realizaremos:", opts: ["Una ecograf√≠a tipo A", "Una ecograf√≠a tipo B", "Una ecograf√≠a Doppler", "Una ecograf√≠a TM"], a: "Una ecograf√≠a Doppler" },
        { q: "En el estudio del funcionalismo cardiaco se utiliza frecuentemente:", opts: ["La ecograf√≠a A", "La ecograf√≠a B", "La ecograf√≠a TM", "La Espirometr√≠a"], a: "La ecograf√≠a TM" },
        { q: "Para una onda arm√≥nica, la raz√≥n entre la longitud de onda y el periodo es:", opts: ["El n√∫mero de ondas", "La frecuencia de la onda", "La frecuencia angular", "La velocidad de propagaci√≥n de la onda"], a: "La velocidad de propagaci√≥n de la onda" },
        { q: "La intensidad relativa de una onda se mide en:", opts: ["Erizos", "W/m2", "Decibelios", "Metros"], a: "Decibelios" },
        { q: "el coeficiente de absorcion de una onda se puede medir en:", opts: ["mol/cm2", "electron/voltio", "1/cm", "decibelios"], a: "1/cm" },
        { q: "¬øCual de las siguientes afirmaciones es cierta?", opts: ["Todas las ondas son movimientos ondulatorios", "Todos los movimientos ondulatorios son ondas", "El movimiento ondulatorio no es una onda", "Solo algunos movimientos ondulatorios son ondas"], a: "Todas las ondas son movimientos ondulatorios" },
        { q: "En un movimiento ondulatorio se dice que dos puntos estan en concordancia de fase cuando:", opts: ["Estan separados por una distancia igual a la mitad de la longitud de la onda", "Estan separados por una distancia igual a la cuarta parte de la longitud de la onda", "Estan separados por una distancia igual a 10 veces la longitud de onda", "Est√°n separados por una distancia igual a la longitud de onda"], a: "Est√°n separados por una distancia igual a la longitud de onda" },
        { q: "La energia transmitida por una onda por unidad de tiempo y de superficie perpendicular a la direccion de propagacion se denomina:", opts: ["Potencia de la onda", "Intensidad de la onda", "Energia de la onda", "Coeficiente de transmision de la onda"], a: "Intensidad de la onda" },
        { q: "Todo punto de un medio alcanzado por un movimiento vibratorio que se propaga por el se convierte en foco emisor de ondas secundarias, este enunciado corresponde a:", opts: ["Principio de Huygens", "Efecto doppler", "Poder de refraccion", "Ley de Zurita"], a: "Principio de Huygens" },
        { q: "La ecuacion y = A sen 2œÄ (1/T ‚Äìx/Œª) representa:", opts: ["La atraccion de dos cargas electricas puntiformes", "La fuerza de atraccion vectorial de un campo magnetico", "El movimiento ondulatorio", "Una formula trigonometrica cualquiera"], a: "El movimiento ondulatorio" },
        { q: "La intensidad de un movimiento ondulatorio es inversamente proporcional a:", opts: ["La amplitud del movimiento", "La distancia en centimetros", "El cuadrado de la amplitud", "El cuadrado de la distancia"], a: "El cuadrado de la distancia" },
        { q: "Un medio disipativo es aquel en el cual:", opts: ["Las ondas se transmiten segun frentes de onda esfericas", "El medio absorbe parte de la energia que la onda transmite", "Se puede transmitir radiaciones electromagneticas", "Se cumple la ley del inverso del cuadrado"], a: "El medio absorbe parte de la energia que la onda transmite" },
        { q: "Al pasar una onda de un medio a otro su energia:", opts: ["Permanece constante", "No se transmite en absoluto", "Parte se transmite y parte se refleja", "Ninguna de las anteriores"], a: "Parte se transmite y parte se refleja" },
        { q: "Indicar cual de las siguientes afirmaciones es falsa:", opts: ["En toda onda hay propagacion de energia", "Los puntos que pertenecen al mismo frente de onda estan en fase", "Las ondas no propagan energia", "El movimiento ondulatorio posee una periodicidad espacial y temporal"], a: "Las ondas no propagan energia" },
        { q: "En las ondas planas los frentes de onda son:", opts: ["Planos", "Rectos", "Esf√©ricos", "Circunferencias"], a: "Planos" },
        { q: "Las ondas se propagan mas rapidamente en:", opts: ["Aire", "Agua", "S√≥lidos", "Es indiferente"], a: "S√≥lidos" },
        { q: "Para que la onda sonora llegue al oido su longitud ha de ser:", opts: ["1/3 la del oido", "3 veces la del oido", "4 veces la del oido", "2 veces la del oido"], a: "4 veces la del oido" },
        { q: "El o√≠do medio:", opts: ["Actua como acoplador de impedancias entre el aire y la perilinfa", "Hace que toda la intensidad de la onda en el aire se transmita a la perilinfa", "Transforma las ondas sonoras en impulsos nerviosos", "Actua como acoplador de impedancias y hace que la intensidad se transmita"], a: "Actua como acoplador de impedancias y hace que la intensidad se transmita" },
        { q: "un sonido de 10 decibelios y 1000 Hz:", opts: ["es audible", "no es audible", "es muy agudo", "produce una sensaci√≥n inefable"], a: "es audible" },
        { q: "se√±ale la proposicion correcta:", opts: ["los sonidos graves se transmiten mejor que los agudos", "los sonidos agudos se transmiten mejor que los graves", "graves y agudos se transmiten de la misma forma", "los sonidos se transmiten mejor en medios poco densos"], a: "los sonidos graves se transmiten mejor que los agudos" },
        { q: "al umbral de la sensacion auditiva desagradable (dolor) le corresponden:", opts: ["130 dB", "110 dB", "120 dB", "150 dB"], a: "120 dB" },
        { q: "desde el punto de vista fisico, el conducto auditivo externo actua como:", opts: ["transformador de presiones", "amplificador de ondas sonoras", "perceptor de ondas", "amplificador y perceptor de ondas sonoras"], a: "amplificador de ondas sonoras" },
        { q: "el organo de Corti se encuentra situado sobre:", opts: ["el timpano", "la membrana tectorial", "rampa vestibular", "membrana basilar"], a: "membrana basilar" },
        { q: "Cual de las siguientes afirmaciones es de dudosa veracidad?", opts: ["dos notas musicales distintas poseen siempre distinta frecuencia", "una misma nota musical se puede emitir con frecuencias distintas separadas por un intervalo de una octava", "lo que caracteriza a las distintas notas musicales es su intensidad", "todas son ciertas"], a: "lo que caracteriza a las distintas notas musicales es su intensidad" },
        { q: "es falso que en la propagacion de un sonido influye que el medio sea:", opts: ["m√°s o menos denso", "muy comprensivo", "poco comprensivo", "transparente a la luz visible"], a: "transparente a la luz visible" },
        { q: "cual es la cualidad del sonido que distingue a otro de distinta nota:", opts: ["mel", "tono", "fon", "intensidad"], a: "tono" },
        { q: "indique cual de las siguientes afirmaciones es falsa:", opts: ["dos notas musicales distintas poseen siempre diferente frecuencia", "una misma nota musical se puede emitir con frecuencias distintas separadas por un intervalo de una octava", "intervalo de tono es sinonimo de diferencia de frecuencias", "lo que caracteriza distintas notas musicales es su intensidad"], a: "lo que caracteriza distintas notas musicales es su intensidad" },
        { q: "en la obtencion de la direccion de un sonido por audicion biaural no influye:", opts: ["la diferencia de fase con que se percibe en cada oido", "la diferencia de intensidad que se percibe con cada oido", "la musicalidad del sonido", "Es imposible obtener la direccion"], a: "la musicalidad del sonido" },
        { q: "la produccion de ultrasonidos de ultrafrecuencia se debe a:", opts: ["efecto piezoelectrico", "efecto rec√≠proco al piezoelectrico", "efecto t√©rmico", "efecto magn√©tico"], a: "efecto piezoelectrico" },
        { q: "en la ecografia tipo B o de Scan:", opts: ["el transductor permanece fijo", "el transductor se mueve", "hay una modulacion en brillo del impulso reflejado", "el transductor se mueve y hay una modulacion en brillo del impulso reflejado"], a: "el transductor se mueve y hay una modulacion en brillo del impulso reflejado" },
        { q: "la ecografia TM se emplea normalmente:", opts: ["para determinar la posicion variable de un obstaculo que se supone en movimiento", "para obtener una imagen de la estructura explorada", "para obtener informacion unidimensional de las estructuras encontradas por el haz", "como metodo terapeutico"], a: "para determinar la posicion variable de un obstaculo que se supone en movimiento" },
        { q: "en la aplicacion terapeutica o diagnostica de los ultrasonidos, se coloca entre el transductor y la piel una sustancia de acoplamiento para:", opts: ["disminuir la reflexion y aumentar la transmision", "que el transductor se deslice con facilidad", "proteger la piel de la irradiacion", "aumentar la frecuencia"], a: "disminuir la reflexion y aumentar la transmision" },
        { q: "la ecografia Doppler se utiliza para determinar:", opts: ["la morfologia de la zona explorada", "la velocidad de la sangre en los vasos sanguineos", "la posicion de las estructuras encontradas por el haz", "el espesor de los musculos"], a: "la velocidad de la sangre en los vasos sanguineos" },
        { q: "la base de la utilizacion diagnostica de los ultrasonidos es:", opts: ["el efecto piezoelectrico", "el efecto rec√≠proco al piezoelectrico", "el fenomeno del eco", "el efecto fotoelectrico"], a: "el fenomeno del eco" },
        { q: "con el sistema B-Mode de registro de los ecos, las interfases de las diferentes impedancias acusticas se registran en el osciloscopio como:", opts: ["deflexiones horizontales", "puntos luminosos", "deflexiones verticales", "depende del transductor"], a: "puntos luminosos" },
        { q: "a frecuencias altas de ultrasonidos:", opts: ["mas directividad y menos divergencia", "mas directividad y divergencia", "menos directividad y mas divergencia", "menos directividad y menos divergencia"], a: "mas directividad y menos divergencia" },
        { q: "la funcion de un transductor es:", opts: ["traducir la magnitud que recoge la variable biologica", "servir de conductor de una se√±al electrica", "traducir la magnitud que recoge a otra distancia", "amplificar la magnitud recogida"], a: "traducir la magnitud que recoge la variable biologica" },
        { q: "para un observador al borde de una acera, el ruido del coche por cruza a gran velocidad:", opts: ["es mas agudo al alejarse que acercarse", "es igual de agudo", "es imperceptible", "es mas grave al alejarse que al acercarse"], a: "es mas grave al alejarse que al acercarse" },
        { q: "el uso de acople de impedancia es necesario:", opts: ["al usar microelectrodos", "al introducir una se√±al en el osciloscopio", "al usar manometros de tension", "al usar electrodos de contacto"], a: "al usar electrodos de contacto" },
        { q: "para recoger cual de las siguientes variables es necesario un transductor:", opts: ["electroencefalograma", "flujo venoso", "potencial sinaptico", "potencial de membrana"], a: "flujo venoso" },
        { q: "la formula que expresa el indice de refraccion absoluta:", opts: ["n= C/N", "n= C/V", "n= V/C", "n= N/C"], a: "n= C/V" },
        { q: "es falso que los ultrasonidos actuen sobre el metabolismo celular como consecuencia de producir:", opts: ["aumento de temperatura", "rotura de macromoleculas", "contacto intimo entre diferentes componentes", "disminucion de temperatura"], a: "disminucion de temperatura" },
        { q: "para comprobar que el cabezal de ecografia emite podemos realizar la prueba del:", opts: ["benceno", "yoduro pot√°sico", "gota de agua", "silbato de Zurita"], a: "gota de agua" },
        { q: "algunos animales no perciben ultrasonidos como:", opts: ["el perro", "el hombre", "el murci√©lago", "el delf√≠n"], a: "el hombre" },
        { q: "el material usado inicialmente para producir ultrasonidos fue:", opts: ["rub√≠", "topacio", "cuarzo", "amatista"], a: "cuarzo" },
        { q: "la resistencia que oponen las diversas sustancias a ser atravesadas por los ultrasonidos se denomina:", opts: ["impedancia ac√∫stica", "ecogenicidad", "densidad resistiva", "resistencia espec√≠fica"], a: "impedancia ac√∫stica" },
        { q: "para una accion terapeutica superficial elegiremos cabezales de:", opts: ["3 Mhz", "2 Mhz", "1 Mhz", "750 Khz"], a: "3 Mhz" },
        { q: "en la ecografia Doppler medimos la velocidad de la sangre cuando la variacion de frecuencia del haz se refleja en:", opts: ["el plasma sanguineo", "las proteinas sanguineas", "los electrolitos del plasma", "los hematies"], a: "los hematies" },
        { q: "Los ultrasonidos se utilizan en terap√©utica aprovechando:", opts: ["Su acci√≥n t√©rmica", "Que disminuyen la temperatura de los tejidos tratados", "Su acci√≥n mec√°nica (o din√°mica)", "Su acci√≥n t√©rmica y mec√°nica"], a: "Su acci√≥n t√©rmica y mec√°nica" },
        { q: "Las ondas sonoras o ac√∫sticas son:", opts: ["Ondas transversales de presi√≥n", "Ondas longitudinales de presi√≥n que se propagan por el aire", "Ondas estacionarias", "Ondas electromagn√©ticas"], a: "Ondas longitudinales de presi√≥n que se propagan por el aire" },
        { q: "La frecuencia captada por un observador que se dirige a una fuente de ondas sonoras es:", opts: ["igual a la emitida por la fuente", "independiente de la velocidad del observador", "mayor que la frecuencia emitida por la fuente", "depende de la distancia"], a: "mayor que la frecuencia emitida por la fuente" },
        { q: "¬øA qui√©n vas a seguir en instagram cuando termines este test?", opts: ["susoocalderoon", "antonioarroyoo19", "not_yisuss", "pepegarridoo", "ignbartel", "santibenvenuty", "imblue.dabadeedabadie", "teochaza"], a: "ignbartel" },
        { q: "Alvaro Cond√≥n. Alvaro Cond√≥n. Alvaro Cond√≥n.", opts: ["Alvaro Cond√≥n", "Alvaro Cond√≥n", "Alvaro Cond√≥n", "Todas las anteriores"], a: "Todas las anteriores" },
        { q: "Los sonidos y los ultrasonidos de alta frecuencia se diferencian en que:", opts: ["uno se propaga en el vacio y otro no", "uno tiene caracter ondulatorio", "son movimientos ondulatorios de distinta frecuencia", "uno es longitudinal y otro transversal"], a: "son movimientos ondulatorios de distinta frecuencia" },
        { q: "En todo movimiento ondulatorio:", opts: ["Se propaga siempre materia", "Se propaga siempre energ√≠a", "Se requiere un medio material para su propagacion", "Se propaga siempre materia y se requiere un medio material para su propagacion"], a: "Se propaga siempre energ√≠a" },
        { q: "En las ondas estacionarias se cumple que la distancia entre nodo y un vientre es:", opts: ["Œª", "1/2 Œª", "1/3 Œª", "1/4 Œª"], a: "1/4 Œª" },
        { q: "La cualidad que del sonido que permite reconocer dos instrumentos distintos dando la misma nota, se denomina:", opts: ["Tono", "Intensidad", "Timbre", "Sonoridad"], a: "Timbre" },
        { q: "El umbral de la sensaci√≥n desagradable es:", opts: ["Dependiente de la frecuencia", "Dependiente del numero de fonos", "Dependiente del tiempo", "Practicamente independiente de la frecuencia"], a: "Practicamente independiente de la frecuencia" },
        { q: "El nivel de intensidad se mide en:", opts: ["fonos", "sones", "mels", "decibelios"], a: "decibelios" },
        { q: "Un sonido con doble numero de sones que otro se percibe con:", opts: ["Igual sonoridad", "Triple sonoridad", "Doble sonoridad", "De la mitad de la intensidad"], a: "Doble sonoridad" },
        { q: "Dos sonidos de intensidades 10^-4 y 10^-6 W/m2 respectivamente lo oiremos:", opts: ["Dos veces mas intenso", "Dos veces menos intenso", "Igual de intensos", "No existe ninguna relaci√≥n (o 100 veces, o 20dB diferencia)"], a: "No existe ninguna relaci√≥n (o 100 veces, o 20dB diferencia)" },
        { q: "El aumento de presi√≥n que se consigue en el o√≠do medio se debe a:", opts: ["La impedancia de la endolinfa", "La cadena de huesecillos act√∫a como palanca", "La diferencia de √°rea del t√≠mpano y la membrana oval", "La cadena de huesecillos act√∫a como palanca y la diferencia de √°rea del t√≠mpano y la membrana oval"], a: "La cadena de huesecillos act√∫a como palanca y la diferencia de √°rea del t√≠mpano y la membrana oval" },
        { q: "Si la relaci√≥n entre las impedancias de la perilinfa y el aire es de 3.249, ¬øQu√© aumento de presi√≥n se producir√° para que toda la intensidad del aire se transmita a la perilinfa?", opts: ["No se tiene que producir ningun aumento de presion", "No que aumenta es la energia", "Aumentara 57 veces", "Disminuira la presion 4 veces"], a: "Aumentara 57 veces" },
        { q: "Un sonido de -10 dB y 1.000 Hz:", opts: ["Es audible", "No es audible", "Es muy agudo", "Produce sensaci√≥n dolorosa"], a: "No es audible" },
        { q: "La sensaci√≥n sonora se mide en:", opts: ["W/m2", "Fonos", "Decibelios", "No tiene unidades"], a: "Fonos" },
        { q: "Cuando se propaga una onda sonora por la coclea se establece una deformaci√≥n en la partici√≥n coclear, en una posici√≥n que depende de:", opts: ["La longitud de onda", "La intensidad del sonido", "La frecuencia de la onda", "El nivel de sonoridad"], a: "La frecuencia de la onda" },
        { q: "Al pasar una onda de un medio a otro de distinta densidad permanece invariable:", opts: ["Su velocidad de propagaci√≥n", "Su frecuencia", "Su longitud de onda", "Su coeficiente de absorci√≥n"], a: "Su frecuencia" },
        { q: "la impedancia ac√∫stica depende de:", opts: ["La velocidad debida a la perturbaci√≥n", "La velocidad de propagaci√≥n", "La densidad del medio", "La velocidad de propagaci√≥n y la densidad del medio"], a: "La velocidad de propagaci√≥n y la densidad del medio" },
        { q: "La unidad de agudeza subjetiva de un sonido es:", opts: ["son", "fon", "decibelio", "mel"], a: "mel" },
        { q: "Con el sistema A-Mode(modulaci√≥n de amplitud) de registro de los ecos, las interfases de diferentes impedancias ac√∫sticas se registran en el osciloscopio como:", opts: ["Deflexiones horizontales", "Puntos luminosos", "Deflexiones verticales", "Depender√° del transductor"], a: "Deflexiones verticales" },
        { q: "En la ecograf√≠a TM determinaremos:", opts: ["La variaci√≥n de la posici√≥n de una estructura a lo largo del tiempo", "La morfolog√≠a de la zona que hay estudiar", "La velocidad de la sangre en un vaso", "El espesor de las masas musculares superficiales"], a: "La variaci√≥n de la posici√≥n de una estructura a lo largo del tiempo" },
        { q: "En la ecograf√≠a Doppler el haz de ultrasonidos es:", opts: ["Pulsado", "Semipulsado", "Continuo", "Semicontinuo"], a: "Continuo" },
        { q: "cierto movimiento ondulatorio posee una frecuencia de 10 Hz y una longitud de onda de 3m, as√≠ que su velocidad de propagaci√≥n es:", opts: ["10/3 m/s", "10 m/s", "3 m/s", "30 m/s"], a: "30 m/s" },
        { q: "una onda arm√≥nica de longitud de onda 3m se propaga a una velocidad de 3 m/s, la frecuencia es:", opts: ["1 Hz", "1 rad/s", "1 m", "1 dB"], a: "1 Hz" },
        { q: "las ondas mec√°nicas se propagan:", opts: ["en el vac√≠o", "en un medio material", "siempre que haya transporte neto de energ√≠a", "siempre que no haya transporte de energ√≠a"], a: "en un medio material" },
        { q: "uno de los siguientes sistemas no se puede emplear como acoplador de impedancia:", opts: ["microelectrodo", "transformador", "seguidor cat√≥dico", "seguidor de emisi√≥n"], a: "microelectrodo" },
        { q: "La velocidad del sonido:", opts: ["Depende del medio por el que se propaga", "Siempre es la misma", "Es mayor en los s√≥lidos que en los gases", "Depende del medio por el que se propaga y es mayor en los s√≥lidos que en los gases"], a: "Depende del medio por el que se propaga y es mayor en los s√≥lidos que en los gases" },
        { q: "¬øQu√© es la longitud de onda?", opts: ["La distancia que recorre la onda en un tiempo mayor al periodo", "La distancia que recorre la onda en un tiempo menor al periodo", "La distancia que recorre una part√≠cula en la unidad de tiempo", "La distancia entre dos puntos consecutivos que est√°n en la misma fase"], a: "La distancia entre dos puntos consecutivos que est√°n en la misma fase" },
        { q: "Con el sistema B-mode de registro de los ecos, las interfases de diferentes impedancias ac√∫sticas:", opts: ["Se registran como deflexiones horizontales", "Se registran como puntos luminosos", "Permite conocer la morfolog√≠a de la zona", "Se registran como puntos luminosos y permite conocer la morfolog√≠a de la zona"], a: "Se registran como puntos luminosos y permite conocer la morfolog√≠a de la zona" },
        { q: "Los sonidos y los ultrasonidos se diferencian en que:", opts: ["Uno es movimiento ondulatorio arm√≥nico y el otro no", "Son movimientos ondulatorios de distinta frecuencia", "Ambos no se propagan en el vac√≠o", "Son movimientos ondulatorios de distinta frecuencia y ambos no se propagan en el vac√≠o"], a: "Son movimientos ondulatorios de distinta frecuencia y ambos no se propagan en el vac√≠o" },
        { q: "Las ondas sonoras o ac√∫sticas son:", opts: ["Ondas longitudinales de presi√≥n que no se propagan solo en el vac√≠o", "Ondas electromagn√©ticas", "Ondas estacionarias", "Ninguna de las tres"], a: "Ondas longitudinales de presi√≥n que no se propagan solo en el vac√≠o" },
        { q: "El sistema TM de registro de los ecos:", opts: ["Determina la posici√≥n variable de un obst√°culo en movimiento", "Permite la representaci√≥n de un obst√°culo en movimiento en funci√≥n del tiempo", "Permite el estudio del funcionalismo card√≠aco", "Las tres anteriores"], a: "Las tres anteriores" },
        { q: "Un sonido se propaga en el aire con una longitud de onda de 2 m y una velocidad de 340 m/s, en el agua lo hace a 1500 m/s ¬øCu√°l es su frecuencia en el agua?", opts: ["340 Hz", "340 m/s", "170 Hz", "1500 Hz"], a: "170 Hz" },
        { q: "Qu√© es el periodo de una onda?", opts: ["La m√°xima elongaci√≥n de una part√≠cula respecto a su posici√≥n de equilibrio", "El n√∫mero de oscilaciones que realiza una part√≠cula en 1 segundo", "El tiempo que tarda una part√≠cula en realizar una oscilaci√≥n completa", "La m√≠nima elongaci√≥n de una part√≠cula respecto a su posici√≥n de equilibrio"], a: "El tiempo que tarda una part√≠cula en realizar una oscilaci√≥n completa" },
        { q: "Las cualidades que nuestro o√≠do distingue en un sonido nos permite afirmar:", opts: ["La frecuencia de un sonido hace que lo percibamos m√°s o menos grave", "El tono de un sonido aumenta si la longitud de onda lo hace tambi√©n", "El volumen de un sonido es independiente de la energ√≠a que transporta la onda sonora", "Ninguna de las anteriores"], a: "La frecuencia de un sonido hace que lo percibamos m√°s o menos grave" },
        { q: "La detecci√≥n de distintos sonidos son recogidos en puntos de:", opts: ["Pabell√≥n auditivo", "C√≥clea", "Membrana oval", "Membrana basilar"], a: "Membrana basilar" },
        { q: "Una onda sonora de frecuencia 2000 Hz se propaga en el aire e incide sobre un material cuya impedancia ac√∫stica es igual a la del hueso. Podemos afirmar que:", opts: ["Se va a producir una refllexi√≥n del 100 % en esa interfase", "Se va a producir una transmisi√≥n del 0 % en esa interfase", "Se va a producir una reflexi√≥n del 0 % en esa interfase", "Se va a producir una refllexi√≥n del 100 % y una transmisi√≥n del 0 % en esa interfase"], a: "Se va a producir una refllexi√≥n del 100 % y una transmisi√≥n del 0 % en esa interfase" },
        { q: "Para conseguir reflexiones importantes en la superficie que separa dos medios:", opts: ["Las impedancias ac√∫sticas deben ser muy distintas", "Las impedancias ac√∫sticas deben ser muy similares", "Los dos medios deben tener una densidad elevada", "Los dos medios deben tener una densidad peque√±a"], a: "Las impedancias ac√∫sticas deben ser muy distintas" },
        { q: "En su camino a lo largo del o√≠do externo, las ondas sonoras alcanzan finalmente:", opts: ["El pabell√≥n auditivo", "El conducto Auditivo", "El t√≠mpano", "El vest√≠bulo"], a: "El t√≠mpano" },
        { q: "¬øque es la resoluci√≥n longitudinal?", opts: ["minima distancia entre dos objetos que se ven en la pantalla como dos ecos diferentes", "m√°xima distancia entre dos objetos que se ven en la pantalla como dos ecos diferentes", "La culpa es de helena", "Machuca ponme matr√≠cula"], a: "minima distancia entre dos objetos que se ven en la pantalla como dos ecos diferentes" },
        { q: "el uso de acople de impedancia es necesario:", opts: ["al usar microelectrodo", "al introducir una se√±al en el osciloscopio", "al usar man√≥metros de tensi√≥n", "al usar electrodos de contacto"], a: "al usar electrodos de contacto" },
        { q: "al acoplar un receptor a un generador de tensi√≥n interesa:", opts: ["que la impedancia de entrada del receptor sea mayor que la de salida del generador", "que la impedancia de entrada sea mucho menor que la de salida", "que sean iguales", "que sean 0"], a: "que la impedancia de entrada del receptor sea mayor que la de salida del generador" },
        { q: "Las ondas sonoras son:", opts: ["ondas transversales de presi√≥n que se propagan por el aire", "ondas longitudinales de presi√≥n que se propagan por el aire", "ondas electromagn√©ticas", "ondas estacionarias"], a: "ondas longitudinales de presi√≥n que se propagan por el aire" },
        { q: "el aumento de la presi√≥n que se consigue en el o√≠do medio se debe a:", opts: ["la impedancia de la endolinfa", "la cadena de huesecillos actuando como palanca", "la diferencia de √°rea del t√≠mpano y la membrana oval", "la b y la c"], a: "la b y la c" },
        { q: "Un reproductor de m√∫sica mp3, que es capaz de reproducir un rango de frecuencia de [60- 10.000] HZ, vale 85 ‚Ç¨; pero por 1‚Ç¨ m√°s nos da otro que reproduce un rango de[10-40.000] Hz.", opts: ["El primero se oye mejor", "Comprar√≠a el segundo, la calidad del sonido es mucho mejor", "El primero se oye peor", "No notar√≠a ninguna diferencia en el sonido"], a: "Comprar√≠a el segundo, la calidad del sonido es mucho mejor" },
        { q: "Si la potencia de una onda sonora se duplica y la distancia disminuye la mitad, ¬øen que factor cambia la intensidad del sonido?", opts: ["La intensidad aumenta en ocho", "La intensidad disminuye en ocho", "La intensidad aumenta el doble", "La intensidad disminuye a la mitad"], a: "La intensidad aumenta en ocho" },
        { q: "Si el movimiento de una part√≠cula vibrante que da origen a las ondas tiene la misma direcci√≥n que la que tiene esta en su avance, las ondas se llaman:", opts: ["Horizontales", "Perpendiculares", "Transversales", "Longitudinales"], a: "Longitudinales" },
        { q: "Cu√°l de las siguientes afirmaciones son ciertas?", opts: ["El sonido es una onda electromagn√©tica", "La luz es una onda mec√°nica", "El sonido es una onda longitudinal", "Todas son ciertas"], a: "El sonido es una onda longitudinal" },
        { q: "86. Resulta sencillo calcular la longitud de onda de una onda si se conoce:", opts: ["La frecuencia de vibraci√≥n y amplitud de la onda", "La frecuencia de vibraci√≥n y el periodo de vibraci√≥n", "La velocidad de propagaci√≥n y la frecuencia de vibraci√≥n", "La velocidad de propagaci√≥n y la amplitud de la onda"], a: "La velocidad de propagaci√≥n y la frecuencia de vibraci√≥n" },
        { q: "92. La frecuencia del sonido captada por un observador en reposo:", opts: ["Disminuye cuando se acerca o aleja de la fuente", "Aumenta cuando se aleja la fuente y disminuye cuando se acerca la fuente", "Aumenta cuando se acerca o se aleja de la fuente", "Aumenta cuando se acerca la fuente y disminuye cuando se aleja la fuente"], a: "Aumenta cuando se acerca la fuente y disminuye cuando se aleja la fuente" },
        { q: "99. Un sonido de 1.000Hz y 40db produce la misma sensaci√≥n sonora que otro de 200 Hz y 55db.¬øCu√°ntos fonos tiene este √∫ltimo sonido?", opts: ["40 db", "55 db", "40 fonos", "55 fonos"], a: "40 fonos" },
        { q: "103. ¬øQue relaci√≥n existe entre las intensidades de un sonido de 10 dB y otro de 20 db?", opts: ["El de 20 dB tiene una intensidad 10 veces mayor que el de 10 dB", "El de 20 dB tiene una intensidad 20 veces mayor que el de 10 dB", "El de 20 dB tiene una intensidad doble que el de 10 dB", "Es de 20 dB tiene intensidad 1000 veces mayor que el de 10 dB"], a: "El de 20 dB tiene una intensidad 10 veces mayor que el de 10 dB" },
        { q: "119. Si la distancia desde una fuente sonora se duplica, ¬øen qu√© factor cambia la intensidad del sonido?", opts: ["Disminuye a la cuarta parte", "Aumenta 4 veces", "Disminuye a la mitad", "Aumenta el doble"], a: "Disminuye a la cuarta parte" },
        { q: "121. Una onda sonora va por el aire y se refleja en la pared de una casa. ¬øCambiar√° la velocidad de propagaci√≥n (c), la frecuencia (f) o la longitud de onda (Œª)?", opts: ["f disminuye, Œª aumenta y c no cambia", "f no cambia, Œª no cambia y c no cambia", "f aumenta, Œª aumenta y c aumenta", "f aumenta, Œª disminuye y c no cambia"], a: "f no cambia, Œª no cambia y c no cambia" },
        { q: "122. Una onda sonora se propaga por el aire seg√∫n la ecuaci√≥n (unidades en el SI): y= 3 cos (4œÄ t - œÄ x)", opts: ["Su amplitud es de 5m, su periodo es de 3s y su longitud de onda es de 2m", "Su amplitud es de 3m, su periodo es de 0,5s y su longitud de onda es de 2m", "Su amplitud es de 3m, su periodo es de 2s y su longitud de onda es de 0,5m", "Su amplitud es de 3m, su periodo es de 5s y su longitud de onda es de 2m"], a: "Su amplitud es de 3m, su periodo es de 0,5s y su longitud de onda es de 2m" },
        { q: "123. Suponga una onda sonora propag√°ndose por un medio No Disipativo. Si la potencia de la fuente sonora se duplica y la distancia disminuye la tercera parte, ¬øen qu√© factor cambia la intensidad del sonido?", opts: ["Aumenta a 8 veces la intensidad inicial", "Como es un medio No disipativo la intensidad se mantiene constante", "Aumenta 18 veces la intensidad inicial", "Se duplica"], a: "Aumenta 18 veces la intensidad inicial" },
        { q: "135. La luz y el sonido son ondas que tienen en com√∫n:", opts: ["Ser longitudinales", "Transportar energ√≠a", "Ser transversales", "Necesitar de un medio material"], a: "Transportar energ√≠a" },
        { q: "La generaci√≥n de ultrasonidos mediante generadores por magnetostricci√≥n se debe a:", opts: ["Efecto piezoel√©ctrico", "Campo magn√©tico oscilante al que se encuentra sometido", "Efecto rec√≠proco del fotoel√©ctrico", "b) y c)"], a: "Campo magn√©tico oscilante al que se encuentra sometido" },
        { q: "La velocidad del sonido:", opts: ["Depende del medio por el que se propague", "Siempre es la misma", "Es mayor en los s√≥lidos que en los gases", "La a) y la c)"], a: "La a) y la c)" },
        { q: "Cuando se propaga una onda sonora por la c√≥clea, se establece una deformaci√≥n en la partici√≥n coclear, en una posici√≥n que depende de:", opts: ["La longitud de onda", "La frecuencia", "La intensidad del sonido", "Ninguna de las tres"], a: "La frecuencia" },
        { q: "Un sonido se propaga en el aire con una longitud de onda de 2m y una velocidad de 340m/s, en el agua lo hace a 1500m/s. ¬øCu√°l es su frecuencia en el agua?", opts: ["340 Hz", "340 m/s", "170 Hz", "1500 Hz"], a: "170 Hz" },
        { q: "Qu√© es la longitud de onda?", opts: ["La distancia que recorre una part√≠cula en unidad de tiempo", "La distancia entre dos puntos consecutivos que est√°n en la misma fase", "La distancia que recorre la onda en un tiempo menor al per√≠odo", "La distancia que recorre la onda en un tiempo mayor al per√≠odo"], a: "La distancia entre dos puntos consecutivos que est√°n en la misma fase" },
        { q: "Una persona en la estaci√≥n oye en la lejan√≠a el silbato de un tren, percibi√©ndolo cada vez menos agudo, de ello deduce que:", opts: ["El tren est√° llegando a la estaci√≥n", "El tren se est√° alejando de la estaci√≥n", "El silbato del tren est√° estropeado", "El tren est√° parado en el and√©n"], a: "El tren se est√° alejando de la estaci√≥n" },
        { q: "En las ondas estacionarias los nodos son los puntos en los que:", opts: ["La amplitud es m√≠nima", "La amplitud es m√°xima", "La distancia entre ellos es landa/2", "La a y c"], a: "La a y c" },
        { q: "Una Onda longitudinal es:", opts: ["Aquella en la que la direcci√≥n de la perturbaci√≥n y la de propagaci√≥n son paralelas", "Aquella que atraviesa de forma trasversal el medio", "El sonido", "La a y c"], a: "La a y c" },
        { q: "En las ondas estacionarias los vientres son los puntos en los que:", opts: ["La amplitud es m√≠nima", "La amplitud es m√°xima", "La distancia entre ellos es landa/2", "La b y c"], a: "La b y c" },
        { q: "Cuando un rayo de luz pasa desde el aire al agua se produce un cambio en:", opts: ["La frecuencia", "La longitud de onda", "La energ√≠a", "La a y la b"], a: "La longitud de onda" },
        { q: "Si un tren de ondas se mueve a lo largo de una cuerda y tiene una velocidad de 60 m/s y una longitud de onda de 3 m, ¬øcu√°l es su frecuencia?", opts: ["20 Hz", "60 Hz", "30 Hz", "180 Hz"], a: "20 Hz" },
        { q: "El umbral de audici√≥n representa:", opts: ["el nivel en el que comienza la sensaci√≥n auditiva", "el nivel de dolor", "el nivel m√°ximo", "el nivel medio"], a: "el nivel en el que comienza la sensaci√≥n auditiva" },
        { q: "5. El rango de frecuencias que percibe un ser humano se extiende entre los:", opts: ["16 Hz y 20 000 Hz", "0 y 100 Hz", "2000 y 5000 Hz", "Todo el espectro"], a: "16 Hz y 20 000 Hz" }
    ];

    // --- ASIGNAR IDs √öNICOS (NECESARIO PARA EL TRACKING) ---
    quizData.forEach((item, index) => {
        item.id = index;
    });

    // --- GESTI√ìN DE ESTADO ---
    let markedQuestions = new Set();
    let failedQuestions = new Set();

    // Fisher-Yates Shuffle
    function shuffleArray(array) {
        let currentIndex = array.length, randomIndex;
        while (currentIndex !== 0) {
            randomIndex = Math.floor(Math.random() * currentIndex);
            currentIndex--;
            [array[currentIndex], array[randomIndex]] = [array[randomIndex], array[currentIndex]];
        }
        return array;
    }

    const container = document.getElementById('quiz-container');

    // Funci√≥n principal para renderizar el quiz
    function renderQuiz(questionsToLoad = quizData) {
        container.innerHTML = "";

        // Ocultar men√∫ de reinicio y mostrar bot√≥n de finalizar
        document.getElementById("restart-menu").style.display = "none";
        document.getElementById("finish-btn").style.display = "inline-block";

        if(questionsToLoad.length === 0) {
            container.innerHTML = "<p style='text-align:center; padding:20px; font-weight:bold;'>No hay preguntas para mostrar en esta selecci√≥n.</p>";
            return;
        }

        questionsToLoad.forEach((item, displayIndex) => {
            const card = document.createElement('div');
            card.className = 'question-card';

            // --- SECCI√ìN: Checkbox de Marcar para revisar ---
            const markContainer = document.createElement("div");
            markContainer.className = "mark-container";
            
            const checkbox = document.createElement("input");
            checkbox.type = "checkbox";
            checkbox.id = `mark-${item.id}`;
            // Si ya estaba marcada en la sesi√≥n global, mantener el check
            if(markedQuestions.has(item.id)) checkbox.checked = true;

            checkbox.onchange = (e) => {
                if(e.target.checked) {
                    markedQuestions.add(item.id);
                } else {
                    markedQuestions.delete(item.id);
                }
            };

            const label = document.createElement("label");
            label.htmlFor = `mark-${item.id}`;
            label.innerText = "Marcar para revisar";

            markContainer.appendChild(checkbox);
            markContainer.appendChild(label);
            card.appendChild(markContainer);
            // ------------------------------------------------

            const header = document.createElement('div');
            header.className = 'question-header';
            header.textContent = `Pregunta ${item.id + 1}`; 
            card.appendChild(header);

            const questionText = document.createElement('div');
            questionText.className = 'question-text';
            questionText.textContent = item.q;
            card.appendChild(questionText);

            const optionsDiv = document.createElement('div');
            optionsDiv.className = 'options-container';

            // Preparamos opciones
            let optionsObj = item.opts.map(opt => ({
                text: opt,
                isCorrect: opt === item.a
            }));

            // Barajamos opciones
            optionsObj = shuffleArray(optionsObj);

            // Explicaci√≥n
            const explanationDiv = document.createElement('div');
            explanationDiv.className = 'explanation';
            explanationDiv.innerHTML = `<strong>Respuesta Correcta:</strong> ${item.a}`;

            optionsObj.forEach(opt => {
                const btn = document.createElement('button');
                btn.className = 'option-btn';
                btn.textContent = opt.text;

                btn.onclick = () => {
                    const allBtns = optionsDiv.querySelectorAll('.option-btn');
                    allBtns.forEach(b => b.disabled = true);

                    if (opt.isCorrect) {
                        btn.classList.add('correct');
                    } else {
                        btn.classList.add('incorrect');
                        // --- REGISTRAR FALLO ---
                        failedQuestions.add(item.id);
                        
                        // marcar la correcta visualmente
                        allBtns.forEach(b => {
                            if (b.textContent === item.a) {
                                b.classList.add('correct');
                            }
                        });
                    }
                    explanationDiv.classList.add('visible');
                };
                optionsDiv.appendChild(btn);
            });

            card.appendChild(optionsDiv);
            card.appendChild(explanationDiv);
            container.appendChild(card);
        });
    }

    // --- FUNCIONES DE CONTROL FINAL ---

    function showEndOptions() {
        document.getElementById("finish-btn").style.display = "none";
        document.getElementById("restart-menu").style.display = "flex";
        
        // Scroll al final
        document.getElementById("controls-area").scrollIntoView({behavior: "smooth"});
        
        // Mostrar estad√≠sticas
        document.getElementById("stats-summary").innerHTML = `
            Preguntas marcadas: <strong>${markedQuestions.size}</strong><br>
            Preguntas falladas en esta sesi√≥n: <strong>${failedQuestions.size}</strong>
        `;
    }

    function restartQuiz(mode) {
        let subset = [];
        
        // Filtramos usando el 'id'
        if (mode === 'all') {
            subset = quizData;
        } else if (mode === 'marked') {
            subset = quizData.filter(q => markedQuestions.has(q.id));
        } else if (mode === 'failed') {
            subset = quizData.filter(q => failedQuestions.has(q.id));
        } else if (mode === 'failed_marked') {
            subset = quizData.filter(q => failedQuestions.has(q.id) || markedQuestions.has(q.id));
        }

        // Limpiamos los fallos de la sesi√≥n anterior
        if(mode !== 'all') {
            failedQuestions.clear(); 
        } else {
            failedQuestions.clear();
            markedQuestions.clear(); // Reset completo
        }

        renderQuiz(subset);
        window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    // Iniciar
    renderQuiz();
</script>

</body>
</html>
