<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Biof√≠sica Respiratoria</title>
    <style>
        :root {
            --primary: #15803d; /* Verde principal */
            --primary-dark: #14532d;
            --primary-light: #bbf7d0;
            --bg: #f0fdf4;
            --text: #1a1a1a;
            --white: #ffffff;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg);
            color: var(--text);
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
        }

        h1 {
            text-align: center;
            color: var(--primary);
            margin-bottom: 10px;
        }

        .intro-text {
            text-align: center;
            margin-bottom: 30px;
            color: #6c757d;
        }

        .question-card {
            background: var(--white);
            border-radius: 10px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            border-left: 5px solid var(--primary-light);
            transition: transform 0.2s;
            position: relative;
        }

        .question-card:hover {
            border-left-color: var(--primary);
        }

        /* --- NUEVO: Estilos para el Checkbox --- */
        .mark-container {
            display: flex;
            align-items: center;
            justify-content: flex-end;
            margin-bottom: 15px;
            font-size: 0.9em;
            color: #166534;
            font-weight: bold;
            border-bottom: 1px solid #dcfce7;
            padding-bottom: 10px;
        }
        .mark-container input {
            margin-right: 8px;
            transform: scale(1.3);
            cursor: pointer;
            accent-color: var(--primary);
        }
        .mark-container label {
            cursor: pointer;
        }

        .question-header {
            font-size: 0.85em;
            color: #166534;
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 1px;
            font-weight: bold;
        }

        .question-text {
            font-weight: 600;
            font-size: 1.15em;
            margin-bottom: 20px;
            color: #343a40;
        }

        .options-container {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .option-btn {
            padding: 14px 18px;
            border: 2px solid #e9ecef;
            background: #fff;
            border-radius: 8px;
            cursor: pointer;
            text-align: left;
            transition: all 0.2s;
            font-size: 1em;
            color: #495057;
        }

        .option-btn:hover:not(:disabled) {
            background-color: #dcfce7;
            border-color: var(--primary);
        }

        .option-btn:disabled {
            cursor: default;
            opacity: 0.7;
        }

        .correct {
            background-color: #d1e7dd !important;
            border-color: #198754 !important;
            color: #0f5132 !important;
        }

        .incorrect {
            background-color: #f8d7da !important;
            border-color: #dc3545 !important;
            color: #842029 !important;
        }

        .explanation {
            margin-top: 15px;
            padding: 15px;
            background-color: #f0fdf4;
            border-left: 5px solid #22c55e;
            border-radius: 4px;
            display: none;
            font-size: 0.95em;
        }

        .explanation.visible {
            display: block;
            animation: fadeIn 0.5s;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        /* --- Estilos para el √°rea de controles finales --- */
        #controls-area {
            margin-top: 40px;
            text-align: center;
            padding: 30px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            border-top: 4px solid var(--primary);
        }
        .action-btn {
            background: var(--primary-dark); color: white; border: none;
            padding: 12px 24px; font-size: 1em; border-radius: 8px;
            cursor: pointer; margin: 5px;
            transition: background 0.3s;
            font-weight: 600;
        }
        .action-btn:hover { background: var(--primary); }
        
        .restart-options {
            display: none;
            flex-direction: column;
            gap: 10px;
            margin-top: 20px;
        }
        .restart-options button {
            background: var(--primary);
        }
        .restart-options button:hover { background: #15803d; }

    </style>
</head>
<body>

    <h1>Biof√≠sica: Respiratorio y Superficies</h1>
    <p class="intro-text">Tensi√≥n superficial, Surfactantes y Ventilaci√≥n</p>
    
    <div id="quiz-container"></div>

    <div id="controls-area">
        <button id="finish-btn" class="action-btn" onclick="showEndOptions()">üèÅ Finalizar revisi√≥n</button>
        
        <div id="restart-menu" class="restart-options">
            <h3>¬øC√≥mo deseas continuar?</h3>
            <p id="stats-summary"></p>
            <button class="action-btn" onclick="restartQuiz('all')">üîÑ Rehacer el cuestionario entero</button>
            <button class="action-btn" onclick="restartQuiz('marked')">üîñ Hacer solo las preguntas marcadas</button>
            <button class="action-btn" onclick="restartQuiz('failed')">‚ùå Hacer solo las preguntas falladas</button>
            <button class="action-btn" onclick="restartQuiz('failed_marked')">‚ö†Ô∏è Hacer falladas y marcadas</button>
        </div>
    </div>

<script>
    const quizData = [
        { q: "1. El volumen residual pulmonar se estima en:", opts: ["30%", "10%", "20%", "5%"], a: "30%" },
        { q: "2. El √°ngulo de conjunci√≥n para un l√≠quido que moja es:", opts: ["Mayor de 90¬∫", "Menor de 90¬∫", "Igual a 90¬∫", "Igual al √°ngulo de contacto"], a: "Menor de 90¬∫" },
        { q: "3. Seg√∫n la ley de Laplace, cuando una burbuja crece, el radio aumenta y:", opts: ["La tensi√≥n superficial disminuye", "La presi√≥n aumenta", "La presi√≥n disminuye", "La tensi√≥n superficial aumenta"], a: "La presi√≥n disminuye" },
        { q: "4. ¬øCu√°les son los procesos involucrados en el intercambio gaseoso entre sangre y pulmones?", opts: ["Pandeo y vaciado", "Densidad y velocidad", "Difusi√≥n y ventilaci√≥n", "Perfusi√≥n y ventilaci√≥n"], a: "Perfusi√≥n y ventilaci√≥n" },
        { q: "5. La unidad de la tensi√≥n superficial en el S.I., es:", opts: ["Kg/s", "N.m/s", "N.m", "N/m"], a: "N/m" },
        { q: "6. En la pared alveolar el O2 se difunde m√°s r√°pidamente que el CO2 porque:", opts: ["La masa del primero es menor que la del segundo", "Es m√°s reactivo", "La masa del primero es mayor que la del segundo", "La solubilidad del Ox√≠geno en la sangre es mayor que la del di√≥xido de carbono"], a: "La masa del primero es menor que la del segundo" },
        { q: "7. Cuando disminuye la superficie de un l√≠quido no surfactante, la tensi√≥n superficial:", opts: ["Se anula", "Permanece constante", "Disminuye", "Aumenta"], a: "Permanece constante" },
        { q: "8. La presi√≥n parcial del ox√≠geno en el aire alveolar es:", opts: ["20 mm de Hg", "80 mm de Hg", "100 mm de Hg", "40 mm Hg"], a: "100 mm de Hg" },
        { q: "9. En un pulm√≥n normal, el 90% de su superficie corresponde a zonas con:", opts: ["Buena perfusi√≥n", "Buena ventilaci√≥n", "Pobre ventilaci√≥n", "La a) y b)"], a: "La a) y b)" },
        { q: "10. El valor del cociente respiratorio es:", opts: ["1", "Menor que 1", "Mayor que 1", "0"], a: "Menor que 1" },
        { q: "11. El Quim√≥grafo es un componente de:", opts: ["El fonendoscopio", "El espir√≥metro", "El esfigmoman√≥metro", "El estetoscopio"], a: "El espir√≥metro" },
        { q: "12. En la pared alveolar el O2 difunde m√°s r√°pido que el CO2 porque (Repetida):", opts: ["Su masa es menor", "Es m√°s r√°pido", "Es m√°s reactivo", "Es m√°s soluble en sangre que el CO2"], a: "Su masa es menor" },
        { q: "13. La presi√≥n alveolar es respecto a la atmosf√©rica en la inspiraci√≥n:", opts: ["3mm de Hg mayor", "3mm de Hg menor (aprox. -1 a -3 mmHg)", "Igual a la atmosf√©rica", "Igual a la presi√≥n de CO2"], a: "3mm de Hg menor (aprox. -1 a -3 mmHg)" },
        { q: "14. La compliancia del aparato respiratorio para el hombre en la zona de respiraci√≥n normal es:", opts: ["0,01 l/cm agua", "0,1 l/cm agua", "0,01 l/mm de Hg", "0,1 mm de Hg"], a: "0,1 l/cm agua" },
        { q: "15. Cuando disminuye la superficie de un l√≠quido surfactante, la tensi√≥n superficial:", opts: ["Aumenta", "Disminuye", "Permanece constante", "Se anula"], a: "Disminuye" },
        { q: "16. El modelo burbuja y membrana el√°stica del alveolo con tensi√≥n superficial constante:", opts: ["A- Utiliza la ecuaci√≥n de Laplace", "B- Explica la fase de llenado", "C- Explica la fase de vaciado", "La a y b"], a: "La a y b" },
        { q: "17. En el modelo burbuja con el l√≠quido surfactante disminuyendo la superficie:", opts: ["Las curvas V/P se desplazan hacia la derecha", "Las curvas V/P se desplazan hacia la izquierda (Mayor complianza)", "La tensi√≥n superficial es constante", "No se alteran las curvas V/P"], a: "Las curvas V/P se desplazan hacia la izquierda (Mayor complianza)" },
        { q: "18. Un m√©todo de diagn√≥stico de enfermedades del sistema respiratorio es la obtenci√≥n del:", opts: ["Electrocardiograma", "Balistocardiograma", "Espirograma", "Termograma"], a: "Espirograma" },
        { q: "19. La embolia pulmonar, producir√° una zona con:", opts: ["Pobre ventilaci√≥n", "Buena perfusi√≥n", "Pobre perfusi√≥n", "Buena ventilaci√≥n"], a: "Pobre perfusi√≥n" },
        { q: "20. La perfusi√≥n es:", opts: ["Suministro de aire a la superficie alveolar", "Aumento de la presi√≥n pulmonar", "Suministro de sangre a los capilares pulmonares", "Expulsi√≥n de la sangre del coraz√≥n"], a: "Suministro de sangre a los capilares pulmonares" },
        { q: "21. Se denomina capacidad funcional residual a:", opts: ["Volumen de aire expulsado por los pulmones en cada espiraci√≥n", "Raz√≥n de O2 espirado y O2 inspirado", "Volumen de aire introducido en los pulmones en cada inspiraci√≥n", "Volumen de aire retenido en los pulmones al final de cada espiraci√≥n"], a: "Volumen de aire retenido en los pulmones al final de cada espiraci√≥n" },
        { q: "22. La proporcionalidad que existe entre la cantidad de O2 disuelta en la sangre y la presi√≥n parcial de O2 en la fase gaseosa se conoce como:", opts: ["Ley de la difusi√≥n", "Ley de Dalton de las presiones parciales", "Ley de Henry de la solubilidad de gases", "Perfusi√≥n"], a: "Ley de Henry de la solubilidad de gases" },
        { q: "23. Se entiende por √≠ndice de refracci√≥n de un medio al cociente entre la velocidad de la luz en:", opts: ["El vac√≠o y dicho medio", "El agua y dicho medio", "El aire y el agua", "El aire y el cuerpo humano"], a: "El vac√≠o y dicho medio" },
        { q: "24. La tensi√≥n superficial:", opts: ["A- Es una caracter√≠stica del l√≠quido", "B- Da origen a fuerzas perpendiculares a la superficie", "C- Da lugar a fuerzas paralelas a la superficie", "a y c son ciertas"], a: "a y c son ciertas" },
        { q: "25. La tensi√≥n superficial depende:", opts: ["Del l√≠quido", "Del medio", "a y b son ciertas", "De la temperatura"], a: "a y b son ciertas" },
        { q: "26. El cociente respiratorio relaciona:", opts: ["Valor cal√≥rico del O2 consumido con el volumen de carb√≥nico eliminado", "Vol√∫menes de O2 consumidos con vol√∫menes de CO2 eliminados", "El volumen de O2 consumido con el valor cal√≥rico del CO2 excretado", "Los valores cal√≥ricos del O2 consumido con y del carb√≥nico"], a: "Vol√∫menes de O2 consumidos con vol√∫menes de CO2 eliminados" },
        { q: "27. La perfusi√≥n es (Repetida):", opts: ["Suministro de aire a la superficie alveolar", "Aumento de la presi√≥n pulmonar", "Suministro de sangre a los capilares pulmonares", "Expulsi√≥n de sangre del coraz√≥n"], a: "Suministro de sangre a los capilares pulmonares" },
        { q: "28. Con un espir√≥metro no se podr√° obtener:", opts: ["El volumen inspirado por los pulmones", "El volumen espirado por los pulmones", "La capacidad funcional residual de los pulmones", "a y b"], a: "La capacidad funcional residual de los pulmones" },
        { q: "29. La proporcionalidad que existe entre la cantidad de O2 disuelta en sangre y la presi√≥n parcial de O2 en la fase gaseosa se conoce como:", opts: ["Ley de la difusi√≥n", "Ley de Dalton de las presiones parciales", "Ley de Henry de la solubilidad de los gases", "Perfusi√≥n"], a: "Ley de Henry de la solubilidad de los gases" },
        { q: "30. El proceso que consiste en suministrar sangre a los capilares se denomina:", opts: ["Difusi√≥n", "Perfusi√≥n", "Ventilaci√≥n", "Estenosis"], a: "Perfusi√≥n" },
        { q: "31. La presi√≥n parcial del di√≥xido de carbono en el aire alveolar es de:", opts: ["40 mmHg", "20 mmHg", "80 mmHg", "100 mmHg"], a: "40 mmHg" },
        { q: "32. En la ley de Jurin, una de las siguientes afirmaciones no es correcta:", opts: ["La altura es inversamente proporcional al radio", "La altura en el capilar es inversamente proporcional a la gravedad", "La altura en el capilar es inversamente proporcional a la densidad", "La altura en el capilar es inversamente proporcional a la tensi√≥n superficial"], a: "La altura en el capilar es inversamente proporcional a la tensi√≥n superficial" },
        { q: "33. Respecto a la tensi√≥n interfacial se dice:", opts: ["Si es positiva, no hay humectaci√≥n", "Si es positiva hay humectaci√≥n (Coeficiente de extensi√≥n)", "Si es negativa, no hay humectaci√≥n", "La b y la c son ciertas"], a: "Si es positiva, no hay humectaci√≥n" },
        { q: "34. En una embolia pulmonar (obstrucci√≥n, por un co√°gulo, de un vaso sangu√≠neo que suministra sangre a una parte del pulm√≥n), se produce:", opts: ["Aumento de la ventilaci√≥n", "Aumento de la difusi√≥n", "Engrosamiento de la pared alveolar", "Disminuci√≥n de la perfusi√≥n"], a: "Disminuci√≥n de la perfusi√≥n" },
        { q: "35. La causa por la que la caracter√≠stica presi√≥n y volumen del pulm√≥n presenta un ciclo de hist√©resis es:", opts: ["La ley de Hooke", "La tensi√≥n superficial del l√≠quido surfactante que ba√±a a los alv√©olos", "El teorema de Bernoulli", "El √°ngulo de contacto"], a: "La tensi√≥n superficial del l√≠quido surfactante que ba√±a a los alv√©olos" },
        { q: "36. Los l√≠quidos surfactantes son aquellos que:", opts: ["Recubren el alveolo", "Su tensi√≥n superficial se anula", "Var√≠an su tensi√≥n superficial seg√∫n el espacio que ocupen", "Su tensi√≥n superficial permanece constante"], a: "Var√≠an su tensi√≥n superficial seg√∫n el espacio que ocupen" },
        { q: "37. Se denomina raz√≥n de intercambio respiratorio o cociente R respiratorio a:", opts: ["Raz√≥n de O2 que se expulsa y CO2 que entra en los pulmones", "Raz√≥n de CO2 que se expulsa y O2 que entra en los pulmones", "Volumen retenido al final de cada respiraci√≥n", "Volumen total de O2 inspirado"], a: "Raz√≥n de CO2 que se expulsa y O2 que entra en los pulmones" },
        { q: "38. La ventilaci√≥n consiste en:", opts: ["Suministro de sangre a los capilares pulmonares", "Suministro de aire a la superficie alveolar", "Determinar el volumen de gas espirado", "Renovaci√≥n periodica del aire alveolar : expiraci√≥n mas inspiracion"], a: "Renovaci√≥n periodica del aire alveolar : expiraci√≥n mas inspiracion" },
        { q: "39. En una pulmon√≠a el √°rea involucrada tendr√°:", opts: ["Pobre perfusi√≥n", "Buena ventilaci√≥n", "Mala ventilaci√≥n", "La a y la c"], a: "Mala ventilaci√≥n" },
        { q: "40. Cuando aumenta la superficie de un liquido no surfactante la tensi√≥n superficial:", opts: ["Aumenta", "Disminuye", "Se anula", "Se mantiene constante"], a: "Se mantiene constante" },
        { q: "41. Cuando aumenta la superficie de un liquido surfactante la tensi√≥n superficial:", opts: ["Aumenta (al disminuir concentraci√≥n superficial)", "Disminuye", "Permanece constante", "Se anula"], a: "Aumenta (al disminuir concentraci√≥n superficial)" },
        { q: "42. El cociente R o raz√≥n de intercambio es:", opts: ["Raz√≥n entre CO2 expulsado y O2 introducido en los pulmones", "Raz√≥n entre O2 expulsado y CO2 introducido en los pulmones", "Generalmente inferior a 1", "La a y la c"], a: "La a y la c" },
        { q: "43. El fen√≥meno de la capilaridad es una consecuencia de:", opts: ["A- La existencia de un √°ngulo de conjunci√≥n dependiente de la tensi√≥n interfacial", "B- El teorema de Laplace", "C- El teorema de Bernoulli", "La A y la B"], a: "La A y la B" },
        { q: "44. El proceso general de intercambio de O2 y CO2 entre los alv√©olos y la sangre se rige por:", opts: ["La ecuaci√≥n de continuidad", "La ley de las presiones parciales de Dalton (y difusi√≥n)", "El teorema de Bernoulli", "La ley de Poiseuille"], a: "La ley de las presiones parciales de Dalton (y difusi√≥n)" },
        { q: "45. Los l√≠quidos surfactantes son aquellos que:", opts: ["Mojan a un s√≥lido", "Var√≠an su tensi√≥n superficial seg√∫n el espacio que ocupan", "Su tensi√≥n superficial permanece constante", "Su tensi√≥n superficial se anula"], a: "Var√≠an su tensi√≥n superficial seg√∫n el espacio que ocupan" },
        { q: "46. Cuando disminuye la superficie de un l√≠quido no surfactante, la tensi√≥n superficial:", opts: ["Aumenta", "Disminuye", "Se mantiene constante", "Se anula"], a: "Se mantiene constante" },
        { q: "47. Cuando la tensi√≥n interfacial es positiva:", opts: ["El s√≥lido ejerce m√°s fuerza que el l√≠quido", "El l√≠quido ejerce m√°s fuerza que el s√≥lido", "Ambos ejercen la misma fuerza", "Ninguna es correcta"], a: "El l√≠quido ejerce m√°s fuerza que el s√≥lido" },
        { q: "48. ¬øCu√°les son los procesos involuntarios en el intercambio gaseoso entre sangre y pulmones?", opts: ["Perfusi√≥n y ventilaci√≥n", "Pandeo y vaciado", "Densidad y velocidad", "Difusi√≥n y ventilaci√≥n"], a: "Difusi√≥n y ventilaci√≥n" },
        { q: "49. ¬øQu√© dura m√°s?", opts: ["Este test", "La vida universitaria de Machuka"], a: "La vida universitaria de Machuka" },
        { q: "50. Tiene la doble nacionalidad:", opts: ["Bartelinho", "Mr bottle"], a: "Bartelinho" },
        { q: "51. La mejor cerveza:", opts: ["Alhambra", "Cruzcampo", "Estrella Galicia"], a: "Estrella Galicia" }
    ];

    // --- ASIGNAR IDs √öNICOS ---
    quizData.forEach((item, index) => {
        item.id = index;
    });

    // --- GESTI√ìN DE ESTADO ---
    let markedQuestions = new Set();
    let failedQuestions = new Set();

    function shuffleArray(array) {
        let currentIndex = array.length, randomIndex;
        while (currentIndex !== 0) {
            randomIndex = Math.floor(Math.random() * currentIndex);
            currentIndex--;
            [array[currentIndex], array[randomIndex]] = [array[randomIndex], array[currentIndex]];
        }
        return array;
    }

    const container = document.getElementById('quiz-container');

    // Funci√≥n principal para renderizar el quiz
    function renderQuiz(questionsToLoad = quizData) {
        container.innerHTML = "";

        // Ocultar men√∫ de reinicio y mostrar bot√≥n de finalizar
        document.getElementById("restart-menu").style.display = "none";
        document.getElementById("finish-btn").style.display = "inline-block";

        if(questionsToLoad.length === 0) {
            container.innerHTML = "<p style='text-align:center; padding:20px; font-weight:bold;'>No hay preguntas para mostrar en esta selecci√≥n.</p>";
            return;
        }

        questionsToLoad.forEach((item, displayIndex) => {
            const card = document.createElement('div');
            card.className = 'question-card';

            // --- SECCI√ìN: Checkbox de Marcar para revisar ---
            const markContainer = document.createElement("div");
            markContainer.className = "mark-container";
            
            const checkbox = document.createElement("input");
            checkbox.type = "checkbox";
            checkbox.id = `mark-${item.id}`;
            // Si ya estaba marcada en la sesi√≥n global, mantener el check
            if(markedQuestions.has(item.id)) checkbox.checked = true;

            checkbox.onchange = (e) => {
                if(e.target.checked) {
                    markedQuestions.add(item.id);
                } else {
                    markedQuestions.delete(item.id);
                }
            };

            const label = document.createElement("label");
            label.htmlFor = `mark-${item.id}`;
            label.innerText = "Marcar para revisar";

            markContainer.appendChild(checkbox);
            markContainer.appendChild(label);
            card.appendChild(markContainer);
            // ------------------------------------------------

            const header = document.createElement('div');
            header.className = 'question-header';
            header.textContent = `Pregunta ${item.id + 1}`; 
            card.appendChild(header);

            const questionText = document.createElement('div');
            questionText.className = 'question-text';
            questionText.innerHTML = item.q; // Usar innerHTML para respetar los diagramas originales si existieran
            
            // L√≥gica original de diagramas (adaptada para funcionar con filtros)
            if (item.id === 0 || item.id === 20 || item.id === 2 || item.id === 15 || item.id === 3 || item.id === 33) {
                 questionText.innerHTML += `<br>`;
            }

            card.appendChild(questionText);

            const optionsDiv = document.createElement('div');
            optionsDiv.className = 'options-container';

            // Preparamos opciones
            let optionsObj = item.opts.map(opt => ({
                text: opt,
                isCorrect: opt === item.a
            }));

            // Barajamos opciones
            optionsObj = shuffleArray(optionsObj);

            // Explicaci√≥n
            const explanationDiv = document.createElement('div');
            explanationDiv.className = 'explanation';
            explanationDiv.innerHTML = `<strong>Respuesta Correcta:</strong> ${item.a}`;

            optionsObj.forEach(opt => {
                const btn = document.createElement('button');
                btn.className = 'option-btn';
                btn.textContent = opt.text;

                btn.onclick = () => {
                    const allBtns = optionsDiv.querySelectorAll('.option-btn');
                    allBtns.forEach(b => b.disabled = true);

                    if (opt.isCorrect) {
                        btn.classList.add('correct');
                    } else {
                        btn.classList.add('incorrect');
                        // --- REGISTRAR FALLO ---
                        failedQuestions.add(item.id);
                        
                        // marcar la correcta visualmente
                        allBtns.forEach(b => {
                            if (b.textContent === item.a) {
                                b.classList.add('correct');
                            }
                        });
                    }
                    explanationDiv.classList.add('visible');
                };
                optionsDiv.appendChild(btn);
            });

            card.appendChild(optionsDiv);
            card.appendChild(explanationDiv);
            container.appendChild(card);
        });
    }

    // --- FUNCIONES DE CONTROL FINAL ---

    function showEndOptions() {
        document.getElementById("finish-btn").style.display = "none";
        document.getElementById("restart-menu").style.display = "flex";
        
        // Scroll al final
        document.getElementById("controls-area").scrollIntoView({behavior: "smooth"});
        
        // Mostrar estad√≠sticas
        document.getElementById("stats-summary").innerHTML = `
            Preguntas marcadas: <strong>${markedQuestions.size}</strong><br>
            Preguntas falladas en esta sesi√≥n: <strong>${failedQuestions.size}</strong>
        `;
    }

    function restartQuiz(mode) {
        let subset = [];
        
        // Filtramos usando el 'id'
        if (mode === 'all') {
            subset = quizData;
        } else if (mode === 'marked') {
            subset = quizData.filter(q => markedQuestions.has(q.id));
        } else if (mode === 'failed') {
            subset = quizData.filter(q => failedQuestions.has(q.id));
        } else if (mode === 'failed_marked') {
            subset = quizData.filter(q => failedQuestions.has(q.id) || markedQuestions.has(q.id));
        }

        // Limpiamos los fallos de la sesi√≥n anterior
        if(mode !== 'all') {
            failedQuestions.clear(); 
        } else {
            failedQuestions.clear();
            markedQuestions.clear(); // Reset completo
        }

        renderQuiz(subset);
        window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    // Iniciar
    renderQuiz();
</script>

</body>
</html>
