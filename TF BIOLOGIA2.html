<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Examen Bloque 2 - Biolog√≠a Celular (Medicina C√°diz)</title>
    <style>
        :root {
            --primary-color: #0056b3;
            --secondary-color: #f0f8ff;
            --correct-color: #d4edda;
            --correct-text: #155724;
            --incorrect-color: #f8d7da;
            --incorrect-text: #721c24;
            --warning-bg: #fff3cd;
            --warning-text: #856404;
        }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background-color: #f4f4f9;
            color: #333;
        }
        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        header {
            text-align: center;
            border-bottom: 2px solid var(--primary-color);
            margin-bottom: 20px;
            padding-bottom: 10px;
        }
        h1 { color: var(--primary-color); margin: 0; font-size: 1.8rem; }
        .professors { font-style: italic; color: #666; margin-top: 5px; }
        
        .stats-bar {
            display: flex;
            justify-content: space-between;
            background: var(--secondary-color);
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            font-weight: bold;
            border: 1px solid #cce5ff;
        }

        .question-card {
            display: none;
            animation: fadeIn 0.5s;
            position: relative; /* Para posicionar la marca */
        }
        .question-card.active { display: block; }

        /* Estilo para el marcador (Pesta√±a) */
        .bookmark-panel {
            position: absolute;
            top: 0;
            right: 0;
            background: #fff3cd;
            padding: 5px 15px;
            border-radius: 20px;
            border: 1px solid #ffeeba;
            font-size: 0.9rem;
            color: #856404;
            display: flex;
            align-items: center;
            cursor: pointer;
            transition: background 0.2s;
        }
        .bookmark-panel:hover { background: #ffe8a1; }
        .bookmark-checkbox { margin-right: 8px; transform: scale(1.2); cursor: pointer; }

        .question-text {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 20px;
            padding-right: 150px; /* Espacio para que el texto no tape la marca */
        }

        .options-grid { display: grid; gap: 10px; }
        
        .option-btn {
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            background: white;
            cursor: pointer;
            text-align: left;
            font-size: 1rem;
            transition: all 0.2s;
            width: 100%;
        }
        .option-btn:hover:not(:disabled) {
            background-color: #f8f9fa;
            border-color: var(--primary-color);
        }
        .option-btn:disabled { cursor: default; opacity: 0.7; }
        
        .option-btn.correct {
            background-color: var(--correct-color);
            border-color: var(--correct-text);
            color: var(--correct-text);
        }
        .option-btn.incorrect {
            background-color: var(--incorrect-color);
            border-color: var(--incorrect-text);
            color: var(--incorrect-text);
        }

        .feedback {
            margin-top: 20px;
            padding: 15px;
            border-radius: 8px;
            display: none;
        }
        .feedback.show { display: block; }
        .feedback-correct {
            background-color: var(--correct-color);
            color: var(--correct-text);
            border-left: 5px solid var(--correct-text);
        }
        .feedback-incorrect {
            background-color: var(--incorrect-color);
            color: var(--incorrect-text);
            border-left: 5px solid var(--incorrect-text);
        }

        .navigation {
            margin-top: 20px;
            display: flex;
            justify-content: flex-end;
        }
        .nav-btn {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 10px 25px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1rem;
            display: none;
        }
        .nav-btn:hover { background-color: #004494; }

        .results-summary {
            text-align: center;
            display: none;
        }
        
        /* Grid de botones finales */
        .action-buttons-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-top: 30px;
        }
        .action-btn {
            padding: 15px;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            color: white;
            transition: transform 0.2s;
        }
        .action-btn:hover { transform: translateY(-2px); }
        .action-btn:disabled { background-color: #ccc !important; cursor: not-allowed; transform: none; }
        
        .btn-restart { background-color: var(--primary-color); grid-column: span 2; }
        .btn-failed { background-color: #dc3545; }
        .btn-marked { background-color: #ffc107; color: #333; }
        .btn-mixed { background-color: #6f42c1; grid-column: span 2; }

        .topic-tag {
            display: inline-block;
            background: #e9ecef;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 0.8rem;
            color: #495057;
            margin-bottom: 10px;
        }

        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    </style>
</head>
<body>

<div class="container">
    <header>
        <h1>Examen Bloque 2: Genoma</h1>
        <div class="professors">Medicina C√°diz - Llorca & Mu√±oz-Manchado</div>
    </header>

    <div class="stats-bar" id="statsBar">
        <div id="progress">Cargando...</div>
        <div id="score">Aciertos sesi√≥n: 0</div>
    </div>

    <div id="quiz-area"></div>

    <div id="results" class="results-summary">
        <h2>Sesi√≥n Finalizada</h2>
        <div style="font-size: 3rem; font-weight: bold; color: var(--primary-color);" id="final-score"></div>
        <p id="final-msg"></p>
        
        <div id="stats-summary" style="margin: 20px 0; color: #555;"></div>

        <div class="action-buttons-grid">
            <button class="action-btn btn-restart" onclick="startQuiz('all')">üîÑ Reiniciar Test Completo (Borrar todo)</button>
            <button class="action-btn btn-failed" id="btn-failed" onclick="startQuiz('failed')">‚ùå Repetir Falladas</button>
            <button class="action-btn btn-marked" id="btn-marked" onclick="startQuiz('marked')">‚ö†Ô∏è Repetir Marcadas</button>
            <button class="action-btn btn-mixed" id="btn-mixed" onclick="startQuiz('mixed')">‚ùå + ‚ö†Ô∏è Repetir Falladas y Marcadas</button>
        </div>
    </div>
</div>

<script>
// --- DATOS DE LAS PREGUNTAS ---
const questions = [
    // --- TEMA 2.1: Estructura del ADN y Cromosomas ---
    {
        topic: "Dogma Central",
        question: "¬øCu√°l es el flujo de informaci√≥n conocido como el 'Dogma Central' de la biolog√≠a molecular?",
        options: ["Prote√≠nas ‚Üí ARN ‚Üí ADN", "ADN ‚Üí ARN ‚Üí Prote√≠nas", "ARN ‚Üí ADN ‚Üí Prote√≠nas", "ADN ‚Üí Prote√≠nas ‚Üí ARN"],
        correct: 1,
        explanation: "El dogma central describe que las instrucciones del ADN se transcriben a ARN y luego se traducen a prote√≠nas."
    },
    {
        topic: "Experimentos Hist√≥ricos",
        question: "¬øQu√© demostraron Hershey y Chase en 1952 utilizando bacteri√≥fagos marcados radiactivamente?",
        options: ["Que las prote√≠nas son el material gen√©tico.", "Que el ARN es el principio transformador.", "Que el ADN, y no la prote√≠na, es el portador de la informaci√≥n gen√©tica.", "Que la replicaci√≥n es semiconservadora."],
        correct: 2,
        explanation: "Al marcar ADN con P32 y prote√≠nas con S35, vieron que solo el P32 entraba en la bacteria, confirmando al ADN como material gen√©tico."
    },
    {
        topic: "Estructura del ADN",
        question: "¬øQu√© tipo de enlace qu√≠mico une las bases nitrogenadas de las dos hebras de ADN entre s√≠?",
        options: ["Enlaces covalentes fosfodi√©ster", "Enlaces pept√≠dicos", "Puentes de hidr√≥geno", "Enlaces i√≥nicos"],
        correct: 2,
        explanation: "Las bases complementarias (A-T, G-C) se unen mediante puentes de hidr√≥geno en el centro de la h√©lice."
    },
    {
        topic: "Estructura del ADN",
        question: "¬øCu√°ntos puentes de hidr√≥geno estabilizan el par Guanina-Citosina?",
        options: ["Uno", "Dos", "Tres", "Cuatro"],
        correct: 2,
        explanation: "El par G-C forma tres puentes de hidr√≥geno, mientras que el par A-T forma solo dos."
    },
    {
        topic: "Empaquetamiento",
        question: "¬øCu√°l es la unidad estructural b√°sica de la cromatina?",
        options: ["El cromosoma mit√≥tico", "El nucleosoma", "La fibra de 30 nm", "El dominio en bucle"],
        correct: 1,
        explanation: "El nucleosoma es la unidad b√°sica, formada por ADN enrollado alrededor de un oct√°mero de histonas."
    },
    {
        topic: "Empaquetamiento",
        question: "¬øQu√© prote√≠nas forman el oct√°mero del nucleosoma?",
        options: ["Dos copias de H1, H2A, H2B y H3", "Dos copias de H2A, H2B, H3 y H4", "Una copia de H1, H2, H3 y H4", "Cuatro copias de H3 y H4"],
        correct: 1,
        explanation: "El n√∫cleo del nucleosoma contiene dos mol√©culas de cada histona: H2A, H2B, H3 y H4. La H1 es externa."
    },
    {
        topic: "Empaquetamiento",
        question: "¬øQu√© funci√≥n cumple la histona H1?",
        options: ["Formar parte del oct√°mero central.", "Unirse al ADN conector y ayudar a compactar los nucleosomas en la fibra de 30 nm.", "Desenrollar el ADN para la transcripci√≥n.", "Reparar el ADN da√±ado."],
        correct: 1,
        explanation: "La H1 es la histona 'de uni√≥n' o linker que facilita la formaci√≥n de estructuras m√°s compactas como la fibra de 30 nm."
    },
    {
        topic: "Cromatina",
        question: "¬øQu√© es la Heterocromatina?",
        options: ["La forma menos condensada de cromatina, transcripcionalmente activa.", "Cromatina exclusiva de las mitocondrias.", "La forma muy condensada de cromatina, asociada a genes silenciados.", "El ADN desnudo sin histonas."],
        correct: 2,
        explanation: "La heterocromatina es compacta y generalmente inactiva transcripcionalmente, al contrario que la eucromatina."
    },
    {
        topic: "Epigen√©tica",
        question: "¬øQu√© efecto suele tener la acetilaci√≥n de las colas de histonas?",
        options: ["Condensar la cromatina y silenciar genes.", "Relajar la cromatina y favorecer la expresi√≥n g√©nica.", "Provocar la degradaci√≥n de las histonas.", "Inducir la replicaci√≥n del ADN."],
        correct: 1,
        explanation: "La acetilaci√≥n elimina la carga positiva de las histonas, debilitando su uni√≥n al ADN y abriendo la estructura (eucromatina)."
    },
    {
        topic: "Epigen√©tica",
        question: "¬øQu√© complejo enzim√°tico utiliza ATP para deslizar los nucleosomas y hacer el ADN m√°s accesible?",
        options: ["ADN Polimerasa", "Complejos remodeladores de la cromatina", "Histona desacetilasa", "Ligasa"],
        correct: 1,
        explanation: "Los complejos remodeladores de cromatina usan energ√≠a (ATP) para mover los nucleosomas."
    },
    // --- TEMA 2.2: Replicaci√≥n del ADN ---
    {
        topic: "Replicaci√≥n",
        question: "¬øQu√© modelo sigue la replicaci√≥n del ADN?",
        options: ["Conservador", "Dispersivo", "Semiconservador", "Aleatorio"],
        correct: 2,
        explanation: "Es semiconservador: cada mol√©cula hija conserva una hebra original y tiene una nueva."
    },
    {
        topic: "Replicaci√≥n",
        question: "¬øEn qu√© direcci√≥n sintetiza siempre la ADN polimerasa la nueva cadena?",
        options: ["3' a 5'", "5' a 3'", "Bidireccional simult√°nea en la misma hebra", "Depende de si es la hebra l√≠der o retrasada"],
        correct: 1,
        explanation: "La ADN polimerasa solo puede a√±adir nucle√≥tidos en el extremo 3', por lo que sintetiza siempre en direcci√≥n 5' ‚Üí 3'."
    },
    {
        topic: "Replicaci√≥n",
        question: "¬øQu√© son los fragmentos de Okazaki?",
        options: ["Errores en la replicaci√≥n que deben ser eliminados.", "Segmentos de ADN sintetizados de forma discontinua en la cadena retrasada.", "Los cebadores de ARN necesarios para iniciar.", "Fragmentos de ADN degradados por nucleasas."],
        correct: 1,
        explanation: "Debido a la asimetr√≠a de la horquilla, la cadena retrasada se sintetiza en trozos cortos llamados fragmentos de Okazaki."
    },
    {
        topic: "Enzimas Replicaci√≥n",
        question: "¬øQu√© funci√≥n tiene la ADN Helicasa?",
        options: ["Sintetizar el cebador de ARN.", "Unir los fragmentos de ADN.", "Separar la doble h√©lice de ADN rompiendo los puentes de hidr√≥geno.", "Aliviar la tensi√≥n de superenrollamiento."],
        correct: 2,
        explanation: "La helicasa 'abre' la doble h√©lice para permitir el acceso de la polimerasa."
    },
    {
        topic: "Enzimas Replicaci√≥n",
        question: "¬øQu√© enzima sintetiza el cebador (primer) necesario para iniciar la replicaci√≥n?",
        options: ["ADN Polimerasa", "Primasa", "Ligasa", "Topoisomerasa"],
        correct: 1,
        explanation: "La primasa es una ARN polimerasa que crea un peque√±o segmento de ARN (cebador) para que la ADN polimerasa pueda empezar."
    },
    {
        topic: "Enzimas Replicaci√≥n",
        question: "¬øQu√© funci√≥n realiza la ADN Ligasa?",
        options: ["Sintetizar ADN en la cadena l√≠der.", "Eliminar los cebadores de ARN.", "Unir los fragmentos de Okazaki sellando el esqueleto az√∫car-fosfato.", "Mantener las hebras separadas."],
        correct: 2,
        explanation: "La ligasa une los cortes o 'mellas' entre fragmentos de ADN, gastando ATP."
    },
    {
        topic: "Enzimas Replicaci√≥n",
        question: "¬øQu√© enzima alivia la tensi√≥n de superenrollamiento por delante de la horquilla de replicaci√≥n?",
        options: ["Telomerasa", "Helicasa", "Topoisomerasa", "Primasa"],
        correct: 2,
        explanation: "La topoisomerasa corta y vuelve a unir el ADN para liberar la tensi√≥n torsional generada al desenrollar la h√©lice."
    },
    {
        topic: "Tel√≥meros",
        question: "¬øQu√© problema soluciona la Telomerasa?",
        options: ["La replicaci√≥n de los extremos de los cromosomas lineales (cadena retrasada).", "La uni√≥n de los fragmentos de Okazaki.", "La separaci√≥n de las crom√°tidas hermanas.", "La correcci√≥n de errores de apareamiento."],
        correct: 0,
        explanation: "La telomerasa alarga los tel√≥meros usando un molde de ARN propio, evitando que los cromosomas se acorten en cada divisi√≥n."
    },
    {
        topic: "Tel√≥meros",
        question: "¬øQu√© son los tel√≥meros?",
        options: ["Secuencias codificantes en el centro del cromosoma.", "Secuencias repetitivas en los extremos de los cromosomas que act√∫an como capuchones.", "Prote√≠nas que unen las crom√°tidas.", "Tipos de ARN regulador."],
        correct: 1,
        explanation: "Son secuencias repetitivas no codificantes que protegen los extremos del cromosoma de la degradaci√≥n."
    },
    {
        topic: "Precisi√≥n",
        question: "¬øQu√© actividad de la ADN polimerasa le permite corregir errores durante la s√≠ntesis?",
        options: ["Actividad exonucleasa (proofreading o correcci√≥n de pruebas).", "Actividad helicasa.", "Actividad primasa.", "Actividad ligasa."],
        correct: 0,
        explanation: "La polimerasa revisa el √∫ltimo nucle√≥tido a√±adido y, si es incorrecto, lo elimina antes de continuar."
    },
    // --- TEMA 2.2: Reparaci√≥n del ADN ---
    {
        topic: "Da√±o ADN",
        question: "¬øQu√© es la despurinaci√≥n?",
        options: ["La p√©rdida de un grupo amino de una base.", "La p√©rdida espont√°nea de bases p√∫ricas (A o G).", "La formaci√≥n de d√≠meros de timina.", "La rotura de la doble hebra."],
        correct: 1,
        explanation: "Es la p√©rdida espont√°nea de una base de purina del esqueleto az√∫car-fosfato."
    },
    {
        topic: "Da√±o ADN",
        question: "¬øQu√© tipo de da√±o causa com√∫nmente la radiaci√≥n ultravioleta (UV)?",
        options: ["Desaminaci√≥n de la citosina.", "D√≠meros de timina.", "Roturas bicatenarias.", "P√©rdida de tel√≥meros."],
        correct: 1,
        explanation: "La luz UV provoca enlaces covalentes entre timinas adyacentes, formando d√≠meros que bloquean la replicaci√≥n."
    },
    {
        topic: "Reparaci√≥n",
        question: "¬øQu√© mecanismo repara las roturas bicatenarias de forma precisa utilizando la crom√°tida hermana?",
        options: ["Uni√≥n de extremos no hom√≥logos (NHEJ).", "Recombinaci√≥n hom√≥loga.", "Reparaci√≥n de apareamientos err√≥neos.", "Correcci√≥n de pruebas."],
        correct: 1,
        explanation: "La recombinaci√≥n hom√≥loga usa la copia id√©ntica como molde para reparar sin perder informaci√≥n (alta fidelidad)."
    },
    {
        topic: "Reparaci√≥n",
        question: "¬øCu√°l es la desventaja de la Uni√≥n de Extremos No Hom√≥logos (NHEJ)?",
        options: ["Es muy lenta.", "Solo ocurre en la fase S.", "A menudo resulta en p√©rdida o adici√≥n de nucle√≥tidos (mutaci√≥n).", "Requiere un molde de ARN."],
        correct: 2,
        explanation: "Es una reparaci√≥n de emergencia 'r√°pida y sucia' que simplemente une los extremos rotos, introduciendo errores."
    },
    {
        topic: "Patolog√≠a",
        question: "¬øQu√© enfermedad es causada por una mutaci√≥n puntual en el gen de la hemoglobina?",
        options: ["Atrofia Muscular Espinal", "Anemia falciforme (drepanoc√≠tica)", "C√°ncer de colon", "Fibrosis qu√≠stica"],
        correct: 1,
        explanation: "El cambio de un solo nucle√≥tido altera la estructura de la hemoglobina, deformando los gl√≥bulos rojos."
    },
    // --- TEMA 2.4: Transcripci√≥n ---
    {
        topic: "ARN",
        question: "¬øQu√© az√∫car contiene el ARN?",
        options: ["Desoxirribosa", "Ribosa", "Glucosa", "Fructosa"],
        correct: 1,
        explanation: "El ARN (√Åcido Ribonucleico) contiene ribosa, que tiene un grupo -OH adicional comparado con la desoxirribosa."
    },
    {
        topic: "ARN",
        question: "¬øQu√© base nitrogenada sustituye a la Timina en el ARN?",
        options: ["Adenina", "Citosina", "Uracilo", "Guanina"],
        correct: 2,
        explanation: "En el ARN, el Uracilo (U) se aparea con la Adenina (A) en lugar de la Timina."
    },
    {
        topic: "Transcripci√≥n",
        question: "¬øQu√© enzima cataliza la transcripci√≥n?",
        options: ["ADN Polimerasa", "ARN Polimerasa", "Ribosoma", "Helicasa"],
        correct: 1,
        explanation: "La ARN polimerasa sintetiza ARN a partir de un molde de ADN."
    },
    {
        topic: "Transcripci√≥n",
        question: "¬øC√≥mo se llama la secuencia de ADN donde se inicia la transcripci√≥n?",
        options: ["Terminador", "Promotor", "Tel√≥mero", "Intr√≥n"],
        correct: 1,
        explanation: "El promotor es la secuencia que indica a la polimerasa d√≥nde empezar."
    },
    {
        topic: "Transcripci√≥n Eucariota",
        question: "¬øQu√© requieren las ARN polimerasas eucariotas para iniciar la transcripci√≥n?",
        options: ["Solo el promotor.", "Factores Generales de Transcripci√≥n.", "Factor Sigma.", "Un cebador de ARN."],
        correct: 1,
        explanation: "Requieren un complejo de prote√≠nas (como TBP, TFIIH) para posicionarse en el promotor."
    },
    {
        topic: "Tipos de ARN",
        question: "¬øQu√© tipo de ARN codifica prote√≠nas?",
        options: ["ARNr (ribos√≥mico)", "ARNt (transferencia)", "ARNm (mensajero)", "miARN (microARN)"],
        correct: 2,
        explanation: "El ARNm lleva el mensaje gen√©tico del ADN al ribosoma para la s√≠ntesis de prote√≠nas."
    },
    // --- TEMA 2.5: Maduraci√≥n del ARN ---
    {
        topic: "Procesamiento ARN",
        question: "¬øD√≥nde ocurre el procesamiento del ARNm en eucariotas?",
        options: ["En el citoplasma.", "En el n√∫cleo.", "En el aparato de Golgi.", "En la mitocondria."],
        correct: 1,
        explanation: "La maduraci√≥n (capping, splicing, poliadenilaci√≥n) ocurre en el n√∫cleo antes de la exportaci√≥n."
    },
    {
        topic: "Procesamiento ARN",
        question: "¬øQu√© es el 'Capping' o encapuchamiento en 5'?",
        options: ["La adici√≥n de una cola de Adeninas.", "La eliminaci√≥n de intrones.", "La adici√≥n de una 7-metilguanosina al extremo 5'.", "La fosforilaci√≥n de la polimerasa."],
        correct: 2,
        explanation: "Es la adici√≥n de una guanosina modificada que protege el ARN y ayuda en la traducci√≥n."
    },
    {
        topic: "Procesamiento ARN",
        question: "¬øQu√© es la cola de poli-A?",
        options: ["Una secuencia de inicio.", "Una larga cadena de adeninas a√±adida al extremo 3'.", "Un tipo de histona.", "El sitio de uni√≥n del ribosoma."],
        correct: 1,
        explanation: "Aumenta la estabilidad del ARNm y regula su exportaci√≥n y traducci√≥n."
    },
    {
        topic: "Splicing",
        question: "¬øQu√© secuencias se eliminan durante el corte y empalme (splicing)?",
        options: ["Exones", "Intrones", "Promotores", "Tel√≥meros"],
        correct: 1,
        explanation: "Los intrones (secuencias no codificantes) se eliminan, dejando solo los exones."
    },
    {
        topic: "Splicing",
        question: "¬øQu√© permite el splicing alternativo?",
        options: ["Corregir errores del ADN.", "Producir m√∫ltiples prote√≠nas diferentes a partir de un mismo gen.", "Duplicar el ADN m√°s r√°pido.", "Eliminar exones da√±ados."],
        correct: 1,
        explanation: "Al combinar exones de formas distintas, un solo gen puede codificar varias isoformas de prote√≠nas."
    },
    // --- TEMA 2.6: Traducci√≥n ---
    {
        topic: "C√≥digo Gen√©tico",
        question: "¬øCu√°ntos nucle√≥tidos forman un cod√≥n?",
        options: ["Uno", "Dos", "Tres", "Cuatro"],
        correct: 2,
        explanation: "El c√≥digo gen√©tico se lee en tripletes de nucle√≥tidos."
    },
    {
        topic: "C√≥digo Gen√©tico",
        question: "¬øQu√© significa que el c√≥digo gen√©tico es 'degenerado'?",
        options: ["Que es ambiguo.", "Que la mayor√≠a de amino√°cidos est√°n codificados por m√°s de un cod√≥n.", "Que var√≠a entre especies.", "Que se degrada con el tiempo."],
        correct: 1,
        explanation: "Hay 64 codones para 20 amino√°cidos, por lo que hay redundancia (sin√≥nimos)."
    },
    {
        topic: "C√≥digo Gen√©tico",
        question: "¬øCu√°l es el cod√≥n de inicio habitual?",
        options: ["AUG", "UAA", "UAG", "GGA"],
        correct: 0,
        explanation: "AUG codifica para Metionina y marca el inicio de la traducci√≥n."
    },
    {
        topic: "C√≥digo Gen√©tico",
        question: "¬øQu√© se√±alan los codones UAA, UAG y UGA?",
        options: ["Inicio de la traducci√≥n.", "Inserci√≥n de Metionina.", "Parada (Stop) de la traducci√≥n.", "Sitio de splicing."],
        correct: 2,
        explanation: "Son codones de terminaci√≥n que no codifican amino√°cidos y detienen el ribosoma."
    },
    {
        topic: "Componentes Traducci√≥n",
        question: "¬øQu√© enzima une el amino√°cido correcto a su ARNt?",
        options: ["Peptidil transferasa", "Aminoacil-tRNA sintetasa", "ARN polimerasa", "Ligasa"],
        correct: 1,
        explanation: "Es la enzima que 'carga' el ARNt, garantizando la fidelidad de la traducci√≥n. Hay una para cada amino√°cido."
    },
    {
        topic: "Ribosoma",
        question: "¬øD√≥nde se encuentran los sitios A, P y E?",
        options: ["En la ARN polimerasa.", "En el ribosoma.", "En el nucleosoma.", "En el proteasoma."],
        correct: 1,
        explanation: "Son los sitios de uni√≥n para los ARNt dentro del ribosoma (Aminoacil, Peptidil, Exit)."
    },
    {
        topic: "Ribosoma",
        question: "¬øQu√© componente del ribosoma cataliza el enlace pept√≠dico (act√∫a como ribozima)?",
        options: ["Las prote√≠nas ribosomales.", "El ARNm.", "El ARNr (ARN ribos√≥mico).", "El ARNt."],
        correct: 2,
        explanation: "El ribosoma es una ribozima; la actividad catal√≠tica reside en el ARN, no en las prote√≠nas."
    },
    {
        topic: "Proceso Traducci√≥n",
        question: "¬øQu√© ocurre en la etapa de Terminaci√≥n?",
        options: ["Se a√±ade la caperuza 5'.", "Un factor de liberaci√≥n se une al cod√≥n de parada y libera la prote√≠na.", "El ribosoma se mueve al siguiente cod√≥n.", "El ARNt iniciador se une al sitio P."],
        correct: 1,
        explanation: "Los factores de liberaci√≥n reconocen el cod√≥n stop y provocan la hidr√≥lisis del enlace final."
    },
    {
        topic: "Polisomas",
        question: "¬øQu√© es un polisoma o polirribosoma?",
        options: ["Un ribosoma con muchas subunidades.", "M√∫ltiples ribosomas traduciendo simult√°neamente el mismo ARNm.", "Un complejo de muchos ARNm.", "Una prote√≠na con muchas cadenas."],
        correct: 1,
        explanation: "Aumentan la eficiencia de s√≠ntesis proteica permitiendo hacer muchas copias a la vez."
    },
    // --- PROTE√çNAS Y DEGRADACI√ìN ---
    {
        topic: "Destino Prote√≠nas",
        question: "¬øQu√© complejo degrada las prote√≠nas marcadas para su destrucci√≥n?",
        options: ["Lisosoma", "Proteasoma", "Ribosoma", "Nucleosoma"],
        correct: 1,
        explanation: "El proteasoma es una 'trituradora' molecular de prote√≠nas en el citosol y n√∫cleo."
    },
    {
        topic: "Degradaci√≥n",
        question: "¬øQu√© mol√©cula marca las prote√≠nas para ser degradadas en el proteasoma?",
        options: ["Ubiquitina", "Metilo", "Fosfato", "Acetilo"],
        correct: 0,
        explanation: "La poliubiquitinaci√≥n es la se√±al de 'beso de la muerte' que dirige a la prote√≠na al proteasoma."
    },
    {
        topic: "Replicaci√≥n",
        question: "¬øPor qu√© la s√≠ntesis de la cadena retrasada es discontinua?",
        options: ["Porque la polimerasa es lenta.", "Porque la h√©lice se abre en direcci√≥n opuesta a la s√≠ntesis 5'-3'.", "Porque faltan nucle√≥tidos.", "Porque no tiene molde."],
        correct: 1,
        explanation: "La polimerasa solo sintetiza 5'-3', debiendo ir 'hacia atr√°s' en la hebra retrasada a medida que se abre la horquilla."
    },
    {
        topic: "ARNt",
        question: "¬øQu√© es el anticod√≥n?",
        options: ["La secuencia de parada.", "La parte del ARNt complementaria al cod√≥n del ARNm.", "El sitio de uni√≥n del amino√°cido.", "Una parte del ribosoma."],
        correct: 1,
        explanation: "Es la secuencia de 3 bases en el ARNt que se aparea con el cod√≥n para asegurar la traducci√≥n correcta."
    },
    {
        topic: "Mutaciones",
        question: "¬øQu√© tipo de c√©lulas transmiten mutaciones a la descendencia?",
        options: ["C√©lulas som√°ticas.", "C√©lulas germinales.", "Neuronas.", "C√©lulas de la piel."],
        correct: 1,
        explanation: "Solo las mutaciones en la l√≠nea germinal (gametos) pasan a la siguiente generaci√≥n."
    },
    {
        topic: "Estructura ADN",
        question: "¬øQu√© significa que las hebras de ADN son antiparalelas?",
        options: ["Que nunca se tocan.", "Que una va en direcci√≥n 5'->3' y la otra en 3'->5'.", "Que tienen distinta composici√≥n.", "Que una es ARN y otra ADN."],
        correct: 1,
        explanation: "La polaridad de las cadenas es opuesta."
    },
    {
        topic: "Splicing",
        question: "¬øQu√© son las snRNP?",
        options: ["Prote√≠nas de membrana.", "Ribonucleoprote√≠nas nucleares peque√±as, componentes del empalmosoma.", "Tipos de ADN.", "Enzimas digestivas."],
        correct: 1,
        explanation: "Forman el n√∫cleo del espliceosoma que elimina intrones."
    },
    {
        topic: "Estructura Genoma",
        question: "¬øQu√© es un gen?",
        options: ["Una prote√≠na.", "Un segmento de ADN que contiene instrucciones para fabricar una prote√≠na o ARN.", "Un cromosoma entero.", "Un tipo de c√©lula."],
        correct: 1,
        explanation: "Es la unidad funcional de la herencia."
    },
    {
        topic: "Cromatina",
        question: "¬øQu√© es la Eucromatina?",
        options: ["Cromatina condensada inactiva.", "Cromatina menos condensada, accesible y activa.", "ADN viral.", "Cromosomas metaf√°sicos."],
        correct: 1,
        explanation: "Es la forma 'verdadera' (eu) donde residen los genes activos."
    },
    {
        topic: "Regulaci√≥n",
        question: "¬øQu√© son los ARN no codificantes reguladores (miRNA, siRNA)?",
        options: ["ARN basura.", "Mol√©culas que regulan la expresi√≥n g√©nica, a menudo silenciando genes.", "Precursores de prote√≠nas.", "Partes del ribosoma."],
        correct: 1,
        explanation: "Controlan la estabilidad y traducci√≥n de los ARNm."
    },
    {
        topic: "Dogma",
        question: "¬øQu√© excepci√≥n al dogma central realizan los retrovirus?",
        options: ["Traducci√≥n inversa (Prote√≠na a ARN).", "Transcripci√≥n inversa (ARN a ADN).", "Replicaci√≥n de prote√≠nas.", "Splicing de ADN."],
        correct: 1,
        explanation: "Usan transcriptasa inversa para copiar su ARN a ADN."
    },
    {
        topic: "Ciclo Celular",
        question: "¬øCu√°ndo ocurre la replicaci√≥n del ADN?",
        options: ["Fase M", "Fase G1", "Fase S (S√≠ntesis)", "Fase G2"],
        correct: 2,
        explanation: "La duplicaci√≥n del genoma ocurre exclusivamente en la fase S."
    }
];

// --- GESTI√ìN DE ESTADO ---
// Inicializamos propiedades extra en las preguntas
questions.forEach(q => {
    q.isMarked = false;       // Estado de marca
    q.userCorrect = null;     // null: no respondida, true: correcta, false: incorrecta
});

let activeIndices = []; // Lista de los √≠ndices de las preguntas activas (playlist)
let currentPlaylistIndex = 0; // Puntero dentro de la playlist
let sessionScore = 0;
let answered = false;

// Al cargar
document.addEventListener('DOMContentLoaded', () => {
    startQuiz('all');
});

// --- FUNCI√ìN PRINCIPAL DE CONTROL ---
function startQuiz(mode) {
    activeIndices = [];
    
    // 1. Crear la lista de reproducci√≥n seg√∫n el modo
    if (mode === 'all') {
        // Reinicio total: limpiamos respuestas
        questions.forEach(q => q.userCorrect = null);
        // Nota: ¬øLimpiamos las marcas? Normalmente un "Reiniciar Test" borra todo.
        questions.forEach(q => q.isMarked = false);
        
        activeIndices = questions.map((_, i) => i);
    } 
    else if (mode === 'failed') {
        activeIndices = questions
            .map((q, i) => q.userCorrect === false ? i : -1)
            .filter(i => i !== -1);
    } 
    else if (mode === 'marked') {
        activeIndices = questions
            .map((q, i) => q.isMarked ? i : -1)
            .filter(i => i !== -1);
    } 
    else if (mode === 'mixed') {
        // Falladas O marcadas
        activeIndices = questions
            .map((q, i) => (q.userCorrect === false || q.isMarked) ? i : -1)
            .filter(i => i !== -1);
    }

    // 2. Comprobaciones
    if (activeIndices.length === 0) {
        alert("No hay preguntas para este modo (ej. no has fallado o marcado ninguna).");
        return;
    }

    // 3. Resetear contadores de sesi√≥n
    currentPlaylistIndex = 0;
    sessionScore = 0;
    
    // 4. UI
    document.getElementById('results').style.display = 'none';
    document.getElementById('quiz-area').style.display = 'block';
    document.getElementById('statsBar').style.display = 'flex';
    
    loadQuestion();
}

function loadQuestion() {
    answered = false;
    
    // Obtenemos el √≠ndice REAL de la pregunta en la base de datos
    const realIndex = activeIndices[currentPlaylistIndex];
    const q = questions[realIndex];
    
    document.getElementById('progress').textContent = `Pregunta ${currentPlaylistIndex + 1} de ${activeIndices.length}`;
    document.getElementById('score').textContent = `Aciertos sesi√≥n: ${sessionScore}`;

    // Renderizado
    const quizArea = document.getElementById('quiz-area');
    
    // Checkbox state
    const markedChecked = q.isMarked ? 'checked' : '';

    let html = `
        <div class="question-card active">
            
            <label class="bookmark-panel">
                <input type="checkbox" class="bookmark-checkbox" onchange="toggleMark(${realIndex}, this)" ${markedChecked}>
                <span>Marcar para revisar</span>
            </label>

            <div class="topic-tag">${q.topic}</div>
            <div class="question-text">${q.question}</div>
            
            <div class="options-grid">
                ${q.options.map((opt, i) => `
                    <button class="option-btn" onclick="checkAnswer(${i}, ${q.correct}, this, ${realIndex})">
                        ${String.fromCharCode(65+i)}. ${opt}
                    </button>
                `).join('')}
            </div>
            
            <div id="feedback" class="feedback"></div>
            
            <div class="navigation">
                <button id="next-btn" class="nav-btn" onclick="nextQuestion()">Siguiente ‚Üí</button>
            </div>
        </div>
    `;
    
    quizArea.innerHTML = html;
}

// Funci√≥n para marcar/desmarcar (se guarda en el objeto global)
function toggleMark(realIndex, checkbox) {
    questions[realIndex].isMarked = checkbox.checked;
}

function checkAnswer(selected, correct, btn, realIndex) {
    if (answered) return;
    answered = true;

    const btns = document.querySelectorAll('.option-btn');
    const feedbackEl = document.getElementById('feedback');
    const nextBtn = document.getElementById('next-btn');

    // Deshabilitar botones
    btns.forEach(b => b.disabled = true);

    if (selected === correct) {
        sessionScore++;
        questions[realIndex].userCorrect = true; // Guardar estado
        btn.classList.add('correct');
        feedbackEl.className = 'feedback feedback-correct show';
        feedbackEl.innerHTML = `<strong>¬°Correcto!</strong> ${questions[realIndex].explanation}`;
    } else {
        questions[realIndex].userCorrect = false; // Guardar estado fallo
        btn.classList.add('incorrect');
        btns[correct].classList.add('correct');
        feedbackEl.className = 'feedback feedback-incorrect show';
        feedbackEl.innerHTML = `<strong>Incorrecto.</strong> ${questions[realIndex].explanation}`;
    }

    document.getElementById('score').textContent = `Aciertos sesi√≥n: ${sessionScore}`;
    nextBtn.style.display = 'inline-block';
}

function nextQuestion() {
    if (currentPlaylistIndex < activeIndices.length - 1) {
        currentPlaylistIndex++;
        loadQuestion();
    } else {
        showResults();
    }
}

function showResults() {
    document.getElementById('quiz-area').style.display = 'none';
    document.getElementById('statsBar').style.display = 'none';
    document.getElementById('results').style.display = 'block';

    const percent = Math.round((sessionScore / activeIndices.length) * 100);
    document.getElementById('final-score').textContent = `${sessionScore} / ${activeIndices.length}`;
    
    // Mensaje motivacional
    let msg = "";
    if(percent >= 90) msg = "¬°Excelente!";
    else if(percent >= 70) msg = "Muy bien.";
    else if(percent >= 50) msg = "Aprobado.";
    else msg = "Sigue repasando.";
    document.getElementById('final-msg').textContent = `${percent}% - ${msg}`;

    // Estad√≠sticas globales para habilitar botones
    const totalFailed = questions.filter(q => q.userCorrect === false).length;
    const totalMarked = questions.filter(q => q.isMarked === true).length;
    const totalMixed = questions.filter(q => q.userCorrect === false || q.isMarked).length;

    document.getElementById('stats-summary').innerHTML = `
        <strong>Resumen Global:</strong><br>
        Preguntas marcadas para revisi√≥n: ${totalMarked}<br>
        Preguntas falladas (hist√≥rico): ${totalFailed}
    `;

    // Habilitar/Deshabilitar botones
    document.getElementById('btn-failed').disabled = (totalFailed === 0);
    document.getElementById('btn-marked').disabled = (totalMarked === 0);
    document.getElementById('btn-mixed').disabled = (totalMixed === 0);
    
    // Actualizar textos con contadores
    document.getElementById('btn-failed').innerHTML = `‚ùå Repetir Falladas (${totalFailed})`;
    document.getElementById('btn-marked').innerHTML = `‚ö†Ô∏è Repetir Marcadas (${totalMarked})`;
}
</script>

</body>
</html>
