<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Bloque VIII: Bioqu√≠mica Humana</title>
    <style>
        :root {
            --primary: #7c3aed; /* Violeta Intenso */
            --primary-dark: #5b21b6;
            --primary-light: #ddd6fe;
            --bg: #f5f3ff;
            --text: #4c1d95;
            --white: #ffffff;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg);
            color: var(--text);
            max-width: 850px;
            margin: 0 auto;
            padding: 20px;
        }

        h1 {
            text-align: center;
            color: var(--primary-dark);
            margin-bottom: 10px;
            border-bottom: 3px solid var(--primary);
            padding-bottom: 15px;
            display: inline-block;
            width: 100%;
        }

        .question-card {
            background: var(--white);
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            border-left: 6px solid var(--primary);
            transition: transform 0.2s, box-shadow 0.2s;
            position: relative;
        }

        .question-card:hover {
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        }

        /* --- Checkbox para Marcar --- */
        .mark-container {
            display: flex;
            align-items: center;
            justify-content: flex-end;
            margin-bottom: 15px;
            font-size: 0.9em;
            color: var(--primary);
            font-weight: bold;
            border-bottom: 1px solid #c4b5fd;
            padding-bottom: 10px;
        }
        .mark-container input {
            margin-right: 8px;
            transform: scale(1.3);
            cursor: pointer;
            accent-color: var(--primary);
        }
        .mark-container label {
            cursor: pointer;
        }

        .question-header {
            font-size: 0.85em;
            color: #6d28d9;
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 1px;
            font-weight: bold;
        }

        .question-text {
            font-weight: 700;
            font-size: 1.15em;
            margin-bottom: 20px;
            color: #4c1d95;
            line-height: 1.5;
        }

        /* Etiquetas para diagramas */
        .img-tag {
            display: block;
            margin-top: 12px;
            padding: 10px;
            background-color: #ede9fe;
            border-left: 4px solid #8b5cf6;
            color: #5b21b6;
            font-size: 0.9em;
            font-style: italic;
            border-radius: 0 4px 4px 0;
        }

        .options-container {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .option-btn {
            padding: 14px 18px;
            border: 2px solid #e5e7eb;
            background: #fff;
            border-radius: 8px;
            cursor: pointer;
            text-align: left;
            transition: all 0.2s;
            font-size: 1em;
            color: #374151;
            position: relative;
        }

        .option-btn:hover:not(:disabled) {
            background-color: var(--primary-light);
            border-color: var(--primary);
            color: var(--primary-dark);
            padding-left: 25px; /* Efecto desplazamiento */
        }

        .option-btn:disabled {
            cursor: default;
            opacity: 0.7;
        }

        /* Estados de respuesta */
        .correct {
            background-color: #d1fae5 !important;
            border-color: #10b981 !important;
            color: #064e3b !important;
            font-weight: 600;
        }

        .incorrect {
            background-color: #fee2e2 !important;
            border-color: #ef4444 !important;
            color: #7f1d1d !important;
        }

        /* Caja de Explicaci√≥n */
        .explanation {
            margin-top: 20px;
            padding: 15px;
            background-color: #f3e8ff;
            border-left: 5px solid var(--primary);
            border-radius: 6px;
            display: none;
            font-size: 0.95em;
            color: #581c87;
            animation: slideDown 0.3s ease-out;
        }
        .explanation.visible {
            display: block;
        }
        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* --- √Årea de Controles --- */
        #controls-area {
            margin-top: 50px;
            text-align: center;
            padding: 30px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 -4px 20px rgba(0,0,0,0.05);
            border-top: 5px solid var(--primary);
        }

        .action-btn {
            background: var(--primary); color: white; border: none;
            padding: 12px 25px; font-size: 1.05em; border-radius: 8px;
            cursor: pointer; margin: 8px;
            transition: background 0.3s, transform 0.2s;
            font-weight: 600;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .action-btn:hover { 
            background: var(--primary-dark);
            transform: translateY(-2px);
        }
        
        .restart-options {
            display: none;
            flex-direction: column;
            gap: 12px;
            margin-top: 25px;
            max-width: 400px;
            margin-left: auto;
            margin-right: auto;
        }
        .restart-options button {
            width: 100%;
            background: #4b5563;
        }
        .restart-options button:hover { background: #1f2937; }
        .restart-options button:first-child { background: var(--primary); }

    </style>
</head>
<body>

    <h1>Bloque VIII: Bioqu√≠mica Humana</h1>
    <div style="text-align: center; color: #5b21b6; margin-bottom: 30px;">
        Santi D√≠az | Metabolismo Nitrogenado, Urea y Amino√°cidos
    </div>
    
    <div id="quiz-container"></div>

    <div id="controls-area">
        <button id="finish-btn" class="action-btn" onclick="showEndOptions()">üèÅ Finalizar revisi√≥n</button>
        
        <div id="restart-menu" class="restart-options">
            <h3>Resultados de la sesi√≥n</h3>
            <p id="stats-summary"></p>
            <button class="action-btn" onclick="restartQuiz('all')">üîÑ Rehacer todo el test</button>
            <button class="action-btn" onclick="restartQuiz('marked')">üîñ Repasar marcadas</button>
            <button class="action-btn" onclick="restartQuiz('failed')">‚ùå Repasar falladas</button>
            <button class="action-btn" onclick="restartQuiz('failed_marked')">‚ö†Ô∏è Falladas + Marcadas</button>
        </div>
    </div>

<script>
    const quizData = [
        { 
            q: "Respecto al ciclo de la urea, indique cu√°l de las siguientes respuestas es correcta:", 
            opts: ["Tiene lugar en el h√≠gado.", "El proceso tiene lugar parte en la mitocondria y parte en el citosol.", "La s√≠ntesis de urea comienza con la condensaci√≥n de bicarbonato y amon√≠aco.", "Todas son correctas."], 
            a: "Todas son correctas.", 
            exp: "El ciclo ocurre exclusivamente en el h√≠gado, compartimentado entre mitocondria y citosol, comenzando con la formaci√≥n de Carbamil-fosfato." 
        },
        { 
            q: "Indique la enzima regulable de la s√≠ntesis de la urea:", 
            opts: ["Carbamil fosfato sintetasa I.", "Arginasa.", "Ornitina transcarbamilasa.", "Argininosuccinato sintetasa."], 
            a: "Carbamil fosfato sintetasa I.", 
            exp: "Es la enzima marcapasos, activada alost√©ricamente por N-acetilglutamato." 
        },
        { 
            q: "El destino del esqueleto carbonatado de los amino√°cidos es formar:", 
            opts: ["alfa-cetoglutarato, acetato (Acetil-CoA) y piruvato.", "Urea y amoniaco exclusivamente.", "Glucosa directamente sin intermediarios.", "Solo cuerpos cet√≥nicos."], 
            a: "alfa-cetoglutarato, acetato (Acetil-CoA) y piruvato.", 
            exp: "Los esqueletos carbonados se integran en el ciclo de Krebs o v√≠as glucol√≠ticas/cetog√©nicas." 
        },
        { 
            q: "Un paciente con enteropat√≠a produce gran cantidad de amoniaco por sobrecrecimiento bacteriano. El amoniaco se absorbe e ingresa en la circulaci√≥n sangu√≠nea. ¬øCu√°l es la consecuencia probable?", 
            opts: ["Descenso del pH sangu√≠neo.", "Conversi√≥n de amoniaco en amonio (NH4+).", "Descenso en la concentraci√≥n de bicarbonato en sangre.", "Respiraci√≥n de Kussmaul (hiperventilaci√≥n).", "Aumento de la espiraci√≥n de CO2."], 
            a: "Conversi√≥n de amoniaco en amonio (NH4+).", 
            exp: "El NH3 capta protones (H+) para formar NH4+, actuando como base, lo que podr√≠a alcalinizar ligeramente, no acidificar." 
        },
        { 
            q: "Cuando se realiza el proceso de transaminaci√≥n, el Œ±-ceto√°cido aceptor del grupo amino m√°s frecuente es:", 
            opts: ["Piruvato.", "Citrato.", "Oxalacetato.", "Œ±-cetoglutarato.", "Succinato."], 
            a: "Œ±-cetoglutarato.", 
            exp: "Recibe el grupo amino para convertirse en Glutamato." 
        },
        { 
            q: "Los nitr√≥genos que forman parte de la estructura de la urea proceden fundamentalmente de:", 
            opts: ["Glutamato y glutamina.", "Glutamato y asparragina.", "Aspartato y glutamina.", "Glutamato y aspartato.", "Lisina y citrulina."], 
            a: "Glutamato y aspartato.", 
            exp: "Uno viene del amonio libre (v√≠a glutamato deshidrogenasa) y el otro directamente del Aspartato." 
        },
        { 
            q: "La principal enzima regulable de la s√≠ntesis de urea es:", 
            opts: ["Carbamilfosfato sintetasa I.", "Ornitina transcarbamilasa.", "Arginasa.", "Argininosintetasa.", "Argininosuccinasa."], 
            a: "Carbamilfosfato sintetasa I.", 
            exp: "CPS-I mitocondrial." 
        },
        { 
            q: "¬øQu√© es cofactor necesario para la hidroxilaci√≥n de prolina y lisina?", 
            opts: ["La vitamina C (Ascorbato).", "La vitamina B12.", "La biotina.", "El magnesio."], 
            a: "La vitamina C (Ascorbato).", 
            exp: "Esencial para la s√≠ntesis de col√°geno." 
        },
        { 
            q: "La fenilalanina se convierte en tirosina por medio de la enzima fenilalanina hidroxilasa. Un d√©ficit de esta enzima da como resultado:", 
            opts: ["Fenilcetonuria.", "Albinismo.", "Alcaptonuria.", "Tirosinemia."], 
            a: "Fenilcetonuria.", 
            exp: "Acumulaci√≥n de fenilalanina y deficiencia de tirosina." 
        },
        { 
            q: "En relaci√≥n con el metabolismo de los AA es INCORRECTO que:", 
            opts: ["Un AA glucog√©nico puede originar Œ±-cetoglutarato al degradarse.", "Un AA cetog√©nico origina Succinil-CoA al degradarse.", "Se libera NH3 tras la acci√≥n de la glutaminasa.", "Se obtenga oxalacetato a partir de aspartato por transaminaci√≥n.", "Un AA no esencial puede sintetizarse a partir de eritrosa-4-P."], 
            a: "Un AA no esencial puede sintetizarse a partir de eritrosa-4-P.", 
            exp: "La v√≠a de la eritrosa-4-P (√°cido shik√≠mico) es para s√≠ntesis de AA arom√°ticos en bacterias/plantas, no en humanos." 
        },
        { 
            q: "Respecto al ciclo de la urea, indica cu√°l de las siguientes respuestas es FALSA:", 
            opts: ["Tiene lugar en el h√≠gado.", "Los donantes de -NH2 son los AA glutamato y glicina.", "El proceso es en parte mitocondrial y en parte citos√≥lico.", "La s√≠ntesis de urea comienza con la condensaci√≥n de CO2 y amoniaco.", "La enzima regulable es la carbamil fosfato sintetasa I."], 
            a: "Los donantes de -NH2 son los AA glutamato y glicina.", 
            exp: "Falso: los donantes principales son Amoniaco (v√≠a Glutamato) y Aspartato." 
        },
        { 
            q: "En cu√°l de los siguientes procesos del metabolismo de los amino√°cidos (AA) se hace alusi√≥n al compuesto representado (Œ±-cetoglutarato):", 
            opts: ["Un AA cetog√©nico puede originar acetoacetato al degradarse.", "Un AA glucog√©nico puede originar Œ±-cetoglutarato al degradarse.", "Se libera NH3 tras la acci√≥n de la glutaminasa.", "Se obtiene oxalacetato a partir del aspartato por transaminaci√≥n.", "Un AA no esencial puede sintetizarse a partir de eritrosa-4-P."], 
            a: "Un AA glucog√©nico puede originar Œ±-cetoglutarato al degradarse.", 
            exp: "El Œ±-cetoglutarato es un punto de entrada al ciclo de Krebs para AA glucog√©nicos (ej. Glu, Gln, Pro, His, Arg)." 
        },
        { 
            q: "El destino del esqueleto carbonatado de los amino√°cidos es formar:", 
            opts: ["Malato, oxalacetato y piruvato.", "Alfa-cetoglutarato, malato, citrato.", "Alfa-cetoglutarato, oxalacetato, fumarato, piruvato, acetil-CoA, succinil-CoA.", "Citrato, isocitrato, malato.", "Solo alfa-cetoglutarato."], 
            a: "Alfa-cetoglutarato, oxalacetato, fumarato, piruvato, acetil-CoA, succinil-CoA.", 
            exp: "Son los 7 metabolitos principales a los que confluyen todos los amino√°cidos." 
        },
        { 
            q: "Respecto al ciclo de la urea, indique cu√°l de las siguientes respuestas es correcta:", 
            opts: ["Tiene lugar en el h√≠gado.", "La urea se sintetiza en el ri√±√≥n.", "El proceso tiene lugar parte en la mitocondria y parte en el citosol.", "La s√≠ntesis de urea comienza con la condensaci√≥n de bicarbonato y amoniaco.", "A, C y D son ciertas."], 
            a: "A, C y D son ciertas.", 
            exp: "H√≠gado, compartimentado y condensaci√≥n NH3+HCO3-." 
        },
        { 
            q: "Indique la enzima regulable de la s√≠ntesis de la urea:", 
            opts: ["Carbamil fosfato sintetasa I.", "Ornitina transcarbamilasa.", "Arginino succinasa.", "Arginasa.", "Ureasa."], 
            a: "Carbamil fosfato sintetasa I.", 
            exp: "Repetida por √©nfasis." 
        },
        { 
            q: "En la bios√≠ntesis de AA:", 
            opts: ["El oxalato es el precursor del aspartato.", "El piruvato es el precursor de la tirosina.", "El alfa-cetoglutarato es el precursor del glutamato.", "El glutamato es el precursor de la histidina.", "El alfa-cetoglutarato es precursor del glutamato y oxalacetato del aspartato."], 
            a: "El alfa-cetoglutarato es precursor del glutamato y oxalacetato del aspartato.", 
            exp: "Por transaminaci√≥n directa." 
        },
        { 
            q: "¬øCu√°les de los siguientes intermediarios metab√≥licos son productos catab√≥licos de los AA?", 
            opts: ["Piruvato.", "Fumarato.", "Oxalacetato.", "Alfa-cetoglutarato.", "Todas son ciertas."], 
            a: "Todas son ciertas.", 
            exp: "Todos son puntos de entrada al metabolismo central." 
        },
        { 
            q: "La desaminaci√≥n oxidativa del √°cido glut√°mico dar√° lugar a:", 
            opts: ["√Åcido Succ√≠nico.", "√Åcido Oxalac√©tico.", "√Åcido Fum√°rico.", "√Åcido Œ±-cetoglut√°rico.", "Ninguna es cierta."], 
            a: "√Åcido Œ±-cetoglut√°rico.", 
            exp: "Reacci√≥n catalizada por la Glutamato Deshidrogenasa (GDH)." 
        },
        { 
            q: "En la etapa enzim√°tica de la desaminaci√≥n oxidativa de un AA se produce:", 
            opts: ["La formaci√≥n en el AA de un grupo imino (=NH).", "La p√©rdida por el AA de 2 √°tomos de H.", "La hidr√≥lisis del grupo amino (-NH2) del mismo.", "A y B son ciertas.", "B y C son ciertas."], 
            a: "A y B son ciertas.", 
            exp: "Se forma un intermedio imino que luego se hidroliza liberando amonio." 
        },
        { 
            q: "En el metabolismo de los AA:", 
            opts: ["La v√≠a catab√≥lica siempre origina cuerpos cet√≥nicos.", "La carencia de un amino√°cido esencial puede provocar balance nitrogenado negativo.", "Los AA ramificados son totalmente degradados en el h√≠gado.", "Las reacciones catab√≥licas son irreversibles.", "La alanina es el principal AA cetog√©nico."], 
            a: "La carencia de un amino√°cido esencial puede provocar balance nitrogenado negativo.", 
            exp: "Si falta un AA esencial, no se pueden sintetizar prote√≠nas corporales y se degrada el exceso de los dem√°s, excretando m√°s N del que se retiene." 
        },
        { 
            q: "De los siguientes AA, ¬øcu√°les son glucog√©nicos?", 
            opts: ["Valina.", "Glut√°mico.", "Leucina.", "Valina y Glut√°mico.", "Ninguna es cierta."], 
            a: "Valina y Glut√°mico.", 
            exp: "Leucina es puramente cetog√©nico (junto con Lisina)." 
        },
        { 
            q: "La glutamato deshidrogenasa cataliza el paso de alfa-cetoglutarato a glutamato:", 
            opts: ["Por aminaci√≥n oxidativa.", "Por hidr√≥lisis.", "Por oxidaci√≥n.", "Por aminaci√≥n reductiva.", "Por hidrataci√≥n."], 
            a: "Por aminaci√≥n reductiva.", 
            exp: "Incorpora NH3 y usa NADPH (poder reductor) para formar Glutamato." 
        },
        { 
            q: "A partir del glutamato-gamma-semialdeh√≠do se forma:", 
            opts: ["Arginina.", "Metionina.", "Prolina.", "Histidina.", "Prolina y Arginina."], 
            a: "Prolina y Arginina.", 
            exp: "El semialdeh√≠do se cicla espont√°neamente para formar Prolina (y tambi√©n es intermedio hacia Arginina/Ornitina)." 
        },
        { 
            q: "Indique qu√© enzimas est√°n implicadas en el metabolismo nitrogenado:", 
            opts: ["Glutaminasa.", "Glutamina sintetasa.", "Glutamato deshidrogenasa.", "Transaminasa.", "Todas son ciertas."], 
            a: "Todas son ciertas.", 
            exp: "Conjunto clave de enzimas para el manejo del grupo amino." 
        },
        { 
            q: "El ciclo de la urea:", 
            opts: ["S√≥lo tiene lugar en las c√©lulas renales.", "Se gasta un mol de ATP por mol de urea producido.", "El aporte de nitr√≥geno se realiza exclusivamente por el fosfato de carbamilo.", "El ciclo es muy reversible.", "Ninguna es cierta."], 
            a: "Ninguna es cierta.", 
            exp: "Es hep√°tico, gasta 3 ATP (4 enlaces), usa Aspartato tambi√©n y es irreversible." 
        },
        { 
            q: "En la s√≠ntesis de urea, la formaci√≥n de carbamil fosfato:", 
            opts: ["Tiene lugar en el citosol.", "Tiene lugar en la mitocondria.", "La enzima implicada en su s√≠ntesis no requiere ATP.", "La enzima que cataliza este paso es NADPH dependiente.", "Son ciertas A y D."], 
            a: "Tiene lugar en la mitocondria.", 
            exp: "Paso limitante catalizado por CPS-I mitocondrial." 
        },
        { 
            q: "¬øEn qu√© organelo celular se realiza el paso de ornitina a citrulina en el ciclo de la urea?", 
            opts: ["Mitocondrias.", "Citoplasma.", "Ret√≠culo endoplasm√°tico liso.", "Ret√≠culo endoplasm√°tico rugoso.", "Ribosoma."], 
            a: "Mitocondrias.", 
            exp: "La ornitina entra a la mitocondria para recibir el grupo carbamilo." 
        },
        { 
            q: "En el ciclo de la urea intervienen:", 
            opts: ["Citrulina, tript√≥fano y fenilalanina.", "S√≥lo tript√≥fano y fenilalanina.", "Ornitina, citrulina y arginina.", "S√≥lo citrulina y arginina.", "Intervienen las 5 sustancias citadas."], 
            a: "Ornitina, citrulina y arginina.", 
            exp: "Son los tres amino√°cidos 'no proteicos' (excepto Arg) clave del ciclo." 
        },
        { 
            q: "¬øCu√°l de estos compuestos NO guarda relaci√≥n directa con el ciclo de la urea?", 
            opts: ["Ornitina.", "Citrulina.", "Carbamil fosfato.", "Glutamato.", "Ascorbato."], 
            a: "Ascorbato.", 
            exp: "El Ascorbato es vitamina C (hidroxilaciones), no interviene en el ciclo de la urea." 
        },
        { 
            q: "En el ciclo de la urea, √©sta queda libre en el medio biol√≥gico al escindirse:", 
            opts: ["Histidina que se convierte en glicocola.", "Fenilalanina que se convierte en tirosina.", "Tript√≥fano que se convierte en tiramina.", "Arginina que se convierte en ornitina.", "Ninguna es cierta."], 
            a: "Arginina que se convierte en ornitina.", 
            exp: "Acci√≥n de la Arginasa (citos√≥lica)." 
        },
        { 
            q: "Respecto al ciclo de la urea, indica cu√°l de las siguientes respuestas es correcta (Repetida):", 
            opts: ["La enzima regulable es la carbamil fosfato sintetasa 1.", "La s√≠ntesis tiene lugar en el ri√±√≥n.", "Los donantes de ‚ÄìNH2 son los amino√°cidos glutamato y glicina.", "El proceso se da enteramente en la mitocondria.", "La s√≠ntesis de urea comienza con la condensaci√≥n de CO2 y glutamato."], 
            a: "La enzima regulable es la carbamil fosfato sintetasa 1.", 
            exp: "CPS-1 es la clave regulatoria." 
        },
        { 
            q: "En cu√°l de los siguientes procesos se hace alusi√≥n al compuesto representado (Oxalacetato):", 
            opts: ["Un AA no esencial puede sintetizarse a partir de este compuesto y eritrosa-4-P.", "Se libera junto con NH3 tras la acci√≥n de la glutaminasa.", "Es el resultado de la degradaci√≥n del esqueleto carbonatado de un AA cetog√©nico.", "Est√° implicado en la reacci√≥n catalizada por la AST (Aspartato aminotransferasa/GOT)."], 
            a: "Est√° implicado en la reacci√≥n catalizada por la AST (Aspartato aminotransferasa/GOT).", 
            exp: "La AST transfiere un grupo amino del Aspartato al Œ±-cetoglutarato, formando Oxalacetato y Glutamato." 
        },
        { 
            q: "El ciclo del Œ≥-glutamilo requiere para llevarse a cabo la presencia de:", 
            opts: ["Glutamina.", "Glutamato.", "Histidina.", "Glutati√≥n.", "Glicina."], 
            a: "Glutati√≥n.", 
            exp: "Ciclo para transporte de amino√°cidos a trav√©s de membranas (Ciclo de Meister)." 
        },
        { 
            q: "La enzima glutati√≥n peroxidasa permite que se lleve a cabo la siguiente reacci√≥n:", 
            opts: ["Oxidaci√≥n del glutati√≥n.", "Reducci√≥n del glutati√≥n.", "Transforma el H2O2 en H2O.", "Son ciertas A y C.", "Son ciertas B y C."], 
            a: "Son ciertas A y C.", 
            exp: "Oxida el glutati√≥n (GSH -> GSSG) mientras reduce el per√≥xido de hidr√≥geno a agua." 
        },
        { 
            q: "Entre los amino√°cidos glucog√©nicos, el m√°s destacado de ellos (ciclo glucosa-alanina) es:", 
            opts: ["Alanina.", "Tirosina.", "Tript√≥fano.", "Fenil-alanina.", "Histidina."], 
            a: "Alanina.", 
            exp: "Fundamental para el transporte de esqueletos carbonados y nitr√≥geno desde el m√∫sculo al h√≠gado." 
        },
        { 
            q: "¬øC√≥mo act√∫a la arginasa?", 
            opts: ["Incorpora arginina a la ornitina.", "Escinde la arginina en fumarato y ornitina.", "Escinde la arginina en ornitina y urea.", "Es s√≥lo de localizaci√≥n mitocondrial.", "Incorpora arginina a la citrulina."], 
            a: "Escinde la arginina en ornitina y urea.", 
            exp: "Paso final del ciclo." 
        },
        { 
            q: "¬øEn cu√°l de los siguientes procesos se hace alusi√≥n al Oxalacetato (Repetida):", 
            opts: ["Un AA no esencial puede sintetizarse a partir de este compuesto y eritrosa-4-P.", "Se libera junto con NH3 tras la acci√≥n de la glutaminasa.", "Es el resultado de la degradaci√≥n del esqueleto carbonatado de un AA cetog√©nico.", "Est√° implicado en la reacci√≥n catalizada por la AST (Aspartato aminotransferasa/GOT)."], 
            a: "Est√° implicado en la reacci√≥n catalizada por la AST (Aspartato aminotransferasa/GOT).", 
            exp: "AST interconvierte Aspartato/Oxalacetato." 
        },
        { 
            q: "¬øCu√°l de las siguientes frases en relaci√≥n a los amino√°cidos y su metabolismo es la correcta?", 
            opts: ["La glutamina derivada del m√∫sculo se metaboliza en el h√≠gado y en el ri√±√≥n para formar amoniaco y un precursor gluconeog√©nico.", "El primer paso en el catabolismo de la mayor√≠a de los amino√°cidos es la desaminaci√≥n oxidativa.", "El h√≠gado utiliza el NH3 para tamponar protones.", "En un estado saludable, la entrada al pool de amino√°cidos excede a la salida."], 
            a: "La glutamina derivada del m√∫sculo se metaboliza en el h√≠gado y en el ri√±√≥n para formar amoniaco y un precursor gluconeog√©nico.", 
            exp: "La glutamina transporta amonio al ri√±√≥n (excreci√≥n) e h√≠gado (urea) y su esqueleto (Œ±-KG) es gluconeog√©nico." 
        },
        { 
            q: "Identifica la afirmaci√≥n correcta en el contexto del ciclo de la urea:", 
            opts: ["Se localiza exclusivamente en la mitocondria.", "La ureasa bacteriana es el principal responsable de la hipoamonemia.", "Es un ciclo exclusivo del h√≠gado.", "Sintetiza urea a partir de asp√°rtico y amoniaco como fuentes de energ√≠a."], 
            a: "Es un ciclo exclusivo del h√≠gado.", 
            exp: "Solo el h√≠gado expresa todas las enzimas necesarias (especialmente Arginasa en cantidad suficiente)." 
        }
    ];

    // --- ASIGNAR IDs √öNICOS ---
    quizData.forEach((item, index) => {
        item.id = index;
    });

    // --- GESTI√ìN DE ESTADO ---
    let markedQuestions = new Set();
    let failedQuestions = new Set();

    function shuffleArray(array) {
        let currentIndex = array.length, randomIndex;
        while (currentIndex !== 0) {
            randomIndex = Math.floor(Math.random() * currentIndex);
            currentIndex--;
            [array[currentIndex], array[randomIndex]] = [array[randomIndex], array[currentIndex]];
        }
        return array;
    }

    const container = document.getElementById('quiz-container');

    // Funci√≥n principal
    function renderQuiz(questionsToLoad = quizData) {
        container.innerHTML = "";
        document.getElementById("restart-menu").style.display = "none";
        document.getElementById("finish-btn").style.display = "inline-block";

        if(questionsToLoad.length === 0) {
            container.innerHTML = "<p style='text-align:center; padding:20px; color:#6b7280;'>No hay preguntas para mostrar en esta selecci√≥n.</p>";
            return;
        }

        questionsToLoad.forEach((item, displayIndex) => {
            const card = document.createElement('div');
            card.className = 'question-card';

            // Checkbox Marcar
            const markContainer = document.createElement("div");
            markContainer.className = "mark-container";
            const checkbox = document.createElement("input");
            checkbox.type = "checkbox";
            checkbox.id = `mark-${item.id}`;
            if(markedQuestions.has(item.id)) checkbox.checked = true;

            checkbox.onchange = (e) => {
                if(e.target.checked) markedQuestions.add(item.id);
                else markedQuestions.delete(item.id);
            };

            const label = document.createElement("label");
            label.htmlFor = `mark-${item.id}`;
            label.innerText = "Marcar para revisar";
            markContainer.appendChild(checkbox);
            markContainer.appendChild(label);
            card.appendChild(markContainer);

            // Pregunta
            const header = document.createElement('div');
            header.className = 'question-header';
            header.textContent = `Pregunta ${item.id + 1}`; 
            card.appendChild(header);

            const questionText = document.createElement('div');
            questionText.className = 'question-text';
            questionText.textContent = item.q;

            // --- INSERCI√ìN DE DIAGRAMAS (Placeholders) ---
            if (item.id === 12) { 
                 questionText.innerHTML += `<span class='img-tag'>[Imagen: Estructura de Œ±-cetoglutarato]</span>`;
            } else if (item.id === 37 || item.id === 32) { 
                 questionText.innerHTML += `<span class='img-tag'>[Imagen: Estructura de Oxalacetato]</span>`;
            }

            card.appendChild(questionText);

            // Opciones
            const optionsDiv = document.createElement('div');
            optionsDiv.className = 'options-container';

            let optionsObj = item.opts.map(opt => ({
                text: opt,
                isCorrect: opt === item.a
            }));
            optionsObj = shuffleArray(optionsObj);

            // Explicaci√≥n
            const explanationDiv = document.createElement('div');
            explanationDiv.className = 'explanation';
            explanationDiv.innerHTML = `<strong>Explicaci√≥n:</strong> ${item.exp}`;

            optionsObj.forEach(opt => {
                const btn = document.createElement('button');
                btn.className = 'option-btn';
                btn.textContent = opt.text;

                btn.onclick = () => {
                    const allBtns = optionsDiv.querySelectorAll('.option-btn');
                    allBtns.forEach(b => b.disabled = true);

                    if (opt.isCorrect) {
                        btn.classList.add('correct');
                    } else {
                        btn.classList.add('incorrect');
                        failedQuestions.add(item.id);
                        
                        allBtns.forEach(b => {
                            if (b.textContent === item.a) b.classList.add('correct');
                        });
                    }
                    explanationDiv.classList.add('visible');
                };
                optionsDiv.appendChild(btn);
            });

            card.appendChild(optionsDiv);
            card.appendChild(explanationDiv);
            container.appendChild(card);
        });
    }

    // --- Control Final ---
    function showEndOptions() {
        document.getElementById("finish-btn").style.display = "none";
        document.getElementById("restart-menu").style.display = "flex";
        document.getElementById("controls-area").scrollIntoView({behavior: "smooth"});
        
        document.getElementById("stats-summary").innerHTML = `
            Preguntas marcadas: <strong>${markedQuestions.size}</strong><br>
            Preguntas falladas en esta sesi√≥n: <strong>${failedQuestions.size}</strong>
        `;
    }

    function restartQuiz(mode) {
        let subset = [];
        if (mode === 'all') subset = quizData;
        else if (mode === 'marked') subset = quizData.filter(q => markedQuestions.has(q.id));
        else if (mode === 'failed') subset = quizData.filter(q => failedQuestions.has(q.id));
        else if (mode === 'failed_marked') subset = quizData.filter(q => failedQuestions.has(q.id) || markedQuestions.has(q.id));

        if(mode !== 'all') failedQuestions.clear(); 
        else {
            failedQuestions.clear();
            markedQuestions.clear();
        }

        renderQuiz(subset);
        window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    renderQuiz();
</script>

</body>
</html>
