<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Examen Bloque 9 - Reproducci√≥n y Desarrollo</title>
    <style>
        :root {
            --primary: #d35400; /* Naranja fuerte/Vitalidad */
            --secondary: #e67e22;
            --success: #27ae60;
            --danger: #c0392b;
            --warning: #f39c12;
            --light: #fdf2e9;
            --dark: #6e2c00;
        }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--light);
            color: #333;
            margin: 0;
            padding: 20px;
            line-height: 1.6;
        }
        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            padding: 40px;
            border-radius: 12px;
            box-shadow: 0 5px 25px rgba(0,0,0,0.15);
            border-top: 5px solid var(--primary);
            min-height: 600px;
        }
        header {
            text-align: center;
            border-bottom: 2px solid #eee;
            padding-bottom: 20px;
            margin-bottom: 30px;
        }
        h1 { color: var(--primary); margin: 0; font-size: 2.2rem; }
        .prof-info { font-style: italic; color: #7f8c8d; margin-top: 10px; }
        
        .status-panel {
            background: #edbb99;
            padding: 15px 25px;
            border-radius: 8px;
            display: flex;
            justify-content: space-between;
            font-weight: bold;
            margin-bottom: 25px;
            color: var(--dark);
            border: 1px solid #dc7633;
        }

        .question-card {
            display: none;
            position: relative; /* Para posicionar el marcador */
            animation: fadeIn 0.4s ease-out;
        }
        .question-card.active { display: block; }

        /* ESTILOS DEL MARCADOR */
        .bookmark-panel {
            position: absolute;
            top: 0;
            right: 0;
            background: #fff3e0;
            border: 1px solid #ffb74d;
            color: #e65100;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.9rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: transform 0.2s;
            z-index: 10;
        }
        .bookmark-panel:hover { transform: scale(1.05); background: #ffe0b2; }
        .bookmark-panel input { cursor: pointer; transform: scale(1.3); }

        .question-header {
            font-size: 0.9rem;
            text-transform: uppercase;
            color: var(--secondary);
            margin-bottom: 10px;
            letter-spacing: 1px;
            font-weight: 700;
            margin-top: 15px;
        }

        .question-text {
            font-size: 1.3rem;
            margin-bottom: 25px;
            font-weight: 600;
            color: #2c3e50;
            padding-right: 120px; /* Espacio para el marcador */
        }

        .options-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .option-btn {
            background: white;
            border: 2px solid #d5d8dc;
            padding: 18px;
            border-radius: 10px;
            cursor: pointer;
            text-align: left;
            font-size: 1.05rem;
            transition: all 0.2s;
            position: relative;
        }

        .option-btn:hover:not(:disabled) {
            border-color: var(--primary);
            background: #fae5d3;
            padding-left: 25px;
        }

        .option-btn:disabled { cursor: default; opacity: 0.8; }

        .correct {
            background-color: #d5f5e3 !important;
            border-color: var(--success) !important;
            color: #145a32;
        }

        .incorrect {
            background-color: #fadbd8 !important;
            border-color: var(--danger) !important;
            color: #7b241c;
        }

        .feedback-area {
            margin-top: 25px;
            padding: 20px;
            border-radius: 8px;
            background: #f8f9fa;
            border-left: 5px solid var(--dark);
            display: none;
        }
        .feedback-area.show { display: block; }
        .rationale { margin-top: 10px; font-size: 0.95rem; }

        .nav-btn {
            display: none;
            background: var(--primary);
            color: white;
            border: none;
            padding: 12px 35px;
            border-radius: 30px;
            font-size: 1.1rem;
            margin-top: 25px;
            cursor: pointer;
            float: right;
            transition: background 0.3s, transform 0.2s;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        .nav-btn:hover { background: var(--secondary); transform: translateY(-2px); }

        /* PANTALLA DE RESULTADOS */
        .results-view {
            text-align: center;
            display: none;
        }
        .final-score {
            font-size: 5rem;
            font-weight: 800;
            color: var(--primary);
            margin: 20px 0;
            text-shadow: 2px 2px 0px #eee;
        }

        .stats-summary {
            background: #fff;
            border: 1px solid #eee;
            padding: 15px;
            border-radius: 8px;
            display: inline-block;
            margin-bottom: 20px;
            color: #555;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }

        /* GRID DE BOTONES DE ACCI√ìN */
        .action-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-top: 20px;
        }
        .action-btn {
            padding: 15px;
            border: none;
            border-radius: 8px;
            font-weight: bold;
            color: white;
            cursor: pointer;
            transition: transform 0.2s;
            font-size: 1rem;
        }
        .action-btn:hover { transform: translateY(-3px); filter: brightness(110%); }
        .action-btn:disabled { background-color: #bdc3c7 !important; cursor: not-allowed; transform: none; filter: none; }

        .btn-restart { background-color: var(--primary); grid-column: span 2; }
        .btn-failed { background-color: var(--danger); }
        .btn-marked { background-color: var(--warning); color: #5d4037; }
        .btn-mixed { background-color: var(--dark); grid-column: span 2; }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(15px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>

<div class="container">
    <header>
        <h1>Examen Bloque 9: Reproducci√≥n y Gametog√©nesis</h1>
        <div class="prof-info">Facultad de Medicina de C√°diz - Prof. Meritxell Llorca Torralba</div>
    </header>

    <div class="status-panel" id="statusBar">
        <span id="q-progress">Cargando...</span>
        <span id="score-display">Aciertos: 0</span>
    </div>

    <div id="quiz-container"></div>

    <div id="results-screen" class="results-view">
        <h2>Sesi√≥n Finalizada</h2>
        <div class="final-score" id="final-number">0/0</div>
        <p id="final-text" style="font-size: 1.2rem; margin-bottom: 20px;"></p>
        
        <div class="stats-summary" id="stats-box"></div>

        <div class="action-grid">
            <button class="action-btn btn-restart" onclick="startQuiz('all')">üîÑ Reiniciar Test Completo</button>
            <button class="action-btn btn-failed" id="btn-failed" onclick="startQuiz('failed')">‚ùå Repetir Falladas</button>
            <button class="action-btn btn-marked" id="btn-marked" onclick="startQuiz('marked')">‚ö†Ô∏è Repetir Marcadas</button>
            <button class="action-btn btn-mixed" id="btn-mixed" onclick="startQuiz('mixed')">‚ùå + ‚ö†Ô∏è Repetir Falladas y Marcadas</button>
        </div>
    </div>
</div>

<script>
const quizData = [
    // --- 1.0 INTRODUCCI√ìN A LA REPRODUCCI√ìN (1-10) ---
    { topic: "Generalidades", question: "¬øQu√© ventaja principal ofrece la reproducci√≥n sexual frente a la asexual?", options: ["Es m√°s r√°pida.", "Genera descendientes id√©nticos.", "Genera variabilidad gen√©tica, aumentando la ventaja competitiva.", "No requiere energ√≠a."], correct: 2, explanation: "La mezcla de genomas crea combinaciones nuevas que permiten la adaptaci√≥n y evoluci√≥n." },
    { topic: "C√©lulas", question: "¬øQu√© son las c√©lulas som√°ticas?", options: ["Los √≥vulos y espermatozoides.", "Todas las c√©lulas del cuerpo excepto la l√≠nea germinal.", "C√©lulas sin n√∫cleo.", "C√©lulas haploides."], correct: 1, explanation: "Son las c√©lulas que forman el cuerpo y son diploides (2n), no participan en la reproducci√≥n sexual directa." },
    { topic: "C√©lulas", question: "¬øQu√© caracter√≠stica define a las c√©lulas germinales?", options: ["Son diploides y dan lugar a gametos mediante meiosis.", "Son haploides desde el nacimiento.", "Son c√©lulas musculares.", "No tienen ADN."], correct: 0, explanation: "Son la l√≠nea celular especializada en las g√≥nadas que sufrir√° meiosis para crear gametos." },
    { topic: "Gen√©tica", question: "¬øQu√© son los cromosomas hom√≥logos?", options: ["Cromosomas id√©nticos formados por replicaci√≥n.", "Pareja de cromosomas (uno paterno, otro materno) con los mismos genes pero posiblemente diferentes alelos.", "Cromosomas de especies diferentes.", "Crom√°tidas hermanas."], correct: 1, explanation: "Son el par 'equivalente' heredado de cada progenitor." },
    { topic: "Gen√©tica", question: "¬øQu√© es un Alelo?", options: ["El centro del cromosoma.", "Una versi√≥n alternativa o variante de un gen.", "Un tipo de c√©lula.", "Una prote√≠na."], correct: 1, explanation: "Los alelos son las diferentes formas que puede tener un gen (ej. color de ojos azul vs marr√≥n)." },
    { topic: "Gen√©tica", question: "¬øQu√© es un Locus?", options: ["Una enfermedad gen√©tica.", "La posici√≥n f√≠sica espec√≠fica de un gen en un cromosoma.", "Un tipo de divisi√≥n celular.", "El n√∫cleo del gameto."], correct: 1, explanation: "Es la 'direcci√≥n' o ubicaci√≥n exacta de un gen dentro del mapa cromos√≥mico." },
    { topic: "Conceptos", question: "¬øQu√© es la 'reserva g√©nica' de una poblaci√≥n?", options: ["Un banco de esperma.", "La totalidad de la informaci√≥n gen√©tica disponible en la poblaci√≥n.", "El ADN basura.", "Las c√©lulas madre."], correct: 1, explanation: "Es el conjunto de todos los alelos de todos los individuos, la materia prima de la evoluci√≥n." },
    { topic: "Ploid√≠a", question: "¬øCu√°l es la ploid√≠a de una c√©lula som√°tica humana t√≠pica?", options: ["Haploide (n = 23).", "Diploide (2n = 46).", "Triploide.", "Tetraploide."], correct: 1, explanation: "Contiene dos juegos de cromosomas, uno de cada progenitor." },
    { topic: "Ploid√≠a", question: "¬øCu√°l es la ploid√≠a de un gameto humano normal?", options: ["Diploide (2n).", "Haploide (n = 23).", "Poliploide.", "Aneuploide."], correct: 1, explanation: "Los gametos deben tener la mitad de cromosomas para restaurar el n√∫mero diploide en la fecundaci√≥n." },
    { topic: "Reproducci√≥n", question: "¬øQu√© proceso garantiza la formaci√≥n de c√©lulas con la mitad de la informaci√≥n gen√©tica?", options: ["Mitosis.", "Meiosis.", "Fecundaci√≥n.", "Clonaci√≥n."], correct: 1, explanation: "La meiosis es la divisi√≥n reduccional exclusiva de la l√≠nea germinal." },

    // --- 2.0 MEIOSIS (11-30) ---
    { topic: "General", question: "¬øCu√°ntas rondas de replicaci√≥n de ADN y cu√°ntas de divisi√≥n celular ocurren en la meiosis?", options: ["1 replicaci√≥n, 1 divisi√≥n.", "2 replicaciones, 2 divisiones.", "1 replicaci√≥n, 2 divisiones.", "Sin replicaci√≥n, 2 divisiones."], correct: 2, explanation: "El ADN se duplica una vez (Fase S previa) y luego hay dos divisiones nucleares consecutivas (I y II)." },
    { topic: "Resultado", question: "¬øCu√°l es el producto final de la meiosis completa a partir de una c√©lula diploide?", options: ["Dos c√©lulas diploides id√©nticas.", "Cuatro c√©lulas haploides gen√©ticamente distintas.", "Dos c√©lulas haploides.", "Cuatro c√©lulas diploides."], correct: 1, explanation: "Se generan cuatro c√©lulas (n) con combinaciones gen√©ticas √∫nicas." },
    { topic: "Meiosis I", question: "¬øQu√© se separa durante la Anafase I de la meiosis?", options: ["Crom√°tidas hermanas.", "Cromosomas hom√≥logos.", "El citoplasma.", "Los centrosomas."], correct: 1, explanation: "Es la divisi√≥n reduccional: los hom√≥logos se segregan a polos opuestos, reduciendo la ploid√≠a." },
    { topic: "Profase I", question: "¬øQu√© estructura proteica estabiliza el apareamiento de hom√≥logos en la Profase I?", options: ["Huso mit√≥tico.", "Complejo Sinapton√©mico.", "Anillo contr√°ctil.", "Poros nucleares."], correct: 1, explanation: "Act√∫a como una 'cremallera' que mantiene alineados a los hom√≥logos para la recombinaci√≥n." },
    { topic: "Profase I", question: "¬øQu√© es el 'Crossing Over' o entrecruzamiento?", options: ["El movimiento de los cromosomas.", "El intercambio de segmentos de ADN entre crom√°tidas no hermanas de cromosomas hom√≥logos.", "La duplicaci√≥n del ADN.", "La separaci√≥n de crom√°tidas."], correct: 1, explanation: "Es un mecanismo clave de variabilidad que mezcla alelos maternos y paternos en el mismo cromosoma." },
    { topic: "Profase I", question: "¬øQu√© es un Quiasma?", options: ["Un error gen√©tico.", "La conexi√≥n f√≠sica visible en forma de cruz donde ocurri√≥ el entrecruzamiento.", "El centro del cromosoma.", "Una prote√≠na."], correct: 1, explanation: "Los quiasmas mantienen unidos a los hom√≥logos hasta la Anafase I y evidencian la recombinaci√≥n." },
    { topic: "Profase I", question: "¬øQu√© es un bivalente o t√©trada?", options: ["Dos cromosomas cualesquiera.", "La estructura formada por dos cromosomas hom√≥logos apareados (4 crom√°tidas).", "Un cromosoma replicado.", "El n√∫cleo."], correct: 1, explanation: "Es la unidad de segregaci√≥n en la Meiosis I, compuesta por los dos hom√≥logos unidos." },
    { topic: "Variabilidad", question: "¬øQu√© es el reordenamiento independiente (o segregaci√≥n independiente)?", options: ["La mutaci√≥n del ADN.", "La distribuci√≥n aleatoria de los hom√≥logos paternos y maternos en la placa metaf√°sica de la Meiosis I.", "El crossing over.", "La fecundaci√≥n."], correct: 1, explanation: "Cada par de hom√≥logos se orienta al azar, creando 2^23 combinaciones posibles de cromosomas en humanos." },
    { topic: "Meiosis I vs II", question: "¬øEn qu√© se diferencia la Anafase I de la Anafase II?", options: ["En la I se separan hom√≥logos; en la II se separan crom√°tidas hermanas.", "En la I se separan crom√°tidas; en la II hom√≥logos.", "Son iguales.", "En la II no hay separaci√≥n."], correct: 0, explanation: "La Anafase I reduce el n√∫mero de cromosomas; la Anafase II es similar a una mitosis (separa copias)." },
    { topic: "Cohesinas", question: "¬øCu√°ndo se degradan las cohesinas de los brazos de los cromosomas en meiosis?", options: ["En Anafase I.", "En Anafase II.", "En Profase I.", "Nunca."], correct: 0, explanation: "Esto permite separar los hom√≥logos (resolviendo quiasmas), pero las cohesinas centrom√©ricas persisten hasta Anafase II." },
    { topic: "Errores", question: "¬øQu√© es una Aneuploid√≠a?", options: ["Tener el n√∫mero correcto de cromosomas.", "Una alteraci√≥n en el n√∫mero de cromosomas (ej. trisom√≠a) por errores de segregaci√≥n.", "Tener dos n√∫cleos.", "Una c√©lula poliploide."], correct: 1, explanation: "Es el resultado de una 'no disyunci√≥n' mei√≥tica, causando s√≠ndromes como el de Down." },
    { topic: "Errores", question: "¬øCu√°l es la causa principal de las aneuploid√≠as?", options: ["Falta de nutrientes.", "Errores en la segregaci√≥n mei√≥tica (no disyunci√≥n).", "Exceso de crossing over.", "Polispermia."], correct: 1, explanation: "Si los cromosomas no se separan correctamente, un gameto recibe dos copias y el otro ninguna." },
    { topic: "Meiosis II", question: "¬øOcurre replicaci√≥n del ADN antes de la Meiosis II?", options: ["S√≠, siempre.", "No, no hay fase S entre Meiosis I y II.", "A veces.", "Solo en espermatog√©nesis."], correct: 1, explanation: "Las c√©lulas pasan directamente, garantizando la reducci√≥n de material gen√©tico a haploide." },
    { topic: "Variabilidad", question: "¬øCu√°ntas combinaciones gen√©ticas posibles genera el reordenamiento independiente en humanos (23 pares)?", options: ["23.", "46.", "2 elevado a 23 (m√°s de 8 millones).", "Infinitas."], correct: 2, explanation: "La combinatoria es 2^n, donde n es el n√∫mero haploide." },
    { topic: "Definici√≥n", question: "¬øQu√© significa que la meiosis es una 'divisi√≥n reduccional'?", options: ["Que las c√©lulas se hacen m√°s peque√±as.", "Que el n√∫mero de cromosomas se reduce a la mitad (2n -> n).", "Que el ADN se pierde.", "Que dura menos tiempo."], correct: 1, explanation: "Es la caracter√≠stica definitoria que permite el ciclo sexual (n + n = 2n)." },
    { topic: "Interfase", question: "¬øC√≥mo se llama el periodo corto entre Meiosis I y II?", options: ["Interfase.", "Intercinesis.", "G0.", "Profase."], correct: 1, explanation: "Es una pausa breve sin replicaci√≥n de ADN." },
    { topic: "Diferencia Mitosis", question: "¬øEn qu√© divisi√≥n se emparejan los cromosomas hom√≥logos?", options: ["Mitosis.", "Meiosis I.", "Meiosis II.", "Todas."], correct: 1, explanation: "El apareamiento de hom√≥logos es exclusivo de la Meiosis I; en mitosis y meiosis II se alinean individualmente." },
    { topic: "Crossing Over", question: "¬øQu√© genera el entrecruzamiento?", options: ["Cromosomas recombinantes con mezcla de alelos paternos y maternos.", "Mutaciones.", "Dos cromosomas id√©nticos.", "P√©rdida de genes."], correct: 0, explanation: "Rompe el ligamiento entre genes del mismo cromosoma, creando haplotipos nuevos." },
    { topic: "Fases", question: "¬øEn qu√© fase se hacen visibles los quiasmas?", options: ["Leptoteno.", "Paquiteno.", "Diploteno/Diacinesis (final de Profase I).", "Anafase."], correct: 2, explanation: "Cuando el complejo sinapton√©mico se disuelve, los hom√≥logos quedan unidos solo por los puntos de cruce (quiasmas)." },
    { topic: "Importancia", question: "¬øQu√© pasar√≠a si la meiosis no redujera el n√∫mero de cromosomas?", options: ["Nada.", "El n√∫mero de cromosomas se duplicar√≠a en cada generaci√≥n (inviable).", "La evoluci√≥n ser√≠a m√°s r√°pida.", "No habr√≠a fecundaci√≥n."], correct: 1, explanation: "La reducci√≥n es vital para mantener constante el cariotipo de la especie a trav√©s de las generaciones." },

    // --- 3.0 GAMETOG√âNESIS (31-50) ---
    { topic: "Espermatog√©nesis", question: "¬øD√≥nde ocurre la espermatog√©nesis?", options: ["En el epid√≠dimo.", "En las paredes de los t√∫bulos semin√≠feros de los test√≠culos.", "En la pr√≥stata.", "En el conducto deferente."], correct: 1, explanation: "El epitelio semin√≠fero es el lugar de proliferaci√≥n y meiosis masculina." },
    { topic: "Espermatog√©nesis", question: "¬øCu√°ndo comienza la espermatog√©nesis en humanos?", options: ["En el desarrollo fetal.", "Al nacer.", "En la pubertad.", "A los 40 a√±os."], correct: 2, explanation: "Se inicia por est√≠mulo hormonal (testosterona) en la pubertad y es continua." },
    { topic: "C√©lulas de Sertoli", question: "¬øQu√© funci√≥n tienen las c√©lulas de Sertoli?", options: ["Producir testosterona.", "Dar soporte, nutrici√≥n y ambiente adecuado a las c√©lulas germinales.", "Convertirse en espermatozoides.", "Producir moco."], correct: 1, explanation: "Son las c√©lulas 'nodriza' del epitelio semin√≠fero." },
    { topic: "C√©lulas de Leydig", question: "¬øQu√© producen las c√©lulas de Leydig?", options: ["Espermatozoides.", "Testosterona.", "L√≠quido seminal.", "FSH."], correct: 1, explanation: "Se encuentran en el intersticio y secretan la hormona masculina principal." },
    { topic: "Proceso", question: "¬øQu√© es la espermiog√©nesis?", options: ["La divisi√≥n mei√≥tica.", "La diferenciaci√≥n de esperm√°tidas (redondas) a espermatozoides (con flagelo) sin divisi√≥n celular.", "La salida del esperma.", "La fecundaci√≥n."], correct: 1, explanation: "Es la fase final de maduraci√≥n morfol√≥gica: formaci√≥n de acrosoma, flagelo y condensaci√≥n nuclear." },
    { topic: "Rendimiento", question: "¬øCu√°ntos espermatozoides funcionales se obtienen de un espermatocito primario?", options: ["Uno.", "Dos.", "Cuatro.", "Ocho."], correct: 2, explanation: "La meiosis masculina es sim√©trica y produce 4 gametos viables." },
    { topic: "Ovog√©nesis", question: "¬øCu√°ndo comienza la ovog√©nesis?", options: ["En la pubertad.", "En el periodo fetal (embrionario).", "En la menopausia.", "En cada menstruaci√≥n."], correct: 1, explanation: "Las hembras inician la meiosis antes de nacer; nacen con una reserva finita de ovocitos detenidos." },
    { topic: "Bloqueo 1", question: "¬øEn qu√© fase se detienen los ovocitos primarios hasta la pubertad?", options: ["Metafase II.", "Profase I (Diploteno).", "Anafase I.", "G1."], correct: 1, explanation: "Permanecen en este estado de latencia (dictiotena) durante a√±os (infancia)." },
    { topic: "Bloqueo 2", question: "¬øEn qu√© fase se detiene el ovocito secundario ovulado?", options: ["Profase I.", "Metafase II.", "Telofase II.", "Interfase."], correct: 1, explanation: "Solo completa la meiosis si es fecundado; si no, degenera en Metafase II." },
    { topic: "Asimetr√≠a", question: "¬øQu√© caracteriza a la divisi√≥n citoplasm√°tica en la ovog√©nesis?", options: ["Es igualitaria.", "Es asim√©trica: genera un ovocito grande y cuerpos polares peque√±os.", "No hay divisi√≥n.", "Genera 4 √≥vulos."], correct: 1, explanation: "El objetivo es conservar todo el citoplasma y nutrientes en una sola c√©lula (el √≥vulo) para el embri√≥n." },
    { topic: "Rendimiento", question: "¬øCu√°ntos √≥vulos funcionales se obtienen de un ovocito primario?", options: ["Cuatro.", "Dos.", "Uno (y 2-3 cuerpos polares).", "Ninguno."], correct: 2, explanation: "La asimetr√≠a sacrifica a las otras c√©lulas hijas (cuerpos polares) para maximizar al √≥vulo." },
    { topic: "Comparaci√≥n", question: "¬øQu√© proceso es continuo durante toda la vida adulta?", options: ["Ovog√©nesis.", "Espermatog√©nesis.", "Ambos.", "Ninguno."], correct: 1, explanation: "Los hombres producen esperma continuamente; las mujeres tienen ciclos y una reserva agotable (menopausia)." },
    { topic: "Duraci√≥n", question: "¬øCu√°nto dura el ciclo completo de espermatog√©nesis?", options: ["24 horas.", "28 d√≠as.", "Aproximadamente 64-74 d√≠as.", "9 meses."], correct: 2, explanation: "Es un proceso largo de diferenciaci√≥n." },
    { topic: "Ovulaci√≥n", question: "¬øQu√© evento reinicia la meiosis del ovocito primario cada mes?", options: ["La fecundaci√≥n.", "El pico hormonal (LH) en la ovulaci√≥n.", "La menstruaci√≥n.", "El estr√©s."], correct: 1, explanation: "El est√≠mulo hormonal de la pubertad permite que un grupo de ovocitos complete la Meiosis I." },
    { topic: "Finalizaci√≥n", question: "¬øQu√© es necesario para que el ovocito complete la Meiosis II?", options: ["La ovulaci√≥n.", "La fecundaci√≥n (entrada del espermatozoide).", "La implantaci√≥n.", "La menstruaci√≥n."], correct: 1, explanation: "El contacto con el espermatozoide rompe el arresto en Metafase II." },
    { topic: "Espermiog√©nesis", question: "¬øQu√© org√°nulo forma el acrosoma del espermatozoide?", options: ["El n√∫cleo.", "La mitocondria.", "El Aparato de Golgi.", "El ret√≠culo."], correct: 2, explanation: "El Golgi se modifica para formar la ves√≠cula llena de enzimas en la cabeza del espermatozoide." },
    { topic: "Espermiog√©nesis", question: "¬øD√≥nde se disponen las mitocondrias en el espermatozoide?", options: ["En la cabeza.", "En la pieza media (cuello).", "En la cola.", "Se pierden."], correct: 1, explanation: "Se enrollan en espiral en el cuello para proporcionar ATP al flagelo." },
    { topic: "Cuerpos Polares", question: "¬øTienen funci√≥n reproductiva los cuerpos polares?", options: ["S√≠, pueden ser fecundados.", "No, generalmente degeneran.", "Se convierten en placenta.", "Nutren al espermatozoide."], correct: 1, explanation: "Son subproductos gen√©ticos sin citoplasma suficiente para el desarrollo." },
    { topic: "Ploid√≠a", question: "¬øCu√°l es la ploid√≠a de una esperm√°tida?", options: ["2n (Diploide).", "n (Haploide).", "4n.", "No tiene ADN."], correct: 1, explanation: "Ya ha terminado la meiosis, pero a√∫n no se ha diferenciado morfol√≥gicamente." },
    { topic: "Comparaci√≥n", question: "¬øQu√© gametog√©nesis tiene una fase de 'pausa' que puede durar 40 o 50 a√±os?", options: ["Espermatog√©nesis.", "Ovog√©nesis.", "Ambas.", "Ninguno."], correct: 1, explanation: "Un ovocito puede estar detenido en Profase I desde el feto hasta justo antes de la menopausia." },

    // --- 4.0 FECUNDACI√ìN (51-62) ---
    { topic: "Corona Radiada", question: "¬øC√≥mo atraviesa el espermatozoide la corona radiada?", options: ["Por fuerza bruta.", "Gracias a la enzima hialuronidasa y el movimiento del flagelo.", "Esperando que se abra.", "Comi√©ndosela."], correct: 1, explanation: "La hialuronidasa digiere la matriz entre las c√©lulas foliculares." },
    { topic: "Zona Pel√∫cida", question: "¬øQu√© es la Zona Pel√∫cida?", options: ["La membrana del √≥vulo.", "Una matriz glicoproteica que rodea al ovocito.", "El n√∫cleo del √≥vulo.", "Una capa de c√©lulas."], correct: 1, explanation: "Es la cubierta protectora esencial para el reconocimiento espec√≠fico de especie." },
    { topic: "Reconocimiento", question: "¬øA qu√© receptor de la zona pel√∫cida se une el espermatozoide?", options: ["ZP1.", "ZP2.", "ZP3.", "ZP4."], correct: 2, explanation: "ZP3 es la glicoprote√≠na clave para el reconocimiento y la inducci√≥n de la reacci√≥n acros√≥mica." },
    { topic: "Reacci√≥n Acros√≥mica", question: "¬øQu√© ocurre en la reacci√≥n acros√≥mica?", options: ["El espermatozoide pierde la cola.", "Se liberan enzimas hidrol√≠ticas (acrosina) para perforar la zona pel√∫cida.", "El √≥vulo se divide.", "Se fusionan los n√∫cleos."], correct: 1, explanation: "El acrosoma libera su contenido, digiriendo un t√∫nel a trav√©s de la zona pel√∫cida." },
    { topic: "Fusi√≥n", question: "¬øQu√© sucede tras la penetraci√≥n de la zona pel√∫cida?", options: ["El espermatozoide muere.", "La membrana del espermatozoide se fusiona con la del ovocito.", "Se forma la placenta.", "Ocurre otra meiosis."], correct: 1, explanation: "Las membranas plasm√°ticas se fusionan y el contenido del espermatozoide entra al citoplasma." },
    { topic: "Polispermia", question: "¬øQu√© es el bloqueo de la polispermia?", options: ["Impedir que el espermatozoide entre.", "Mecanismo para evitar la fecundaci√≥n por m√°s de un espermatozoide.", "Fecundar con muchos espermatozoides.", "Destruir el √≥vulo."], correct: 1, explanation: "Es vital para mantener la diploid√≠a; la entrada de varios espermatozoides ser√≠a letal." },
    { topic: "Reacci√≥n Cortical", question: "¬øC√≥mo se logra el bloqueo de la polispermia (Reacci√≥n Cortical)?", options: ["Liberando gr√°nulos corticales que endurecen la zona pel√∫cida y modifican ZP3.", "Cerrando la vagina.", "Matando a los espermatozoides.", "El √≥vulo se encoge."], correct: 0, explanation: "Las enzimas liberadas alteran la zona pel√∫cida haci√©ndola impenetrable para otros." },
    { topic: "Activaci√≥n", question: "¬øQu√© efecto tiene la entrada del espermatozoide en el ovocito?", options: ["Lo mata.", "Activa metab√≥licamente al ovocito y provoca la finalizaci√≥n de la Meiosis II.", "Lo duplica.", "Nada."], correct: 1, explanation: "El 'despertar' del √≥vulo incluye terminar su divisi√≥n y prepararse para el desarrollo." },
    { topic: "Pron√∫cleos", question: "¬øQu√© son los pron√∫cleos?", options: ["N√∫cleos de c√©lulas som√°ticas.", "Los n√∫cleos haploides del √≥vulo y el espermatozoide antes de fusionarse dentro del cigoto.", "Cuerpos polares.", "N√∫cleos virales."], correct: 1, explanation: "Son los paquetes de ADN materno y paterno visibles en el cigoto antes de la singamia." },
    { topic: "Singamia", question: "¬øQu√© marca el final de la fecundaci√≥n?", options: ["La entrada del esperma.", "La fusi√≥n de los pron√∫cleos (singamia) para formar el cigoto diploide.", "La implantaci√≥n.", "El nacimiento."], correct: 1, explanation: "Es el momento en que se restablece el genoma completo y √∫nico del nuevo individuo." },
    { topic: "Mitocondrias", question: "¬øQu√© ocurre con las mitocondrias del espermatozoide tras la fecundaci√≥n?", options: ["Se replican.", "Son degradadas; solo se conservan las maternas.", "Se fusionan con las maternas.", "Forman el n√∫cleo."], correct: 1, explanation: "La herencia mitocondrial es materna; las paternas son eliminadas." },
    { topic: "Definici√≥n", question: "¬øQu√© es el Cigoto?", options: ["Un gameto.", "La primera c√©lula diploide del nuevo organismo.", "Un embri√≥n de 8 c√©lulas.", "Un feto."], correct: 1, explanation: "Es la c√©lula totipotente resultante de la fecundaci√≥n." },

    // --- 5.0 FEN√ìMENOS ESPECIALES Y TECNOLOG√çA (63-75) ---
    { topic: "Gemelos", question: "¬øC√≥mo se originan los gemelos dicig√≥ticos ('fraternos')?", options: ["Un √≥vulo se divide en dos.", "Fecundaci√≥n de dos √≥vulos distintos por dos espermatozoides distintos.", "Clonaci√≥n.", "Fecundaci√≥n de un √≥vulo por dos espermatozoides."], correct: 1, explanation: "Son hermanos que coinciden en el tiempo; comparten el 50% de ADN como cualquier hermano." },
    { topic: "Gemelos", question: "¬øC√≥mo se originan los gemelos monocig√≥ticos ('id√©nticos')?", options: ["Dos √≥vulos fecundados.", "Un √∫nico cigoto que se divide en dos embriones en etapas tempranas.", "Mutaci√≥n gen√©tica.", "Fusi√≥n de dos embriones."], correct: 1, explanation: "Son clones naturales; comparten el 100% de su secuencia de ADN." },
    { topic: "Gemelos", question: "¬øQu√© tipo de gemelos son siempre del mismo sexo?", options: ["Dicig√≥ticos.", "Monocig√≥ticos.", "Ambos.", "Ninguno."], correct: 1, explanation: "Al tener el mismo genoma (incluyendo XY o XX), tienen el mismo sexo." },
    { topic: "Clonaci√≥n", question: "¬øQu√© t√©cnica se us√≥ para crear a la oveja Dolly?", options: ["FIV.", "Transferencia Nuclear de C√©lulas Som√°ticas (TNCS).", "Bipartici√≥n embrionaria.", "Inseminaci√≥n artificial."], correct: 1, explanation: "Se transfiri√≥ el n√∫cleo de una c√©lula adulta (ubre) a un √≥vulo enucleado." },
    { topic: "Clonaci√≥n", question: "¬øQu√© demostr√≥ el experimento de Dolly?", options: ["Que las ovejas no pueden clonarse.", "Que el n√∫cleo de una c√©lula diferenciada puede ser reprogramado para generar un organismo completo.", "Que el ADN se pierde al envejecer.", "Que se necesita esperma."], correct: 1, explanation: "Rompi√≥ el dogma de la irreversibilidad del desarrollo." },
    { topic: "Clonaci√≥n", question: "¬øQu√© es la clonaci√≥n terap√©utica?", options: ["Crear beb√©s.", "Crear embriones para obtener c√©lulas madre compatibles y tratar enfermedades, no para nacer.", "Curar ovejas.", "Congelar √≥vulos."], correct: 1, explanation: "El objetivo es obtener tejidos para trasplantes, no individuos completos." },
    { topic: "TRA", question: "¬øQu√© es la Fecundaci√≥n in Vitro (FIV)?", options: ["Inyectar esperma en el √∫tero.", "Fecundar √≥vulos con espermatozoides en el laboratorio (placa de cultivo).", "Clonaci√≥n.", "Ecograf√≠a."], correct: 1, explanation: "La uni√≥n de gametos ocurre fuera del cuerpo, y luego se transfiere el embri√≥n." },
    { topic: "TRA", question: "¬øQu√© es la ICSI?", options: ["Inyecci√≥n Intracitoplasm√°tica de Espermatozoides.", "Inseminaci√≥n Casera.", "Infecci√≥n Celular.", "Implante de Cigoto."], correct: 0, explanation: "Es una variante de FIV donde se inyecta un solo espermatozoide directamente dentro del √≥vulo (√∫til en infertilidad masculina severa)." },
    { topic: "TRA", question: "¬øQu√© es el DGP (Diagn√≥stico Gen√©tico Preimplantacional)?", options: ["Analizar el ADN de los padres.", "Analizar gen√©ticamente una c√©lula del embri√≥n (FIV) antes de transferirlo al √∫tero.", "Operar al feto.", "Elegir el nombre del beb√©."], correct: 1, explanation: "Permite seleccionar embriones sanos libres de enfermedades gen√©ticas o aneuploid√≠as." },
    { topic: "Epigen√©tica", question: "¬øPor qu√© los gemelos id√©nticos pueden ser diferentes (ej. enfermedades) aunque tengan el mismo ADN?", options: ["Tienen diferente ADN mitocondrial.", "Por influencias ambientales y cambios epigen√©ticos (metilaci√≥n) a lo largo de la vida.", "No pueden ser diferentes.", "Uno es adoptado."], correct: 1, explanation: "El ambiente modifica la expresi√≥n de los genes (epigenoma) haciendo que diverjan con el tiempo." },
    { topic: "Bipartici√≥n", question: "¬øQu√© es la bipartici√≥n embrionaria?", options: ["Clonaci√≥n artificial dividiendo un embri√≥n temprano en dos mitades.", "La divisi√≥n de bacterias.", "La muerte del embri√≥n.", "La formaci√≥n de gametos."], correct: 0, explanation: "Es una forma de inducir gemelos id√©nticos artificialmente (usado en ganader√≠a)." },
    { topic: "IA", question: "¬øQu√© es la Inseminaci√≥n Artificial?", options: ["Fecundaci√≥n en laboratorio.", "Depositar semen preparado en el √∫tero de la mujer.", "Crear esperma sint√©tico.", "Uso de robots."], correct: 1, explanation: "Es la t√©cnica m√°s sencilla, facilitando el encuentro de gametos dentro del cuerpo." },
    { topic: "Resumen", question: "¬øQu√© c√©lula humana es haploide?", options: ["Neurona.", "Hepatocito.", "Espermatozoide.", "Zigoto."], correct: 2, explanation: "Solo los gametos son haploides (n)." }
];

// --- GESTI√ìN DE ESTADO ---
quizData.forEach(q => {
    q.isMarked = false;
    q.userCorrect = null;
});

let activeIndices = []; 
let currentPlaylistIndex = 0;
let sessionScore = 0;
let answered = false;

document.addEventListener('DOMContentLoaded', () => {
    startQuiz('all');
});

function startQuiz(mode) {
    activeIndices = [];

    // L√≥gica para filtrar preguntas
    if (mode === 'all') {
        quizData.forEach(q => q.userCorrect = null); // Resetear respuestas
        // Opcional: resetear marcas con quizData.forEach(q => q.isMarked = false);
        activeIndices = quizData.map((_, i) => i);
    } 
    else if (mode === 'failed') {
        activeIndices = quizData.map((q, i) => q.userCorrect === false ? i : -1).filter(i => i !== -1);
    } 
    else if (mode === 'marked') {
        activeIndices = quizData.map((q, i) => q.isMarked ? i : -1).filter(i => i !== -1);
    } 
    else if (mode === 'mixed') {
        activeIndices = quizData.map((q, i) => (q.userCorrect === false || q.isMarked) ? i : -1).filter(i => i !== -1);
    }

    if (activeIndices.length === 0) {
        alert("No hay preguntas disponibles para este modo.");
        return;
    }

    currentPlaylistIndex = 0;
    sessionScore = 0;
    
    document.getElementById('results-screen').style.display = 'none';
    document.getElementById('quiz-container').style.display = 'block';
    document.getElementById('statusBar').style.display = 'flex';
    
    loadQuestion();
}

function loadQuestion() {
    answered = false;
    const realIndex = activeIndices[currentPlaylistIndex];
    const q = quizData[realIndex];
    
    document.getElementById('q-progress').innerText = `Pregunta ${currentPlaylistIndex + 1} de ${activeIndices.length}`;
    document.getElementById('score-display').innerText = `Aciertos: ${sessionScore}`;

    const container = document.getElementById('quiz-container');
    const checkedAttr = q.isMarked ? 'checked' : '';

    let html = `
        <div class="question-card active">
            <label class="bookmark-panel">
                <input type="checkbox" onchange="toggleMark(${realIndex}, this)" ${checkedAttr}>
                <span>Marcar</span>
            </label>

            <div class="question-header">${q.topic}</div>
            <div class="question-text">${q.question}</div>
            <div class="options-list">
                ${q.options.map((opt, i) => `
                    <button class="option-btn" onclick="checkAnswer(${i}, ${q.correct}, this, ${realIndex})">
                        ${String.fromCharCode(65+i)}. ${opt}
                    </button>
                `).join('')}
            </div>
            <div class="feedback-area" id="feedback"></div>
            <button class="nav-btn" id="next-btn" onclick="nextQuestion()">Siguiente</button>
        </div>
    `;
    
    container.innerHTML = html;
}

function toggleMark(realIndex, checkbox) {
    quizData[realIndex].isMarked = checkbox.checked;
}

function checkAnswer(selected, correct, btn, realIndex) {
    if(answered) return;
    answered = true;

    const allBtns = document.querySelectorAll('.option-btn');
    const feedback = document.getElementById('feedback');
    const nextBtn = document.getElementById('next-btn');

    allBtns.forEach(b => b.disabled = true);

    if(selected === correct) {
        sessionScore++;
        quizData[realIndex].userCorrect = true;
        btn.classList.add('correct');
        feedback.innerHTML = `<strong style="color:var(--success)">¬°Correcto!</strong> <div class="rationale">${quizData[realIndex].explanation}</div>`;
    } else {
        quizData[realIndex].userCorrect = false;
        btn.classList.add('incorrect');
        allBtns[correct].classList.add('correct');
        feedback.innerHTML = `<strong style="color:var(--danger)">Incorrecto.</strong> <div class="rationale">${quizData[realIndex].explanation}</div>`;
    }

    feedback.classList.add('show');
    nextBtn.style.display = 'block';
    document.getElementById('score-display').innerText = `Aciertos: ${sessionScore}`;
}

function nextQuestion() {
    if(currentPlaylistIndex < activeIndices.length - 1) {
        currentPlaylistIndex++;
        loadQuestion();
    } else {
        showResults();
    }
}

function showResults() {
    document.getElementById('statusBar').style.display = 'none';
    document.getElementById('quiz-container').style.display = 'none';
    document.getElementById('results-screen').style.display = 'block';
    
    document.getElementById('final-number').innerText = `${sessionScore} / ${activeIndices.length}`;
    
    const percent = Math.round((sessionScore / activeIndices.length) * 100);
    let msg = "";
    if(percent >= 90) msg = "¬°Excelente!";
    else if(percent >= 70) msg = "¬°Muy bien!";
    else if(percent >= 50) msg = "Aprobado.";
    else msg = "Necesitas repasar.";
    
    document.getElementById('final-text').innerText = `${percent}% - ${msg}`;

    // Stats
    const totalFailed = quizData.filter(q => q.userCorrect === false).length;
    const totalMarked = quizData.filter(q => q.isMarked === true).length;
    const totalMixed = quizData.filter(q => q.userCorrect === false || q.isMarked).length;

    document.getElementById('stats-box').innerHTML = `
        <strong>Resumen Global:</strong><br>
        Marcadas: ${totalMarked} | Falladas: ${totalFailed}
    `;

    document.getElementById('btn-failed').disabled = (totalFailed === 0);
    document.getElementById('btn-marked').disabled = (totalMarked === 0);
    document.getElementById('btn-mixed').disabled = (totalMixed === 0);
    
    document.getElementById('btn-failed').innerText = `‚ùå Repetir Falladas (${totalFailed})`;
    document.getElementById('btn-marked').innerText = `‚ö†Ô∏è Repetir Marcadas (${totalMarked})`;
}
</script>

</body>
</html>
