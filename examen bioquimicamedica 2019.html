<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Examen Bioqu√≠mica Feb 2019 - Pro</title>
    <style>
        :root {
            --primary: #2980b9;    /* Azul para este examen */
            --secondary: #34495e;
            --success: #27ae60;
            --error: #c0392b;
            --warning: #f39c12;
            --bg: #ecf0f1;
            --card-bg: #ffffff;
        }

        body { font-family: 'Segoe UI', system-ui, sans-serif; margin: 0; background-color: var(--bg); height: 100vh; display: flex; overflow: hidden; color: #333; }

        /* SIDEBAR */
        #sidebar { width: 300px; background: var(--secondary); color: white; display: flex; flex-direction: column; flex-shrink: 0; box-shadow: 2px 0 10px rgba(0,0,0,0.1); z-index: 100; }
        .sb-header { padding: 20px; background: rgba(0,0,0,0.2); text-align: center; border-bottom: 1px solid #46637f; }
        .sb-info { padding: 10px; text-align: center; font-size: 0.9rem; color: #bdc3c7; }
        
        #nav-grid { flex: 1; overflow-y: auto; padding: 10px; display: grid; grid-template-columns: repeat(5, 1fr); gap: 5px; align-content: start; }
        .nav-btn { aspect-ratio: 1; border: none; background: rgba(255,255,255,0.1); color: #bdc3c7; border-radius: 4px; cursor: pointer; font-weight: bold; font-size: 0.8rem; position: relative; }
        .nav-btn:hover { background: rgba(255,255,255,0.3); color: white; }
        .nav-btn.active { background: white; color: var(--secondary); transform: scale(1.1); z-index: 2; box-shadow: 0 0 10px var(--primary); }
        .nav-btn.correct { background: var(--success); color: white; }
        .nav-btn.wrong { background: var(--error); color: white; }
        .nav-btn.marked::after { content: ''; position: absolute; top: 2px; right: 2px; width: 6px; height: 6px; background: var(--warning); border-radius: 50%; border: 1px solid white; }

        /* MAIN */
        #main { flex: 1; display: flex; flex-direction: column; position: relative; }
        .top-bar { height: 60px; background: white; display: flex; align-items: center; justify-content: space-between; padding: 0 30px; box-shadow: 0 2px 5px rgba(0,0,0,0.05); }
        .timer { font-family: monospace; font-size: 1.2rem; background: #eee; padding: 5px 10px; border-radius: 5px; color: var(--primary); font-weight: bold; }

        #quiz-area { flex: 1; overflow-y: auto; padding: 40px; scroll-behavior: smooth; }
        .q-container { max-width: 800px; margin: 0 auto 100px auto; }

        .q-card { background: var(--card-bg); padding: 30px; border-radius: 10px; margin-bottom: 25px; box-shadow: 0 4px 6px rgba(0,0,0,0.05); border-left: 5px solid transparent; transition: 0.3s; }
        .q-card.current { border-left-color: var(--primary); transform: translateX(5px); box-shadow: 0 8px 15px rgba(0,0,0,0.1); }
        
        .q-meta { display: flex; justify-content: space-between; margin-bottom: 15px; font-size: 0.85rem; color: #7f8c8d; font-weight: bold; text-transform: uppercase; }
        .q-text { font-size: 1.15rem; font-weight: 600; margin-bottom: 20px; line-height: 1.5; }

        .opt-btn { display: block; width: 100%; text-align: left; padding: 15px; margin-bottom: 10px; border: 2px solid #f0f0f0; background: #f9f9f9; border-radius: 8px; cursor: pointer; transition: 0.2s; font-size: 1rem; color: #444; }
        .opt-btn:hover:not(:disabled) { border-color: var(--primary); background: #fdf8ff; }
        .opt-btn.correct { background: #d4edda; border-color: var(--success); color: #155724; }
        .opt-btn.wrong { background: #f8d7da; border-color: var(--error); color: #721c24; }
        .opt-btn:disabled { cursor: default; opacity: 0.7; }

        .feedback { margin-top: 15px; padding: 15px; background: #e8f8f5; border-left: 4px solid var(--success); border-radius: 4px; display: none; animation: slideIn 0.3s; }
        .tools { margin-top: 15px; padding-top: 15px; border-top: 1px solid #eee; display: flex; justify-content: flex-end; }
        .mark-label { display: flex; align-items: center; gap: 8px; font-size: 0.9rem; color: #7f8c8d; cursor: pointer; }
        .mark-label input { transform: scale(1.2); accent-color: var(--warning); }

        /* MODALS */
        .modal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); z-index: 2000; display: flex; justify-content: center; align-items: center; backdrop-filter: blur(5px); }
        .modal-box { background: white; padding: 40px; border-radius: 12px; width: 90%; max-width: 550px; text-align: center; box-shadow: 0 20px 50px rgba(0,0,0,0.5); }
        
        .btn { width: 100%; padding: 15px; border: none; border-radius: 8px; font-size: 1.1rem; font-weight: bold; cursor: pointer; margin-top: 10px; transition: transform 0.1s; }
        .btn:hover { transform: scale(1.02); }
        .btn-primary { background: var(--primary); color: white; }
        .btn-secondary { background: var(--secondary); color: white; }
        
        .retry-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 20px; }
        .btn-retry { font-size: 0.9rem; padding: 12px; color: white; }
        .r-fail { background: var(--error); }
        .r-mark { background: var(--warning); }
        .r-mix { background: #8e44ad; grid-column: span 2; }
        .r-all { background: var(--secondary); grid-column: span 2; }

        @keyframes slideIn { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>

    <div id="start-screen" class="modal">
        <div class="modal-box">
            <h1 style="color:var(--secondary); margin-bottom:5px;">Bioqu√≠mica M√©dica</h1>
            <h2 style="color:var(--primary); margin-top:0;">Febrero 2019</h2>
            <p>70 Preguntas</p>
            
            <div style="text-align:left; background:#f8f9fa; padding:20px; border-radius:8px; margin:20px 0;">
                <p style="font-size:0.9rem; color:#7f8c8d; margin-bottom:15px;">
                    ‚ÑπÔ∏è Las respuestas (a, b, c, d) se mezclar√°n autom√°ticamente.
                </p>
                <label style="display:flex; align-items:center; gap:10px; cursor:pointer; font-size:1.1rem; margin-bottom:10px;">
                    <input type="checkbox" id="shuffle-questions" checked> 
                    <strong>¬øMezclar orden de las preguntas?</strong>
                </label>
                <label style="display:flex; align-items:center; gap:10px; cursor:pointer; font-size:1.1rem;">
                    <input type="checkbox" id="timer-check"> 
                    Activar Temporizador
                </label>
            </div>

            <button class="btn btn-primary" onclick="initQuiz()">COMENZAR TEST</button>
        </div>
    </div>

    <div id="result-screen" class="modal" style="display:none;">
        <div class="modal-box">
            <h2>Resultados</h2>
            <div style="font-size:3.5rem; font-weight:800; color:var(--primary);" id="score">0%</div>
            
            <div style="display:grid; grid-template-columns:1fr 1fr 1fr; gap:10px; margin:20px 0;">
                <div style="background:#eafaf1; padding:10px; border-radius:5px; color:var(--success)">‚úÖ <b id="r-ok">0</b></div>
                <div style="background:#fdedec; padding:10px; border-radius:5px; color:var(--error)">‚ùå <b id="r-ko">0</b></div>
                <div style="background:#fef9e7; padding:10px; border-radius:5px; color:var(--warning)">üö© <b id="r-mk">0</b></div>
            </div>

            <div class="retry-grid">
                <button class="btn btn-retry r-fail" onclick="retry('failed')">Solo Falladas</button>
                <button class="btn btn-retry r-mark" onclick="retry('marked')">Solo Marcadas</button>
                <button class="btn btn-retry r-mix" onclick="retry('failed_marked')">Falladas + Marcadas</button>
                <button class="btn btn-retry r-all" onclick="retry('all')">Reiniciar Todo</button>
            </div>
        </div>
    </div>

    <div id="sidebar">
        <div class="sb-header">
            <h3>Navegaci√≥n</h3>
        </div>
        <div class="sb-info">
            <span id="prog-text">0 / 70</span>
        </div>
        <div id="nav-grid"></div>
        <div style="padding:20px;">
            <button class="btn btn-secondary" onclick="finish()">Finalizar</button>
        </div>
    </div>

    <div id="main">
        <div class="top-bar">
            <strong>Examen Feb 2019</strong>
            <div class="timer" id="timer">00:00</div>
        </div>
        <div id="quiz-area">
            <div class="q-container" id="questions-wrapper"></div>
        </div>
    </div>

    <script>
        // BASE DE DATOS FEBRERO 2019 (70 Preguntas)
        const fullDB = [
            { id: 1, q: "1. Se√±ale la respuesta correcta respecto al principal marcador bioqu√≠mico del estado nutricional:", o: ["Hierro", "Potasio", "Alb√∫mina", "Transaminasas hep√°ticas", "Hemoglobina"], c: 2 },
            { id: 2, q: "2. En relaci√≥n al riesgo aterog√©nico de las dietas, se favorece con la ingesta de:", o: ["Grasas saturadas", "√Åcidos grasos œâ3", "Fibra soluble", "Grasas monoinsaturadas", "√Åcidos grasos œâ6"], c: 0 },
            { id: 3, q: "3. La funci√≥n coenzim√°tica de la vitamina C permite que √©sta act√∫e en procesos de:", o: ["Fosforilaci√≥n", "Isomerizaci√≥n", "Hidrataci√≥n", "Metilaci√≥n", "Oxidorreducci√≥n"], c: 4 },
            { id: 4, q: "4. La vitamina C tiene un potente efecto reductor. Se√±ale la respuesta correcta en relaci√≥n a la mol√©cula que es necesaria para que recupere su estado reducido inicial:", o: ["Vitamina E", "Per√≥xido de hidr√≥geno", "NADPH+", "Glutati√≥n reducido", "Glutati√≥n oxidado"], c: 3 },
            { id: 5, q: "5. De las siguientes opciones, indique cu√°l es la forma activa de la vitamina D:", o: ["24,25 dihidroxicalciferol", "1,24 dihidroxicalciferol", "1,25 dihidroxicalciferol", "2,24 dehidroxicalciferol", "2,25 dihidroxicalciferol"], c: 2 },
            { id: 6, q: "6. Se√±ale la respuesta correcta respecto a los receptores espec√≠ficos para el √°cido retinoico:", o: ["Son receptores de superficie con actividad tiros√≠n kinasa", "Estos receptores activan a la fosfolipasa C", "Son receptores nucleares", "Son receptores de superficie acoplados a prote√≠na G", "Act√∫an como poros de transici√≥n"], c: 2 },
            { id: 7, q: "7. La estructura de la vitamina A est√° formada por:", o: ["Un diterpeno", "Un tetraterpeno", "Dos anillos Œ±-iononas", "Una cadena lateral con 40 carbonos", "Un anillo de licopeno"], c: 0 },
            { id: 8, q: "8. ¬øCu√°l es uno de los principales amino√°cidos donadores de nitr√≥geno empleados por las c√©lulas neopl√°sicas?:", o: ["Tirosina", "Valina", "Glutamina", "Histidina", "Treonina"], c: 2 },
            { id: 9, q: "9. Respecto al metabolismo celular tumoral, se√±ale la respuesta incorrecta:", o: ["La enzima piruvato deshidrogenasa quinasa fosforila a la piruvato deshidrogenasa, activ√°ndola", "La enzima piruvato deshidrogenasa quinasa fosforila a la piruvato deshidrogenasa, inactiv√°ndola", "La insulina favorece la acci√≥n de la enzima piruvato deshidrogenasa fosfatasa", "El aumento de piruvato frena la actividad de la enzima piruvato deshidrogenasa quinasa", "El aumento de acetil-CoA favorece la actividad de la enzima piruvato deshidrogenasa quinasa"], c: 0 },
            { id: 10, q: "10. Indique en qu√© momento tras la ingesta se obtiene el m√°ximo efecto t√©rmico de los alimentos:", o: ["Entre los 60‚Äì120 minutos", "Entre los 10‚Äì30 minutos", "A los 30‚Äì45 minutos", "Entre 180‚Äì240 minutos", "Entre 240‚Äì300 minutos"], c: 0 },
            { id: 11, q: "11. Se√±ale la respuesta incorrecta respecto a las v√≠as metab√≥licas que se activan durante el ayuno temprano:", o: ["Aumenta la glucogenolisis y disminuye la lipog√©nesis", "Aumenta la gluconeog√©nesis a expensas del lactato", "Se favorece la secreci√≥n de insulina", "Se inhibe la secreci√≥n de insulina", "Aumenta la lipog√©nesis y disminuye la glucogenolisis"], c: 2 },
            { id: 12, q: "12. En el ayuno prolongado, se activa la formaci√≥n de glucosa a partir de:", o: ["Asparagina", "Lisina", "Glicina", "Alanina", "Metionina"], c: 3 },
            { id: 13, q: "13. Se√±alar cu√°l es el transportador de glucosa en el m√∫sculo:", o: ["GLUT 1", "GLUT 2", "GLUT 4", "GLUT 3", "GLUT 5"], c: 2 },
            { id: 14, q: "14. Se√±ale el t√©rmino que define baja concentraci√≥n de glucosa en sangre:", o: ["Hipoinsulinemia", "Hiperglucemia", "Normoglucemia", "Isoglucemia", "Hipoglucemia"], c: 4 },
            { id: 16, q: "16. La apoprote√≠na m√°s caracter√≠stica de los quilomicrones:", o: ["B30", "B90", "B100", "B39", "B48"], c: 4 },
            { id: 17, q: "17. Respecto a la Œ≥-glutamiltranspeptidasa, se√±ale la respuesta correcta:", o: ["Cataliza la transformaci√≥n del Œ≥-glutamil del glutati√≥n a un amino√°cido neutro", "Es una enzima citos√≥lica", "Cataliza la transferencia de la glicina del glutati√≥n a un amino√°cido", "Cataliza la transferencia de la ciste√≠na del glutati√≥n a un amino√°cido", "Los principales receptores amino√°cidos aceptores son √°cidos"], c: 0 },
            { id: 18, q: "18. En relaci√≥n con la fase pancre√°tica de la digesti√≥n de prote√≠nas:", o: ["Los oligop√©ptidos procedentes de la fase g√°strica activan a la enteropeptidasa", "La enteropeptidasa activa la liberaci√≥n de colecistoquinina (CCK)", "Los oligop√©ptidos activan a las c√©lulas endocrinas del duodeno liber√°ndose colecistoquinina (CCK)", "Los zim√≥genos pancre√°ticos se activan en el p√°ncreas", "El jugo pancre√°tico tiene pH √°cido"], c: 2 },
            { id: 19, q: "19. ¬øCu√°l de las siguientes organoquinas no es una adipoquina proinflamatoria?:", o: ["TNF Œ±", "Visfatina", "Adiponectina", "Leptina", "Resistina"], c: 2 },
            { id: 20, q: "20. Indique cu√°l es la v√≠a de se√±alizaci√≥n caracter√≠stica de la leptina:", o: ["Activaci√≥n de prote√≠na kinasa A", "Activaci√≥n de la fosfolipasa C", "V√≠a de se√±alizaci√≥n JAK2/STAT3", "V√≠a de se√±alizaci√≥n del receptor acoplado a prote√≠na G", "Se inicia con la uni√≥n al receptor AdipoR1"], c: 2 },
            { id: 21, q: "21. Se√±ale qu√© dos inmunoglobulinas son las responsables de la inmunidad fetal y del reci√©n nacido:", o: ["IgM e IgA", "IgD e IgA", "IgM e IgG", "IgA e IgE", "IgG e IgA"], c: 4 },
            { id: 22, q: "22. Respecto a la IgG se√±ale la respuesta incorrecta:", o: ["Es la m√°s abundante en el suero", "Es la Ig m√°s abundante en la respuesta secundaria", "Se presenta en forma pentam√©rica", "Puede atravesar la barrera placentaria", "Neutraliza y opsoniza toxinas"], c: 2 },
            { id: 23, q: "23. Respecto a los MHC se√±ale la respuesta incorrecta:", o: ["Presentan en la superficie peque√±os p√©ptidos reconocidos por linfocitos T", "Los MHC I s√≥lo aparecen en la superficie de las c√©lulas presentadoras de ant√≠genos", "Cadenas de MHC II ancladas por dominios Œ±2 y Œ≤2", "MHC II es reconocida por CD4 de linfocitos TH", "MHC I formada por cadena Œ± y Œ≤2-microglobulina"], c: 1 },
            { id: 24, q: "24. El receptor para el factor de crecimiento similar a la insulina (IGF-1) se caracteriza por:", o: ["Presentar dominios tiros√≠n-kinasa", "Estar acoplado a prote√≠na G", "Corresponderse con un receptor nuclear", "Activar a la enzima prote√≠na kinasa A", "Activar la salida de calcio"], c: 0 },
            { id: 25, q: "25. La principal forma circulante de la prolactina es la forma:", o: ["Monom√©rica", "Dim√©rica", "Trim√©rica", "Macroprolactina", "Asociada a alb√∫mina"], c: 0 },
            { id: 26, q: "26. Mecanismo de se√±alizaci√≥n intracelular de la hormona somatocrinina (GHRH):", o: ["Sistema adenilato ciclasa y calmodulina", "Sistema JAK/STAT quinasas", "Se realiza mediante la uni√≥n a receptores nucleares", "Sistema tiros√≠n quinasas", "Est√° acoplado a prote√≠na G y activaci√≥n de prote√≠na kinasa A"], c: 4 },
            { id: 27, q: "27. ¬øDe qu√© tipo de hormonas es caracter√≠stica la formaci√≥n del complejo hormona-receptor a nivel nuclear?:", o: ["Glucag√≥n", "Somatostatina", "Hormonas esteroideas", "Adrenalina", "Insulina"], c: 2 },
            { id: 28, q: "28. La enzima aldosterona sintasa est√° constituida por:", o: ["18Œ≤-hidroxiesteroide deshidrogenasa y 18Œ≤-hidroxilasa", "18 hidroxilasa y 18 oxidasa", "11Œ≤-hidroxilasa y 18 desmolasa", "17,20 desmolasa y 17,21 liasa", "17Œ±-hidroxilasa y 17 oxidasa"], c: 1 },
            { id: 29, q: "29. ¬øQu√© enzima cataliza el paso de androstenediona a testosterona?:", o: ["Aromatasa", "Sulfotransferasa 2A1", "11Œ≤ hidroxilasa", "17Œ± hidroxilasa", "17Œ≤ hidroxiesteroide deshidrogenasa"], c: 4 },
            { id: 30, q: "30. El amino√°cido precursor para la s√≠ntesis de tirosina es la fenilalanina. ¬øQu√© enzima cataliza este paso?:", o: ["Fenilalanina hidroxilasa", "Fenilalanina descarboxilasa", "Dihidrobiopterina reductasa", "Tirosinasa", "Tetrahidrobiopterina reductasa"], c: 0 },
            { id: 31, q: "31. Si encontrara en una anal√≠tica niveles elevados de TSH, ¬øqu√© podr√≠a esperar respecto a los niveles de hormonas tiroideas?", o: ["La TSH corresponde al eje gonadal", "La TSH no es un buen marcador", "Regular√≠a los niveles de TRH y no de tiroideas", "Que estuvieran bajas", "Que estuvieran altas"], c: 3 },
            { id: 32, q: "32. Se√±ale la respuesta correcta en relaci√≥n a la forma activa de las hormonas tiroideas:", o: ["3,5,3‚Äô triiodotironina", "3,5,5‚Äô triiodotironina", "3,5,3‚Äô,5‚Äô tetraiodotironina", "3,5 diiodotironina", "3,3‚Äô,5‚Äô triiodotironina"], c: 0 },
            { id: 33, q: "33. ¬øPor qu√© la glucosa es la se√±al para que se sintetice insulina?:", o: ["Incremento metabolismo y elevaci√≥n cociente ADP/ATP", "Disminuci√≥n metabolismo y elevaci√≥n ATP/ADP", "Incremento metabolismo y elevaci√≥n cociente ATP/ADP", "Incremento metabolismo y elevaci√≥n ADP/O", "Reducci√≥n metabolismo y elevaci√≥n ATP/O"], c: 2 },
            { id: 34, q: "34. Se√±ale la respuesta correcta respecto a la cascada de se√±alizaci√≥n intracelular activada por insulina:", o: ["Se activa la prote√≠na fosfatasa 1 que est√° desfosforilada", "Se inhibe la prote√≠na fosfatasa 1 que est√° fosforilada", "Se activa la adenilato ciclasa que est√° fosforilada", "Se activa la adenilato ciclasa que est√° sin fosforilar", "Se activa la prote√≠na fosfatasa 1 que est√° fosforilada"], c: 0 },
            { id: 35, q: "35. Se√±ale la respuesta correcta sobre los oncogenes:", o: ["Favorecen el bloqueo del ciclo celular", "Favorecen la diferenciaci√≥n celular", "Favorecen la apoptosis", "Estimulan la proliferaci√≥n celular", "Codifican p53"], c: 3 },
            { id: 36, q: "36. Respecto a los factores de crecimiento, se√±ale la respuesta correcta:", o: ["Son se√±ales para la apoptosis", "No se unen a receptores espec√≠ficos", "Act√∫an uni√©ndose a receptores con dominios alanina-quinasa", "Su uni√≥n produce un descenso del calcio intracelular", "Son se√±ales para el crecimiento y la divisi√≥n celular"], c: 4 },
            { id: 37, q: "37. Respecto al 11-cis-retinal de la rodopsina, se√±alar la respuesta incorrecta:", o: ["Deriva de la vitamina D", "Deriva de la vitamina A", "Procede de la dieta y de la degradaci√≥n de la rodopsina", "Se transforma en todo-trans-retinal por fotones", "Se transforma en vitamina B por fotones"], c: 4 },
            { id: 38, q: "38. En la cascada de fotorrecepci√≥n, se√±ale la respuesta correcta:", o: ["Se cierran los canales de sodio del fotorreceptor", "La rodopsina cambia su configuraci√≥n a metarrodopsina III", "El 11-cis-retinal no sufre cambios", "Se incrementa la concentraci√≥n de AMPc", "Se abren los canales de sodio"], c: 0 },
            { id: 39, q: "39. En la s√≠ntesis de catecolaminas, la enzima que cataliza el paso de L-DOPA a dopamina es:", o: ["Tirosina descarboxilasa", "Dopamina Œ≤-hidroxilasa", "L-DOPA sintetasa", "DOPA descarboxilasa", "Dopamina sintetasa"], c: 3 },
            { id: 40, q: "40. En la s√≠ntesis de catecolaminas, la enzima que cataliza el paso de tirosina a L-DOPA es:", o: ["Tirosina descarboxilasa", "Tirosina hidroxilasa", "L-DOPA sintetasa", "L-DOPA descarboxilasa", "Tirosina N-metil transferasa"], c: 1 },
            { id: 41, q: "41. En la s√≠ntesis de catecolaminas, la enzima que cataliza el paso de noradrenalina a adrenalina es:", o: ["Fenilalanina hidroxilasa", "Adrenalina sintetasa", "Noradrenalina descarboxilasa", "Feniletanolamina-N-metiltransferasa", "Dopamina Œ≤-hidroxilasa"], c: 3 },
            { id: 42, q: "42. ¬øQu√© enzima de s√≠ntesis de aminas bi√≥genas tiene como coenzima a la tetrahidrobiopterina (THB)?:", o: ["5-hidroxitript√≥fano descarboxilasa", "Histidina descarboxilasa", "Tript√≥fano hidroxilasa", "Feniletanolamina-N-metiltransferasa", "Dopamina Œ≤-hidroxilasa"], c: 2 },
            { id: 43, q: "43. De los siguientes compuestos se√±ale cu√°l es el producto de la degradaci√≥n de la serotonina:", o: ["Melatonina", "√Åcido 5-hidroxiindolac√©tico", "√Åcido N-metilimidazolac√©tico", "√Åcido homovan√≠lico", "3-Metoxi-4-hidroxifenilglicol (MOPEG)"], c: 1 },
            { id: 44, q: "44. Se√±ale la enzima que participa en la degradaci√≥n de GABA:", o: ["GABA hidroxilasa", "GABA Œ±-cetoglutarato transaminasa", "GABA oxidasa", "GABA-succinato transaminasa", "GABA-deshidrogenasa"], c: 1 },
            { id: 45, q: "45. Respecto a la alb√∫mina, se√±ale la respuesta correcta:", o: ["Mantiene la presi√≥n onc√≥tica", "Es la prote√≠na plasm√°tica con menor concentraci√≥n", "Su concentraci√≥n no depende del estado nutricional", "Transporta exclusivamente vitamina A", "No transporta f√°rmacos"], c: 0 },
            { id: 46, q: "46. De las prote√≠nas plasm√°ticas implicadas en el metabolismo del hierro, se√±alar la respuesta correcta:", o: ["Ferritina act√∫a como transportador del ion f√©rrico", "Transferrina act√∫a como reserva de ion ferroso", "Haptoglobina fija grupos hemo procedentes de la hem√≥lisis", "Hemopexina une grupos hemo cuando se satura la haptoglobina", "Ceruloplasmina transporta cobre"], c: 4 },
            { id: 47, q: "47. Indique qu√© enzima cataliza el proceso de s√≠ntesis de uroporfirin√≥geno III:", o: ["Uroporfirin√≥geno quelatasa", "Protoporfirin√≥geno oxidasa", "Uroporfirin√≥geno descarboxilasa", "Porfobilin√≥geno desaminasa", "Coproporfirin√≥geno oxidasa"], c: 3 },
            { id: 48, q: "48. ¬øCu√°l es la secuencia de cadenas laterales del compuesto coproporfirin√≥geno III?:", o: ["M, V, M, V, M, P, P, M", "M, P, M, P, V, P, P, V", "M, P, M, P, M, P, P, M", "A, P, A, P, M, P, P, M", "M, P, V, P, M, P, P, M"], c: 2 },
            { id: 49, q: "49. En el paso de s√≠ntesis de protoporfirin√≥geno IX se produce una p√©rdida de 2 carbonos. Indique la respuesta correcta:", o: ["Se produce a nivel de 2 restos propi√≥nicos de los anillos I y II", "Se produce a nivel de 2 restos acetatos de los anillos I y II", "Se produce a nivel de 2 restos propi√≥nicos de los anillos III y IV", "Se produce a nivel de 2 restos metilos de los anillos I y II", "Se produce a nivel de 2 restos vinilos de los anillos III y IV"], c: 0 },
            { id: 50, q: "50. El efecto Bohr se caracteriza por:", o: ["Competir con el 2,3 BPG", "Competici√≥n del CO‚ÇÇ por la fijaci√≥n del ox√≠geno", "Facilitar la liberaci√≥n de ox√≠geno a pH √°cido", "Facilitar la liberaci√≥n de ox√≠geno a pH alcalino", "Facilitar la captaci√≥n de ox√≠geno a pH √°cido"], c: 2 },
            { id: 51, q: "51. Se√±ale la respuesta correcta respecto a la oxihemoglobina:", o: ["Se identifica como estado T", "Se identifica como estado R", "Se identifica como estado Oxi", "Se identifica como estado Hemo"], c: 1 },
            { id: 52, q: "52. Se√±ale la respuesta incorrecta relacionada con la prostaciclina:", o: ["Es un potente vasoconstrictor", "Inhibe la agregaci√≥n plaquetaria", "Es un potente vasodilatador", "Se forma a partir del √°cido araquid√≥nico", "Favorece el efecto antitromb√≥tico"], c: 0 },
            { id: 53, q: "53. En el sistema extr√≠nseco de la coagulaci√≥n, el factor VII requiere como activador al factor:", o: ["III (Tisular)", "IV", "V", "VI", "VIII"], c: 0 },
            { id: 54, q: "54. ¬øCu√°l es la secuencia correcta de la cascada de la coagulaci√≥n en relaci√≥n a la v√≠a intr√≠nseca?:", o: ["VII ‚Üí X ‚Üí IX ‚Üí XI", "VII ‚Üí XI ‚Üí X ‚Üí XII", "XII ‚Üí XI ‚Üí IX ‚Üí X", "VII ‚Üí XI ‚Üí IX ‚Üí X", "XII ‚Üí XIII ‚Üí IX ‚Üí X"], c: 2 },
            { id: 55, q: "55. Indique la respuesta incorrecta sobre los antioxidantes:", o: ["Un antioxidante protege a otras mol√©culas de la oxidaci√≥n", "Glutati√≥n reductasa usa NADPH", "La SOD tipo (Cu/Zn-SOD) se encuentra en las mitocondrias", "Los antioxidantes enzim√°ticos son SOD, catalasa y GPx", "Vitamina C esencial en recuperaci√≥n de Vitamina E"], c: 2 },
            { id: 56, q: "56. Se√±ale el principal antioxidante ex√≥geno protector frente a la lipoperoxidaci√≥n:", o: ["Vitamina A", "Carotenoides", "Vitamina C", "Vitamina E", "Flavonoides"], c: 3 },
            { id: 57, q: "57. Respecto a la formaci√≥n de las especies reactivas del ox√≠geno y del nitr√≥geno se√±ale la respuesta correcta:", o: ["Uni√≥n O‚ÇÇ‚Ä¢‚Åª y NO produce peroxinitrito (ONOO‚Åª)", "Radical hidroxilo (HO‚Ä¢) se forma a partir del H‚ÇÇO‚ÇÇ", "O‚ÇÇ‚Ä¢‚Åª y NO provienen del O‚ÇÇ", "Ruptura de ONOO‚Åª produce HO‚Ä¢ y NO‚ÇÇ", "Todas son ciertas"], c: 4 },
            { id: 58, q: "58. Con respecto a la zonaci√≥n hep√°tica, se√±alar la respuesta correcta:", o: ["Se produce por el diferente aporte de ox√≠geno y nutrientes", "Captaci√≥n de glucosa predomina en zona perivenosa", "Cetog√©nesis predomina en zona periportal", "Oxidaci√≥n de √°cidos grasos predomina en zona perivenosa", "Biotransformaci√≥n de xenobi√≥ticos predomina en zona periportal"], c: 0 },
            { id: 59, q: "59. En la biotransformaci√≥n del √°cido acetilsalic√≠lico:", o: ["No se produce incremento de polaridad", "Se elimina por sulfataci√≥n", "No se biotransforma en el h√≠gado", "No necesita conjugaci√≥n", "Se conjuga con √°cido glucur√≥nico"], c: 4 },
            { id: 60, q: "60. En relaci√≥n con la familia del citocromo p450, se√±ale la respuesta correcta:", o: ["Son hemoprote√≠nas de alta especificidad", "El √°tomo de hierro est√° en estado ferroso constante", "Disminuyen la polaridad de f√°rmacos", "Se colocalizan con NADPH citocromo p450 reductasa", "Se colocalizan con NADPH citocromo p450 oxidasa"], c: 3 },
            { id: 61, q: "61. En la s√≠ntesis de col√°geno la coenzima de las hidroxilasas es:", o: ["Vitamina B", "Vitamina C", "Vitamina D", "Vitamina A", "Vitamina E"], c: 1 },
            { id: 62, q: "62. Respecto a la s√≠ntesis de col√°geno, indique la respuesta correcta:", o: ["1 de cada 4 amino√°cidos es glicina", "Vitamina C es cofactor de lisil oxidasa", "Enlaces entrecruzamiento entre residuos de prolina", "Formaci√≥n de fibras en ret√≠culo endoplasm√°tico", "O-glucosidaciones por galactosil/glucosil transferasas"], c: 4 },
            { id: 63, q: "63. ¬øCu√°l es el rango de normalidad de los niveles plasm√°ticos de potasio?", o: ["3,4‚Äì4,9 mmol/L", "135‚Äì145 mmol/L", "95‚Äì105 mmol/L", "21‚Äì28 mmol/L", "34‚Äì49 mmol/L"], c: 0 },
            { id: 64, q: "64. ¬øEn qu√© parte de la nefrona se produce la mayor secreci√≥n de potasio?", o: ["Asa descendente de Henle", "Asa ascendente de Henle", "T√∫bulo colector", "T√∫bulo contorneado distal", "T√∫bulo contorneado proximal"], c: 3 },
            { id: 65, q: "65. En el ciclo de remodelaci√≥n del hueso:", o: ["Resorci√≥n mayor que formaci√≥n", "No hay remodelaci√≥n", "Formaci√≥n mayor que resorci√≥n", "La resorci√≥n √≥sea es producida por los osteoclastos", "La formaci√≥n es producida por los osteoclastos"], c: 3 },
            { id: 66, q: "66. En el mantenimiento de las concentraciones de calcio:", o: ["PTH favorece formaci√≥n √≥sea", "Calcitonina se libera cuando disminuye calcio", "PTH inhibe absorci√≥n renal", "La calcitonina inhibe la resorci√≥n √≥sea", "PTH se libera cuando aumenta calcio"], c: 3 },
            { id: 67, q: "67. Indique cu√°l de las siguientes respuestas es verdadera respecto a la composici√≥n proteica del filamento grueso:", o: ["Con papa√≠na se obtiene meromiosina ligera y pesada", "Con tripsina se obtienen dos unidades de meromiosina pesada", "Con papa√≠na se obtienen dos unidades de meromiosina ligera", "Recibe el nombre de actiomiosina", "Tras la digesti√≥n con tripsina se obtiene meromiosina ligera y meromiosina pesada"], c: 4 },
            { id: 68, q: "68. Un ejercicio f√≠sico de alta intensidad y corta duraci√≥n se caracteriza por:", o: ["Consumir r√°pidamente los dep√≥sitos de gluc√≥geno muscular", "Consumir lenta y progresiva dep√≥sitos de gluc√≥geno", "Favorecer entrada triglic√©ridos", "Favorecer entrada alanina", "M√∫sculo es insulinoindependiente"], c: 0 },
            { id: 69, q: "69. Hora y media de ejercicio: citrato inhibe a qu√© enzima:", o: ["Fructosa 2,6 bifosfatasa", "Piruvato quinasa", "Fosfofructoquinasa 1", "Fructosa 1,6 bifosfatasa", "Fosfofructoquinasa 2"], c: 2 },
            { id: 70, q: "70. Durante el ejercicio f√≠sico y metabolismo de glucosa (Cierta):", o: ["Favorece almacenamiento glucosa", "Favorece almacenamiento √°cidos grasos", "Aumenta expresi√≥n GLUT-2", "Aumenta cifra insulinemia", "Aumenta la expresi√≥n de los transportadores GLUT-4"], c: 4 }
        ];

        let currentQuestions = [];
        let userState = {};
        let timerInterval;
        let seconds = 0;

        function initQuiz() {
            document.getElementById('start-screen').style.display = 'none';
            const shuffleQ = document.getElementById('shuffle-questions').checked;
            const useTimer = document.getElementById('timer-check').checked;

            // Clonar base de datos
            currentQuestions = JSON.parse(JSON.stringify(fullDB));

            if (shuffleQ) {
                currentQuestions.sort(() => Math.random() - 0.5);
            }

            userState = {};
            renderSidebar();
            renderQuestions();

            if (useTimer) {
                document.getElementById('timer').style.display = 'block';
                timerInterval = setInterval(() => {
                    seconds++;
                    let m = Math.floor(seconds / 60).toString().padStart(2, '0');
                    let s = (seconds % 60).toString().padStart(2, '0');
                    document.getElementById('timer').innerText = `${m}:${s}`;
                }, 1000);
            }
        }

        function renderSidebar() {
            const grid = document.getElementById('nav-grid');
            grid.innerHTML = '';
            
            currentQuestions.forEach((q, index) => {
                const btn = document.createElement('button');
                btn.className = 'nav-btn';
                btn.innerText = index + 1;
                btn.onclick = () => scrollToQ(index);
                btn.id = `nav-${index}`;
                grid.appendChild(btn);
            });
            updateProgress();
        }

        function renderQuestions() {
            const container = document.getElementById('questions-wrapper');
            container.innerHTML = '';

            currentQuestions.forEach((q, index) => {
                const card = document.createElement('div');
                card.className = 'q-card';
                card.id = `card-${index}`;

                card.innerHTML = `
                    <div class="q-meta">
                        <span>Pregunta ${index + 1}</span>
                        <span>#${q.id}</span>
                    </div>
                    <div class="q-text">${q.q}</div>
                `;

                // Mezclar opciones SIEMPRE
                let options = q.o.map((text, i) => ({ text, originalIndex: i }));
                options.sort(() => Math.random() - 0.5);

                const optContainer = document.createElement('div');
                
                options.forEach(opt => {
                    const btn = document.createElement('button');
                    btn.className = 'opt-btn';
                    btn.innerText = opt.text;
                    btn.onclick = () => handleAnswer(index, opt.originalIndex, btn, options, q.c);
                    optContainer.appendChild(btn);
                });
                card.appendChild(optContainer);

                // Feedback
                const fb = document.createElement('div');
                fb.className = 'feedback';
                fb.id = `fb-${index}`;
                fb.innerHTML = `<strong>Respuesta Correcta:</strong> ${q.o[q.c]}`;
                card.appendChild(fb);

                // Tools
                const tools = document.createElement('div');
                tools.className = 'tools';
                tools.innerHTML = `
                    <label class="mark-label">
                        <input type="checkbox" onchange="toggleMark(${index}, this.checked)">
                        Marcar para revisar
                    </label>
                `;
                card.appendChild(tools);

                container.appendChild(card);
            });
        }

        function handleAnswer(qIndex, selectedOriginalIndex, btnElement, shuffledOptions, correctIndex) {
            if (userState[qIndex] && userState[qIndex].answered) return;

            const isCorrect = selectedOriginalIndex === correctIndex;
            if (!userState[qIndex]) userState[qIndex] = {};
            userState[qIndex].answered = true;
            userState[qIndex].correct = isCorrect;

            if (isCorrect) {
                btnElement.classList.add('correct');
            } else {
                btnElement.classList.add('wrong');
                // Buscar correcta visualmente
                const siblings = btnElement.parentElement.children;
                for (let sib of siblings) {
                    if (sib.innerText === fullDB.find(x => x.id === currentQuestions[qIndex].id).o[correctIndex]) {
                        sib.classList.add('correct');
                    }
                }
            }

            const siblings = btnElement.parentElement.children;
            for (let sib of siblings) sib.disabled = true;

            document.getElementById(`fb-${qIndex}`).style.display = 'block';
            
            const navBtn = document.getElementById(`nav-${qIndex}`);
            navBtn.classList.add(isCorrect ? 'correct' : 'wrong');
            
            updateProgress();
        }

        function toggleMark(qIndex, isChecked) {
            if (!userState[qIndex]) userState[qIndex] = {};
            userState[qIndex].marked = isChecked;
            const navBtn = document.getElementById(`nav-${qIndex}`);
            if (isChecked) navBtn.classList.add('marked');
            else navBtn.classList.remove('marked');
        }

        function scrollToQ(index) {
            document.getElementById(`card-${index}`).scrollIntoView({ behavior: 'smooth', block: 'center' });
            document.querySelectorAll('.q-card').forEach(c => c.classList.remove('current'));
            document.getElementById(`card-${index}`).classList.add('current');
            
            document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
            document.getElementById(`nav-${index}`).classList.add('active');
        }

        function updateProgress() {
            const answeredCount = Object.values(userState).filter(s => s.answered).length;
            document.getElementById('prog-text').innerText = `${answeredCount} / ${currentQuestions.length}`;
        }

        function finish() {
            clearInterval(timerInterval);
            let correct = 0, wrong = 0, marked = 0;
            
            currentQuestions.forEach((q, i) => {
                const s = userState[i];
                if (s) {
                    if (s.answered) {
                        if (s.correct) correct++; else wrong++;
                    }
                    if (s.marked) marked++;
                }
            });

            const score = Math.round((correct / currentQuestions.length) * 100);
            document.getElementById('score').innerText = score + "%";
            document.getElementById('r-ok').innerText = correct;
            document.getElementById('r-ko').innerText = wrong;
            document.getElementById('r-mk').innerText = marked;
            document.getElementById('result-screen').style.display = 'flex';
        }

        function retry(mode) {
            let nextQuestions = [];

            if (mode === 'all') {
                nextQuestions = JSON.parse(JSON.stringify(fullDB));
            } else {
                nextQuestions = currentQuestions.filter((q, i) => {
                    const s = userState[i];
                    if (!s) return false;
                    if (mode === 'failed') return s.answered && !s.correct;
                    if (mode === 'marked') return s.marked;
                    if (mode === 'failed_marked') return (s.answered && !s.correct) || s.marked;
                    return false;
                });
            }

            if (nextQuestions.length === 0) {
                alert("No hay preguntas para esta selecci√≥n.");
                return;
            }

            currentQuestions = nextQuestions;
            userState = {};
            seconds = 0;
            document.getElementById('timer').innerText = "00:00";
            document.getElementById('result-screen').style.display = 'none';
            document.getElementById('start-screen').style.display = 'none';
            
            renderSidebar();
            renderQuestions();
            if (document.getElementById('timer-check').checked) {
                timerInterval = setInterval(() => {
                    seconds++;
                    let m = Math.floor(seconds / 60).toString().padStart(2, '0');
                    let s = (seconds % 60).toString().padStart(2, '0');
                    document.getElementById('timer').innerText = `${m}:${s}`;
                }, 1000);
            }
        }
    </script>
</body>
</html>