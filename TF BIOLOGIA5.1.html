<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Examen Bloque 5 - Membranas y Citoesqueleto (Medicina C√°diz)</title>
    <style>
        :root {
            --primary-color: #0056b3; /* Azul Medicina */
            --secondary-color: #f0f8ff;
            --correct-color: #d4edda;
            --correct-text: #155724;
            --incorrect-color: #f8d7da;
            --incorrect-text: #721c24;
            --mark-bg: #fff3cd;
            --mark-text: #856404;
        }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background-color: #f4f4f9;
            color: #333;
        }
        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            min-height: 500px;
        }
        header {
            text-align: center;
            border-bottom: 2px solid var(--primary-color);
            margin-bottom: 20px;
            padding-bottom: 10px;
        }
        h1 {
            color: var(--primary-color);
            margin: 0;
            font-size: 1.8rem;
        }
        .professors {
            font-style: italic;
            color: #666;
            margin-top: 5px;
        }
        .stats-bar {
            display: flex;
            justify-content: space-between;
            background: var(--secondary-color);
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            font-weight: bold;
            border: 1px solid #cce5ff;
            position: sticky;
            top: 0;
            z-index: 100;
        }
        .question-card {
            display: none;
            animation: fadeIn 0.5s;
            position: relative; /* Para posicionar la marca */
        }
        .question-card.active {
            display: block;
        }
        
        /* Estilos para la pesta√±a de Marcar */
        .bookmark-panel {
            position: absolute;
            top: -10px;
            right: 0;
            background: var(--mark-bg);
            color: var(--mark-text);
            padding: 5px 15px;
            border-radius: 20px;
            border: 1px solid #ffeeba;
            font-size: 0.9rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            transition: transform 0.2s;
            z-index: 10;
        }
        .bookmark-panel:hover {
            transform: scale(1.05);
            background-color: #ffe8a1;
        }
        .bookmark-checkbox {
            margin-right: 8px;
            transform: scale(1.3);
            cursor: pointer;
        }

        .question-text {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 20px;
            padding-top: 25px; /* Espacio para la marca */
            padding-right: 140px; /* Espacio lateral para la marca */
        }
        .options-grid {
            display: grid;
            gap: 10px;
        }
        .option-btn {
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            background: white;
            cursor: pointer;
            text-align: left;
            font-size: 1rem;
            transition: all 0.2s;
            width: 100%;
        }
        .option-btn:hover:not(:disabled) {
            background-color: #f8f9fa;
            border-color: var(--primary-color);
        }
        .option-btn:disabled {
            cursor: default;
            opacity: 0.7;
        }
        .option-btn.correct {
            background-color: var(--correct-color);
            border-color: var(--correct-text);
            color: var(--correct-text);
        }
        .option-btn.incorrect {
            background-color: var(--incorrect-color);
            border-color: var(--incorrect-text);
            color: var(--incorrect-text);
        }
        .feedback {
            margin-top: 20px;
            padding: 15px;
            border-radius: 8px;
            display: none;
        }
        .feedback.show {
            display: block;
        }
        .feedback-correct {
            background-color: var(--correct-color);
            color: var(--correct-text);
            border-left: 5px solid var(--correct-text);
        }
        .feedback-incorrect {
            background-color: var(--incorrect-color);
            color: var(--incorrect-text);
            border-left: 5px solid var(--incorrect-text);
        }
        .navigation {
            margin-top: 20px;
            display: flex;
            justify-content: flex-end;
        }
        .nav-btn {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 10px 25px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1rem;
            display: none;
        }
        .nav-btn:hover {
            background-color: #004494;
        }
        
        .results-summary {
            text-align: center;
            display: none;
            padding: 20px;
        }
        
        /* Grid de botones finales */
        .action-buttons-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-top: 30px;
        }
        .action-btn {
            padding: 15px;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            color: white;
            transition: transform 0.2s;
        }
        .action-btn:hover { transform: translateY(-3px); }
        .action-btn:disabled { background-color: #ccc !important; cursor: not-allowed; transform: none; }
        
        .btn-restart { background-color: var(--primary-color); grid-column: span 2; }
        .btn-failed { background-color: #dc3545; }
        .btn-marked { background-color: #ffc107; color: #333; }
        .btn-mixed { background-color: #6f42c1; grid-column: span 2; }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        .topic-tag {
            display: inline-block;
            background: #e9ecef;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 0.8rem;
            color: #495057;
            margin-bottom: 10px;
        }
    </style>
</head>
<body>

<div class="container">
    <header>
        <h1>Examen Bloque 5: Membranas y Citoesqueleto</h1>
        <div class="professors">Profesoras: Meritxell Llorca Torralba y Ana Mu√±oz-Manchado</div>
    </header>

    <div class="stats-bar" id="statsBar">
        <div id="progress">Cargando...</div>
        <div id="score">Aciertos sesi√≥n: 0</div>
    </div>

    <div id="quiz-area"></div>

    <div id="results" class="results-summary">
        <h2>Sesi√≥n Finalizada</h2>
        <div style="font-size: 3rem; font-weight: bold; color: var(--primary-color);" id="final-score"></div>
        <p id="final-percent"></p>
        
        <div id="stats-summary" style="margin: 20px 0; color: #555;"></div>

        <div class="action-buttons-grid">
            <button class="action-btn btn-restart" onclick="startQuiz('all')">üîÑ Reiniciar Test Completo (Borrar todo)</button>
            <button class="action-btn btn-failed" id="btn-failed" onclick="startQuiz('failed')">‚ùå Repetir Falladas</button>
            <button class="action-btn btn-marked" id="btn-marked" onclick="startQuiz('marked')">‚ö†Ô∏è Repetir Marcadas</button>
            <button class="action-btn btn-mixed" id="btn-mixed" onclick="startQuiz('mixed')">‚ùå + ‚ö†Ô∏è Repetir Falladas y Marcadas</button>
        </div>
    </div>
</div>

<script>
// Base de datos de preguntas
const questions = [
    // --- MEMBRANAS CELULARES (1-15) ---
    {
        topic: "Estructura de Membrana",
        question: "¬øQu√© propiedad fundamental de los fosfol√≠pidos impulsa su autoensamblaje en bicapa?",
        options: ["Su naturaleza hidrof√≥bica pura.", "Su naturaleza anfip√°tica (cabeza hidr√≥fila y colas hidr√≥fobas).", "Su carga el√©ctrica positiva.", "Su capacidad de formar enlaces covalentes entre s√≠."],
        correct: 1,
        explanation: "La dualidad anfip√°tica hace que las colas se escondan del agua y las cabezas se expongan, formando la bicapa espont√°neamente."
    },
    {
        topic: "L√≠pidos de Membrana",
        question: "¬øCu√°l es uno de los fosfol√≠pidos m√°s comunes en las membranas celulares?",
        options: ["Colesterol.", "Glucol√≠pido.", "Fosfatidilcolina.", "Triglic√©rido."],
        correct: 2,
        explanation: "La fosfatidilcolina es citada textualmente como uno de los componentes m√°s abundantes."
    },
    {
        topic: "Fluidez de Membrana",
        question: "¬øQu√© efecto tienen las colas de √°cidos grasos insaturados (con dobles enlaces) en la membrana?",
        options: ["Aumentan la rigidez.", "Aumentan la fluidez al crear 'codos' que dificultan el empaquetamiento.", "Disminuyen la permeabilidad.", "No tienen efecto."],
        correct: 1,
        explanation: "Los dobles enlaces crean quiebres o 'codos' que impiden que los l√≠pidos se empaqueten densamente, aumentando la fluidez."
    },
    {
        topic: "Fluidez de Membrana",
        question: "¬øC√≥mo act√∫a el colesterol en las membranas de c√©lulas animales?",
        options: ["Aumenta la permeabilidad a iones.", "Act√∫a como canal i√≥nico.", "Endurece la membrana y la hace menos permeable.", "Cataliza reacciones qu√≠micas."],
        correct: 2,
        explanation: "El colesterol rellena los huecos entre fosfol√≠pidos, reduciendo la movilidad y aumentando la rigidez/impermeabilidad."
    },
    {
        topic: "Asimetr√≠a de Membrana",
        question: "¬øD√≥nde se encuentran exclusivamente los glucol√≠pidos en la membrana plasm√°tica?",
        options: ["En la monocapa citos√≥lica.", "En la monocapa no citos√≥lica (externa).", "En ambas capas por igual.", "En el interior hidrof√≥bico."],
        correct: 1,
        explanation: "Se ubican en la cara externa para formar parte del glucoc√°liz y participar en el reconocimiento celular."
    },
    {
        topic: "Prote√≠nas de Membrana",
        question: "¬øQu√© porcentaje aproximado de la masa total de la membrana plasm√°tica constituyen las prote√≠nas?",
        options: ["10%", "25%", "50%", "90%"],
        correct: 2,
        explanation: "Aunque son menos numerosas que los l√≠pidos, por su tama√±o constituyen cerca del 50% de la masa."
    },
    {
        topic: "Prote√≠nas de Membrana",
        question: "¬øC√≥mo se denominan las prote√≠nas que atraviesan la bicapa lip√≠dica por completo?",
        options: ["Prote√≠nas perif√©ricas.", "Prote√≠nas transmembrana.", "Prote√≠nas ancladas a l√≠pidos.", "Prote√≠nas citos√≥licas."],
        correct: 1,
        explanation: "Atraviesan la membrana, a menudo en forma de h√©lice alfa."
    },
    {
        topic: "Estructura Celular",
        question: "¬øQu√© estructura rica en actina se encuentra justo debajo de la membrana plasm√°tica?",
        options: ["La l√°mina nuclear.", "El glucoc√°liz.", "La corteza celular.", "El centrosoma."],
        correct: 2,
        explanation: "La corteza celular refuerza la membrana y determina la forma de la c√©lula."
    },
    {
        topic: "Superficie Celular",
        question: "¬øCu√°l es la funci√≥n del glucoc√°liz (capa de carbohidratos)?",
        options: ["Transporte de electrones.", "S√≠ntesis de ATP.", "Protecci√≥n mec√°nica, lubricaci√≥n y reconocimiento celular.", "Contracci√≥n muscular."],
        correct: 2,
        explanation: "Protege la superficie, la mantiene h√∫meda/lubricada y permite la identificaci√≥n entre c√©lulas."
    },
    {
        topic: "S√≠ntesis de Membrana",
        question: "¬øD√≥nde comienza el proceso de ensamblaje de nuevas membranas?",
        options: ["En el Aparato de Golgi.", "En el Ret√≠culo Endoplasm√°tico (RE).", "En la mitocondria.", "En el n√∫cleo."],
        correct: 1,
        explanation: "La s√≠ntesis de l√≠pidos y el ensamblaje inicial ocurren en el RE."
    },
    {
        topic: "Fluidez",
        question: "¬øQu√© tipo de movimiento ocurre raramente de forma espont√°nea en los fosfol√≠pidos (sin enzimas)?",
        options: ["Difusi√≥n lateral.", "Rotaci√≥n.", "Flexi√≥n de colas.", "Flip-flop (cambio de una monocapa a otra)."],
        correct: 3,
        explanation: "El paso de la cabeza polar a trav√©s del centro hidrof√≥bico es energ√©ticamente desfavorable."
    },
    {
        topic: "Prote√≠nas",
        question: "¬øCu√°l NO es una funci√≥n t√≠pica de las prote√≠nas de membrana?",
        options: ["Almacenamiento de informaci√≥n gen√©tica.", "Transporte de iones.", "Recepci√≥n de se√±ales.", "Anclaje al citoesqueleto."],
        correct: 0,
        explanation: "El almacenamiento de informaci√≥n gen√©tica es funci√≥n del ADN en el n√∫cleo."
    },
    {
        topic: "Estructura",
        question: "¬øQu√© es una prote√≠na integral de membrana?",
        options: ["Aquella que se puede liberar solo rompiendo la bicapa (ej. con detergentes).", "Aquella unida d√©bilmente a la superficie.", "Una prote√≠na secretada.", "Una prote√≠na del citosol."],
        correct: 0,
        explanation: "Est√°n directamente insertadas o ancladas covalentemente a l√≠pidos, requiriendo disrupci√≥n de la membrana para extraerlas."
    },
    {
        topic: "Gl√∫cidos",
        question: "¬øQu√© componentes forman el glucoc√°liz?",
        options: ["Solo fosfol√≠pidos.", "Az√∫cares de glucol√≠pidos, glucoprote√≠nas y proteoglucanos.", "Colesterol y √°cidos grasos.", "ARN ribosomal."],
        correct: 1,
        explanation: "Es la 'zona dulce' externa formada por las cadenas de carbohidratos unidas a l√≠pidos y prote√≠nas."
    },
    {
        topic: "Estructura",
        question: "¬øQu√© mol√©cula lip√≠dica es anfip√°tica?",
        options: ["Solo el fosfol√≠pido.", "Solo el colesterol.", "Solo el glucol√≠pido.", "Todas las anteriores."],
        correct: 3,
        explanation: "Todos los l√≠pidos de membrana principales tienen una parte hidr√≥fila y otra hidr√≥foba."
    },
    // --- TRANSPORTE DE MEMBRANA (16-35) ---
    {
        topic: "Permeabilidad",
        question: "¬øQu√© mol√©culas atraviesan la bicapa lip√≠dica m√°s f√°cilmente por difusi√≥n simple?",
        options: ["Iones cargados (Na+).", "Mol√©culas polares grandes (Glucosa).", "Mol√©culas peque√±as no polares (O2, CO2).", "Prote√≠nas."],
        correct: 2,
        explanation: "Los gases y mol√©culas peque√±as hidrof√≥bicas difunden sin ayuda."
    },
    {
        topic: "Permeabilidad",
        question: "¬øQu√© tipo de mol√©cula es pr√°cticamente impermeable a la bicapa lip√≠dica pura?",
        options: ["Agua.", "Etanol.", "Iones inorg√°nicos (Na+, K+, Ca2+).", "Ox√≠geno."],
        correct: 2,
        explanation: "Debido a su carga y capa de hidrataci√≥n, los iones no pueden cruzar el interior hidrof√≥bico sin canales o transportadores."
    },
    {
        topic: "Transporte",
        question: "¬øCu√°l es la diferencia entre transporte pasivo y activo?",
        options: ["El pasivo requiere ATP.", "El activo mueve solutos a favor de gradiente.", "El pasivo es a favor de gradiente (sin energ√≠a) y el activo en contra (con energ√≠a).", "El activo solo ocurre en el n√∫cleo."],
        correct: 2,
        explanation: "El transporte activo requiere un aporte energ√©tico para vencer el gradiente electroqu√≠mico."
    },
    {
        topic: "Bombas",
        question: "¬øQu√© hace la bomba de Na+-K+?",
        options: ["Bombea 3 Na+ dentro y 2 K+ fuera.", "Bombea Na+ fuera y K+ dentro, gastando ATP.", "Permite la difusi√≥n pasiva de Na+ y K+.", "Sintetiza ATP."],
        correct: 1,
        explanation: "Expulsa sodio e introduce potasio contra gradiente para mantener el potencial y el equilibrio osm√≥tico."
    },
    {
        topic: "Bombas",
        question: "¬øPor qu√© es crucial la bomba de Na+-K+ para el volumen celular?",
        options: ["Evita que la c√©lula pierda agua y se seque.", "Evita que entre exceso de agua por √≥smosis y la c√©lula estalle.", "Genera l√≠pidos.", "Controla el pH."],
        correct: 1,
        explanation: "Al mantener baja la concentraci√≥n de solutos (Na+) dentro, contrarresta la tendencia del agua a entrar."
    },
    {
        topic: "Bombas",
        question: "¬øQu√© funci√≥n tienen las bombas de Ca2+?",
        options: ["Mantener una concentraci√≥n citos√≥lica de Ca2+ extremadamente baja.", "Aumentar el Ca2+ en el citosol para la digesti√≥n.", "Transportar Ca2+ al n√∫cleo.", "Eliminar Ca2+ de la mitocondria."],
        correct: 0,
        explanation: "Mantener el Ca2+ citos√≥lico bajo es vital para que pueda actuar como se√±alizador (mensajero intracelular)."
    },
    {
        topic: "Cotransporte",
        question: "¬øQu√© fuente de energ√≠a utiliza el transportador de glucosa-Na+ en el intestino?",
        options: ["ATP directo.", "Luz solar.", "El gradiente electroqu√≠mico de Na+ (transporte activo secundario).", "El gradiente de glucosa."],
        correct: 2,
        explanation: "Usa la energ√≠a almacenada en el gradiente de sodio (creado por la bomba Na/K) para arrastrar glucosa."
    },
    {
        topic: "Canales I√≥nicos",
        question: "¬øQu√© propiedad define a los canales i√≥nicos adem√°s de su selectividad?",
        options: ["Siempre est√°n abiertos.", "Son bombas de ATP.", "Tienen regulaci√≥n (gating): se abren/cierran ante est√≠mulos.", "Transportan l√≠pidos."],
        correct: 2,
        explanation: "No son poros continuos; oscilan entre estados abierto y cerrado seg√∫n voltaje, ligando o estr√©s mec√°nico."
    },
    {
        topic: "Potencial de Membrana",
        question: "¬øQu√© canales son los principales responsables del potencial de membrana en reposo?",
        options: ["Canales de Na+ regulados por voltaje.", "Canales de fuga de K+.", "Bombas de Ca2+.", "Canales de Cl-."],
        correct: 1,
        explanation: "Permiten que el K+ salga a favor de gradiente, dejando cargas negativas dentro, estableciendo el potencial negativo."
    },
    {
        topic: "Potencial de Acci√≥n",
        question: "¬øQu√© evento inicia la fase ascendente (despolarizaci√≥n) del potencial de acci√≥n?",
        options: ["La apertura de canales de K+.", "La apertura r√°pida de canales de Na+ regulados por voltaje.", "El cierre de la bomba Na/K.", "La entrada de Cl-."],
        correct: 1,
        explanation: "La entrada masiva de Na+ hace que el potencial de membrana se vuelva positivo transitoriamente."
    },
    {
        topic: "Potencial de Acci√≥n",
        question: "¬øQu√© ocurre inmediatamente despu√©s de la despolarizaci√≥n para repolarizar la membrana?",
        options: ["Inactivaci√≥n de canales de Na+ y apertura de canales de K+ regulados por voltaje.", "Apertura de m√°s canales de Na+.", "Entrada de Ca2+.", "Hidr√≥lisis de ATP."],
        correct: 0,
        explanation: "El Na+ deja de entrar y el K+ sale r√°pidamente, devolviendo la membrana a su potencial negativo."
    },
    {
        topic: "Gradiente",
        question: "¬øQu√© es el gradiente electroqu√≠mico?",
        options: ["Solo la diferencia de concentraci√≥n.", "Solo la diferencia de voltaje.", "La suma de la fuerza del gradiente de concentraci√≥n y el potencial de membrana.", "La cantidad de ATP disponible."],
        correct: 2,
        explanation: "Determina la direcci√≥n neta del transporte pasivo de iones, combinando fuerzas qu√≠micas y el√©ctricas."
    },
    {
        topic: "Transportadores",
        question: "¬øQu√© tipo de prote√≠na de transporte sufre un cambio conformacional para mover el soluto?",
        options: ["Canal i√≥nico.", "Transportador (carrier).", "Poro nuclear.", "Acuaporina."],
        correct: 1,
        explanation: "Los transportadores unen el soluto y cambian de forma para liberarlo al otro lado, a diferencia de los canales que son poros."
    },
    {
        topic: "Se√±alizaci√≥n",
        question: "¬øQu√© tipo de canal responde a la uni√≥n de un neurotransmisor?",
        options: ["Regulado por voltaje.", "Regulado por ligando.", "Regulado mec√°nicamente.", "De fuga."],
        correct: 1,
        explanation: "El neurotransmisor act√∫a como un ligando que abre el canal."
    },
    {
        topic: "Se√±alizaci√≥n",
        question: "¬øQu√© ley rige el potencial de acci√≥n?",
        options: ["Ley de la gravedad.", "Ley del todo o nada.", "Ley de la termodin√°mica.", "Ley de la difusi√≥n simple."],
        correct: 1,
        explanation: "Si el est√≠mulo supera el umbral, el potencial se dispara completamente; si no, no ocurre."
    },
    {
        topic: "Neurotransmisi√≥n",
        question: "¬øC√≥mo se propaga el potencial de acci√≥n a lo largo del ax√≥n?",
        options: ["De forma bidireccional.", "Disip√°ndose con la distancia.", "Como una onda autopropagada unidireccional.", "Mediante transporte activo."],
        correct: 2,
        explanation: "La inactivaci√≥n de los canales de Na+ detr√°s de la onda asegura que solo avance hacia adelante."
    },
    {
        topic: "Transporte",
        question: "¬øQu√© ion est√° m√°s concentrado en el exterior de la c√©lula animal t√≠pica?",
        options: ["K+", "Na+", "H+", "Fosfato"],
        correct: 1,
        explanation: "El Na+ es el principal cati√≥n extracelular (como agua de mar), mientras que el K+ es intracelular."
    },
    {
        topic: "Transporte",
        question: "La glucosa entra a las c√©lulas en contra de gradiente mediante:",
        options: ["Difusi√≥n simple.", "Bomba de ATP.", "Cotransporte con Na+ (Simporte).", "Canal i√≥nico."],
        correct: 2,
        explanation: "Aprovecha la entrada favorable de Na+ para 'colarse' contra su propio gradiente."
    },
    {
        topic: "Canales",
        question: "¬øQu√© canal se activa por deformaci√≥n f√≠sica de la membrana (ej. o√≠do)?",
        options: ["Regulado por voltaje.", "Regulado por ligando.", "Regulado mec√°nicamente.", "Canal de fuga."],
        correct: 2,
        explanation: "La fuerza mec√°nica abre el canal, fundamental para el sentido del tacto y la audici√≥n."
    },
    {
        topic: "Potencial",
        question: "¬øQu√© bomba restablece los gradientes i√≥nicos a largo plazo tras los potenciales de acci√≥n?",
        options: ["La bomba Na+/K+.", "El canal de fuga de K+.", "El canal de Na+.", "La bomba de protones."],
        correct: 0,
        explanation: "Aunque cada disparo mueve pocos iones, la bomba Na+/K+ trabaja constantemente para mantener los gradientes vitales."
    },
    // --- MITOCONDRIA Y ENERG√çA (36-50) ---
    {
        topic: "Funci√≥n Mitocondrial",
        question: "¬øCu√°l es la funci√≥n principal de la mitocondria?",
        options: ["S√≠ntesis de prote√≠nas.", "Digesti√≥n celular.", "Fosforilaci√≥n oxidativa (producci√≥n de ATP).", "Fotos√≠ntesis."],
        correct: 2,
        explanation: "Es la central energ√©tica que convierte la energ√≠a qu√≠mica de los alimentos en ATP usando ox√≠geno."
    },
    {
        topic: "Estructura Mitocondrial",
        question: "¬øQu√© caracter√≠stica tiene la membrana mitocondrial externa?",
        options: ["Es impermeable a todo.", "Contiene porinas y es permeable a mol√©culas < 5000 daltons.", "Contiene la cadena de transporte de electrones.", "Est√° plegada en crestas."],
        correct: 1,
        explanation: "Las porinas la hacen muy permeable, por lo que el espacio intermembrana es qu√≠micamente similar al citosol."
    },
    {
        topic: "Estructura Mitocondrial",
        question: "¬ø√≥nde se localiza la cadena transportadora de electrones y la ATP sintasa?",
        options: ["Membrana externa.", "Matriz.", "Membrana mitocondrial interna.", "Espacio intermembrana."],
        correct: 2,
        explanation: "La membrana interna es impermeable y alberga la maquinaria de la fosforilaci√≥n oxidativa."
    },
    {
        topic: "Estructura Mitocondrial",
        question: "¬øQu√© son las crestas mitocondriales?",
        options: ["Pliegues de la membrana interna que aumentan su superficie.", "Prote√≠nas de transporte.", "Fragmentos de ADN mitocondrial.", "Poros de la membrana externa."],
        correct: 0,
        explanation: "Aumentan enormemente la superficie disponible para alojar m√°s complejos de producci√≥n de ATP."
    },
    {
        topic: "Matriz",
        question: "¬øQu√© proceso metab√≥lico clave ocurre en la matriz mitocondrial?",
        options: ["Gluc√≥lisis.", "Ciclo del √°cido c√≠trico (Krebs) y oxidaci√≥n de piruvato/√°cidos grasos.", "Fotos√≠ntesis.", "Splicing del ARN."],
        correct: 1,
        explanation: "La matriz contiene las enzimas para oxidar los combustibles metab√≥licos y generar electrones de alta energ√≠a."
    },
    {
        topic: "Acoplamiento Quimiosm√≥tico",
        question: "¬øQu√© se bombea desde la matriz al espacio intermembrana usando la energ√≠a de los electrones?",
        options: ["ATP.", "Protones (H+).", "Electrones.", "Ox√≠geno."],
        correct: 1,
        explanation: "El transporte de electrones impulsa el bombeo de protones, creando un gradiente electroqu√≠mico."
    },
    {
        topic: "ATP Sintasa",
        question: "¬øQu√© impulsa a la ATP sintasa a producir ATP?",
        options: ["La luz.", "El flujo de protones (H+) volviendo a la matriz a favor de gradiente.", "La hidr√≥lisis de ATP.", "El transporte de Na+."],
        correct: 1,
        explanation: "El gradiente de protones act√∫a como una 'presa' hidr√°ulica; al fluir de vuelta, hace girar la turbina de la ATP sintasa."
    },
    {
        topic: "Cadena de Transporte",
        question: "¬øCu√°l es el aceptor final de los electrones en la cadena respiratoria?",
        options: ["NADH.", "ATP.", "Ox√≠geno (O2).", "CO2."],
        correct: 2,
        explanation: "El ox√≠geno recibe los electrones y protones para formar agua; sin √©l, la cadena se detiene."
    },
    {
        topic: "Transportadores de electrones",
        question: "¬øQu√© mol√©culas donan los electrones de alta energ√≠a a la cadena?",
        options: ["ATP y GTP.", "NADH y FADH2.", "Agua y CO2.", "Glucosa y piruvato."],
        correct: 1,
        explanation: "Son los portadores activados que traen los electrones del ciclo de Krebs y la gluc√≥lisis."
    },
    {
        topic: "Complejos",
        question: "¬øCu√°ntos grandes complejos respiratorios forman la cadena de transporte?",
        options: ["Uno.", "Tres (NADH deshidrogenasa, Citocromo c reductasa, Citocromo c oxidasa).", "Cinco.", "Diez."],
        correct: 1,
        explanation: "Son tres complejos principales de bombeo de protones."
    },
    {
        topic: "Din√°mica",
        question: "¬øSon las mitocondrias org√°nulos est√°ticos?",
        options: ["S√≠, son r√≠gidos.", "No, son din√°micos, se mueven, fusionan y dividen.", "Solo se mueven en mitosis.", "Desaparecen en interfase."],
        correct: 1,
        explanation: "Forman redes tubulares cambiantes y se distribuyen activamente por la c√©lula."
    },
    {
        topic: "Gen√©tica",
        question: "¬øQu√© caracter√≠stica gen√©tica √∫nica tienen las mitocondrias?",
        options: ["No tienen ADN.", "Contienen su propio ADN y ribosomas.", "Usan el ADN del n√∫cleo directamente.", "Su ADN es lineal."],
        correct: 1,
        explanation: "Poseen un genoma propio (remanente de su origen bacteriano) y maquinaria para sintetizar algunas prote√≠nas."
    },
    {
        topic: "Gradiente",
        question: "¬øPor qu√© es esencial la impermeabilidad de la membrana interna?",
        options: ["Para evitar que entre agua.", "Para mantener el gradiente de protones necesario para la s√≠ntesis de ATP.", "Para proteger el ADN.", "Para aislar el citocromo c."],
        correct: 1,
        explanation: "Si fuera permeable, los protones volver√≠an a filtrarse sin pasar por la ATP sintasa, disipando la energ√≠a (desacoplamiento)."
    },
    {
        topic: "Mecanismo",
        question: "¬øQu√© conversi√≥n de energ√≠a realiza la mitocondria?",
        options: ["Luminosa a Qu√≠mica.", "Qu√≠mica (enlaces de nutrientes) a Qu√≠mica (enlace de ATP).", "Mec√°nica a El√©ctrica.", "T√©rmica a Qu√≠mica."],
        correct: 1,
        explanation: "Extrae energ√≠a de enlaces C-H y la almacena en el enlace fosfato de alta energ√≠a del ATP."
    },
    {
        topic: "Espacio Intermembrana",
        question: "¬øQu√© enzima se encuentra en el espacio intermembrana utilizando el ATP saliente?",
        options: ["ADN polimerasa.", "Quinasas que fosforilan otros nucle√≥tidos.", "ATP sintasa.", "Ribosomas."],
        correct: 1,
        explanation: "Aprovechan el ATP reci√©n hecho para fosforilar nucle√≥tidos como AMP o GDP."
    },
    // --- CITOESQUELETO Y M√öSCULO (51-75) ---
    {
        topic: "General",
        question: "¬øCu√°l NO es una funci√≥n del citoesqueleto?",
        options: ["Mantener la forma celular.", "Generar ATP.", "Permitir el movimiento celular.", "Organizar org√°nulos internos."],
        correct: 1,
        explanation: "La generaci√≥n de ATP es mitocondrial. El citoesqueleto es estructural y motor."
    },
    {
        topic: "Filamentos Intermedios",
        question: "¬øCu√°l es la funci√≥n principal de los filamentos intermedios?",
        options: ["Transporte de ves√≠culas.", "Proporcionar resistencia mec√°nica frente al estr√©s f√≠sico.", "Contracci√≥n muscular.", "Formar el anillo contr√°ctil."],
        correct: 1,
        explanation: "Son como cuerdas resistentes que evitan que la c√©lula se rompa al estirarse."
    },
    {
        topic: "Filamentos Intermedios",
        question: "¬øD√≥nde se encuentra la l√°mina nuclear?",
        options: ["En el citoplasma.", "En el n√∫cleo, sosteniendo la envoltura nuclear.", "En la membrana plasm√°tica.", "En la mitocondria."],
        correct: 1,
        explanation: "Es una red de filamentos intermedios que da soporte al n√∫cleo."
    },
    {
        topic: "Filamentos Intermedios",
        question: "¬øQu√© estructuras de uni√≥n intercelular anclan los filamentos intermedios?",
        options: ["Uniones estrechas.", "Desmosomas.", "Gap junctions.", "Sinapsis."],
        correct: 1,
        explanation: "Los desmosomas conectan los filamentos intermedios de c√©lulas vecinas, dando fuerza al tejido."
    },
    {
        topic: "Microt√∫bulos",
        question: "¬øQu√© prote√≠na forma los microt√∫bulos?",
        options: ["Actina.", "Tubulina.", "Queratina.", "Miosina."],
        correct: 1,
        explanation: "Est√°n formados por d√≠meros de tubulina que se apilan formando tubos huecos."
    },
    {
        topic: "Microt√∫bulos",
        question: "¬øDesde d√≥nde crecen generalmente los microt√∫bulos en una c√©lula animal?",
        options: ["Desde la membrana plasm√°tica.", "Desde el centrosoma.", "Desde la mitocondria.", "Desde los ribosomas."],
        correct: 1,
        explanation: "El centrosoma es el principal Centro Organizador de Microt√∫bulos (MTOC)."
    },
    {
        topic: "Microt√∫bulos",
        question: "¬øQu√© es la inestabilidad din√°mica?",
        options: ["La capacidad de los microt√∫bulos de crecer y encogerse r√°pidamente.", "El movimiento de los l√≠pidos.", "La rotura del ADN.", "La vibraci√≥n de la membrana."],
        correct: 0,
        explanation: "Permite a los microt√∫bulos explorar el espacio celular creciendo y retray√©ndose seg√∫n la hidr√≥lisis de GTP."
    },
    {
        topic: "Motores Moleculares",
        question: "¬øHacia qu√© extremo del microt√∫bulo se mueven las Cinesinas?",
        options: ["Hacia el extremo negativo (-) o centro.", "Hacia el extremo positivo (+) o periferia.", "No se mueven.", "Hacia el n√∫cleo."],
        correct: 1,
        explanation: "Las cinesinas transportan carga hacia fuera (extremo +), alej√°ndose del centrosoma."
    },
    {
        topic: "Motores Moleculares",
        question: "¬øHacia qu√© extremo del microt√∫bulo se mueven las Dine√≠nas?",
        options: ["Hacia el extremo positivo (+).", "Hacia el extremo negativo (-) o centro.", "Aleatoriamente.", "Hacia la membrana."],
        correct: 1,
        explanation: "Las dine√≠nas transportan carga hacia el centro de la c√©lula (extremo -)."
    },
    {
        topic: "Cilios y Flagelos",
        question: "¬øQu√© estructura de microt√∫bulos es caracter√≠stica de cilios y flagelos?",
        options: ["Disposici√≥n '9+2'.", "Disposici√≥n aleatoria.", "Un solo microt√∫bulo central.", "H√©lice triple."],
        correct: 0,
        explanation: "Nueve pares externos y dos microt√∫bulos centrales forman el axonema."
    },
    {
        topic: "Actina",
        question: "¬øD√≥nde se concentran los filamentos de actina en la c√©lula?",
        options: ["En el n√∫cleo.", "En la corteza celular, justo bajo la membrana.", "Alrededor del centrosoma.", "En la matriz mitocondrial."],
        correct: 1,
        explanation: "Forman el c√≥rtex celular, determinando la forma y el movimiento de la superficie."
    },
    {
        topic: "Actina",
        question: "¬øQu√© estructuras forma la actina para el movimiento celular (reptaci√≥n)?",
        options: ["Cilios.", "Filopodios y Lamelipodios.", "Desmosomas.", "Microt√∫bulos astrales."],
        correct: 1,
        explanation: "Son proyecciones de actina en el borde de avance que empujan la membrana hacia adelante."
    },
    {
        topic: "Actina",
        question: "¬øQu√© prote√≠na motora interact√∫a con la actina para generar contracci√≥n?",
        options: ["Cinesina.", "Dine√≠na.", "Miosina.", "Tubulina."],
        correct: 2,
        explanation: "La miosina utiliza ATP para deslizarse sobre la actina, base de la contracci√≥n muscular y celular."
    },
    {
        topic: "Contracci√≥n Muscular",
        question: "¬øCu√°l es la unidad contr√°ctil fundamental del m√∫sculo esquel√©tico?",
        options: ["El miocito.", "El sarc√≥mero.", "El t√∫bulo T.", "El ret√≠culo sarcopl√°smico."],
        correct: 1,
        explanation: "El sarc√≥mero es la disposici√≥n ordenada de actina y miosina que se acorta."
    },
    {
        topic: "Contracci√≥n Muscular",
        question: "¬øQu√© ion desencadena la contracci√≥n muscular al ser liberado?",
        options: ["Na+", "K+", "Ca2+", "Cl-"],
        correct: 2,
        explanation: "El calcio liberado del ret√≠culo sarcopl√°smico es la se√±al intracelular para contraer."
    },
    {
        topic: "Mecanismo Contracci√≥n",
        question: "¬øA qu√© prote√≠na se une el Ca2+ para iniciar la contracci√≥n en el m√∫sculo estriado?",
        options: ["Miosina.", "Actina.", "Troponina.", "Tropomiosina."],
        correct: 2,
        explanation: "El calcio se une a la troponina, lo que causa un cambio en la tropomiosina."
    },
    {
        topic: "Mecanismo Contracci√≥n",
        question: "¬øQu√© hace la tropomiosina en reposo?",
        options: ["Genera ATP.", "Bloquea los sitios de uni√≥n de la miosina en la actina.", "Une calcio.", "Degrada actina."],
        correct: 1,
        explanation: "Impide que las cabezas de miosina se unan a la actina; el calcio la desplaza."
    },
    {
        topic: "Mecanismo Contracci√≥n",
        question: "¬øQu√© ocurre durante el 'golpe de fuerza' o deslizamiento?",
        options: ["Los filamentos de actina se acortan.", "Los filamentos de miosina se acortan.", "Los filamentos de actina y miosina se deslizan uno sobre otro sin cambiar de longitud.", "La membrana se rompe."],
        correct: 2,
        explanation: "El sarc√≥mero se acorta por el solapamiento creciente de filamentos, no porque los filamentos se encojan."
    },
    {
        topic: "Regulaci√≥n Actina",
        question: "¬øQu√© familia de prote√≠nas regula la organizaci√≥n de la actina en respuesta a se√±ales?",
        options: ["Prote√≠nas Rho.", "Prote√≠nas Ran.", "Prote√≠nas Ras.", "Prote√≠nas Rab."],
        correct: 0,
        explanation: "La familia Rho controla la formaci√≥n de lamelipodios, filopodios y fibras de estr√©s."
    },
    {
        topic: "Microt√∫bulos",
        question: "¬øQu√© mol√©cula regula la inestabilidad din√°mica de los microt√∫bulos?",
        options: ["ATP.", "GTP.", "Calcio.", "AMPc."],
        correct: 1,
        explanation: "La tubulina unida a GTP polimeriza; si se hidroliza a GDP, el microt√∫bulo se despolimeriza."
    },
    {
        topic: "Actina",
        question: "¬øQu√© estructura transitoria de actina/miosina divide la c√©lula en la citoquinesis?",
        options: ["El huso mit√≥tico.", "El anillo contr√°ctil.", "El centrosoma.", "La l√°mina nuclear."],
        correct: 1,
        explanation: "El anillo contr√°ctil estrangula el citoplasma para separar las dos c√©lulas hijas."
    },
    {
        topic: "Intermedios",
        question: "¬øTienen polaridad (extremos distintos) los filamentos intermedios?",
        options: ["S√≠, un extremo + y otro -.", "No, sus extremos son id√©nticos.", "Depende del tipo.", "S√≠, 5' y 3'."],
        correct: 1,
        explanation: "A diferencia de actina y microt√∫bulos, los filamentos intermedios son apolares."
    },
    {
        topic: "Miosina",
        question: "¬øQu√© tipo de miosina es la responsable de la contracci√≥n muscular?",
        options: ["Miosina I.", "Miosina II.", "Miosina V.", "Cinesina."],
        correct: 1,
        explanation: "La Miosina II forma filamentos gruesos bipolares en el sarc√≥mero."
    },
    {
        topic: "Energ√≠a",
        question: "¬øQu√© usa la prote√≠na motora (cinesina/dine√≠na/miosina) para moverse?",
        options: ["Gradiente de protones.", "Hidr√≥lisis de ATP.", "Difusi√≥n pasiva.", "Energ√≠a t√©rmica."],
        correct: 1,
        explanation: "Los cambios conformacionales que generan movimiento est√°n acoplados a ciclos de ATP."
    },
    {
        topic: "Resumen",
        question: "¬øQu√© filamento es el m√°s resistente y duradero?",
        options: ["Microt√∫bulo.", "Actina.", "Filamento intermedio.", "ADN."],
        correct: 2,
        explanation: "Su funci√≥n principal es la resistencia mec√°nica, comparable a una cuerda."
    }
];

// --- GESTI√ìN DE ESTADO ---
// Inicializamos propiedades extra en las preguntas
questions.forEach(q => {
    q.isMarked = false;       // Estado de marca
    q.userCorrect = null;     // null: no respondida, true: correcta, false: incorrecta
});

let activeIndices = []; // √çndices de las preguntas activas (playlist)
let currentPlaylistIndex = 0; // Puntero dentro de la playlist
let sessionScore = 0;
let answered = false;

// Al cargar
document.addEventListener('DOMContentLoaded', () => {
    startQuiz('all');
});

// Funci√≥n Principal: Iniciar/Reiniciar con modos
function startQuiz(mode) {
    activeIndices = [];
    
    // 1. Filtrar √≠ndices seg√∫n el modo
    if (mode === 'all') {
        // Reinicio total: limpiamos respuestas
        questions.forEach(q => q.userCorrect = null);
        questions.forEach(q => q.isMarked = false); // Opcional: limpiar marcas
        activeIndices = questions.map((_, i) => i);
    } 
    else if (mode === 'failed') {
        activeIndices = questions.map((q, i) => q.userCorrect === false ? i : -1).filter(i => i !== -1);
    } 
    else if (mode === 'marked') {
        activeIndices = questions.map((q, i) => q.isMarked ? i : -1).filter(i => i !== -1);
    } 
    else if (mode === 'mixed') {
        // Falladas O marcadas
        activeIndices = questions.map((q, i) => (q.userCorrect === false || q.isMarked) ? i : -1).filter(i => i !== -1);
    }

    // 2. Validar
    if (activeIndices.length === 0) {
        alert("No hay preguntas para este modo (ej. no has fallado o marcado ninguna).");
        return;
    }

    // 3. Resetear sesi√≥n
    currentPlaylistIndex = 0;
    sessionScore = 0;
    
    // 4. UI
    document.getElementById('results').style.display = 'none';
    document.getElementById('quiz-area').style.display = 'block';
    document.getElementById('statsBar').style.display = 'flex';
    
    loadQuestion();
}

function loadQuestion() {
    answered = false;
    
    // Usamos activeIndices para saber qu√© pregunta real cargar
    const realIndex = activeIndices[currentPlaylistIndex];
    const q = questions[realIndex];
    
    document.getElementById('progress').textContent = `Pregunta ${currentPlaylistIndex + 1} de ${activeIndices.length}`;
    document.getElementById('score').textContent = `Aciertos sesi√≥n: ${sessionScore}`;

    const quizArea = document.getElementById('quiz-area');
    
    // Estado del checkbox
    const markedChecked = q.isMarked ? 'checked' : '';

    let html = `
        <div class="question-card active">
            
            <label class="bookmark-panel">
                <input type="checkbox" class="bookmark-checkbox" onchange="toggleMark(${realIndex}, this)" ${markedChecked}>
                <span>Marcar para revisar</span>
            </label>

            <div class="topic-tag">${q.topic}</div>
            <div class="question-text">${q.question}</div>
            
            <div class="options-grid">
                ${q.options.map((opt, i) => `
                    <button class="option-btn" onclick="checkAnswer(${i}, ${q.correct}, this, ${realIndex})">
                        ${String.fromCharCode(65+i)}. ${opt}
                    </button>
                `).join('')}
            </div>
            
            <div id="feedback" class="feedback"></div>
            
            <div class="navigation">
                <button id="next-btn" class="nav-btn" onclick="nextQuestion()">Siguiente ‚Üí</button>
            </div>
        </div>
    `;
    
    quizArea.innerHTML = html;
}

// Funci√≥n para marcar/desmarcar (se guarda en el objeto global)
function toggleMark(realIndex, checkbox) {
    questions[realIndex].isMarked = checkbox.checked;
}

function checkAnswer(selected, correct, btn, realIndex) {
    if (answered) return;
    answered = true;

    const btns = document.querySelectorAll('.option-btn');
    const feedbackEl = document.getElementById('feedback');
    const nextBtn = document.getElementById('next-btn');

    // Deshabilitar botones
    btns.forEach(b => b.disabled = true);

    if (selected === correct) {
        sessionScore++;
        questions[realIndex].userCorrect = true; // Guardar estado
        btn.classList.add('correct');
        feedbackEl.className = 'feedback feedback-correct show';
        feedbackEl.innerHTML = `<strong>¬°Correcto!</strong> ${questions[realIndex].explanation}`;
    } else {
        questions[realIndex].userCorrect = false; // Guardar estado fallo
        btn.classList.add('incorrect');
        btns[correct].classList.add('correct');
        feedbackEl.className = 'feedback feedback-incorrect show';
        feedbackEl.innerHTML = `<strong>Incorrecto.</strong> ${questions[realIndex].explanation}`;
    }

    document.getElementById('score').textContent = `Aciertos sesi√≥n: ${sessionScore}`;
    nextBtn.style.display = 'inline-block';
}

function nextQuestion() {
    if (currentPlaylistIndex < activeIndices.length - 1) {
        currentPlaylistIndex++;
        loadQuestion();
    } else {
        showResults();
    }
}

function showResults() {
    document.getElementById('quiz-area').style.display = 'none';
    document.getElementById('statsBar').style.display = 'none';
    document.getElementById('results').style.display = 'block';

    const percent = Math.round((sessionScore / activeIndices.length) * 100);
    document.getElementById('final-score').textContent = `${sessionScore} / ${activeIndices.length}`;
    
    let msg = "";
    if(percent >= 90) msg = "¬°Excelente!";
    else if(percent >= 70) msg = "Muy bien.";
    else if(percent >= 50) msg = "Aprobado.";
    else msg = "Sigue repasando.";
    document.getElementById('final-percent').textContent = `${percent}% - ${msg}`;

    // Calcular estad√≠sticas globales
    const totalFailed = questions.filter(q => q.userCorrect === false).length;
    const totalMarked = questions.filter(q => q.isMarked === true).length;
    const totalMixed = questions.filter(q => q.userCorrect === false || q.isMarked).length;

    document.getElementById('stats-summary').innerHTML = `
        <strong>Resumen Global:</strong><br>
        Preguntas marcadas para revisi√≥n: ${totalMarked}<br>
        Preguntas falladas (hist√≥rico): ${totalFailed}
    `;

    // Habilitar/Deshabilitar botones
    document.getElementById('btn-failed').disabled = (totalFailed === 0);
    document.getElementById('btn-marked').disabled = (totalMarked === 0);
    document.getElementById('btn-mixed').disabled = (totalMixed === 0);
    
    document.getElementById('btn-failed').innerHTML = `‚ùå Repetir Falladas (${totalFailed})`;
    document.getElementById('btn-marked').innerHTML = `‚ö†Ô∏è Repetir Marcadas (${totalMarked})`;
}
</script>

</body>
</html>
