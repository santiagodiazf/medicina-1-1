<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz Anatomía - Tema 14: Corazón</title>
    <style>
        :root {
            --primary-color: #8e44ad;
            --secondary-color: #9b59b6;
            --success-color: #27ae60;
            --error-color: #c0392b;
            --background-color: #f4f7f6;
            --card-background: #ffffff;
            --sidebar-width: 280px;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--background-color);
            margin: 0;
            display: flex;
            height: 100vh;
            overflow: hidden;
        }

        /* SIDEBAR */
        .sidebar {
            width: var(--sidebar-width);
            background-color: #2c3e50;
            color: white;
            display: flex;
            flex-direction: column;
            border-right: 1px solid #bdc3c7;
            flex-shrink: 0;
        }

        .sidebar-header {
            padding: 15px;
            text-align: center;
            background-color: #1a252f;
            border-bottom: 1px solid #34495e;
        }

        .sidebar-header h2 { margin: 0; font-size: 1.1rem; }
        
        .sidebar-controls {
            margin-top: 10px;
            display: flex;
            flex-direction: column;
            gap: 10px;
            align-items: center;
        }

        .sidebar-stats { font-size: 0.9rem; color: #bdc3c7; }

        .finish-btn-side {
            background-color: #e74c3c;
            border: none;
            border-radius: 4px;
            color: white;
            padding: 8px 15px;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: bold;
            width: 80%;
            transition: 0.2s;
        }
        .finish-btn-side:hover { background-color: #c0392b; }

        .sidebar-nav {
            flex-grow: 1;
            overflow-y: auto;
            padding: 10px;
            display: grid;
            grid-template-columns: repeat(4, 1fr); 
            gap: 5px;
            align-content: start;
        }

        .nav-btn {
            aspect-ratio: 1;
            border: none;
            border-radius: 4px;
            background-color: #34495e;
            color: white;
            cursor: pointer;
            font-size: 0.8rem;
            display: flex;
            align-items: center;
            justify-content: center;
            text-decoration: none;
            transition: 0.2s;
        }

        .nav-btn:hover { background-color: var(--secondary-color); }
        .nav-btn.correct { background-color: var(--success-color); }
        .nav-btn.incorrect { background-color: var(--error-color); }
        .nav-btn.marked { border: 2px solid #f1c40f; color: #f1c40f; font-weight: bold; }

        /* MAIN CONTENT */
        .main-content {
            flex-grow: 1;
            overflow-y: auto;
            padding: 30px;
            scroll-behavior: smooth;
        }

        .container { max-width: 900px; margin: 0 auto; }

        h1 { color: var(--primary-color); border-bottom: 3px solid var(--secondary-color); padding-bottom: 10px; }

        .question-card {
            background-color: var(--card-background);
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.08);
            padding: 20px;
            margin-bottom: 25px;
            border-left: 5px solid var(--secondary-color);
            scroll-margin-top: 20px;
        }

        .question-header-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            color: #7f8c8d;
            font-size: 0.9rem;
            font-weight: bold;
        }

        .bookmark-btn {
            background: none;
            border: 1px solid #bdc3c7;
            border-radius: 4px;
            cursor: pointer;
            color: #95a5a6;
            padding: 2px 8px;
        }
        .bookmark-btn.active { color: #f39c12; border-color: #f39c12; background: #fef9e7; }

        .question-text { font-size: 1.1rem; color: #2c3e50; margin-bottom: 15px; font-weight: 600; line-height: 1.4; }

        .options-grid { display: flex; flex-direction: column; gap: 8px; }

        .option-btn {
            padding: 10px 15px;
            border: 1px solid #bdc3c7;
            border-radius: 5px;
            background: white;
            cursor: pointer;
            text-align: left;
            transition: 0.2s;
            font-size: 1rem;
        }

        .option-btn:hover:not(.disabled) { background-color: #f0f3f4; border-color: var(--primary-color); }
        
        .option-btn.correct { background-color: #d4edda; border-color: #28a745; color: #155724; }
        .option-btn.incorrect { background-color: #f8d7da; border-color: #dc3545; color: #721c24; }
        .option-btn.disabled { cursor: default; opacity: 0.7; }

        .feedback {
            margin-top: 10px;
            padding: 10px;
            border-radius: 5px;
            display: none;
            font-size: 0.9rem;
        }
        .feedback.show { display: block; }
        .feedback.success { background-color: #e8f8f5; color: #0e6251; }
        .feedback.error { background-color: #fdedec; color: #78281f; }

        /* RESULT PANEL */
        .results-panel {
            background: #2c3e50;
            color: white;
            padding: 30px;
            border-radius: 10px;
            text-align: center;
            margin-top: 40px;
            display: none;
            margin-bottom: 50px;
        }

        .action-buttons {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 10px;
            margin-top: 20px;
        }

        .action-btn {
            padding: 12px 24px;
            border: none;
            border-radius: 5px;
            background: var(--secondary-color);
            color: white;
            cursor: pointer;
            font-size: 1rem;
            font-weight: bold;
            transition: transform 0.1s;
        }
        .action-btn:hover { background: #8e44ad; transform: scale(1.05); }
        .action-btn:active { transform: scale(0.95); }

        @media (max-width: 768px) {
            body { flex-direction: column; overflow: auto; }
            .sidebar { width: 100%; height: auto; border-right: none; border-bottom: 1px solid #ccc; padding-bottom: 10px; }
            .sidebar-nav { grid-template-columns: repeat(8, 1fr); max-height: 150px; }
            .main-content { overflow: visible; }
        }
    </style>
</head>
<body>

<div class="sidebar">
    <div class="sidebar-header">
        <h2>Tema 14: Corazón</h2>
        <div class="sidebar-controls">
            <div class="sidebar-stats"><span id="progress-text">0/172</span> respondidas</div>
            <button class="finish-btn-side" onclick="showResults(true)">Finalizar Test</button>
        </div>
    </div>
    <div id="sidebar-nav" class="sidebar-nav"></div>
</div>

<div class="main-content">
    <div class="container">
        <h1>Anatomía del Corazón</h1>
        <div id="questions-list"></div>
        
        <div id="results-panel" class="results-panel">
            <h2>Test Finalizado</h2>
            <p id="score-text" style="font-size: 1.4rem; margin: 15px 0;"></p>
            <div class="action-buttons">
                <button class="action-btn" onclick="resetQuiz('all')">Repetir Todo</button>
                <button class="action-btn" onclick="resetQuiz('wrong')">Repetir Falladas</button>
                <button class="action-btn" onclick="resetQuiz('marked')">Repetir Marcadas</button>
                <button class="action-btn" onclick="resetQuiz('wrong_marked')">Falladas + Marcadas</button>
            </div>
        </div>
    </div>
</div>

<script>
    // BASE DE DATOS MASIVA - TEMA 14 CORAZÓN
    const dbQuestions = [
        { id: 1, original: "33", q: "La valva mayor de la válvula mitral se encuentra en posición:", options: ["Anterior", "Posterior", "Lateral, externa o izquierda", "Medial, derecha o septal"], correct: 0, exp: "La valva mayor de la mitral es la valva ANTERIOR (también llamada aórtica)." },
        { id: 2, original: "34", q: "El corazón está irrigado por las arterias:", options: ["Coronarias izquierdas y anterior", "Aorta", "Coronarias derecha e izquierda", "Subclavia"], correct: 2, exp: "La irrigación depende de las dos arterias coronarias (derecha e izquierda)." },
        { id: 3, original: "35", q: "Las arterias coronarias son ramas de:", options: ["El cayado de la arteria aorta", "La arteria pulmonar", "La arteria aorta ascendente", "La arteria aorta descendente"], correct: 2, exp: "Nacen de los senos de Valsalva en la aorta ascendente." },
        { id: 4, original: "36", q: "Los 2/3 anteriores del tabique interventricular están irrigados por la arteria:", options: ["Circunfleja", "Coronaria derecha", "Descendente anterior", "Diagonal"], correct: 2, exp: "La descendente anterior (interventricular anterior) irriga los 2/3 anteriores del tabique." },
        { id: 5, original: "37", q: "El nodo sinusal se ubica cerca de la desembocadura de:", options: ["La vena cava inferior", "La vena cava superior", "El seno venoso", "Las venas pulmonares"], correct: 1, exp: "El nodo sinusal está en la unión de la Vena Cava Superior y la aurícula derecha." },
        { id: 6, original: "38", q: "El nódulo aurículo ventricular está ubicado en:", options: ["La porción superior de la crista terminalis", "El tabique interauricular (Triángulo de Koch)", "El limbo de la fosa oval", "La porción rugosa de la aurícula derecha"], correct: 1, exp: "Se sitúa en el triángulo de Koch, en la base del tabique interauricular." },
        { id: 7, original: "39", q: "Cuál de las siguientes estructuras posee una pared muscular más gruesa:", options: ["Ventrículo derecho", "Aurícula derecha", "Aurícula izquierda", "Ventrículo izquierdo", "Todas igual"], correct: 3, exp: "El ventrículo izquierdo tiene la pared más gruesa para bombear a la circulación sistémica." },
        { id: 8, original: "40", q: "El ápex del corazón:", options: ["Se dirige anterocaudalmente y a la derecha", "Se dirige dorsocranealmente y a la izquierda", "Se dirige dorsocaudalmente y a la izquierda", "Se dirige anterocaudalmente y a la izquierda"], correct: 3, exp: "El ápex apunta hacia abajo (caudal), adelante (anterior) y a la izquierda." },
        { id: 9, original: "41", q: "El pericardio se encuentra unido a:", options: ["Las vertebras (lig. pericardiovertebrales)", "Fascia superior diafragma (lig. pericardiofrénicos)", "Cara interna esternón (lig. esternopericárdicos)", "B y C son correctas", "Todas son ciertas"], correct: 4, exp: "El pericardio tiene ligamentos vertebrales, frénicos y esternales." },
        { id: 10, original: "42", q: "El ápex del corazón se encontraría:", options: ["Línea media clavicular y 8 espacio", "Línea axilar y 6 espacio", "Línea costoclaviculoesternal 7 espacio", "En la línea media clavicular y el 5 espacio intercostal", "Línea costoclaviculoesternal 6 espacio"], correct: 3, exp: "Anatómicamente se proyecta en el 5º espacio intercostal, línea medioclavicular izquierda." },
        { id: 11, original: "43", q: "Como se denomina la estructura que tapiza en ocasiones el surco auriculoventricular derivada de las aurículas:", options: ["Orejuela", "Língula", "Seno interventricular", "Triángulo de Koch", "Válvula de Tebesio"], correct: 0, exp: "Las orejuelas (aurículas u ojalillos) cubren parte de los surcos." },
        { id: 12, original: "44", q: "Dónde se produce el drenaje del seno venoso (seno coronario):", options: ["En la válvula de Tebesio", "En la válvula de Eustaquio", "En la aurícula derecha", "A y C (Aurícula derecha mediante válvula de Tebesio)", "B y C"], correct: 3, exp: "El seno coronario drena en la aurícula derecha y su orificio tiene la válvula de Tebesio." },
        { id: 13, original: "45", q: "En el centro fibroso del corazón cuál diría usted que es la estructura más anterior:", options: ["Anillo fibroso de la válvula pulmonar", "Anillo fibroso de la válvula aórtica", "Anillo auriculoventricular izquierdo", "Anillo auriculoventricular derecho", "Están en el mismo plano"], correct: 0, exp: "La válvula pulmonar es la más anterior y superior de todas." },
        { id: 14, original: "46", q: "Relacione: Válvula tricúspide", options: ["Músculos anteroposterior, medial y septal", "Músculos papilares anterior, posterior y septal", "Válvulas semilunares", "Origen coronarias", "Músculos papilares anterior y posterior"], correct: 1, exp: "La tricúspide tiene 3 valvas y se asocia a músculos papilares anterior, posterior y septal." },
        { id: 15, original: "47", q: "Relacione: Válvula mitral", options: ["Músculos papilares anterior, posterior y septal", "Válvulas semilunares", "Origen coronarias", "Está formada por los músculos papilares anterior y posterior", "Músculos septales"], correct: 3, exp: "La mitral (bicúspide) tiene músculos papilares anterior y posterior." },
        { id: 16, original: "48", q: "Relacione: Válvula aórtica", options: ["Músculos papilares", "Presenta válvulas semilunares anterior y laterales", "De ella nacen las arterias coronarias (senos Valsalva)", "Músculos septales"], correct: 2, exp: "En la raíz aórtica (senos de Valsalva) nacen las coronarias." },
        { id: 17, original: "49", q: "Relacione: Válvula pulmonar", options: ["Músculos papilares", "Presenta las válvulas semilunares anterior y laterales (izq/der)", "Nacen coronarias", "Músculos septales"], correct: 1, exp: "La pulmonar tiene valvas semilunares (Anterior, Derecha, Izquierda según nomenclatura clásica)." },
        { id: 18, original: "50", q: "El seno de Valsalva se encuentra en:", options: ["Valvula pulmonar", "Valvula aórtica", "Válvula tricúspide", "Válvula mitral", "Ninguna"], correct: 1, exp: "Los senos de Valsalva están en la raíz de la aorta." },
        { id: 19, original: "51", q: "El trígono anterior del centro fibroso del corazón se encuentra entre:", options: ["Valvula pulmonar y tricúspide", "Válvula aórtica y válvula mitral (y tricúspide)", "Mitral, tricúspide y aórtica", "Ninguna", "A y B"], correct: 2, exp: "Une los anillos aórtico, mitral y tricuspídeo (cuerpo fibroso central)." },
        { id: 20, original: "52", q: "El surco terminal de His está formado externamente por la confluencia de:", options: ["Vena cava superior y cayado aorta", "Vena cava inferior y superior", "Vena cava superior y atrio derecho (borde)", "Ninguna", "Todas"], correct: 3, exp: "El sulcus terminalis está en la AD, marcando la unión de la aurícula primitiva y el seno venoso." },
        { id: 21, original: "53", q: "Relacione: Seno oblicuo del pericardio (Fondo de saco de Haller)", options: ["Formado alrededor de las venas pulmonares", "Formado alrededor del ápex", "Formado alrededor del helio", "Ninguna", "Anterior a la vena cava"], correct: 0, exp: "El seno oblicuo está detrás de la AI, entre las venas pulmonares." },
        { id: 22, original: "54", q: "Relacione: Seno transverso del pericardio (Theile)", options: ["Alrededor venas pulmonares", "Detrás de Aorta y Pulmonar, delante de VCS y Aurículas", "Alrededor del hilio", "Ninguna"], correct: 1, exp: "Separa el pedículo arterial (delante) del venoso (detrás)." },
        { id: 23, original: "55", q: "La arteria interventricular anterior es rama de:", options: ["Arteria coronaria derecha", "Arteria aorta ascendente", "Arteria coronaria izquierda", "Ninguna", "A y B"], correct: 2, exp: "Es rama terminal de la coronaria izquierda (junto con la circunfleja)." },
        { id: 24, original: "56", q: "La vena interventricular anterior es rama de (o drena en):", options: ["Vena menor", "Vena marginal", "Vena cava", "Vena circunfleja", "Vena mayor cardiaca (Magna)"], correct: 4, exp: "La vena interventricular anterior se continúa como Vena Cardiaca Magna." },
        { id: 25, original: "57", q: "La arteria pericardiofrénica es rama de:", options: ["Arteria vertebral", "Arteria subclavia", "Arteria carótida común", "Arteria torácica interna"], correct: 3, exp: "Rama de la mamaria interna (torácica interna)." },
        { id: 26, original: "58", q: "Los ostium primum y secundum se producen secuencialmente para producir:", options: ["Ductus de Botal", "La separación entre ventrículos", "Formación grandes vasos", "El tabicamiento de la aurícula primitiva"], correct: 3, exp: "Son orificios en el Septum Primum durante el tabicamiento interauricular." },
        { id: 27, original: "1", q: "El espacio que queda anterior con respecto al saco pericardio es denominado:", options: ["Cara inferior saco", "Mediastino posterior", "Mediastino superior", "Mediastino anterior", "Cara mediastínica"], correct: 3, exp: "Delante del pericardio está el mediastino anterior." },
        { id: 28, original: "2", q: "Los ligamentos pericardicofrénicos fijan el centro tendinoso del diafragma y:", options: ["Cara inferior del saco pericárdico", "Mediastino posterior", "Mediastino superior", "Mediastino anterior", "Cara mediastínica"], correct: 0, exp: "Unen el pericardio (cara inferior) al diafragma." },
        { id: 29, original: "3", q: "Cuál de las siguientes afirmaciones es cierta respecto la aurícula derecha:", options: ["Posee tres músculos papilares", "Presenta cuatro forámenes venas pulmonares", "2/3 anteriores vascularizados por IV anterior", "En esta cavidad drena el seno venoso", "Pared gruesa"], correct: 3, exp: "El seno coronario drena en la aurícula derecha." },
        { id: 30, original: "4", q: "Cuál de las siguientes afirmaciones es cierta respecto al ventrículo derecho:", options: ["Posee tres músculos papilares (anterior, posterior, septal)", "Venas pulmonares", "Pared más gruesa", "Drena seno venoso"], correct: 0, exp: "El VD tiene tres músculos papilares clásicos (aunque el septal es pequeño)." },
        { id: 31, original: "5", q: "Cuál de las siguientes afirmaciones es cierta respecto al ventrículo izquierdo:", options: ["Posee tres músculos papilares", "Presenta cuatro forámenes venas pulmonares", "Pared muscular más gruesa", "Drena seno venoso", "Pared fina"], correct: 2, exp: "El VI tiene la pared más gruesa (miocardio)." },
        { id: 32, original: "6", q: "Cuál de las siguientes afirmaciones es cierta respecto al tabique interventricular:", options: ["Sus dos tercios anteriores están vascularizados por la arteria interventricular anterior", "Posee tres músculos papilares", "Drena seno venoso", "Pared fina"], correct: 0, exp: "La irrigación septal: 2/3 anteriores (Coronaria Izq), 1/3 posterior (Coronaria Der)." },
        { id: 33, original: "Extra", q: "El seno transverso del corazón, se relaciona ¿Con qué parte del mismo?", options: ["Cara posterobasal", "Ápex cardíaco", "Porción de los grandes vasos (Pedículo arterial/venoso)", "Surco interventricular"], correct: 2, exp: "Está tras la aorta y pulmonar." },
        { id: 34, original: "Extra", q: "¿Cuál de los siguientes vasos arteriales depende de la arteria coronaria izquierda?", options: ["Arteria interventricular posterior", "Arteria circunfleja", "Arteria marginal derecha", "Arteria nodo sinusal"], correct: 1, exp: "La circunfleja es rama terminal de la izquierda." },
        { id: 35, original: "Extra", q: "En el corazón primitivo, la sangre que procede del ventrículo pasa al:", options: ["Aurícula", "Bulbus cordis (Cono arterioso)", "Aortas primitivas", "Seno venoso"], correct: 1, exp: "Secuencia: Seno venoso -> Aurícula -> Ventrículo -> Bulbus cordis." },
        { id: 36, original: "Extra", q: "¿Cuál de las siguientes afirmaciones acerca del pericardio seroso es incorrecta?", options: ["Tapiza la vena cava superior", "El parietal se une al fibroso", "El visceral se fija al miocardio", "La doble lámina se fija en el ápex con ligamentos pericardicofrénicos"], correct: 3, exp: "Los ligamentos fijan el pericardio fibroso, no la doble lámina serosa en el ápex." },
        { id: 37, original: "Extra", q: "El pericardio fibroso envuelve:", options: ["El corazón, pericardio seroso y porción inicial grandes vasos", "Mediastino medio hasta manubrio", "Bronquios", "Frénicos"], correct: 0, exp: "Envuelve al corazón y raíces de grandes vasos." },
        { id: 38, original: "25", q: "Las orejuelas no se corresponden con la porción valvular de:", options: ["Porción ascendente cayado", "Ventrículo izquierdo", "Vena cava", "Seno Valsalva", "Aurículas"], correct: 4, exp: "Las orejuelas son apéndices de las aurículas." },
        { id: 39, original: "1", q: "El Tabicamiento entre aurículas: señale la opción correcta:", options: ["Se organiza por el septum primum y secundum", "Crea comunicación cono-ventrículo", "Cierra semana 8", "Delimita trígono Koch"], correct: 0, exp: "Depende del Septum Primum y Secundum." },
        { id: 40, original: "2", q: "Sobre la aurícula derecha, señale la correcta:", options: ["4 forámenes pulmonares", "Toda recubierta por músculos pectinados", "2/3 anteriores vascularizados por IV anterior", "El surco terminal limita las porciones vascular (lisa) y muscular (pectínea/orejuela)"], correct: 3, exp: "El sulcus terminalis separa el seno venoso (liso) de la aurícula primitiva (pectíneos)." },
        { id: 41, original: "3", q: "¿En cuál de las siguientes cavidades drena el seno venoso o coronario?", options: ["Ventrículo derecho", "Cono arterioso", "Aurícula izquierda", "Aurícula derecha"], correct: 3, exp: "Drena en la AD." },
        { id: 42, original: "4", q: "Sobre el trígono fibroso derecho señale:", options: ["Está sobre porción membranosa tabique IV", "Se relaciona con válvulas pulmonares", "Punto de anclaje mitral solamente", "Se relaciona con el cuerpo fibroso central y anillo aórtico"], correct: 3, exp: "Conecta anillo aórtico, mitral y tricuspídeo (cuerpo fibroso central)." },
        { id: 43, original: "5", q: "Cuál afirmación acerca del pericardio seroso es incorrecta:", options: ["Parietal se une al fibroso", "Visceral se fija al miocardio", "Se divide en tres láminas", "Crea cavidad virtual"], correct: 2, exp: "Tiene dos láminas: parietal y visceral." },
        { id: 44, original: "6", q: "La arteria pericardiofrénica es rama de:", options: ["Arteria torácica interna", "Arteria vertebral", "Carótida común", "Subclavia"], correct: 0, exp: "Rama de la mamaria interna." },
        { id: 45, original: "7", q: "El nódulo sinusal o sinoauricular se encuentra situado:", options: ["Bajo trabécula papilar VD", "En porción membranosa tabique", "En la cercanía de la entrada de la vena cava superior", "Cerca seno venoso"], correct: 2, exp: "Unión VCS y AD." },
        { id: 46, original: "8", q: "El segmento atrioventricular del aparato eléctrico se sitúa:", options: ["Trabécula papilar", "Porción membranosa tabique IV (Haz His)", "Porción muscular", "Cerca VCS"], correct: 1, exp: "El Haz de His atraviesa el trígono fibroso y la porción membranosa." },
        { id: 47, original: "9", q: "El Haz de His del aparato eléctrico del corazón se sitúa:", options: ["Cerca venas pulmonares", "Atraviesa porción muscular", "Limbo fosa oval", "Atraviesa la porción membranosa del tabique interventricular"], correct: 3, exp: "Cruza la parte membranosa del tabique." },
        { id: 48, original: "10", q: "Cuál vaso arterial depende de la arteria coronaria derecha:", options: ["Circunfleja izquierda", "Marginal derecha", "Marginal izquierda", "Interventricular anterior"], correct: 1, exp: "La marginal derecha es rama de la CD." },
        { id: 49, original: "11", q: "De las siguientes cavidades cardíacas, solo una presenta una luz semilunar al corte seccional:", options: ["Ventrículo derecho", "Ventrículo izquierdo", "Aurícula derecha", "Aurícula izquierda"], correct: 0, exp: "El VD abraza al VI, dándole forma de semiluna al corte." },
        { id: 50, original: "12", q: "¿Quién inerva sensitivamente el pericardio fibroso?", options: ["Esplácnicos", "Frénico", "No inervado", "Vago"], correct: 1, exp: "El nervio frénico recoge la sensibilidad dolorosa del pericardio." },
        { id: 51, original: "13", q: "Relacione: Red de Purkinje", options: ["Subendocardio ventricular", "Trígono Koch", "Trígono fibroso"], correct: 0, exp: "Se distribuye por el subendocardio de los ventrículos." },
        { id: 52, original: "14", q: "La valva mayor de la válvula mitral se encuentra en posición:", options: ["Anterior", "Posterior", "Lateral", "Medial"], correct: 0, exp: "Repetida: Anterior." },
        { id: 53, original: "15", q: "El corazón está irrigado por las arterias:", options: ["Coronarias izquierda y anterior", "Aorta", "Coronarias derecha e izquierda", "Subclavia"], correct: 2, exp: "Repetida: Coronarias D e I." },
        { id: 54, original: "16", q: "Las arterias coronarias son ramas de:", options: ["Cayado aorta", "Pulmonar", "Aorta ascendente", "Aorta descendente"], correct: 2, exp: "Repetida: Aorta ascendente." },
        { id: 55, original: "17", q: "Los 2/3 anteriores del tabique interventricular están irrigados por:", options: ["Circunfleja", "Coronaria derecha", "Descendente anterior", "Diagonal"], correct: 2, exp: "Repetida: Descendente anterior." },
        { id: 56, original: "18", q: "EL nodo sinusal se ubica cerca de:", options: ["VCI", "VCS", "Seno venoso", "Venas pulmonares"], correct: 1, exp: "Repetida: VCS." },
        { id: 57, original: "19", q: "El nódulo auriculoventricular está ubicado en:", options: ["Crista terminalis", "Tabique interauricular (Triángulo Koch)", "Limbo fosa oval", "Músculos pectíneos"], correct: 1, exp: "Repetida: Triángulo de Koch." },
        { id: 58, original: "20", q: "El corazón:", options: ["Órgano macizo", "VD anterior a AD", "VI posterior a AI", "Aurícula derecha se relaciona directamente con el esófago (Falso, es la Izquierda)"], correct: 3, exp: "Nota: La opción correcta sobre relaciones suele ser AI con esófago." },
        { id: 59, original: "21", q: "Indique la opción correcta sobre el sistema de conducción:", options: ["Nódulo en triángulo Koch es sinoauricular (Falso, es AV)", "Haces internodales llegan bases ventriculares (Falso)", "En el nódulo auriculoventricular se produce un retraso (Cierto)", "Irriga 4 cavidades"], correct: 2, exp: "El nodo AV retrasa el impulso para permitir llenado ventricular." },
        { id: 60, original: "22", q: "El nódulo sinusal:", options: ["Es subendocárdico (subepicárdico realmente)", "Está en desembocadura VCI", "Recibe haces internodales", "Está en la cresta terminal y mide 4 cm (aprox 15mm)"], correct: 3, exp: "Está en la parte superior de la crista terminalis." },
        { id: 61, original: "23", q: "La válvula tricúspide es el orificio:", options: ["Entrada VI", "Entrada VD", "Salida VI", "Salida VD"], correct: 1, exp: "Comunica AD con VD (entrada VD)." },
        { id: 62, original: "24", q: "El aparato valvular no está formado por:", options: ["Valvas", "Músculos papilares", "Músculos pectíneos", "Anillo fibroso"], correct: 2, exp: "Los músculos pectíneos son de las aurículas, no del aparato valvular." },
        { id: 63, original: "25", q: "La parte anterior del tabique interventricular está irrigado por:", options: ["Descendente anterior", "Descendente posterior", "Circunfleja", "Coronaria derecha"], correct: 0, exp: "Repetida: Descendente anterior." },
        { id: 64, original: "26", q: "La desembocadura del seno coronario se encuentra en la aurícula derecha de la pared:", options: ["Anterior", "Posterior/Inferior", "Interna", "Externa"], correct: 1, exp: "Pared posterior/inferior (cerca del tabique)." },
        { id: 65, original: "27", q: "El haz de His inerva:", options: ["VI y AI", "Ventrículo izquierdo", "Ventrículos izquierdo y derecho", "Aurículas y ventrículos"], correct: 2, exp: "Conduce a los ventrículos." },
        { id: 66, original: "28", q: "La aurícula derecha no se relaciona con:", options: ["Tráquea", "Esófago", "Pulmón izquierdo", "Diafragma"], correct: 2, exp: "Está a la derecha. El pulmón izquierdo queda lejos." },
        { id: 67, original: "29", q: "En la tetralogía de Fallot, ¿qué defecto es el primario?", options: ["Aorta cabalgante", "CIV", "Hipertrofia VD", "Estenosis pulmonar (infundibular)"], correct: 3, exp: "La estenosis infundibular." },
        { id: 68, original: "30", q: "¿Cuál de las siguientes afirmaciones acerca del pericardio seroso es incorrecta?", options: ["Parietal se une al fibroso", "Senos pericárdicos son zonas de reflexión", "Doble lámina crea cavidad", "Visceral se fija intensamente al miocardio", "Incorrecta: Los ligamentos fijan el seroso directamente"], correct: 0, exp: "El seroso parietal se une al fibroso, el visceral al corazón." },
        { id: 69, original: "31", q: "¿Cuál de los siguientes vasos es subsidiario casi siempre de la arteria coronaria izquierda?", options: ["Interventricular posterior", "Nodo sinusal", "Arteria marginal (izquierda)", "IV anterior"], correct: 3, exp: "La IV anterior siempre es rama de la izquierda." },
        { id: 70, original: "32", q: "La arteria pericardiofrénica desciende asociada, ¿a qué estructura?", options: ["Nervio frénico", "Vena cava", "Vena hemiácigos", "Vena ácigos"], correct: 0, exp: "Acompaña al nervio frénico." },
        { id: 71, original: "33", q: "En esta porción encontramos la dilatación del seno venoso (embriológico/seno coronario):", options: ["Orejuela", "Porción vascular aurícula derecha (seno venarum)", "Cara posterior AI", "Surco IV"], correct: 1, exp: "El seno venoso embrionario forma la parte lisa de la AD." },
        { id: 72, original: "34", q: "¿Qué elemento discurre en su descenso por el borde lateral derecho del pericardio?", options: ["Esófago", "VCI", "Nervio frénico derecho", "VCS"], correct: 2, exp: "El frénico derecho baja por la derecha del pericardio." },
        { id: 73, original: "35", q: "¿Qué elemento nervioso se encarga del contingente simpático de los plexos cardíacos?", options: ["Nervios torácicos", "Esplácnicos", "Vago", "Nervios cardíacos simpáticos cervicales"], correct: 3, exp: "Repetida: Simpáticos cervicales." },
        { id: 74, original: "36", q: "Los dos tercios anteriores están vascularizados por la arteria interventricular anterior:", options: ["Aurícula izquierda", "Tabique interventricular", "Aurícula derecha", "Ventrículo izquierdo"], correct: 1, exp: "Repetida: Tabique IV." },
        { id: 75, original: "37", q: "Las almohadillas endocárdicas suponen una zona de crecimiento del mesénquima, que participa en:", options: ["Separación ventrículos", "Tabicamiento aurículas", "Separación aurícula y ventrículo primitivo (Canal AV)", "Ductus"], correct: 2, exp: "Forman los canales AV y válvulas." },
        { id: 76, original: "38", q: "Los ligamentos pericardicofrénicos fijan el centro tendinoso del diafragma con:", options: ["Mediastino", "Pulmón", "Saco pericárdico", "Tejido laxo"], correct: 2, exp: "Repetida: Saco pericárdico." },
        { id: 77, original: "39", q: "El tabicamiento espiroideo del tronco arterioso produce:", options: ["Separación ventrículos", "Tabicamiento aurículas", "Separación AV", "Formación de los grandes vasos arteriales (Aorta/Pulmonar)"], correct: 3, exp: "Separa Aorta y Pulmonar." },
        { id: 78, original: "40", q: "La comunicación entre arteria pulmonar y aorta se denomina", options: ["Ductus de Botal (Conducto arterioso)", "CIV", "CIA", "Fallot"], correct: 0, exp: "Ductus arterioso o de Botal." },
        { id: 79, original: "41", q: "Nódulo aurículo-ventricular", options: ["Cerca VCS", "Cerca tricúspide en tabique interauricular", "Bajo endotelio ventrículos", "Membranosa"], correct: 1, exp: "Triángulo de Koch." },
        { id: 80, original: "42", q: "Nódulo sinusal", options: ["Cerca VCS", "Cerca tricúspide", "Ventrículos", "Membranosa"], correct: 0, exp: "Desembocadura VCS." },
        { id: 81, original: "43", q: "Red de Purkinje", options: ["Cerca VCS", "Cerca tricúspide", "Bajo el endotelio de ambos ventrículos con una gran distribución", "Membranosa"], correct: 2, exp: "Distribución ventricular." },
        { id: 82, original: "44", q: "Haz de Hiss", options: ["Cerca VCS", "Cerca tricúspide", "Ventrículos", "Atraviesa la porción membranosa del tabique interventricular"], correct: 3, exp: "Atraviesa tabique membranoso." },
        { id: 83, original: "45", q: "Segmento atrioventricular", options: ["Cerca VCS", "Cerca tricúspide", "Ventrículos", "Membranosa", "Haz de His"], correct: 4, exp: "Sinónimo funcional o parte del Haz." },
        { id: 84, original: "46", q: "Es el principal efector del marcapasos automático del corazón", options: ["Nodo AV", "Nodo Sinusal", "Haz His", "Purkinje"], correct: 1, exp: "El nodo sinusal tiene la frecuencia más alta." },
        { id: 85, original: "47", q: "Cuando falla el elemento principal, este asume el papel de control automático", options: ["Nodo AV", "Nodo Sinusal", "Haz His", "Purkinje"], correct: 0, exp: "El nodo AV toma el mando si falla el sinusal." },
        { id: 86, original: "48", q: "De las siguientes, una no corresponde con límites del triángulo de Koch", options: ["Cresta terminal", "Ligamento Todaro", "Limbo fosa oval", "Valva septal tricúspide"], correct: 0, exp: "La cresta terminal está en la pared lateral, lejos del Koch." },
        { id: 87, original: "49", q: "Entre las estructuras que se encuentran ancladas y formando el centro fibroso del corazón, una respuesta es incorrecta.", options: ["Válvula pulmonar", "Válvula mitral", "Válvula aórtica", "Porción muscular tabique"], correct: 0, exp: "La válvula pulmonar está separada del esqueleto fibroso central por el infundíbulo." },
        { id: 88, original: "50", q: "El nódulo sinusal se encuentra situado:", options: ["Triángulo Koch", "Parte vascular porción superior cresta terminal AD", "Tabique fibroso", "Ventrículo"], correct: 1, exp: "Unión VCS y AD." },
        { id: 89, original: "51", q: "Cúal de los siguientes vasos arteriales depende de la arteria coronaria derecha", options: ["Circunfleja izq", "Marginal izq", "Interventricular ant", "Marginal derecha"], correct: 3, exp: "Marginal derecha." },
        { id: 90, original: "52", q: "Quién inerva sensitivamente el pericardio seroso parietal?", options: ["Frénico", "Esplácnicos", "No inervada", "Vago"], correct: 0, exp: "El frénico inerva la parietal." },
        { id: 91, original: "53", q: "El conducto torácico se encuentra inmediatamente por:", options: ["Delante aorta", "Detrás aorta", "Delante esófago", "Detrás vena cava"], correct: 1, exp: "Suele ir detrás/medial a la aorta en el hiato, luego asciende posterior." },
        { id: 92, original: "54", q: "Del cayado de la arteria aorta nacen las siguientes ramas:", options: ["TABC, Carótida común izq, Subclavia izq", "TABC, Carótida der, Subclavia der", "Dos troncos", "Ninguna"], correct: 0, exp: "Tronco Braquiocefálico, Carótida Común Izquierda, Subclavia Izquierda." },
        { id: 93, original: "55", q: "El nervio frénico pasa por:", options: ["Delante de la arteria subclavia", "Delante carótida", "Delante yugular", "Detrás pedículo"], correct: 0, exp: "Pasa delante de la arteria subclavia." },
        { id: 94, original: "56", q: "La vena cava superior se forma por la unión de:", options: ["Subclavia y yugular", "TBC derecho y ácigos", "Ambos troncos venosos braquiocefálicos", "TBC izq y conducto torácico"], correct: 2, exp: "Unión de TBC derecho e izquierdo." },
        { id: 95, original: "57", q: "El ventrículo derecho tiene relación con:", options: ["Pulmón derecho", "Pulmón izquierdo", "Esternón", "Arteria circunfleja"], correct: 2, exp: "Cara esternocostal (anterior)." },
        { id: 96, original: "58", q: "La punta o ápice del corazón corresponde a:", options: ["Ventrículo derecho", "Aurícula derecha", "Aurícula izquierda", "Ventrículo izquierdo"], correct: 3, exp: "Ventrículo izquierdo." },
        { id: 97, original: "59", q: "El seno coronario se encuentra en el:", options: ["Surco auriculoventricular posterior", "Surco interventricular", "Infundíbulo", "Surco IV posterior"], correct: 0, exp: "Surco AV posterior." },
        { id: 98, original: "60", q: "Entre los orificios de las dos venas cavas en la superficie externa de la aurícula derecha se encuentra:", options: ["Musculatura pectínea", "Surco terminal", "Vago", "Cresta terminal (interna)"], correct: 1, exp: "El Surco Terminal (externo) corresponde a la Cresta Terminal (interna)." },
        { id: 99, original: "61", q: "¿Cuál de los siguientes es un accidente del ventrículo derecho?", options: ["Anillo oval", "Válvula seno coronario", "Cresta supraventricular (Espolón de Wolff)", "Cresta terminal"], correct: 2, exp: "Separa la entrada y salida del VD." },
        { id: 100, original: "62", q: "En la aurícula derecha desemboca:", options: ["Venas pulmonares", "Arteria pulmonar", "Seno coronario", "Aorta"], correct: 2, exp: "Seno coronario." },
        { id: 101, original: "63", q: "La válvula mitral se ubica:", options: ["Tabique IV", "Tabique IA", "Orificio AV derecho", "Orificio AV izquierdo"], correct: 3, exp: "AV izquierdo." },
        { id: 102, original: "64", q: "La valva mayor de la válvula mitral se encuentra en posición:", options: ["Anterior", "Posterior", "Lateral", "Medial"], correct: 0, exp: "Repetida: Anterior." },
        { id: 103, original: "65", q: "El corazón esta irrigado por las arterias", options: ["Coronarias izq y ant", "Aorta", "Coronarias derecha e izquierda", "Subclavia"], correct: 2, exp: "Repetida." },
        { id: 104, original: "66", q: "Las arterias coronarias son ramas de:", options: ["Cayado", "Pulmonar", "Aorta ascendente", "Descendente"], correct: 2, exp: "Repetida." },
        { id: 105, original: "67", q: "Los 2/3 anteriores del tabique interventricular esta irrigados por la arteria:", options: ["Circunfleja", "Coronaria derecha", "Descendente anterior", "Diagonal"], correct: 2, exp: "Repetida." },
        { id: 106, original: "68", q: "El nodo sinusal se ubica cerca de la desembocadura de:", options: ["VCI", "VCS", "Seno venoso", "Pulmonares"], correct: 1, exp: "Repetida." },
        { id: 107, original: "69", q: "El nódulo auriculoventricular está ubicado en:", options: ["Crista terminalis", "Tabique IA (Triángulo Koch)", "Limbo", "Músculos pectíneos"], correct: 1, exp: "Repetida." },
        { id: 108, original: "70", q: "Un corazón trasplantado puede funcionar sin inervación extrínseca:", options: ["Sí, por automatismo nodal", "No, es falsa", "Sí, terminaciones motoras", "Fibras simpáticas"], correct: 0, exp: "El sistema de conducción es intrínseco y automático." },
        { id: 109, original: "71", q: "En la cavidad pericárdica, el seno oblicuo se relaciona con:", options: ["Surco IV anterior", "Orejuela izq", "Porción vascular AD", "La cara posterior de la aurícula izquierda"], correct: 3, exp: "Detrás de la AI." },
        { id: 110, original: "72", q: "El pericardio fibroso envuelve:", options: ["Las raíces de los ocho grandes vasos", "Bronquios", "Frénicos", "Mediastino medio"], correct: 0, exp: "Envuelve corazón y raíces vasculares." },
        { id: 111, original: "73", q: "Los nervios esplácnicos:", options: ["Nivel T6-T12", "Atraviesan pilares diafragma", "Son parasimpáticos (Falso)", "A y B", "B y C"], correct: 3, exp: "Son simpáticos y atraviesan los pilares." },
        { id: 112, original: "74", q: "Cuál de las siguientes estructuras posee una pared muscular más gruesa:", options: ["VD", "AD", "AI", "VI"], correct: 3, exp: "Repetida: Ventrículo Izquierdo." },
        { id: 113, original: "75", q: "El ápex del corazón:", options: ["Anterocaudal derecha", "Dorsocraneal izquierda", "Anterocaudal izquierda"], correct: 2, exp: "Repetida: Abajo, adelante, izquierda." },
        { id: 114, original: "76", q: "El pericardio se encuentra unido a:", options: ["Vertebras", "Diafragma", "Esternón", "Todas"], correct: 3, exp: "Repetida: Todas." },
        { id: 115, original: "77", q: "El ápex del corazón se encontraría:", options: ["5 espacio intercostal línea medioclavicular", "6 espacio", "8 espacio", "7 espacio"], correct: 0, exp: "Repetida: 5º espacio." },
        { id: 116, original: "78", q: "Como se denomina la estructura que tapiza en ocasiones el surco auriculoventricular derivada de las aurículas:", options: ["Orejuela", "Língula", "Seno", "Koch"], correct: 0, exp: "Repetida: Orejuelas." },
        { id: 117, original: "79", q: "Donde se produce el drenaje del seno venoso:", options: ["Tebesio", "Eustaquio", "Aurícula derecha", "A y C"], correct: 3, exp: "Repetida: Aurícula derecha (Válvula de Tebesio)." },
        { id: 118, original: "80", q: "En el centro fibroso del corazón cual diría usted que es la estructura más anterior:", options: ["Pulmonar", "Aórtica", "Mitral", "Tricúspide"], correct: 0, exp: "Repetida: Pulmonar." },
        { id: 119, original: "81", q: "Relacione: Válvula tricúspide", options: ["Papilares ant, post, septal", "Papilares ant, post", "Semilunares", "Coronarias"], correct: 0, exp: "Repetida." },
        { id: 120, original: "82", q: "El seno de Valsalva se encuentra en:", options: ["Pulmonar", "Aórtica", "Tricúspide", "Mitral"], correct: 1, exp: "Repetida." },
        { id: 121, original: "83", q: "El trígono anterior del centro fibroso del corazón se encuentra entre:", options: ["Pulmonar y tricúspide", "Aórtica y mitral", "Mitral, tricúspide, aórtica"], correct: 2, exp: "Repetida." },
        { id: 122, original: "84", q: "El surco terminal de His está formado externamente por la confluencia de:", options: ["VCS y orejuela/AD", "VCI y VCS", "Aorta"], correct: 0, exp: "Repetida (contexto VCS)." },
        { id: 123, original: "85", q: "El foco de auscultación pulmonar lo encontramos a nivel de:", options: ["3 espacio", "2 espacio izq", "4 espacio", "1 espacio"], correct: 1, exp: "2º espacio intercostal, línea paraesternal izquierda." },
        { id: 124, original: "86", q: "Si quisiera tomar un punto como referencia del cambio de dirección del nervio recurrente izquierdo que estructura utilizaría:", options: ["Lig pericardiofrénico", "Aorta descendente", "Ligamento de Botal (Arterioso) / Cayado Aórtico", "VCS"], correct: 2, exp: "Pasa bajo el cayado aórtico, posterior al ligamento arterioso." },
        { id: 125, original: "87", q: "Relacione: Seno oblicuo del pericardio", options: ["Venas pulmonares", "Ápex", "Hilio", "Vena cava"], correct: 0, exp: "Repetida." },
        { id: 126, original: "88", q: "La arteria interventricular anterior es rama de", options: ["Coronaria derecha", "Aorta", "Coronaria izquierda"], correct: 2, exp: "Repetida." },
        { id: 127, original: "89", q: "La vena interventricular anterior es rama de:", options: ["Menor", "Marginal", "Cava", "Mayor cardiaca (Magna)"], correct: 3, exp: "Repetida." },
        { id: 128, original: "90", q: "Relacione: Conducto arterioso de Botalli", options: ["Arteria aorta", "Duodeno", "Venas pulmonares", "Riñón"], correct: 0, exp: "Conecta la arteria pulmonar con la Aorta." },
        { id: 129, original: "91", q: "Las arterias torácicas internas:", options: ["Cara posterior triangular esternón", "Epigástricas craneales (superiores)", "Ocupan 6 primeros espacios", "Cara anterior esternón"], correct: 1, exp: "Se continúan como Epigástricas superiores." },
        { id: 130, original: "92", q: "Cuál de las siguientes afirmaciones acerca del pericardio seroso es correcta", options: ["Se fija en ápex", "Tres láminas", "Visceral se une al fibroso (Falso, es parietal)", "Visceral se fija a superficie miocardio (Epicardio)"], correct: 3, exp: "La hoja visceral es el epicardio." },
        { id: 131, original: "93", q: "La grasa visceral dispuesta sobre el corazón señale la correcta", options: ["Se dispone en los surcos auriculoventricular e interventricular", "Depende metabólico", "Sobre membranosa", "Perjudicial"], correct: 0, exp: "Sigue el trayecto de los vasos coronarios en los surcos." },
        { id: 132, original: "94", q: "Sobre el aparato eléctrico del corazón, se sitúa en la cercanía de la entrada de la vena cava superior:", options: ["Haz His", "Nódulo sinusal", "Banda moderadora", "Nodo AV"], correct: 1, exp: "Repetida." },
        { id: 133, original: "95", q: "El seno oblicuo del corazón se encuentra en:", options: ["Surco AV posterior, entrada venas pulmonares", "Ventral aorta", "Ápex", "Orejuelas"], correct: 0, exp: "Fondo de saco de Haller, tras la AI." },
        { id: 134, original: "96", q: "Sobre el aparato eléctrico del corazón, atraviesa la porción membranosa del tabique interventricular:", options: ["Nodo sinusal", "Haz de His", "Banda moderadora", "Segmento AV"], correct: 1, exp: "Haz de His." },
        { id: 135, original: "97", q: "¿Qué cavidad posee 3 músculos papilares?", options: ["AD", "VD", "AI", "VI"], correct: 1, exp: "Ventrículo Derecho (Anterior, Posterior, Septal)." },
        { id: 136, original: "98", q: "En esta cavidad drena el seno venoso:", options: ["AD", "VD", "AI", "VI"], correct: 0, exp: "Repetida: Aurícula Derecha." },
        { id: 137, original: "99", q: "Sobre el aparato eléctrico del corazón, atraviesa la porción muscular del tabique interventricular:", options: ["Nodo sinusal", "Haz His (ramas)", "Banda moderadora", "Segmento AV"], correct: 2, exp: "La banda moderadora contiene la rama derecha del Haz de His." },
        { id: 138, original: "100", q: "Sobre el ventrículo izquierdo, señale aquella afirmación correcta:", options: ["4 forámenes venas", "Pared gruesa, 2 músculos papilares", "Drena seno venoso", "3 músculos papilares"], correct: 1, exp: "Pared gruesa y papilares anterior/posterior." },
        { id: 139, original: "101", q: "El tabicamiento entre aurículas (señale la opción correcta):", options: ["Comunica cono-ventrículo", "Cierra semana 8", "Trígono Koch", "Se organiza por el septum primum y el septum secundum"], correct: 3, exp: "Repetida." },
        { id: 140, original: "102", q: "Quién inerva sensitivamente el pericardio fibroso:", options: ["Vago", "Esplácnicos", "Frénico", "No inervado"], correct: 2, exp: "Repetida: Frénico." },
        { id: 141, original: "103", q: "Sobre la aurícula derecha, señale la correcta:", options: ["4 forámenes", "El surco terminal limita las porciones vascular (lisa) y muscular (pectínea)", "Toda pectíneos", "2/3 irrigados IV ant"], correct: 1, exp: "Repetida." },
        { id: 142, original: "104", q: "El cayado de la aorta se relaciona con:", options: ["Mediastino superior", "Anterior", "Posterior", "Medio"], correct: 0, exp: "Está en el mediastino superior." },
        { id: 143, original: "105", q: "La vena ácigos:", options: ["Desemboca hemiácigos accesoria", "Forma cayado sobre bronquio derecho", "Asciende a la izquierda", "Mediastino medio"], correct: 1, exp: "El cayado de la ácigos cabalga el pedículo pulmonar derecho." },
        { id: 144, original: "106", q: "El mediastino es el espacio comprendido entre:", options: ["Pulmones", "Costillas", "Pleura parietal (mediastínica)", "Pleura visceral"], correct: 2, exp: "Repetida." },
        { id: 145, original: "107", q: "El mediastino medio o visceral:", options: ["Cadena simpática", "Recurrente", "Esófago", "Corazón y grandes vasos"], correct: 3, exp: "Repetida." },
        { id: 146, original: "108", q: "Del cayado (arco) de la arteria aorta nacen las siguientes ramas:", options: ["TABC, Carótida común izq, Subclavia izq", "Otras combinaciones incorrectas"], correct: 0, exp: "Repetida." },
        { id: 147, original: "109", q: "El nervio frénico pasa por:", options: ["Delante subclavia", "Delante carótida", "Delante yugular", "Detrás pedículo"], correct: 0, exp: "Repetida." },
        { id: 148, original: "110", q: "La vena cava superior se forma por la unión de:", options: ["Subclavia y yugular", "TBC der y ácigos", "Ambos troncos venosos braquiocefálicos", "Otros"], correct: 2, exp: "Repetida." },
        { id: 149, original: "111", q: "Relaciones: Nódulo Sinusal", options: ["Triángulo Koch", "Marcapasos natural", "Paredes corazón", "Hilio"], correct: 1, exp: "Es el marcapasos natural." },
        { id: 150, original: "112", q: "Cual de las siguientes estructuras es más caudal:", options: ["Válvula Tebesio", "Válvula Eustaquio (VCI)", "Lig arterioso", "Cayado", "Vena cava inferior (entrada)"], correct: 4, exp: "La VCI entra por abajo (caudal)." },
        { id: 151, original: "113", q: "Sobre el ventrículo izquierdo, señale aquella afirmación correcta", options: ["4 forámenes", "Pared gruesa, 2 papilares", "3 papilares", "Seno venoso"], correct: 1, exp: "Repetida." },
        { id: 152, original: "114", q: "Quien inerva sensitivamente el pericardio fibroso", options: ["No inervada", "Vago", "Frénico", "Esplácnicos"], correct: 2, exp: "Repetida." },
        { id: 153, original: "115", q: "La comunicación postnatal entre la arteria pulmonar izquierda y la aorta... se denomina", options: ["CIV", "Fallot", "Ductus persistente de Botal", "Situs inversus"], correct: 2, exp: "Ductus." },
        { id: 154, original: "116", q: "Las orejuelas se corresponden con la porción avascular de qué cavidad", options: ["Cayado", "Aurícula (izquierda/derecha)", "Ventrículo", "Cayado"], correct: 1, exp: "Son partes de las aurículas." },
        { id: 155, original: "117", q: "El cono de eyección: señale la correcta", options: ["Ápex", "Porción lisa salida VD (Infundíbulo)", "Anclaje válvulas", "Nodo sinusal"], correct: 1, exp: "Es la salida del Ventrículo Derecho (Infundíbulo)." },
        { id: 156, original: "88", q: "De las siguientes relaciones del esófago en el mediastino posterior, una es incorrecta:", options: ["Aorta torácica", "Cara posterobasal corazón (AI)", "Nervios vagos", "Bronquio principal izquierdo (Relación anterior)", "Bronquio principal derecho (Menos directa que el izq)"], correct: 4, exp: "El esófago se relaciona más íntimamente con el bronquio izquierdo y la aurícula izquierda." },
        { id: 157, original: "7", q: "La língula se relaciona sobre:", options: ["Esófago", "Mediastino anterior", "Superficie esternocostal del corazón (Ápex)", "Pulmón derecho"], correct: 2, exp: "Cubre el ápex cardíaco." },
        { id: 158, original: "10", q: "Los ligamentos pericardicofrénicos fijan el centro tendinoso del diafragma con:", options: ["Pulmón", "Mediastino", "Saco pericárdico", "Tejido laxo"], correct: 2, exp: "Repetida." },
        { id: 159, original: "13", q: "Cuando falla el elemento principal éste asume el papel de control automático", options: ["Nodo AV", "Sinusal", "His", "Segmento AV"], correct: 0, exp: "Repetida." },
        { id: 160, original: "Extra", q: "Segmento atrioventricular", options: ["Cerca VCS", "Cerca tricúspide", "Ventrículos", "Atraviesa porción membranosa tabique IV"], correct: 3, exp: "Repetida." },
        { id: 161, original: "Extra", q: "Tabique interventricular", options: ["3 papilares", "4 forámenes", "2/3 anteriores vascularizados IV anterior", "Seno venoso"], correct: 2, exp: "Repetida." },
        { id: 162, original: "2", q: "Los ligamentos pericardicofrénicos fijan el centro tendinoso del diafragma y", options: ["Saco pericárdico", "Mediastino post", "Mediastino sup", "Mediastino ant"], correct: 0, exp: "Repetida." },
        { id: 163, original: "3", q: "La confluencia de los nervios simpáticos cardiacos cervicales y ramos vagales organizan:", options: ["Nervios torácicos", "Plexo cardiaco anterior/profundo (Plexos cardíacos)", "Plexos mediastínicos", "Esplácnico"], correct: 1, exp: "Forman el Plexo Cardíaco." },
        { id: 164, original: "4", q: "Sobre el aparato eléctrico del corazón, se relaciona bajo el espesor de la trabécula del músculo papilar anterior del ventrículo derecho:", options: ["Nodo AV", "Banda moderadora (Rama derecha His)", "Nodo sinusal", "Segmento AV"], correct: 1, exp: "La banda moderadora lleva la rama derecha." },
        { id: 165, original: "5", q: "En el corazón primitivo, la sangre que procede de bulbus cordi pasa al:", options: ["Aurícula", "Seno venoso", "Cono arterioso (es lo mismo)", "Ventrículo primitivo", "Sacos aórticos/Arcos"], correct: 4, exp: "Del Bulbus Cordis sale hacia el tronco arterioso/arcos aórticos." },
        { id: 166, original: "6", q: "El frénico derecho pasa:", options: ["Retrohiliar", "Entre borde derecho corazón (pericardio) y pleura mediastínica", "Entre parietal y mediastino anterior", "Entre pleura y cara posterobasal"], correct: 1, exp: "Baja lateral al pericardio derecho." },
        { id: 167, original: "7", q: "Sobre las cuerdas tendinosas, una afirmación es incorrecta:", options: ["Se originan valvas", "Extienden cavidad auricular (Incorrecta, están en ventrículos)", "Fibrosas", "Insertan papilares"], correct: 1, exp: "Están en los ventrículos, no en las aurículas." },
        { id: 168, original: "5", q: "Cuál de las siguientes afirmaciones acerca del pericardio seroso es incorrecta:", options: ["Visceral fija miocardio", "Doble lámina fija ápex con ligamentos (Falso)", "Dos láminas", "Parietal une fibroso"], correct: 1, exp: "Repetida." },
        { id: 169, original: "6", q: "La comunicación postnatal entre la arteria pulmonar izquierda y la aorta... se denomina:", options: ["CIV", "Situs", "Ductus persistente", "Fallot"], correct: 2, exp: "Repetida." },
        { id: 170, original: "7", q: "Cuál de los siguientes vasos arteriales depende de la arteria coronaria derecha:", options: ["Marginal derecha", "IV anterior", "Circunfleja", "Marginal izq"], correct: 0, exp: "Repetida." },
        { id: 171, original: "8", q: "Sobre el trigono fibroso derecho señale la correcta:", options: ["Sobre porción membranosa tabique", "Anclaje mitral", "Anillo aórtico", "Válvulas pulmonares"], correct: 0, exp: "Repetida." },
        { id: 172, original: "9", q: "El haz de His del aparato eléctrico del corazón se sitúa:", options: ["Limbo", "Muscular", "Venas pulmonares", "Atraviesa porción membranosa"], correct: 3, exp: "Repetida." }
    ];

    let currentQuestions = [...dbQuestions];
    let markedIds = new Set();
    let userAnswers = {};

    function shuffle(array) {
        return array.sort(() => Math.random() - 0.5);
    }

    function renderQuiz() {
        const list = document.getElementById('questions-list');
        const nav = document.getElementById('sidebar-nav');
        const resultsPanel = document.getElementById('results-panel');
        
        list.innerHTML = '';
        nav.innerHTML = '';
        resultsPanel.style.display = 'none';

        if(currentQuestions.length === 0) {
            list.innerHTML = `<div class="question-card"><p>No hay preguntas para los criterios seleccionados.</p></div>`;
            return;
        }

        currentQuestions.forEach((q, index) => {
            const btn = document.createElement('a');
            btn.href = `#q-${q.id}`;
            btn.className = 'nav-btn';
            btn.innerText = index + 1;
            btn.id = `nav-btn-${q.id}`;
            
            if (userAnswers[q.id] === true) btn.classList.add('correct');
            if (userAnswers[q.id] === false) btn.classList.add('incorrect');
            if (markedIds.has(q.id)) btn.classList.add('marked');

            nav.appendChild(btn);

            const card = document.createElement('div');
            card.className = 'question-card';
            card.id = `q-${q.id}`;

            const originalOptions = q.options.map((text, i) => ({ text, isCorrect: i === q.correct }));
            const finalOptions = shuffle(originalOptions);

            let optionsHTML = '';
            finalOptions.forEach(opt => {
                const safeText = opt.text.replace(/'/g, "&#39;"); 
                optionsHTML += `<button class="option-btn" onclick="handleAnswer(${q.id}, ${opt.isCorrect}, this)">${opt.text}</button>`;
            });

            const isMarked = markedIds.has(q.id);

            card.innerHTML = `
                <div class="question-header-row">
                    <span>Pregunta ${index + 1} (Ref: ${q.original})</span>
                    <button class="bookmark-btn ${isMarked ? 'active' : ''}" onclick="toggleMark(${q.id}, this)">
                        ${isMarked ? '★ Marcada' : '☆ Marcar'}
                    </button>
                </div>
                <div class="question-text">${q.q}</div>
                <div class="options-grid" id="opts-${q.id}">
                    ${optionsHTML}
                </div>
                <div class="feedback" id="feed-${q.id}"></div>
            `;
            list.appendChild(card);
        });
        updateProgress();
    }

    function handleAnswer(id, isCorrect, btn) {
        if (userAnswers.hasOwnProperty(id)) return;
        
        userAnswers[id] = isCorrect;
        const navBtn = document.getElementById(`nav-btn-${id}`);
        const feedback = document.getElementById(`feed-${id}`);
        const container = document.getElementById(`opts-${id}`);
        const qData = dbQuestions.find(x => x.id === id);

        const allBtns = container.querySelectorAll('.option-btn');
        allBtns.forEach(b => {
            b.classList.add('disabled');
            b.onclick = null;
            const correctText = qData.options[qData.correct];
            if (b.innerText === correctText) b.classList.add('correct');
        });

        if (isCorrect) {
            feedback.innerHTML = `<strong>¡Correcto!</strong><br>${qData.exp}`;
            feedback.className = 'feedback success show';
            if(navBtn) navBtn.classList.add('correct');
        } else {
            btn.classList.add('incorrect');
            feedback.innerHTML = `<strong>Incorrecto.</strong><br>${qData.exp}`;
            feedback.className = 'feedback error show';
            if(navBtn) navBtn.classList.add('incorrect');
        }
        updateProgress();
    }

    function toggleMark(id, btn) {
        const navBtn = document.getElementById(`nav-btn-${id}`);
        if (markedIds.has(id)) {
            markedIds.delete(id);
            btn.innerHTML = '☆ Marcar';
            btn.classList.remove('active');
            if(navBtn) navBtn.classList.remove('marked');
        } else {
            markedIds.add(id);
            btn.innerHTML = '★ Marcada';
            btn.classList.add('active');
            if(navBtn) navBtn.classList.add('marked');
        }
    }

    function updateProgress() {
        const count = Object.keys(userAnswers).length;
        const total = currentQuestions.length;
        document.getElementById('progress-text').innerText = `${count}/${total}`;
        
        if (count === total && total > 0) {
            showResults(false);
        }
    }

    function showResults(manualFinish = false) {
        const panel = document.getElementById('results-panel');
        let correct = 0;
        Object.values(userAnswers).forEach(v => { if(v) correct++; });
        
        // Si se finaliza manualmente, el total son las preguntas cargadas, no solo las respondidas
        // Las no respondidas cuentan como fallo implícito para el score, pero no se añaden a 'wrong' para repetir
        const total = currentQuestions.length;
        
        document.getElementById('score-text').innerText = `Has acertado ${correct} de ${total}`;
        panel.style.display = 'block';
        
        if(manualFinish) {
            panel.scrollIntoView({ behavior: 'smooth' });
        } else {
            // Auto scroll solo si se completó naturalmente
            setTimeout(() => panel.scrollIntoView({ behavior: 'smooth' }), 100);
        }
    }

    function resetQuiz(mode) {
        let nextIds = [];

        // Logic fix: Grab IDs based on CURRENT state before clearing
        if (mode === 'all') {
            nextIds = dbQuestions.map(q => q.id);
        } else if (mode === 'wrong') {
            // Solo las que están explícitamente MAL en userAnswers
            nextIds = Object.keys(userAnswers).filter(id => userAnswers[id] === false).map(Number);
        } else if (mode === 'marked') {
            nextIds = Array.from(markedIds);
        } else if (mode === 'wrong_marked') {
            const wrong = Object.keys(userAnswers).filter(id => userAnswers[id] === false).map(Number);
            const marked = Array.from(markedIds);
            nextIds = [...new Set([...wrong, ...marked])];
        }

        if (nextIds.length === 0) {
            alert("No hay preguntas para los criterios seleccionados.");
            return;
        }

        // Reset
        userAnswers = {};
        currentQuestions = dbQuestions.filter(q => nextIds.includes(q.id));
        renderQuiz();
        document.querySelector('.main-content').scrollTop = 0;
    }

    renderQuiz();
</script>
</body>
</html>