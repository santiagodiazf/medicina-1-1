<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Bloque X: Informaci√≥n Gen√©tica</title>
    <style>
        :root {
            --primary: #059669; /* Verde Esmeralda */
            --primary-dark: #047857;
            --primary-light: #d1fae5;
            --bg: #f0fdf4;
            --text: #1f2937;
            --white: #ffffff;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg);
            color: var(--text);
            max-width: 850px;
            margin: 0 auto;
            padding: 20px;
        }

        h1 {
            text-align: center;
            color: var(--primary-dark);
            margin-bottom: 10px;
            border-bottom: 3px solid var(--primary);
            padding-bottom: 15px;
            display: inline-block;
            width: 100%;
        }

        .question-card {
            background: var(--white);
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            border-left: 6px solid var(--primary);
            transition: transform 0.2s, box-shadow 0.2s;
            position: relative;
        }

        .question-card:hover {
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        }

        /* --- Checkbox para Marcar --- */
        .mark-container {
            display: flex;
            align-items: center;
            justify-content: flex-end;
            margin-bottom: 15px;
            font-size: 0.9em;
            color: var(--primary);
            font-weight: bold;
            border-bottom: 1px solid #e5e7eb;
            padding-bottom: 10px;
        }
        .mark-container input {
            margin-right: 8px;
            transform: scale(1.3);
            cursor: pointer;
            accent-color: var(--primary);
        }
        .mark-container label {
            cursor: pointer;
        }

        .question-header {
            font-size: 0.85em;
            color: #059669;
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 1px;
            font-weight: bold;
        }

        .question-text {
            font-weight: 700;
            font-size: 1.15em;
            margin-bottom: 20px;
            color: #111827;
            line-height: 1.5;
        }

        /* Etiquetas para diagramas */
        .img-tag {
            display: block;
            margin-top: 12px;
            padding: 10px;
            background-color: #ecfdf5;
            border-left: 4px solid #34d399;
            color: #065f46;
            font-size: 0.9em;
            font-style: italic;
            border-radius: 0 4px 4px 0;
        }

        .options-container {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .option-btn {
            padding: 14px 18px;
            border: 2px solid #e5e7eb;
            background: #fff;
            border-radius: 8px;
            cursor: pointer;
            text-align: left;
            transition: all 0.2s;
            font-size: 1em;
            color: #374151;
            position: relative;
        }

        .option-btn:hover:not(:disabled) {
            background-color: var(--primary-light);
            border-color: var(--primary);
            color: var(--primary-dark);
            padding-left: 25px; /* Efecto desplazamiento */
        }

        .option-btn:disabled {
            cursor: default;
            opacity: 0.7;
        }

        /* Estados de respuesta */
        .correct {
            background-color: #d1fae5 !important;
            border-color: #10b981 !important;
            color: #064e3b !important;
            font-weight: 600;
        }

        .incorrect {
            background-color: #fee2e2 !important;
            border-color: #ef4444 !important;
            color: #7f1d1d !important;
        }

        /* Caja de Explicaci√≥n */
        .explanation {
            margin-top: 20px;
            padding: 15px;
            background-color: #f0fdfa;
            border-left: 5px solid var(--primary);
            border-radius: 6px;
            display: none;
            font-size: 0.95em;
            color: #134e4a;
            animation: slideDown 0.3s ease-out;
        }
        .explanation.visible {
            display: block;
        }
        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* --- √Årea de Controles --- */
        #controls-area {
            margin-top: 50px;
            text-align: center;
            padding: 30px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 -4px 20px rgba(0,0,0,0.05);
            border-top: 5px solid var(--primary);
        }

        .action-btn {
            background: var(--primary); color: white; border: none;
            padding: 12px 25px; font-size: 1.05em; border-radius: 8px;
            cursor: pointer; margin: 8px;
            transition: background 0.3s, transform 0.2s;
            font-weight: 600;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .action-btn:hover { 
            background: var(--primary-dark);
            transform: translateY(-2px);
        }
        
        .restart-options {
            display: none;
            flex-direction: column;
            gap: 12px;
            margin-top: 25px;
            max-width: 400px;
            margin-left: auto;
            margin-right: auto;
        }
        .restart-options button {
            width: 100%;
            background: #4b5563;
        }
        .restart-options button:hover { background: #1f2937; }
        .restart-options button:first-child { background: var(--primary); }

    </style>
</head>
<body>

    <h1>Informaci√≥n Gen√©tica</h1>
    <div style="text-align: center; color: #4b5563; margin-bottom: 30px;">
        1¬∫ Medicina UCA | Replicaci√≥n, Transcripci√≥n y Traducci√≥n
    </div>
    
    <div id="quiz-container"></div>

    <div id="controls-area">
        <button id="finish-btn" class="action-btn" onclick="showEndOptions()">üèÅ Finalizar revisi√≥n</button>
        
        <div id="restart-menu" class="restart-options">
            <h3>Resultados de la sesi√≥n</h3>
            <p id="stats-summary"></p>
            <button class="action-btn" onclick="restartQuiz('all')">üîÑ Rehacer todo el test</button>
            <button class="action-btn" onclick="restartQuiz('marked')">üîñ Repasar marcadas</button>
            <button class="action-btn" onclick="restartQuiz('failed')">‚ùå Repasar falladas</button>
            <button class="action-btn" onclick="restartQuiz('failed_marked')">‚ö†Ô∏è Falladas + Marcadas</button>
        </div>
    </div>

<script>
    // Datos convertidos al formato est√°ndar
    const quizData = [
        { 
            q: "1. En la s√≠ntesis de DNA:", 
            opts: ["Se necesitan desoxinucle√≥tidos monofosfato para elongar la cadena.", "No es necesario que haya un √°cido nucleico que act√∫e como cebador.", "El sentido de la elongaci√≥n de la cadena es 3‚Äô‚Üí5‚Äô.", "En eucariotas intervienen 3 RNA polimerasas en el proceso de inicio.", "Las DNA polimerasas tienen actividad exonucleasa 3‚Äô‚Üí5‚Äô."], 
            a: "Las DNA polimerasas tienen actividad exonucleasa 3‚Äô‚Üí5‚Äô.", 
            exp: "Las DNA polimerasas a√±aden desoxinucle√≥tidos trifosfato y corrigen errores gracias a su actividad exonucleasa 3'‚Üí5' (proofreading)." 
        },
        { 
            q: "2. El RNA mensajero de eucariotas:", 
            opts: ["Sufre una poliadenilaci√≥n en el extremo 5‚Äô.", "Es procesado de modo que conserva todos sus intrones.", "Sufre modificaciones en sus extremos 5‚Äô y 3‚Äô.", "No se modifica.", "Se modifica solamente en el extremo 3‚Äô."], 
            a: "Sufre modificaciones en sus extremos 5‚Äô y 3‚Äô.", 
            exp: "El mRNA eucariota madura con la adici√≥n de un caperuz√≥n (Cap 5‚Äô) y una cola poli-A en 3‚Äô, adem√°s del splicing." 
        },
        { 
            q: "3. Indique la respuesta FALSA respecto a la informaci√≥n gen√©tica:", 
            opts: ["Topoisomerasa, helicasa, ADN polimerasa y primasa son enzimas implicadas en la replicaci√≥n del ADN.", "La caja TATA es un elemento de control com√∫n de inicio de la transcripci√≥n.", "Las telomerasas intervienen en la uni√≥n de los fragmentos de Okazaki.", "El cod√≥n AUG en el mRNA marca el inicio de la traducci√≥n.", "El CRE es un elemento de respuesta espec√≠fico que promueve la transcripci√≥n."], 
            a: "Las telomerasas intervienen en la uni√≥n de los fragmentos de Okazaki.", 
            exp: "Falso. Las telomerasas alargan los tel√≥meros. La uni√≥n de los fragmentos de Okazaki la realiza la DNA ligasa." 
        },
        { 
            q: "4. En relaci√≥n con la entrada en la fase S del ciclo celular (replicaci√≥n del DNA):", 
            opts: ["La prote√≠na del retinoblastoma es activadora del inicio de la fase S.", "La activaci√≥n de la prote√≠na CDK4 es independiente de se√±ales mitog√©nicas extracelulares.", "La prote√≠na CDK2 fosforila a la prote√≠na E2F.", "La prote√≠na E2F act√∫a como factor de transcripci√≥n de genes necesarios para el inicio de la fase S.", "Ninguna de las anteriores es correcta."], 
            a: "La prote√≠na E2F act√∫a como factor de transcripci√≥n de genes necesarios para el inicio de la fase S.", 
            exp: "E2F es un factor de transcripci√≥n clave que, al liberarse de Rb, activa genes necesarios para la s√≠ntesis de DNA." 
        },
        { 
            q: "5. ¬øCu√°l de las siguientes afirmaciones sobre las DNA polimerasas de E. coli es correcta?", 
            opts: ["Las polimerasas I y III requieren a la vez un cebador y un molde.", "Todas las polimerasas tienen a la vez actividad exonucleol√≠tica de 3‚Äô a 5‚Äô y de 5‚Äô a 3‚Äô.", "La funci√≥n principal de la DNA polimerasa III es la reparaci√≥n del DNA.", "La polimerasa I tiende a permanecer unida al molde hasta que se ha a√±adido un n√∫mero grande de nucle√≥tidos.", "En E. coli se han descrito 7 DNA polimerasas distintas."], 
            a: "Las polimerasas I y III requieren a la vez un cebador y un molde.", 
            exp: "Todas las DNA polimerasas conocidas requieren un molde de DNA y un cebador con un extremo 3‚Äô-OH libre." 
        },
        { 
            q: "6. La prote√≠na p53:", 
            opts: ["Es defosforilada cuando se produce da√±o en el DNA.", "Impide la entrada en la fase S cuando el DNA no est√° da√±ado.", "Es un oncog√©n.", "Es una prote√≠na supresora de tumores.", "No tiene ninguna relaci√≥n con la formaci√≥n de tumores."], 
            a: "Es una prote√≠na supresora de tumores.", 
            exp: "p53 es el 'guardi√°n del genoma', un supresor tumoral que detiene el ciclo celular o induce apoptosis ante da√±o en el DNA." 
        },
        { 
            q: "7. Qu√© respuesta es FALSA respecto al espliceosoma:", 
            opts: ["Est√° formado por snRNP (peque√±as part√≠culas de retrotranscriptasas nucleares unidas a prote√≠nas).", "Se encarga de la maduraci√≥n del hnRNA.", "Corta intrones y empalma exones.", "Tiene actividad ribozima.", "Lo constituyen cinco subunidades de snRNA unidas a prote√≠nas."], 
            a: "Est√° formado por snRNP (peque√±as part√≠culas de retrotranscriptasas nucleares unidas a prote√≠nas).", 
            exp: "Falso. Los snRNP contienen 'Ribonucleoprote√≠nas nucleares peque√±as', no retrotranscriptasas." 
        },
        { 
            q: "8. Qu√© es cierto respecto al CRE:", 
            opts: ["Es un factor de transcripci√≥n.", "Es un elemento de respuesta al AMPc.", "Se activa por glucag√≥n.", "Est√° en la regi√≥n promotora del gen de la PEPCK.", "Estimula la neoglucog√©nesis."], 
            a: "Es un elemento de respuesta al AMPc.", 
            exp: "CRE (cAMP Response Element) es una secuencia de DNA que responde a niveles de AMPc." 
        },
        { 
            q: "9. Indique la respuesta FALSA respecto a la informaci√≥n gen√©tica (Repetida):", 
            opts: ["Topoisomerasa, helicasa, ADN polimerasa y primasa son enzimas implicadas en la replicaci√≥n del ADN.", "La caja TATA es un elemento de control com√∫n de inicio de la transcripci√≥n.", "El espliceosoma tiene actividad ribozima y se encarga de alargar los tel√≥meros.", "El cod√≥n AUG en el mRNA marca el inicio de la traducci√≥n.", "El CRE es un elemento de respuesta espec√≠fico que promueve la transcripci√≥n."], 
            a: "El espliceosoma tiene actividad ribozima y se encarga de alargar los tel√≥meros.", 
            exp: "Falso. El espliceosoma elimina intrones (splicing), no alarga tel√≥meros (telomerasa)." 
        },
        { 
            q: "10. Sea una enzima de restricci√≥n tipo II que reconoce una secuencia en el DNA de 5 pares de bases. ¬øQu√© afirmaci√≥n es correcta?", 
            opts: ["El enzima cortar√° el DNA cada 1024 pares (promedio estad√≠stico).", "El enzima, al ser tipo II, corta en una secuencia espec√≠fica de DNA diferente a la que reconoce.", "El enzima genera fragmentos de 1024 pares de bases de longitud media.", "El enzima tiene una frecuencia de corte mayor a otra que reconozca 4 pares de bases."], 
            a: "El enzima cortar√° el DNA cada 1024 pares (promedio estad√≠stico).", 
            exp: "Estad√≠sticamente, una secuencia de 5 bases aparece cada 4^5 = 1024 pares de bases." 
        },
        { 
            q: "11. En relaci√≥n a la metilaci√≥n del DNA, indica cu√°l es FALSA:", 
            opts: ["Mayor metilaci√≥n en las islas CpG se asocia a fen√≥menos de expresi√≥n o sobreexpresi√≥n de un gen dado.", "Se produce en zonas promotoras ricas en secuencias de CpG.", "La metilaci√≥n se asocia con la regulaci√≥n de genes supresores de tumores.", "Se produce mayoritariamente sobre la H3."], 
            a: "Mayor metilaci√≥n en las islas CpG se asocia a fen√≥menos de expresi√≥n o sobreexpresi√≥n de un gen dado.", 
            exp: "Falso. La hipermetilaci√≥n de islas CpG en promotores generalmente SILENCIA (reprime) la expresi√≥n g√©nica." 
        },
        { 
            q: "12. Identifica qu√© afirmaci√≥n es INCORRECTA:", 
            opts: ["La RNA polimerasa puede presentar actividad 3¬¥-5¬¥ exonucleasa.", "La DNA polimerasa I tiene actividad exonucleasa 5¬¥ - 3¬¥.", "La replicaci√≥n es un proceso semiconservativo universalmente.", "La fidelidad del proceso replicativo se explica exclusivamente por la complementariedad de las bases."], 
            a: "La fidelidad del proceso replicativo se explica exclusivamente por la complementariedad de las bases.", 
            exp: "Falso. La fidelidad tambi√©n depende de la actividad correctora de pruebas (exonucleasa 3'-5') y los sistemas de reparaci√≥n." 
        },
        { 
            q: "13. Identifica la afirmaci√≥n correcta en relaci√≥n a una mol√©cula de mRNA eucariota o procariota:", 
            opts: ["Siempre produce una prote√≠na.", "Une factores de transcripci√≥n.", "Nunca puede producir ADN.", "Tiene direccionalidad, con un extremo 5¬¥ y otro 3¬¥."], 
            a: "Tiene direccionalidad, con un extremo 5¬¥ y otro 3¬¥.", 
            exp: "Todos los √°cidos nucleicos (DNA y RNA) tienen polaridad definida 5' -> 3'." 
        },
        { 
            q: "14. Un polinucle√≥tido es un pol√≠mero en el que:", 
            opts: ["Existen al menos 20 clases diferentes de mon√≥meros susceptibles de ser utilizados.", "Las bases p√∫ricas y pirimid√≠nicas son las unidades repetitivas.", "Las unidades monom√©ricas est√°n unidas por enlace fosfodi√©ster.", "Las unidades monom√©ricas no se pueden separar por hidr√≥lisis.", "Los dos extremos son estructuralmente equivalentes."], 
            a: "Las unidades monom√©ricas est√°n unidas por enlace fosfodi√©ster.", 
            exp: "El esqueleto del DNA/RNA se forma mediante enlaces fosfodi√©ster entre el 3'-OH de un az√∫car y el 5'-fosfato del siguiente." 
        },
        { 
            q: "15. En una doble h√©lice de DNA:", 
            opts: ["La parte externa de la h√©lice no est√° cargada.", "La adenina de una hebra forma puentes de hidr√≥geno con la timina de la hebra opuesta.", "Los puentes de hidr√≥geno se forman entre bases p√∫ricas y pirimid√≠nicas de la misma hebra.", "Los enlaces fosfodi√©ster est√°n orientados hacia el interior de la h√©lice.", "Las hebras individuales no son helicoidales."], 
            a: "La adenina de una hebra forma puentes de hidr√≥geno con la timina de la hebra opuesta.", 
            exp: "Principio de complementariedad de Watson-Crick: A se aparea con T mediante 2 puentes de hidr√≥geno." 
        },
        { 
            q: "16. Un nucleosoma:", 
            opts: ["Utiliza un solo tipo de histona por nucleosoma.", "Tiene un n√∫cleo de DNA con prote√≠nas que lo envuelven.", "Tiene histonas en contacto con el surco mayor del DNA.", "Es una estructura regularmente repetida de DNA e histonas.", "Est√° separada de un segundo nucleosoma por prote√≠nas no histonas."], 
            a: "Es una estructura regularmente repetida de DNA e histonas.", 
            exp: "El nucleosoma es la unidad b√°sica de la cromatina: ~146 pb de DNA enrollado sobre un oct√°mero de histonas." 
        },
        { 
            q: "17. La h√©lice de la forma A del DNA difiere de la h√©lice B en todo lo siguiente EXCEPTO:", 
            opts: ["La apariencia de los surcos mayor y menor.", "La polaridad de las cadenas.", "La pendiente de las bases.", "La inclinaci√≥n de los pares de bases respecto al eje de la h√©lice.", "El grosor de la h√©lice."], 
            a: "La polaridad de las cadenas.", 
            exp: "Tanto en la forma A como en la B, las cadenas son antiparalelas." 
        },
        { 
            q: "18. El RNA:", 
            opts: ["No puede formar pares de bases del tipo Watson y Crick.", "No puede tener nunca estructura de doble h√©lice.", "Presenta apilamiento de bases y pares de bases unidos por puentes de hidr√≥geno.", "Incorpora bases p√∫ricas y pirimid√≠nicas modificadas y no modificadas durante la transcripci√≥n.", "Normalmente contiene unos 65 - 100 nucle√≥tidos."], 
            a: "Presenta apilamiento de bases y pares de bases unidos por puentes de hidr√≥geno.", 
            exp: "El RNA suele ser monocatenario pero forma estructuras secundarias (horquillas, bucles) mediante apareamiento de bases intracadena." 
        },
        { 
            q: "19. La replicaci√≥n:", 
            opts: ["Utiliza una actividad polimerasa de 5¬¥ a 3¬¥ para sintetizar una hebra y de 3¬¥ a 5¬¥ para sintetizar la hebra complementaria.", "Debe empezar un paso de escisi√≥n.", "S√≥lo requiere prote√≠nas con actividad DNA polimerasa.", "Es semiconservadora.", "Requiere un cebador en los eucariotas pero no en los procariotas."], 
            a: "Es semiconservadora.", 
            exp: "Cada mol√©cula hija de DNA conserva una hebra 'vieja' (molde) y una hebra 'nueva' reci√©n sintetizada." 
        },
        { 
            q: "20. En la replicaci√≥n del DNA en los eucariotas:", 
            opts: ["El proceso tiene lugar a lo largo de todo el ciclo celular.", "La helicasa se disocia del DNA tan pronto se forma la burbuja de iniciaci√≥n.", "Al menos una DNA polimerasa tiene actividad exonucleot√≠dica de 3¬¥ a 5¬¥.", "S√≥lo se forma un replisoma porque hay UN solo origen de replicaci√≥n.", "Los fragmentos de Okazaki tienen 1000-2000 nucle√≥tidos de longitud."], 
            a: "Al menos una DNA polimerasa tiene actividad exonucleot√≠dica de 3¬¥ a 5¬¥.", 
            exp: "Esta actividad es esencial para la correcci√≥n de pruebas (proofreading) y asegurar la fidelidad." 
        },
        { 
            q: "21. Los requisitos para la s√≠ntesis proteica en eucariotas incluyen todos los siguientes EXCEPTO:", 
            opts: ["20 Aa diferentes en forma de aminoacil - tRNA.", "fMet - tRNA.", "GTP.", "mRNA.", "Ribosoma."], 
            a: "fMet - tRNA.", 
            exp: "El fMet-tRNA (formil-metionina) es exclusivo de PROCARIOTAS (y mitocondrias). Eucariotas usan Met-tRNA." 
        },
        { 
            q: "22. La degeneraci√≥n del c√≥digo gen√©tico denota la existencia de:", 
            opts: ["Tripletes de bases que no codifican ning√∫n Aa.", "Codones m√∫ltiples para un solo Aa.", "Codones compuestos por tan solo dos bases.", "Diferentes sistemas de s√≠ntesis de prote√≠nas en los que un determinado triplete codifica Aa diferentes.", "Codones que incorporan una o m√°s bases 'inusuales'."], 
            a: "Codones m√∫ltiples para un solo Aa.", 
            exp: "Degeneraci√≥n significa redundancia: varios codones diferentes pueden codificar el mismo amino√°cido." 
        },
        { 
            q: "23. Durante la fase de elongaci√≥n de la s√≠ntesis proteica eucariota:", 
            opts: ["El p√©ptido se separa del tRNA y se traslada al sitio E del ribosoma.", "El aminoacil-tRNA entrante se une al sitio P.", "Se sintetiza un nuevo enlace pept√≠dico por el sitio peptidil transferasa de la subunidad ribos√≥mica grande.", "El p√©ptido, todav√≠a unido a la mol√©cula del tRNA, se traslada al sitio P.", "El aminoacil - tRNA entrante se une al sitio E del ribosoma."], 
            a: "Se sintetiza un nuevo enlace pept√≠dico por el sitio peptidil transferasa de la subunidad ribos√≥mica grande.", 
            exp: "La peptidil transferasa (una ribozima en la subunidad mayor) cataliza la formaci√≥n del enlace pept√≠dico." 
        },
        { 
            q: "24. Todas las caracter√≠sticas siguientes son propias de un oper√≥n EXCEPTO:", 
            opts: ["Incluye genes estructurales.", "Es un mecanismo de control para genes eucariotas.", "Se espera que codifique un mRNA policistr√≥nico.", "Contiene secuencias de control tales como un operador.", "Suele regular la expresi√≥n de los genes en funci√≥n de los nutrientes del medio."], 
            a: "Es un mecanismo de control para genes eucariotas.", 
            exp: "Los operones son caracter√≠sticos de PROCARIOTAS. Los eucariotas suelen tener promotores individuales para cada gen." 
        },
        { 
            q: "25. La expresi√≥n completa del oper√≥n lac requiere:", 
            opts: ["La prote√≠na represora.", "S√≥lo lactosa.", "Solo cAMP.", "Lactosa y cAMP.", "Que no haya lactosa en el medio."], 
            a: "Lactosa y cAMP.", 
            exp: "La lactosa inactiva al represor (desbloqueo) y el cAMP (con CAP) activa al promotor (estimulaci√≥n)." 
        },
        { 
            q: "26. En la transcripci√≥n eucari√≥tica por la RNA polimerasa II, la formaci√≥n de un complejo de preiniciaci√≥n:", 
            opts: ["Implica la adici√≥n ordenada de varios factores de transformaci√≥n y de la RNA polimerasa.", "Requiere que el dominio C- Terminal (CTD) de la RNA polimerasa II no est√© fosforilado en este punto.", "Todas son correctas.", "Todas son falsas.", "Empieza con la uni√≥n de una prote√≠na (TBP) a la caja TATA del promotor."], 
            a: "Todas son correctas.", 
            exp: "Se requiere un ensamblaje ordenado de factores basales (TFIIA, B, D, E, F, H) y la Pol II con su CTD no fosforilado." 
        },
        { 
            q: "27. La terminaci√≥n de la s√≠ntesis proteica:", 
            opts: ["Requiere la acci√≥n de una hidrolasa no ribos√≥mica para liberar al p√©ptido.", "Requiere un cod√≥n de terminaci√≥n en el sitio P de la subunidad ribos√≥mica grande.", "Ocurre cuando un factor proteico de liberaci√≥n no ribos√≥mico se une al ribosoma.", "No requiere energ√≠a.", "Coincide con la degradaci√≥n de los ribosomas."], 
            a: "Ocurre cuando un factor proteico de liberaci√≥n no ribos√≥mico se une al ribosoma.", 
            exp: "Cuando entra un cod√≥n STOP en el sitio A, se unen factores de liberaci√≥n (RF) que hidrolizan el p√©ptido." 
        },
        { 
            q: "28. Deseas realizar un protocolo de subclonaci√≥n de DNA de longitud peque√±a (menor de 5 kb), identifica qu√© vector usar√≠as preferiblemente:", 
            opts: ["YAC.", "Bacteri√≥fago lambda.", "Pl√°smido.", "C√≥smido."], 
            a: "Pl√°smido.", 
            exp: "Los pl√°smidos son ideales para insertar fragmentos de DNA peque√±os (hasta 10-15 kb)." 
        },
        { 
            q: "29. Indica qu√© emparejamiento de bases es incorrecto:", 
            opts: ["A - T.", "A - U.", "T - C.", "G - C."], 
            a: "T - C.", 
            exp: "Las pirimidinas (T, C) no se aparean entre s√≠ en la estructura est√°ndar de Watson-Crick." 
        }
    ];

    // --- ASIGNAR IDs √öNICOS ---
    quizData.forEach((item, index) => {
        item.id = index;
    });

    // --- GESTI√ìN DE ESTADO ---
    let markedQuestions = new Set();
    let failedQuestions = new Set();

    function shuffleArray(array) {
        let currentIndex = array.length, randomIndex;
        while (currentIndex !== 0) {
            randomIndex = Math.floor(Math.random() * currentIndex);
            currentIndex--;
            [array[currentIndex], array[randomIndex]] = [array[randomIndex], array[currentIndex]];
        }
        return array;
    }

    const container = document.getElementById('quiz-container');

    // Funci√≥n principal
    function renderQuiz(questionsToLoad = quizData) {
        container.innerHTML = "";
        document.getElementById("restart-menu").style.display = "none";
        document.getElementById("finish-btn").style.display = "inline-block";

        if(questionsToLoad.length === 0) {
            container.innerHTML = "<p style='text-align:center; padding:20px; color:#6b7280;'>No hay preguntas para mostrar en esta selecci√≥n.</p>";
            return;
        }

        questionsToLoad.forEach((item, displayIndex) => {
            const card = document.createElement('div');
            card.className = 'question-card';

            // Checkbox Marcar
            const markContainer = document.createElement("div");
            markContainer.className = "mark-container";
            const checkbox = document.createElement("input");
            checkbox.type = "checkbox";
            checkbox.id = `mark-${item.id}`;
            if(markedQuestions.has(item.id)) checkbox.checked = true;

            checkbox.onchange = (e) => {
                if(e.target.checked) markedQuestions.add(item.id);
                else markedQuestions.delete(item.id);
            };

            const label = document.createElement("label");
            label.htmlFor = `mark-${item.id}`;
            label.innerText = "Marcar para revisar";
            markContainer.appendChild(checkbox);
            markContainer.appendChild(label);
            card.appendChild(markContainer);

            // Pregunta
            const header = document.createElement('div');
            header.className = 'question-header';
            header.textContent = `Pregunta ${item.id + 1}`; 
            card.appendChild(header);

            const questionText = document.createElement('div');
            questionText.className = 'question-text';
            questionText.textContent = item.q;

            // --- INSERCI√ìN DE DIAGRAMAS (Visualizaci√≥n mejorada) ---
            if (item.id === 0) { // DNA Replication
                questionText.innerHTML += `<span class='img-tag'></span>`;
            } else if (item.id === 1) { // mRNA Processing
                questionText.innerHTML += `<span class='img-tag'></span>`;
            } else if (item.id === 3) { // Cell Cycle E2F
                questionText.innerHTML += `<span class='img-tag'></span>`;
            } else if (item.id === 5) { // p53
                questionText.innerHTML += `<span class='img-tag'></span>`;
            } else if (item.id === 15) { // Nucleosome
                 questionText.innerHTML += `<span class='img-tag'>

[Image of nucleosome structure]
</span>`;
            } else if (item.id === 24) { // Lac Operon
                 questionText.innerHTML += `<span class='img-tag'></span>`;
            } else if (item.id === 20) { // Translation Initiation
                 questionText.innerHTML += `<span class='img-tag'></span>`;
            } else if (item.id === 27) { // Cloning Vectors
                 questionText.innerHTML += `<span class='img-tag'>

[Image of plasmid vector map]
</span>`;
            }

            card.appendChild(questionText);

            // Opciones
            const optionsDiv = document.createElement('div');
            optionsDiv.className = 'options-container';

            let optionsObj = item.opts.map(opt => ({
                text: opt,
                isCorrect: opt === item.a
            }));
            optionsObj = shuffleArray(optionsObj);

            // Explicaci√≥n
            const explanationDiv = document.createElement('div');
            explanationDiv.className = 'explanation';
            explanationDiv.innerHTML = `<strong>Explicaci√≥n:</strong> ${item.exp}`;

            optionsObj.forEach(opt => {
                const btn = document.createElement('button');
                btn.className = 'option-btn';
                btn.textContent = opt.text;

                btn.onclick = () => {
                    const allBtns = optionsDiv.querySelectorAll('.option-btn');
                    allBtns.forEach(b => b.disabled = true);

                    if (opt.isCorrect) {
                        btn.classList.add('correct');
                    } else {
                        btn.classList.add('incorrect');
                        failedQuestions.add(item.id);
                        
                        allBtns.forEach(b => {
                            if (b.textContent === item.a) b.classList.add('correct');
                        });
                    }
                    explanationDiv.classList.add('visible');
                };
                optionsDiv.appendChild(btn);
            });

            card.appendChild(optionsDiv);
            card.appendChild(explanationDiv);
            container.appendChild(card);
        });
    }

    // --- Control Final ---
    function showEndOptions() {
        document.getElementById("finish-btn").style.display = "none";
        document.getElementById("restart-menu").style.display = "flex";
        document.getElementById("controls-area").scrollIntoView({behavior: "smooth"});
        
        document.getElementById("stats-summary").innerHTML = `
            Preguntas marcadas: <strong>${markedQuestions.size}</strong><br>
            Preguntas falladas en esta sesi√≥n: <strong>${failedQuestions.size}</strong>
        `;
    }

    function restartQuiz(mode) {
        let subset = [];
        if (mode === 'all') subset = quizData;
        else if (mode === 'marked') subset = quizData.filter(q => markedQuestions.has(q.id));
        else if (mode === 'failed') subset = quizData.filter(q => failedQuestions.has(q.id));
        else if (mode === 'failed_marked') subset = quizData.filter(q => failedQuestions.has(q.id) || markedQuestions.has(q.id));

        if(mode !== 'all') failedQuestions.clear(); 
        else {
            failedQuestions.clear();
            markedQuestions.clear();
        }

        renderQuiz(subset);
        window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    renderQuiz();
</script>

</body>
</html>
